<!DOCTYPE html>
<html>
<head>
    <title>SpreadJS - Samples</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    <!--Font-Awesome-->
    <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet">

    <!--SpreadJS Css-->
    <link href="http://cdn.wijmo.com/spreadjs/gcspread.sheets.8.40.20151.0.css" rel="stylesheet" type="text/css" />

    <!--Theme-->
    <link href="http://cdn.wijmo.com/themes/arctic/jquery-wijmo.css" rel="stylesheet" type="text/css" title="rocket-jqueryui" />

    <!--Wijmo Widgets CSS-->
    <link href="http://cdn.wijmo.com/jquery.wijmo-pro.all.3.20143.59.min.css" rel="stylesheet" type="text/css" />

    <!--jQuery References-->
    <script src="http://code.jquery.com/jquery-1.11.1.min.js" type="text/javascript"></script>
    <script src="http://code.jquery.com/ui/1.11.0/jquery-ui.min.js" type="text/javascript"></script>

    <!--Wijmo Widgets JavaScript-->
    <script src="http://cdn.wijmo.com/jquery.wijmo-open.all.3.20143.59.min.js" type="text/javascript"></script>
    <script src="http://cdn.wijmo.com/jquery.wijmo-pro.all.3.20143.59.min.js" type="text/javascript"></script>

    <script type="text/javascript" src="http://cdn.wijmo.com/spreadjs/gcspread.sheets.all.8.40.20151.0.min.js"></script>

    <style type="text/css">
        .theme-title {
            width: 50px;
            height: 50px;
            margin: 2px 2px 2px 2px;
            border: 1px solid gray;
        }

        .theme-smalltitle {
            width: 50px;
            height: 20px;
            margin: 2px 2px 2px 2px;
            border: 1px solid gray;
        }

        td {
            border-collapse: collapse;
        }

        .dialogLabel {
            width: 80px;
            display: inline-block;
            display: -moz-inline-box;
        }

        .dialogRightLabel {
            width: 70px; 
            display: inline-block; 
            display: -moz-inline-box;
            margin-left:10px;
        }

        .dialogInput {
            width: 100px;
        }

        .dialogRow {
            margin-top: 10px;
        }

        .ui-dialog .ui-dialog-titlebar-close span {
            display: block;
            margin-left: -8px;
            margin-top: -8px;
        }

        #ribbon {
            background: white;
        }

        #ribbon * {
            outline: 0;
        }

        #ribbon > ul {
            background: #DEDEDE;
        }

        #ribbon > ul > li {
            border: 1px solid #DEDEDE;
            border-radius: 0;
        }

        #ribbon > div {
            border: 1px solid #ABABAB;
        }

        #ribbon .ui-widget-header {
            border: 0;
        }

        #ribbon ul>li>a {
            padding: 8px 16px;
            font-family: "Segoe UI";
            font-size:9pt;
            font-weight:normal;
            color: black;
        }

        #ribbon button > span {
            font-family: "Segoe UI"; 
            font-size: 9pt;
            font-weight:normal;
            color: black;
        }

        #ribbon span.ui-button-text {
            font-family: "Segoe UI"; 
            font-size: 9pt;
            font-weight:normal;
        }

        #ribbon div.wijmo-wijribbon-abbrevgroup span.wijmo-wijribbon-text {
            font-family: "Segoe UI"; 
            font-size: 9pt;
            font-weight:normal;
        }

        .gcsj-func-color-text {
            font-family:  Calibri;
            font-size:  11pt;
        }

        #ribbon ul.wijmo-wijribbon-dropdown > li {
            border:0;
        }

        #ribbon ul.wijmo-wijribbon-dropdown label>span {
            font-size: 9pt;
            font-weight: bold;
            color: #595959;
        }

        #ribbon .ui-state-default, .ui-widget-content .ui-state-default {
            background: #F3F3F3;
        }

        #ribbon > ul > li.ui-state-default {
            background: #DEDEDE;
            border: 1px solid #DEDEDE;
        }

        #ribbon > ul > li.ui-state-default > a {
            color: black;
            border: 1px solid #DEDEDE;
        }

        #ribbon > ul > li.ui-tabs-active {
            background: #F3F3F3;
            border: 1px solid #ABABAB;
        }

        #ribbon > ul > li.ui-tabs-active > a {
            color: green;
            border: 1px solid #F3F3F3;
        }

        #ribbon > ul > li.ui-state-hover > a {
            color: green;
        }

        #ribbon>div>ul>li button .ui-state-hover  {
            background: #D3F0E0;
        }

        #ribbon>div>ul>li div.ui-buttonset .ui-state-hover  {
            background: #D3F0E0;
        }

        #ribbon>div>ul>li div.wijmo-wijribbon-abbrevgroup.ui-state-hover  {
            background: #D3F0E0;
        }

        #ribbon ul.wijmo-wijribbon-dropdown>li span.ui-state-hover {
            background: #D3F0E0;
        }

        .ui-dialog {
            background: #5ABB83;
            padding: 6px;
            border:1px solid #458F64;
            border-radius: 0;
            font-family: "Segoe UI"; 
            font-size: 9pt;
            font-weight: normal;
            z-index: 1000 !important;
        }

        .ui-dialog-titlebar {
            border: 0;
            background: none;
            text-align: center;
            font-family: Calibri;
            font-size: 12pt;
            font-weight: normal;
        }

        .ui-dialog .ui-button {
            border: 1px solid #ACACAC;
            border-radius: 0;
            box-shadow: none;
            color: black;
            background: #F0F0F0;
            font-family: "Segoe UI"; 
            font-size: 9pt;
            font-weight: normal;
        }

        .ui-dialog input[type="button"],
        .ui-dialog input[type="input"],
        .ui-dialog select
         {
            border: 1px solid #ACACAC;
            border-radius: 0;
        }

        .ui-dialog input[type="button"] {
            background: #F0F0F0;
        }

        .ui-dialog .ui-dialog-buttonset .ui-button {
            width: 72px;
        }

        .ui-dialog .ui-button:hover {
            background: #E7F2FC;
        }

        .ui-dialog .ui-dialog-content {
            background: #F0F0F0;
        }

        .ui-dialog .ui-dialog-buttonpane {
            border: 0;
            margin: 0;
            background: #F0F0F0;
        }

        .ui-dialog .ui-dialog-title {
            float: none;
        }

        .ui-dialog .ui-widget input, .ui-widget select, .ui-widget textarea, .ui-widget button {
            font-family: "Segoe UI"; 
            font-size: 9pt;
            font-weight: normal;
        }

        .ui-dialog .ui-widget-header {
            background: none;
        }

        .ui-dialog-content, .ui-dialog-content * {
            font-family: "Segoe UI"; 
            font-size: 9pt;
            font-weight:normal;
            color:black;
        }

        .wijmo-wijribbon .wijmo-wijribbon-panel .wijmo-wijribbon-groups {
            background-color: #F3F3F3;
            font-size: 9pt;
        }

        .wijmo-wijribbon .wijmo-wijribbon-dropdown {
            background-color: white;
        }

        .wijmo-wijribbon .wijmo-wijribbon-group .wijmo-wijribbon-bigbutton {
            height: 54px;
        }

        .wijmo-wijribbon-groups .wijmo-wijribbon-group .wijmo-wijribbon-dropdowngroup {
            background: white;
        }

        #colorchart td {
            border: 1px solid transparent;
            border-collapse: collapse;
        }

        #colorchart .selected {
            border: 1px solid white;
        }

        div.dialogGroup {
            padding: 6px;
            border: 1px solid gray;
        }

        #datavalidationdialog ul>li>a {
            color: black;
        }

        .ui-tabls {
            background-image: none;
        }
    </style>

    <script id="scriptInit" type="text/javascript">
        // zoom event handler
        function zoomFactor_Changed(value) {
            var ss = $("#ss").data("spread");
            var sheet = ss.getActiveSheet();
            sheet.zoom(value);
        }

        // spread / sheet event handlers
        function selectionChanged(sender, args) {
            var spread = $("#ss").data("spread");
            var sheet = spread.getActiveSheet();
            var position = sheet.getText(0, sheet.getActiveColumnIndex(), GcSpread.Sheets.SheetArea.colHeader) + sheet.getText(sheet.getActiveRowIndex(), 0, GcSpread.Sheets.SheetArea.rowHeader);
            $("#positionbox").val(position);
        }

        function updateSheetList() {
            $("#sheetList").empty();
            var spread = $("#ss").data("spread");
            if (spread && spread.sheets) {
                for (var index = 0; index < spread.sheets.length; index++) {
                    var sheetName = spread.sheets[index].getName();
                    $("#sheetList").append("<option value='" + sheetName + "'>" + sheetName + "</option>");
                }
            }
        }

        function setstatus(sheet) {
            var statusnow = sheet.editorStatus();
            if (statusnow === GcSpread.Sheets.EditorStatus.Ready) {
                $("#rapidInputMode").text("READY");
            } else if (statusnow === GcSpread.Sheets.EditorStatus.Enter) {
                $("#rapidInputMode").text("ENTER");
            } else if (statusnow === GcSpread.Sheets.EditorStatus.Edit) {
                $("#rapidInputMode").text("EDIT");
            }
        }

        // group event handlers
        function rowlabelactive() {
            $("#showRowGroupLabel").addClass("ui-state-active");
        }
        function rowlabelnoactive() {
            $("#showRowGroupLabel").removeClass("ui-state-active");
        }
        function collabelactive() {
            $("#showColGroupLabel").addClass("ui-state-active");
        }
        function collabelnoactive() {
            $("#showColGroupLabel").removeClass("ui-state-active");
        }

        // validation event handlers
        function IsRangeSet() {
            var validatorComparisonOperator = parseInt($("#validatorComparisonOperator").val());

            if (validatorType == "NumberValidator" || validatorType == "TextLengthValidator") {
                if ($("#txtValidatorValue1").val().length == 0) {
                    if (validatorComparisonOperator >= 6 && $("#txtValidatorValue2").val().length == 0) {
                        alert("You must enter both a Maximum and Minimum.");
                    } else {
                        alert("You must enter a Value.");
                    }
                }
            } else if (validatorType == "DateValidator") {
                if ($("#txtValidatorValue1").val().length == 0) {
                    if (validatorComparisonOperator >= 6 && $("#txtValidatorValue2").val().length == 0) {
                        alert("You must enter both a End Date and a Start Date.");
                    } else {
                        alert("You must enter a date Value.");
                    }
                }
            } else if (validatorType == "ListValidator") {
                if ($("#txtValidatorValue").val().length == 0) {
                    alert("You must enter a Source.");
                }
            } else if (validatorType == "FormulaListValidator" || validatorType == "FormulaValidator") {
                if ($("#txtValidatorValue").val().length == 0) {
                    alert("You must enter a Formula.");
                }
            }
        }

        // border event hanlders
        function noborderclick() {
            $("#borderdialog :checkbox").removeAttr("checked");
            $("#border11").css("border", "none");
            $("#border12").css("border", "none");
            $("#border21").css("border", "none");
            $("#border22").css("border", "none");
            $("#bordertable").css("border", "none");
        }
        function outlineborderclick() {
            $("#borderdialog :checkbox").removeAttr("checked");
            $("[id*=Side]").prop("checked", true);
            $("#border11").css("border", "1px solid gray");
            $("#border12").css("border", "1px solid gray");
            $("#border21").css("border", "1px solid gray");
            $("#border22").css("border", "1px solid gray");
            $("#border11").css("border-right", "none");
            $("#border11").css("border-bottom", "none");
            $("#border12").css("border-left", "none");
            $("#border12").css("border-bottom", "none");
            $("#border21").css("border-right", "none");
            $("#border21").css("border-top", "none");
            $("#border22").css("border-top", "none");
            $("#border22").css("border-left", "none");
            $("#bordertable").css("border", "1px solid gray");
        }
        function allborderclick() {
            $("#borderdialog :checkbox").prop("checked", true);
            $("#border11").css("border", "1px solid gray");
            $("#border12").css("border", "1px solid gray");
            $("#border21").css("border", "1px solid gray");
            $("#border22").css("border", "1px solid gray");
            $("#bordertable").css("border", "1px solid gray");
        }

        // helper functions begin
        function componentToHex(c) {
            var hex = c.toString(16);
            return hex.length == 1 ? "0" + hex : hex;
        }

        function rgbToHex(r, g, b) {
            return "#" + componentToHex(r) + componentToHex(g) + componentToHex(b);
        }

        function processMinItems($selectionElement, $valueElement) {
            var type = parseInt($selectionElement.val(), 10),
                value = "";
            switch (type) {
                case 0: // Number
                case 3: // Percent
                    value = "0";
                    break;
                case 4: // Percentile
                    value = "10";
                    break;
                default:
                    value = "";
                    break;
            }
            $valueElement.val(value);
        }

        function processMidItems($selectionElement, $valueElement) {
            var type = parseInt($selectionElement.val(), 10),
                value = "";
            switch (type) {
                case 0: // Number
                    value = "0";
                    break;
                case 3: // Percent
                case 4: // Percentile
                    value = "50";
                    break;
                default:
                    value = "";
                    break;
            }
            $valueElement.val(value);
        }

        function processMaxItems($selectionElement, $valueElement) {
            var type = parseInt($selectionElement.val(), 10),
                value = "";
            switch (type) {
                case 0: // Number
                    value = "0";
                    break;
                case 3: // Percent
                    value = "100";
                    break;
                case 4: // Percentile
                    value = "90";
                    break;
                default:
                    value = "";
                    break;
            }
            $valueElement.val(value);
        }

        function getActualRange(range, maxRowCount, maxColCount) {
            var row = range.row < 0 ? 0 : range.row;
            var col = range.col < 0 ? 0 : range.col;
            var rowCount = range.rowCount < 0 ? maxRowCount : range.rowCount;
            var colCount = range.colCount < 0 ? maxColCount : range.colCount;

            return new GcSpread.Sheets.Range(row, col, rowCount, colCount);
        }
        function getActualCellRange(cellRange, rowCount, columnCount) {
            if (cellRange.row == -1 && cellRange.col == -1) {
                return new GcSpread.Sheets.Range(0, 0, rowCount, columnCount);
            }
            else if (cellRange.row == -1) {
                return new GcSpread.Sheets.Range(0, cellRange.col, rowCount, cellRange.colCount);
            }
            else if (cellRange.col == -1) {
                return new GcSpread.Sheets.Range(cellRange.row, 0, cellRange.rowCount, columnCount);
            }

            return cellRange;
        }

        // font related setting
        function setStyleFont(sheet, styleEle, styleFontName, optionValue1, optionValue2) {
            var sels = sheet.getSelections();
            for (var n = 0; n < sels.length; n++) {
                var sel = getActualCellRange(sels[n], sheet.getRowCount(), sheet.getColumnCount());
                for (var r = sel.row; r < sel.row + sel.rowCount; r++) {
                    for (var c = sel.col; c < sel.col + sel.colCount; c++) {
                        var style = sheet.getStyle(r, c);
                        if (!style) {
                            style = new GcSpread.Sheets.Style();
                        }
                        if (!style.font) {
                            var defaultFont = sheet.getDefaultStyle().font;
                            if (defaultFont) {
                                style.font = sheet.getDefaultStyle().font;
                            } else {
                                style.font = "10pt Arial";
                            }
                        }
                        styleEle.style.font = style.font;
                        var styleFont = $(styleEle).css(styleFontName);
                        if (styleFont === optionValue1[0] || styleFont === optionValue1[1]) {
                            $(styleEle).css(styleFontName, optionValue2);
                        } else {
                            $(styleEle).css(styleFontName, optionValue1[0]);
                        }
                        style.font = styleEle.style.font;
                        sheet.setStyle(r, c, style);
                    }
                }
            }
        }

        // screen size
        function screenAdption() {
            adjustHeight($("#ribbon div[aria-hidden='false']").index() - 1);
        }

        /* 
            adjust layout: 
            1. ribbon content height if needed for the tab with the specified index
            2. spread and its container' height
        */
        function adjustHeight(tabIndex) {
            var ids = ["picture", "sparklineEx", "setcolor", "dragFill", "jQueryThemes"];

            // 1. ribbon content
            if (tabIndex < ids.length) {
                var $last = $("#" + ids[tabIndex]),
                    $first = $last.siblings().first(),
                    height = $last.css("height"),
                    height2 = $first.css("height");

                if (height != height2) {
                    $last.siblings().css("height", height);
                }
            }

            // 2. spread and its container
            var windowHeight = $(window).height(),
                spreadHeight = windowHeight - $("#ribbon").height() - $("#formulaBar").height() - $("#statusBar").height() - 24;

            // adjust height if too small
            spreadHeight = Math.max(spreadHeight, 120);
            
            $("#controlPanel").height(spreadHeight);
            $("#ss").height(spreadHeight);

            // sometimes the window height changed for some unknown reason, so check and do adjust
            var windowHeight2 = $(window).height();

            if (windowHeight2 > windowHeight) {
                spreadHeight += $(window).height() - windowHeight;
                $("#controlPanel").height(spreadHeight);
                $("#ss").height(spreadHeight);
            }
            
            $("#ss").data("spread").refresh();
        }

        // sparklineex
        function parseRangeToExpString(range, sp) {
            var Calc = GcSpread.Sheets.Calc;
            return Calc.rangeToFormula(range, 0, 0, Calc.RangeReferenceRelative.allRelative);
        }
        function parseStringToExternalRanges(expString, sheet) {
            var Calc = GcSpread.Sheets.Calc;
            var results = [];
            var exps = expString.split(",");
            try {
                for (var i = 0; i < exps.length; i++) {
                    var range = Calc.formulaToRange(sheet, exps[i]);
                    results.push({ "range": range });
                }
            }
            catch (e) {
                return null;
            }
            return results;
        }

        //table
        function getTableStyle() {
            var styleName = $("#tableStyles>option:selected").text();
            if (styleName) {
                return GcSpread.Sheets.TableStyles[styleName.toLowerCase()]();
            }
            return null;
        }
        function getTableName(sheet) {
            var i = 1,
                sheets = sheet.parent.sheets,
                found;
            while (true) {
                var name = "table" + i.toString();
                found = sheets.some(function (checkingSheet) {
                    return checkingSheet.findTableByName(name);
                });
                if (!found) {
                    return name;
                }
                i++;
            }
        }

        // Icon Change
        function changeIcons() {
            iconChange($("button[title='Paste']"), true, 'fa fa-clipboard fa-2x');
            iconChange($("button[title='Table']"), true, 'fa fa-table fa-2x');
            iconChange($("button[title='Picture']"), true, 'fa fa-picture-o fa-2x');
            iconChange($("button[title='Sort A-Z']"), false, 'fa fa-sort-alpha-asc');
            iconChange($("button[title='Sort Z-A']"), false, 'fa fa-sort-alpha-desc');
            iconChange($("button[title='Filter']"), true, 'fa fa-filter fa-2x');
            iconChange($("button[title='Comment']"), true, 'fa fa-comment fa-2x');
            iconChange($("button[title='Remove Conditional Formats']"), false, 'fa fa-trash-o');
            iconChange($("button[title='Circle Invalid Data']"), false, 'fa fa-circle-thin');
            iconChange($("button[title='Clear Validation Circles']"), false, 'fa fa-trash-o');
            iconChange($("button[title='Clear CellType']"), false, 'fa fa-trash-o');
            iconChange($("button[title='Freeze Setting']"), false, 'fa fa-cog');
            iconChange($("button[title='Group']"), true, 'fa fa-link fa-2x');
            iconChange($("button[title='UnGroup']"), true, 'fa fa-chain-broken fa-2x');
            iconChange($("button[title='Show Detail']"), false, 'fa fa-plus-square-o');
            iconChange($("button[title='Hide Detail']"), false, 'fa fa-minus-square-o');
            iconChange($("button[title='Data Validation']"), true, 'fa fa-ban fa-2x');
            iconChange($("button[title='SparklineEx']"), true, 'fa fa-bar-chart-o fa-2x');
            iconChange($("button[title='Freeze Pane']"), true, 'fa fa-plus-square fa-2x');
            iconChange($("button[title='UnFreeze']"), true, 'fa fa-square-o fa-2x');
            iconChange($("button[title='Import']"), true, 'fa fa-folder-open-o fa-2x');
            iconChange($("button[title='Export']"), true, 'fa fa-floppy-o fa-2x');
        }
        function iconChange(element, isBig, cssClass) {
            element.children('.ui-icon').remove();
            var i = $('<i></i>');
            i.addClass(cssClass);
            if (isBig) {
                i.css({
                    position: 'absolute',
                    left: '50%',
                    top: '50%',
                    height: '32px',
                    width: '32px',
                    display: 'block',
                    cursor: 'pointer',
                    overflow: 'hidden'
                }).css('margin-left', '-17px')
                        .css('margin-top', '-22px')
                        .css('text-align', 'center');
            } else {
                i.css({
                    position: 'absolute',
                    left: '.5em',
                    top: '50%',
                    height: '16px',
                    width: '16px',
                    display: 'block',
                    cursor: 'pointer',
                    overflow: 'hidden'
                }).css('margin-top', '-7px')
                        .css('text-align', 'center');
            }
            element.prepend(i);
            return i;
        }

        // color dialog
        function setColor(event, title) {
            var colorValue = $(event.target).css("background-Color") || "";
            showColorDialog(title, colorValue);
        }

        function showColorDialog(title, colorValue) {
            $("#colordialog").dialog({ title: title, color: colorValue });
            $("#colordialog").dialog("open");
        }

        // color dialog event hanlders
        function colorSelected(event) {
            var event = event || window.event;
            var target = event.srcElement || event.target;
            $("#colorchart td.selected").removeClass("selected");
            $(target).addClass("selected");
            $("#selectedColor").val(target.bgColor);
            $("#colorSample").css("background-color", target.bgColor);
        }

        // conditional format dialog
        function createIconCriteriaDOM() {
            var IconSetType = GcSpread.Sheets.IconSetType,
                    IconCriterion = GcSpread.Sheets.IconCriterion,
                    IconValueType = GcSpread.Sheets.IconValueType;
            var iconSetType = parseInt($("#iconSetType").val(), 10);
            var iconCriteria = [];
            if (iconSetType >= IconSetType.ThreeArrowsColored &&
                    iconSetType <= IconSetType.ThreeSymbolsUncircled) {
                iconCriteria = new Array(2);
                iconCriteria[0] = new IconCriterion(true, IconValueType.Percent, 33);
                iconCriteria[1] = new IconCriterion(true, IconValueType.Percent, 67);
            }
            else if (iconSetType >= IconSetType.FourArrowsColored &&
                    iconSetType <= IconSetType.FourTrafficLights) {
                iconCriteria = new Array(3);
                iconCriteria[0] = new IconCriterion(true, IconValueType.Percent, 25);
                iconCriteria[1] = new IconCriterion(true, IconValueType.Percent, 50);
                iconCriteria[2] = new IconCriterion(true, IconValueType.Percent, 75);
            }
            else if (iconSetType >= IconSetType.FiveArrowsColored &&
                    iconSetType <= IconSetType.FiveBoxes) {
                iconCriteria = new Array(4);
                iconCriteria[0] = new IconCriterion(true, IconValueType.Percent, 20);
                iconCriteria[1] = new IconCriterion(true, IconValueType.Percent, 40);
                iconCriteria[2] = new IconCriterion(true, IconValueType.Percent, 60);
                iconCriteria[3] = new IconCriterion(true, IconValueType.Percent, 80);
            }

            $("#iconCriteriaSetting").empty();
            $.each(iconCriteria, function (i, v) {
                var $div = $("<div style='margin-top: 10px'></div>"),
                        $selectOperator = $("<select></select>"),
                        $input = $("<input style='margin-left: 10px'/>"),
                        $selectType = $("<select style='margin-left: 10px'></select>");
                $selectOperator.html("<option value=1 " + getSelected(v.isGreaterThanOrEqualTo, true) + ">>=</option>" +
                        "<option value=0 " + getSelected(v.isGreaterThanOrEqualTo, false) + ">></option>");
                $input.val(v.iconValue);
                $selectType.html("<option value=1 " + getSelected(v.iconValueType, 1) + ">Number</option>" +
                        "<option value=4 " + getSelected(v.iconValueType, 4) + ">Percent</option>" +
                        "<option value=7 " + getSelected(v.iconValueType, 7) + ">Formula</option>" +
                        "<option value=5 " + getSelected(v.iconValueType, 5) + ">Percentile</option>");
                $div.append($selectOperator).append($input).append($selectType);
                $("#iconCriteriaSetting").append($div);
            });
        }
        function getSelected(v1, v2) {
            return v1 === v2 ? "selected='selected'" : "";
        }
        function setEnumTypeOfCF(rule, type) {
            switch (rule) {
                case "0":
                    $("#ruletext").text("Format only cells with:");
                    $("#andtext").hide();
                    $("#formattext").hide();
                    type.empty();
                    type.show();
                    $("#ComparisonOperator1").show();
                    $("#value1").show();
                    $("#value1").val("");
                    $("#value2").hide();
                    $("#colorScale").hide();
                    type.append("<option value='0'>EqualsTo</option>");
                    type.append("<option value='1'>NotEqualsTo</option>");
                    type.append("<option value='2'>GreaterThan</option>");
                    type.append("<option value='3'>GreaterThanOrEqualsTo</option>");
                    type.append("<option value='4'>LessThan</option>");
                    type.append("<option value='5'>LessThanOrEqualsTo</option>");
                    type.append("<option value='6'>Between</option>");
                    type.append("<option value='7'>NotBetween</option>");
                    break;
                case "1":
                    $("#ruletext").text("Format only cells with:");
                    $("#andtext").hide();
                    $("#formattext").hide();
                    type.empty();
                    type.show();
                    $("#ComparisonOperator1").show();
                    $("#value1").show();
                    $("#value1").val("");
                    $("#value2").hide();
                    $("#colorScale").hide();
                    type.append("<option value='0'>Contains</option>");
                    type.append("<option value='1'>DoesNotContain</option>");
                    type.append("<option value='2'>BeginsWith</option>");
                    type.append("<option value='3'>EndsWith</option>");
                    break;
                case "2":
                    $("#ruletext").text("Format only cells with:");
                    $("#andtext").hide();
                    $("#formattext").hide();
                    type.empty();
                    type.show();
                    $("#ComparisonOperator1").show();
                    $("#value1").hide();
                    $("#value2").hide();
                    $("#colorScale").hide();
                    type.append("<option value='0'>Today</option>");
                    type.append("<option value='1'>Yesterday</option>");
                    type.append("<option value='2'>Tomorrow</option>");
                    type.append("<option value='3'>Last7Days</option>");
                    type.append("<option value='4'>ThisMonth</option>");
                    type.append("<option value='5'>LastMonth</option>");
                    type.append("<option value='6'>NextMonth</option>");
                    type.append("<option value='7'>ThisWeek</option>");
                    type.append("<option value='8'>LastWeek</option>");
                    type.append("<option value='9'>NextWeek</option>");
                    break;
                case "3":
                    $("#ruletext").text("Format values where this formula is true:");
                    $("#andtext").hide();
                    $("#formattext").show();
                    $("#formattext").text("eg:=COUNTIF($B$1:$B$5,A1).");
                    type.empty();
                    $("#ComparisonOperator1").hide();
                    $("#value1").show();
                    $("#value1").val("");
                    $("#value2").hide();
                    $("#colorScale").hide();
                    break;
                case "4":
                    $("#ruletext").text("Format values that rank in the:");
                    $("#andtext").hide();
                    $("#formattext").hide();
                    type.empty();
                    $("#ComparisonOperator1").show();
                    $("#value1").show();
                    $("#value1").val("10");
                    $("#value2").hide();
                    $("#colorScale").hide();
                    type.append("<option value='0'>Top</option>");
                    type.append("<option value='1'>Bottom</option>");
                    break;
                case "5":
                    $("#ruletext").text("Format all:");
                    $("#andtext").hide();
                    $("#formattext").show();
                    $("#formattext").text("values in the selected range.");
                    type.empty();
                    $("#ComparisonOperator1").hide();
                    $("#value1").hide();
                    $("#value2").hide();
                    $("#colorScale").hide();
                    break;
                case "6":
                    $("#ruletext").text("Format all:");
                    $("#andtext").hide();
                    $("#formattext").show();
                    $("#formattext").text("values in the selected range.");
                    type.empty();
                    $("#ComparisonOperator1").hide();
                    $("#value1").hide();
                    $("#value2").hide();
                    $("#colorScale").hide();
                    break;
                case "7":
                    $("#ruletext").text("Format values that are:");
                    $("#andtext").hide();
                    $("#formattext").show();
                    $("#formattext").text("the average for selected range.");
                    type.empty();
                    type.show();
                    $("#ComparisonOperator1").show();
                    $("#value1").hide();
                    $("#value2").hide();
                    $("#colorScale").hide();
                    type.append("<option value='0'>Above</option>");
                    type.append("<option value='1'>Below</option>");
                    type.append("<option value='2'>EqualOrAbove</option>");
                    type.append("<option value='3'>EqualOrBelow</option>");
                    type.append("<option value='4'>Above1StdDev</option>");
                    type.append("<option value='5'>Below1StdDev</option>");
                    type.append("<option value='6'>Above2StdDev</option>");
                    type.append("<option value='7'>Below2StdDev</option>");
                    type.append("<option value='8'>Above3StdDev</option>");
                    type.append("<option value='9'>Below3StdDev</option>");
                    break;
                case "8":
                    $("#ruletext").text("Format all cells based on their values:");
                    $("#andtext").hide();
                    $("#formattext").hide();
                    type.empty();
                    type.hide();
                    $("#ComparisonOperator1").hide();
                    $("#value1").hide();
                    $("#value2").hide();
                    $("#colorScale").show();
                    $("#midpoint, #midType, #midValue, #midColor").css("visibility", "hidden");
                    $("#minType").val("1");
                    $("#maxType").val("2");
                    $("#minValue").val("");
                    $("#maxValue").val("");
                    $("#minColor").css("background", "#F8696B");
                    $("#maxColor").css("background", "#63BE7B");
                    break;
                case "9":
                    $("#ruletext").text("Format all cells based on their values:");
                    $("#andtext").hide();
                    $("#formattext").hide();
                    type.empty();
                    type.hide();
                    $("#ComparisonOperator1").hide();
                    $("#value1").hide();
                    $("#value2").hide();
                    $("#colorScale").show();
                    $("#midpoint, #midType, #midValue, #midColor").css("visibility", "visible");
                    $("#minType").val("1");
                    $("#midType").val("4");
                    $("#maxType").val("2");
                    $("#minValue").val("");
                    $("#midValue").val("50");
                    $("#maxValue").val("");
                    $("#minColor").css("background-color", "#F8696B");
                    $("#midColor").css("background-color", "#FFEB84");
                    $("#maxColor").css("background-color", "#63BE7B");
                    break;
                default:
                    $("#andtext").hide();
                    type.empty();
                    type.show();
                    $("#ComparisonOperator1").show();
                    $("#value1").show();
                    $("#value1").val("");
                    $("#value2").hide();
                    $("#colorScale").hide();
                    type.append("<option value='0'>EqualsTo</option>");
                    type.append("<option value='1'>NotEqualsTo</option>");
                    type.append("<option value='2'>GreaterThan</option>");
                    type.append("<option value='3'>GreaterThanOrEqualsTo</option>");
                    type.append("<option value='4'>LessThan</option>");
                    type.append("<option value='5'>LessThanOrEqualsTo</option>");
                    type.append("<option value='6'>Between</option>");
                    type.append("<option value='7'>NotBetween</option>");
                    break;
            }
        }

        // DataBar dialog
        function parseValue(value) {
            if (!value) {
                return null;
            }

            if (!isNaN(value) && isFinite(value)) {
                return parseFloat(value);
            } else {
                return value;
            }
        }

        // picture dialog
        function getFloatingObjectName(sheet) {
            var i = 0;
            while (true) {
                var name = "floatingObject" + i.toString();
                if (!sheet.findFloatingObject(name) && !sheet.findPicture(name)) {
                    return name;
                }
                i++;
            }
        }

        //Excel I/O
        function importFileWithAjax(serverUrl, formData, successCallback, errorCallback) {
            $.ajax({
                url: serverUrl, //Server script to process data
                type: 'POST',
                success: function completeHandler(data, textStatus, jqXHR) {
                    if (successCallback) {
                        successCallback(jqXHR.responseText);
                    }
                },
                error: function errorHandler(jqXHR, textStatus, errorThrown) {
                    if (errorCallback) {
                        errorCallback(errorThrown);
                    }
                },

                data: formData,  // Form data
                cache: false,  //Options to tell jQuery not to process data or worry about content-type.
                contentType: false,
                processData: false,
                headers: {  //Options to tell server return data with specified type
                    "Accept": "application/json"
                }
            });
        }
        function importFileWithIFrame(serverUrl, $fileElement, options, successCallback, errorCallback) {
            var theFileContainer = $fileElement.parent();
            var theCloneFileElement = $fileElement.clone();

            var $iframe = $("<iframe id='xFrame' style='display: none' src='about:blank'></iframe>").appendTo("body");
            $iframe.ready(function () {
                var formDoc = getiframeDocument($iframe);
                formDoc.write("<html><head></head><body><form method='Post' enctype='multipart/form-data' action='" + serverUrl + "'></form>dummy windows for postback</body></html>");
                var $form = $(formDoc).find('form');
                //append options to form
                $.each(options, function (index, field) {
                    $('<input type="hidden"/>')
                            .prop('name', field.name)
                            .val(field.value)
                            .appendTo($form);
                });
                //append Excel file to form
                $form.append($fileElement.attr("id", "tempFile1"));
                theFileContainer.prepend(theCloneFileElement);
                $form.submit();
            });
            $iframe.bind("load", function (e, args) {
                var formDoc = getiframeDocument($iframe);
                try {
                    var responseText = formDoc.body ? formDoc.body.innerText : null;
                    if (successCallback && responseText) {
                        successCallback(responseText);
                    }

                } catch (error) {
                    if (errorCallback) {
                        errorCallback(error);
                    }
                }
            });
        }
        function exportFile(serverUrl, content) {
            var formInnerHtml = '<input type="hidden" name="type" value="application/json" />';
            formInnerHtml += '<input type="hidden" name="data" value="' + htmlSpecialCharsEntityEncode(content) + '" />';
            var $iframe = $("<iframe style='display: none' src='about:blank'></iframe>").appendTo("body");
            $iframe.ready(function () {
                var formDoc = getiframeDocument($iframe);
                formDoc.write("<html><head></head><body><form method='Post' action='" + serverUrl + "'>" + formInnerHtml + "</form>dummy windows for postback</body></html>");
                var $form = $(formDoc).find('form');
                $form.submit();
            });
        }
        function getiframeDocument($iframe) {
            var iframeDoc = $iframe[0].contentWindow || $iframe[0].contentDocument;
            if (iframeDoc.document) {
                iframeDoc = iframeDoc.document;
            }
            return iframeDoc;
        }
        var htmlSpecialCharsRegEx = /[<>&\r\n"']/gm,
            hexColorValueRegEx = /^#[a-zA-z0-9]{6}$/,
            rgbColorValueRegEx = /^rgba?\((\d{1,3})\,\s{0,}(\d{1,3})\,\s{0,}(\d{1,3})/;

        var htmlSpecialCharsPlaceHolders = {
            '<': 'lt;',
            '>': 'gt;',
            '&': 'amp;',
            '\r': "#13;",
            '\n': "#10;",
            '"': 'quot;',
            "'": 'apos;' /*single quotes just to be safe*/
        };
        function htmlSpecialCharsEntityEncode(str) {
            return str.replace(htmlSpecialCharsRegEx, function (match) {
                return '&' + htmlSpecialCharsPlaceHolders[match];
            });
        }
        function showLoading() {
            $("#ss").css("position", "relative");
            var width = $("#ss").width() + 2, height = $("#ss").height();
            $("<span id='delaySpan'><span id='icon' style='display:inline-block'></span>Importing...</span>")
                    .css("left", width / 2 - 70)
                    .css("top", height / 2 - 30)
                    .css("position", "absolute")
                    .css("color", "#4f4f4f")
                    .css("background", "#ffffff")
                    .css("border", "1px solid #a8a8a8")
                    .css("border-radius", "3px")
                    .css("-webkit-border-radius", "3px")
                    .css("box-shadow", "0 0 10px rgba(0, 0, 0, 0.25")
                    .css("font-family", "Arial, sans-serif")
                    .css("font-size", "20px")
                    .css("padding", "0.4em")
                    .insertAfter("#ss");
            $("<div id='delayDiv'></div>")
                    .css("background", "#2D5972")
                    .css("opacity", 0.3)
                    .css("position", "absolute")
                    .css("top", 0)
                    .css("left", 0)
                    .css("width", width)
                    .css("height", height)
                    .insertAfter("#ss");
        }
        function hideLoading() {
            $("#delayDiv").remove();
            $("#delaySpan").remove();
        }
        function importSuccessCallback(responseText) {
            var spreadJson = JSON.parse(responseText);
            if (spreadJson.spread) {
                var spread = $("#ss").data("spread");
                spread.fromJSON(spreadJson.spread);
                hideLoading();
            } else if (spreadJson.error) {
                hideLoading();
                alert(spreadJson.error);
            }
        }
        function importErrorCallback(error) {
            hideLoading();
            alert(error);
        }
        function excelImport() {
            try {
                var dataOnly = $('#import_excel_dataOnly').prop('checked') ? 1 : 0,
                        dataAndFormulasOnly = $('#import_excel_dataAndFormulasOnly').prop('checked') ? 3 : 0,
                        rowHeaders = $('#import_excel_rowHeaders').prop('checked') ? 4 : 0,
                        columnHeaders = $('#import_excel_columnHeaders').prop('checked') ? 8 : 0,
                        rowColumnHeaders = $('#import_excel_rowcolumnHeaders').prop('checked') ? 12 : 0,
                        doNotRecalculateAfterLoad = $('#import_excel_donotrecalculateafterload').prop('checked') ? 1024 : 0;
                var excelOpenFlags = (dataOnly | dataAndFormulasOnly | rowHeaders | columnHeaders | rowColumnHeaders | doNotRecalculateAfterLoad);

                var serverUrl = $("#serviceUrl").val() + "/xsapi/import/";
                var formData;
                var theFile = $("#import_excel_file");

                if ($.browser.msie && parseInt($.browser.version, 10) <= 9) {
                    formData = [];
                    formData.push({ name: "ExcelOpenFlags", value: excelOpenFlags });

                    showLoading();
                    importFileWithIFrame(serverUrl, theFile, formData, importSuccessCallback, importErrorCallback);
                } else {
                    if (serverUrl && theFile[0]) {
                        formData = new FormData();
                        formData.append("ExcelOpenFlags", excelOpenFlags);
                        formData.append("file", theFile[0].files[0]);

                        showLoading();
                        importFileWithAjax(serverUrl, formData, importSuccessCallback, importErrorCallback);
                    }
                }
            } catch (ex) {
                alert(ex);
            }
        }
        function excelExport(spread) {
            var ExcelSaveFlags = {
                NoFlagsSet: 0,
                NoFormulas: 1,
                SaveCustomRowHeaders: 2,
                SaveCustomColumnHeaders: 4,
                SaveAsFiltered: 8,
                SaveBothCustomRowAndColumnHeaders: 6,
                SaveAsViewed: 136,
                DataOnly: 32,
                AutoRowHeight: 4096
            };
            var saveFlags = ExcelSaveFlags;
            var dataObj = {
                "spread": spread.toJSON(),
                "exportFileType": "xlsx",
                "excel": {
                    "saveFlags": saveFlags
                }
            };

            var name = $("#exportFileName").val();

            if (name) {
                dataObj["exportFileName"] = name;
            }

            var content = JSON.stringify(dataObj);
            var serverUrl = $("#serviceUrl").val() + "/xsapi/export/";
            exportFile(serverUrl, content);
        }

        // context menu
        function getCellInSelections(selections, row, col) {
            var count = selections.length, range;
            for (var i = 0; i < count; i++) {
                range = selections[i];
                if (range.contains(row, col)) {
                    return range;
                }
            }
            return null;
        }
        function getHitTest(pageX, pageY, sheet) {
            var offset = $("#ss").offset(),
                    x = pageX - offset.left,
                    y = pageY - offset.top;
            return sheet.hitTest(x, y);
        }
        function showMergeContextMenu(sheet) {
            var selections = sheet.getSelections();
            if (selections && selections.length > 0) {
                var spans = sheet.getSpans(selections[selections.length - 1], GcSpread.Sheets.SheetArea.viewport);
                if (spans && spans.length > 0) {
                    $(".context-merge").hide();
                    $(".context-unmerge").show();
                } else {
                    $(".context-merge").show();
                    $(".context-unmerge").hide();
                }
            }
        }

        // initalize spread
        function initSpread() {
            var spread = $("#ss").data("spread"); // get instance of wijspread control
            var sheet = spread.getActiveSheet(); // get active worksheet of the wijspread control
            spread.repaint();
            spread.bind("EnterCell", selectionChanged);
            //formulabox
            var fbx = new GcSpread.Sheets.FormulaTextBox(document.getElementById('formulabox'));
            fbx.spread(spread);
            //show range group
            $("#showRowGroup").attr("disabled", true);
            $("#showColGroup").attr("disabled", true);
            $("#showRowGroupLabel").attr("disabled", true);
            $("#showColGroupLabel").attr("disabled", true);
            $("#showRowGroup").attr("value", "false");
            $("#showColGroup").attr("value", "false");
            $("#showRowGroupLabel").addClass("ui-state-disabled");
            $("#showColGroupLabel").addClass("ui-state-disabled");
            $("#showRowGroupLabel").bind("mouseup", rowlabelactive);
            $("#showColGroupLabel").bind("mouseup", collabelactive);

            $("#setTabStripColor").attr("disabled", true);
            $("#setTabStripColor").addClass("ui-state-disabled");
            //rapid input mode start
            setstatus(sheet);
            sheet.bind(GcSpread.Sheets.Events.EditorStatusChanged, function () {
                setstatus(sheet);
            });
            //rapid input mode end
            sheet.isPaintSuspended(true);

            var cfs = sheet.getConditionalFormats();

            var table = sheet.addTable("tblOperatingExpenses2", 4, 1, 11, 6, new GcSpread.Sheets.TableStyle());
            //table.rowFilter().setShowFilterButton(false);
            table.showFooter(true);

            var dataTable = [
                ["STATUS", "OPERATING", "BUDGET", "ACTUAL", "DIFFERENCE ($)", "DIFFERENCE (%)"],
                [0, "Advertising", 600, 545, 0, 0],
                [0, "Debts", 125, 150, 0, 0],
                [0, "Benefits", 100, 100, 0, 0],
                [0, "Supplies", 100, 90, 0, 0],
                [0, "Postage", 150, 145, 0, 0],
                [0, "Rent or mortgage", 1000, 1000, 0, 0],
                [0, "Sales expenses", 500, 630, 0, 0],
                [0, "Taxes", 350, 375, 0, 0],
                [0, "Utilities", 400, 370, 0, 0],
                [0, "Other", 500, 435, 0, 0],
                [0, "Total Expenses", 0, 0, 0, 0]
            ];

            sheet.addSpan(0, 1, 1, 4);
            sheet.addSpan(0, 5, 1, 2);
            sheet.addSpan(1, 1, 1, 6);
            sheet.addSpan(2, 1, 1, 6);
            sheet.addSpan(3, 1, 1, 2);
            sheet.addSpan(16, 1, 1, 6);
            sheet.addSpan(17, 1, 1, 6);

            sheet.getDefaultStyle().vAlign = GcSpread.Sheets.VerticalAlign.center;
            sheet.getDefaultStyle().font = "lighter 10pt Calibri";
            sheet.getDefaultStyle().foreColor = "rgb(68, 84, 106)";
            sheet.gridline = new GcSpread.Sheets.LineBorder("Black", GcSpread.Sheets.LineStyle.empty);
            sheet.setGridlineOptions({ showVerticalGridline: false, showHorizontalGridline: false });
            sheet.getCell(0, 1).value("Expense Budget").font("lighter 28pt Calibri");
            sheet.getCell(0, 5).value("CONTOSO, 2013").font("11pt Calibri").foreColor("rgb(64, 64, 64)")
                    .hAlign(GcSpread.Sheets.HorizontalAlign.right).vAlign(GcSpread.Sheets.VerticalAlign.bottom);
            sheet.getCell(3, 1).value("OPERATING BUDGET").font("bold 13pt Calibri ").foreColor("rgb(64, 64, 64)");
            sheet.getCells(4, 1, 4, 6).font("bold 10pt Calibri")
                    .borderTop(new GcSpread.Sheets.LineBorder("rgb(217,217,217)", GcSpread.Sheets.LineStyle.thin));
            sheet.getCells(15, 1, 15, 6).font("bold 10pt Calibri")
                    .borderBottom(new GcSpread.Sheets.LineBorder("rgb(217,217,217)", GcSpread.Sheets.LineStyle.thin));
            sheet.getCells(3, 1, 3, 2)
                    .borderLeft(new GcSpread.Sheets.LineBorder("rgb(217,217,217)", GcSpread.Sheets.LineStyle.thin))
                    .borderTop(new GcSpread.Sheets.LineBorder("rgb(217,217,217)", GcSpread.Sheets.LineStyle.thin))
                    .borderRight(new GcSpread.Sheets.LineBorder("rgb(217,217,217)", GcSpread.Sheets.LineStyle.thin));
            sheet.getCells(4, 1, 15, 1).borderLeft(new GcSpread.Sheets.LineBorder("rgb(217,217,217)", GcSpread.Sheets.LineStyle.thin)).hAlign(GcSpread.Sheets.HorizontalAlign.center);
            sheet.getCells(4, 6, 15, 6).borderRight(new GcSpread.Sheets.LineBorder("rgb(217,217,217)", GcSpread.Sheets.LineStyle.thin));
            sheet.getCells(5, 1, 14, 6).borderBottom(new GcSpread.Sheets.LineBorder("rgb(217,217,217)", GcSpread.Sheets.LineStyle.dashed));;

            sheet.setArray(4, 1, dataTable);

            var row, col,
                rowHeights = [74, 4, 20];

            for (row = 0; row < 3; row++) {
                sheet.setRowHeight(row, rowHeights[row]);
            }
            for (row = 3; row < 17; row++) {
                sheet.setRowHeight(row, 24);
            }
            sheet.setRowHeight(17, 4);

            var colWidths = [18, 83, 111, 84, 85, 126, 129];
            for (col = 0; col < 7; col++) {
                sheet.setColumnWidth(col, colWidths[col]);
            }

            sheet.getCells(1, 1, 1, 6)
                    .borderTop(new GcSpread.Sheets.LineBorder("rgb(217,217,217)", GcSpread.Sheets.LineStyle.thick))
                    .borderBottom(new GcSpread.Sheets.LineBorder("rgb(217,217,217)", GcSpread.Sheets.LineStyle.thin));

            sheet.getCells(17, 1, 17, 6)
                    .borderTop(new GcSpread.Sheets.LineBorder("rgb(217,217,217)", GcSpread.Sheets.LineStyle.thick))
                    .borderBottom(new GcSpread.Sheets.LineBorder("rgb(217,217,217)", GcSpread.Sheets.LineStyle.thin));

            sheet.getCells(3, 3, 15, 5).formatter('"$"#,##0.00');
            sheet.getCells(3, 6, 14, 6).formatter('0%');
            sheet.getCell(15, 6).formatter('0.0%');

            var iconSetRule1 = new GcSpread.Sheets.IconSetRule();
            iconSetRule1.ranges = [new GcSpread.Sheets.Range(15, 1, 1, 1)];
            iconSetRule1.iconSetType(GcSpread.Sheets.IconSetType.ThreeSymbolsCircled)
                    .showIconOnly(true);
            var icons = iconSetRule1.iconCriteria();
            icons[0] = new GcSpread.Sheets.IconCriterion(false, GcSpread.Sheets.IconValueType.Number, -1);
            icons[1] = new GcSpread.Sheets.IconCriterion(true, GcSpread.Sheets.IconValueType.Number, 1);

            var cellValueRule1 = new GcSpread.Sheets.CellValueRule(GcSpread.Sheets.ComparisonOperator.LessThan, 0);
            cellValueRule1.style = new GcSpread.Sheets.Style();
            cellValueRule1.style.foreColor = "red";
            cellValueRule1.ranges = [new GcSpread.Sheets.Range(15, 5, 1, 2)];


            var dataBarRule1 = new GcSpread.Sheets.DataBarRule();
            dataBarRule1.minimumType(GcSpread.Sheets.ScaleValueType.Automin);
            dataBarRule1.maximumType(GcSpread.Sheets.ScaleValueType.Automax);
            dataBarRule1.ranges = [new GcSpread.Sheets.Range(5, 4, 10, 1)];
            dataBarRule1.color("orange").showBorder(true).borderColor("orange").dataBarDirection(GcSpread.Sheets.BarDirection.RightToLeft);


            var dataBarRule2 = new GcSpread.Sheets.DataBarRule();
            dataBarRule2.minimumType(GcSpread.Sheets.ScaleValueType.Automin);
            dataBarRule2.maximumType(GcSpread.Sheets.ScaleValueType.Automax);
            dataBarRule2.ranges = [new GcSpread.Sheets.Range(5, 3, 10, 1)];
            dataBarRule2.color("rgb(0,138,239)").showBorder(true).borderColor("rgb(0,138,239)");


            var dataBarRule3 = new GcSpread.Sheets.DataBarRule();
            dataBarRule3.minimumType(GcSpread.Sheets.ScaleValueType.LowestValue);
            dataBarRule3.maximumType(GcSpread.Sheets.ScaleValueType.HighestValue);
            dataBarRule3.ranges = [new GcSpread.Sheets.Range(5, 6, 10, 1)];
            dataBarRule3.color("rgb(91,155,213)").showBorder(true).borderColor("rgb(91,155,213)")
                    .negativeFillColor("rgb(237,125,49)").useNegativeBorderColor(true).negativeBorderColor("rgb(237,125,49)")
                    .axisPosition(GcSpread.Sheets.DataBarAxisPosition.CellMidPoint);

            var iconSetRule2 = new GcSpread.Sheets.IconSetRule();
            iconSetRule2.ranges = [new GcSpread.Sheets.Range(5, 1, 10, 1)];
            iconSetRule2.iconSetType(GcSpread.Sheets.IconSetType.ThreeSymbolsUncircled)
                    .reverseIconOrder(true)
                    .showIconOnly(true);

            cfs.addRule(iconSetRule1);
            cfs.addRule(cellValueRule1);
            cfs.addRule(dataBarRule1);
            cfs.addRule(dataBarRule2);
            cfs.addRule(dataBarRule3);
            cfs.addRule(iconSetRule2);

            table.setColumnFormula(0, "=tblOperatingExpenses2[[#Totals],[DIFFERENCE (%)]]");
            table.setColumnFormula(2, "=SUBTOTAL(109,[BUDGET])");
            table.setColumnFormula(3, "=SUBTOTAL(109,[ACTUAL])");
            table.setColumnFormula(4, "=SUBTOTAL(109,[DIFFERENCE ($)])");
            table.setColumnFormula(5, '=IFERROR(SUM(tblOperatingExpenses2[[#Totals],[DIFFERENCE ($)]]/tblOperatingExpenses2[[#Totals],[BUDGET]]),"")');

            table.setColumnDataFormula(0, '=IFERROR([@ACTUAL]/[@BUDGET],"")');
            table.setColumnDataFormula(4, '=[@BUDGET]-[@ACTUAL]');
            table.setColumnDataFormula(5, '=IFERROR([@[DIFFERENCE ($)]]/[@BUDGET],"")');

            updateSheetList();
            sheet.isPaintSuspended(false);
        }

        var validatorType;

        var pictureUrl = "";
        $(document).ready(function () {
            validatorType = "AnyValidator";
            $("#validatorTab1").hide();
            $("#validatorTab2").hide();
            $("#isIntTab").hide();
            $("#isTimeTab").hide();

            var selCellType = "TextCell";

            var tableName = "";
            var isTableAdd = false;
            var isPictureAdd = false;
            var isCommentAdd = false;
            // theme change
            $('.premium-themes a, .jqueryui-themes a').click(function () {
                $("link[title='rocket-jqueryui']").attr("href", $(this).attr("href"));
                setTimeout(
                        function () {
                            var ss = $("#ss").data("spread");
                            ss.repaint();
                        }, 100);

                return false;
            });

            // data validation
            $("#datavalidationdialog").wijribbon();
            $("#validationInputMessge").bind("mousedown", IsRangeSet);
            $("#validationErrorAlert").bind("mousedown", IsRangeSet);
            $("#validatorTypes").change(function () {
                validatorType = $(this).val();
                switch (validatorType) {
                    case "AnyValidator":
                        $("#validatorTab1").hide();
                        $("#isTimeTab").hide();
                        $("#isIntTab").hide();
                        $("#validatorTab2").hide();
                        $("#datatitle").hide();
                        break;
                    case "DateValidator":
                        $("#validatorTab1").show();
                        $("#isTimeTab").show();
                        $("#isIntTab").hide();
                        $("#validatorTab2").hide();
                        $("#rangeStart").text("Start date:");
                        $("#rangeEnd").text("End date:");
                        $("#datatitle").show();
                        break;
                    case "FormulaListValidator":
                        $("#validatorTab2").show();
                        $("#validatorTab1").hide();
                        $("#rangevalidator").text("Formula:");
                        $("#prompt").text("(e.g: E5:I5)");
                        $("#datatitle").hide();
                        break;
                    case "FormulaValidator":
                        $("#validatorTab2").show();
                        $("#validatorTab1").hide();
                        $("#rangevalidator").text("Formula:");
                        $("#prompt").text("(e.g: =ISERROR(FIND(\" \",A1)))");
                        $("#datatitle").hide();
                        break;
                    case "ListValidator":
                        $("#validatorTab2").show();
                        $("#validatorTab1").hide();
                        $("#rangevalidator").text("Source");
                        $("#prompt").text("(e.g: 1,2,3)");
                        $("#datatitle").hide();
                        break;
                    case "NumberValidator":
                        $("#validatorTab1").show();
                        $("#isTimeTab").hide();
                        $("#isIntTab").show();
                        $("#validatorTab2").hide();
                        $("#rangeStart").text("Minimum:");
                        $("#rangeEnd").text("Maximum:");
                        $("#datatitle").show();
                        break;
                    case "TextLengthValidator":
                        $("#validatorTab1").show();
                        $("#isTimeTab").hide();
                        $("#isIntTab").hide();
                        $("#validatorTab2").hide();
                        $("#rangeStart").text("Minimum:");
                        $("#rangeEnd").text("Maximum:");
                        $("#datatitle").show();
                        break;
                }
            });
            $("#chkValidatorIgnoreBlank").change(function () {
                var ss = $("#ss").data("spread");
                var sheet = ss.getActiveSheet();
                var sels = sheet.getSelections();
                for (var i = 0; i < sels.length; i++) {
                    var sel = getActualCellRange(sels[i], sheet.getRowCount(), sheet.getColumnCount());
                    for (var r = 0; r < sel.rowCount; r++) {
                        for (var c = 0; c < sel.colCount; c++) {
                            var dv = sheet.getDataValidator(sel.row + r, sel.col + c);
                            if (dv) {
                                dv.ignoreBlank = $(this).prop("checked");
                            }
                        }
                    }
                }
            });
            $("#chkShowError").change(function () {
                var ss = $("#ss").data("spread");
                var sheet = ss.getActiveSheet();
                var checked = $("#chkShowError").prop("checked");
                if (checked) {
                    ss.bind(GcSpread.Sheets.Events.ValidationError, function (event, data) {
                        var dv = data.validator;
                        if (dv) {
                            alert(dv.errorMessage);
                        }
                    });
                } else {
                    ss.unbind(GcSpread.Sheets.Events.ValidationError);
                }
            });
            $("#validatorComparisonOperator").change(function() {
                var operator = parseInt($(this).val(), 10);
                if (operator >= 6) { //validatorTypes
                    var isDateValidator = $("#validatorTypes").val() == "DateValidator";
                    $("#rangeStart").text(isDateValidator? "Start Date:" : "Minimum:");
                    $("#txtValidatorValue2").parent().show();
                } else {
                    $("#rangeStart").text("Value: ");
                    $("#txtValidatorValue2").parent().hide();
                }
            });
            $("#datavalidationdialog").dialog({
                autoOpen: false,
                height: 410,
                width: 400,
                modal: true,
                resizable: false,
                buttons: {
                    Clear: function () {
                        var ss = $("#ss").data("spread");
                        var sheet = ss.getActiveSheet();
                        var sels = sheet.getSelections();
                        for (var i = 0; i < sels.length; i++) {
                            var sel = getActualCellRange(sels[i], sheet.getRowCount(), sheet.getColumnCount());
                            for (var r = 0; r < sel.rowCount; r++) {
                                for (var c = 0; c < sel.colCount; c++) {
                                    sheet.setDataValidator(sel.row + r, sel.col + c, null);
                                }
                            }
                        }
                        $("#validatorTypes").val("AnyValidator");
                        $("#txtValidatorValue1").val("");
                        $("#txtValidatorValue2").val("");
                        $("#txtValidatorValue").val("");
                        $("#validatorTab1").hide();
                        $("#isTimeTab").hide();
                        $("#isIntTab").hide();
                        $("#validatorTab2").hide();
                        $("#txtMessageTitle").val("");
                        $("#txtMessageMessage").val("");
                        $("#validatorErrorStyles").val("0");
                        $("#txtErrorTitle").val("");
                        $("#txtErrorMessage").val("");
                        validatorType = "AnyValidator";
                        $(this).dialog("close");
                    },
                    OK: function () {
                        //setvalidator
                        var gcdv = GcSpread.Sheets.DefaultDataValidator;

                        var ddv = null;
                        var v1 = $("#txtValidatorValue1").val();
                        var v2 = $("#txtValidatorValue2").val();
                        switch (validatorType) {
                            case "AnyValidator":
                                ddv = new GcSpread.Sheets.DefaultDataValidator();
                                break;
                            case "DateValidator":
                                if ($("#chkIsTime").prop("checked")) {
                                    ddv = gcdv.createDateValidator(parseInt($("#validatorComparisonOperator").val(), 10),
                                            isNaN(v1) ? v1 : new Date(v1),
                                            isNaN(v2) ? v2 : new Date(v2),
                                            true);
                                } else {
                                    ddv = gcdv.createDateValidator(parseInt($("#validatorComparisonOperator").val(), 10),
                                            isNaN(v1) ? v1 : new Date(v1),
                                            isNaN(v2) ? v2 : new Date(v2),
                                            false);
                                }
                                break;
                            case "FormulaListValidator":
                                ddv = gcdv.createFormulaListValidator($("#txtValidatorValue").val());
                                break;
                            case "FormulaValidator":
                                ddv = gcdv.createFormulaValidator($("#txtValidatorValue").val());
                                break;
                            case "ListValidator":
                                ddv = gcdv.createListValidator($("#txtValidatorValue").val());
                                break;
                            case "NumberValidator":
                                if ($("#chkIsInteger").prop("checked")) {
                                    ddv = gcdv.createNumberValidator(parseInt($("#validatorComparisonOperator").val(), 10),
                                            isNaN(v1) ? v1 : parseInt(v1, 10),
                                            isNaN(v2) ? v2 : parseInt(v2, 10),
                                            true);
                                } else {
                                    ddv = gcdv.createNumberValidator(parseInt($("#validatorComparisonOperator").val(), 10),
                                            isNaN(v1) ? v1 : parseFloat(v1),
                                            isNaN(v2) ? v2 : parseFloat(v2),
                                            false);
                                }
                                break;
                            case "TextLengthValidator":
                                ddv = gcdv.createTextLengthValidator(parseInt($("#validatorComparisonOperator").val(), 10),
                                        isNaN(v1) ? v1 : parseInt(v1, 10),
                                        isNaN(v2) ? v2 : parseInt(v2, 10));
                                break;
                        }

                        if (ddv != null) {
                            ddv.errorMessage = $("#txtErrorMessage").val();
                            ddv.errorStyle = parseInt($("#validatorErrorStyles").val(), 10);
                            ddv.errorTitle = $("#txtErrorTitle").val();
                            ddv.showErrorMessage = $("#chkShowError").prop("checked");
                            ddv.ignoreBlank = $("#chkValidatorIgnoreBlank").prop("checked");
                            var checked = $("#chkShowMessage").prop("checked");
                            if (checked) {
                                ddv.inputTitle = $("#txtMessageTitle").val();
                                ddv.inputMessage = $("#txtMessageMessage").val();
                            }

                            var ss = $("#ss").data("spread");
                            var sheet = ss.getActiveSheet();
                            sheet.isPaintSuspended(true);
                            var sels = sheet.getSelections();
                            for (var i = 0; i < sels.length; i++) {
                                var sel = getActualCellRange(sels[i], sheet.getRowCount(), sheet.getColumnCount());
                                for (var r = 0; r < sel.rowCount; r++) {
                                    for (var c = 0; c < sel.colCount; c++) {
                                        sheet.setDataValidator(sel.row + r, sel.col + c, ddv);
                                    }
                                }
                            }
                            sheet.isPaintSuspended(false);
                        }
                        $(this).dialog("close");
                    },
                    Cancel: function () {
                        $(this).dialog("close");
                    }
                },
                open: function (event, ui) {
                    // reset items
                    $("#txtMessageTitle").val("");
                    $("#txtMessageMessage").val("");
                    $("#txtErrorTitle").val("");
                    $("#txtErrorMessage").val("");
                    $("#validatorComparisonOperator").val("6");
                    $("#txtValidatorValue1").val("");
                    $("#txtValidatorValue2").val("");
                    $("#validatorTypes").val("AnyValidator");
                    $("#validatorTypes").change();
                    $("#datavalidationdialog").wijtabs("select", 0);
                }
            });
            //Conditional format
            $("#Rule1").bind("change", function () {
                var rule = $("#Rule1").val();
                var type = $("#ComparisonOperator1");
                setEnumTypeOfCF(rule, type);
            });
            $("#ComparisonOperator1").bind("change", function () {
                var type = $("#ComparisonOperator1").val();
                switch (type) {
                    case "0":
                    case "1":
                    case "2":
                    case "3":
                    case "4":
                    case "5":
                        $("#andtext").hide();
                        $("#value2").hide();
                        break;
                    case "6":
                    case "7":
                        $("#andtext").show();
                        $("#andtext").text("and");
                        $("#value2").show();
                        break;
                    default:
                        $("#andtext").hide();
                        $("#value2").hide();
                        break;
                }
            });
            $("#iconSetType").bind("change", function () {
                createIconCriteriaDOM();
            });
            $("#minType").bind("change", function () {
                processMinItems($(event.target), $("#minValue"));
            });
            $("#midType").bind("change", function () {
                processMinItems($(event.target), $("#midValue"));
            });
            $("#maxType").bind("change", function () {
                processMaxItems($(event.target), $("#maxValue"));
            });
            $("#conditionalformatdialog").dialog({
                autoOpen: false,
                height: 200,
                width: 400,
                modal: true,
                resizable: false,
                buttons: {
                    OK: function () {
                        var spread1 = $("#ss").data("spread");
                        var sheet = spread1.getActiveSheet();
                        var sels = sheet.getSelections();
                        var style = new GcSpread.Sheets.Style();
                        style.backColor = "red";
                        style.foreColor = "green";
                        var value1 = $("#value1").val();
                        var value2 = $("#value2").val();
                        var cfs = sheet.getConditionalFormats();
                        var rule = $("#Rule1").val();
                        var operator = parseInt($("#ComparisonOperator1").val(), 10);

                        var minType = parseInt($("#minType").val(), 10);
                        var midType = parseInt($("#midType").val(), 10);
                        var maxType = parseInt($("#maxType").val(), 10);
                        var midColor = $("#midColor").css("background-color");
                        var minColor = $("#minColor").css("background-color");
                        var maxColor = $("#maxColor").css("background-color");
                        var midValue = $("#midValue").val();
                        var maxValue = $("#maxValue").val();
                        var minValue = $("#minValue").val();

                        switch (rule) {
                            case "0":
                                var doubleValue1 = parseFloat(value1);
                                var doubleValue2 = parseFloat(value2);
                                cfs.addCellValueRule(operator, isNaN(doubleValue1) ? value1 : doubleValue1, isNaN(doubleValue2) ? value2 : doubleValue2, style, sels);
                                break;
                            case "1":
                                cfs.addSpecificTextRule(operator, value1, style, sels);
                                break;
                            case "2":
                                cfs.addDateOccurringRule(operator, style, sels);
                                break;
                            case "3":
                                try {
                                    cfs.addFormulaRule(value1, style, sels);
                                }
                                catch (e) {
                                    cfs.removeRule(cfs.getRule(cfs.count() - 1));
                                    alert("Invalid Formula");
                                }
                                break;
                            case "4":
                                cfs.addTop10Rule(operator, parseInt(value1, 10), style, sels);
                                break;
                            case "5":
                                cfs.addUniqueRule(style, sels);
                                break;
                            case "6":
                                cfs.addDuplicateRule(style, sels);
                                break;
                            case "7":
                                cfs.addAverageRule(operator, style, sels);
                                break;
                            case "8":
                                cfs.add2ScaleRule(minType, minValue, minColor, maxType, maxValue, maxColor, sels);
                                break;
                            case "9":
                                cfs.add3ScaleRule(minType, minValue, minColor, midType, midValue, midColor, maxType, maxValue, maxColor, sels);
                                break;
                            default:
                                var doubleValue1 = parseFloat(value1);
                                var doubleValue2 = parseFloat(value2);
                                cfs.addCellValueRule(operator, isNaN(doubleValue1) ? value1 : doubleValue1, isNaN(doubleValue2) ? value2 : doubleValue2, style, sels);
                                break;
                        }
                        $(this).dialog("close");
                        sheet.repaint();
                    },
                    Cancel: function () {
                        $(this).dialog("close");
                    }
                },
                open: function (event, ui) {
                    var isColorScale = $("#conditionalformatdialog").dialog("option", "colorScale");
                    $("#colorScaleStyle").css("display", isColorScale ? "inline-block" : "none");
                }
            });
            // data bar dialog related
            $("#minimumType").bind("change", function () {
                processMinItems($(event.target), $("#minimumValue"));
            });
            $("#maximumType").bind("change", function () {
                processMinItems($(event.target), $("#maximumValue"));
            });
            $("#databardialog").dialog({
                autoOpen: false,
                height: 480,
                width: 420,
                modal: true,
                resizable: false,
                buttons: {
                    OK: function () {
                        var spread1 = $("#ss").data("spread");
                        var sheet = spread1.getActiveSheet();
                        sheet.isPaintSuspended(true);

                        var selections = sheet.getSelections();
                        if (selections) {
                            var ranges = [];
                            $.each(selections, function (i, v) {
                                ranges.push(new GcSpread.Sheets.Range(v.row, v.col, v.rowCount, v.colCount));
                            });
                            var cfs = sheet.getConditionalFormats();
                            var dataBarRule = new GcSpread.Sheets.DataBarRule();
                            dataBarRule.ranges = ranges;
                            dataBarRule.minimumType(parseInt($("#minimumType").val(), 10));
                            dataBarRule.minimumValue(parseValue($("#minimumValue").val()));
                            dataBarRule.maximumType(parseInt($("#maximumType").val(), 10));
                            dataBarRule.maximumValue(parseValue($("#maximumValue").val()));
                            dataBarRule.gradient($("#gradient").prop("checked"));
                            dataBarRule.color($("#color").css("background-color"));
                            dataBarRule.showBorder($("#showBorder").prop("checked"));
                            dataBarRule.borderColor($("#borderColor").css("background-color"));
                            dataBarRule.dataBarDirection(parseInt($("#dataBarDirection").val(), 10));
                            dataBarRule.negativeFillColor($("#negativeFillColor").css("background-color"));
                            dataBarRule.useNegativeFillColor($("#useNegativeFillColor").prop("checked"));
                            dataBarRule.negativeBorderColor($("#negativeBorderColor").css("background-color"));
                            dataBarRule.useNegativeBorderColor($("#useNegativeBorderColor").prop("checked"));
                            dataBarRule.axisPosition(parseInt($("#axisPosition").val(), 10));
                            dataBarRule.axisColor($("#axisColor").css("background-color"));
                            dataBarRule.showBarOnly($("#showBarOnly").prop("checked"));
                            cfs.addRule(dataBarRule);
                        }

                        sheet.isPaintSuspended(false);
                        $(this).dialog("close");
                    },
                    Cancel: function () {
                        $(this).dialog("close");
                    }
                }
            });
            // icon set
            $("#iconsetdialog").dialog({
                autoOpen: false,
                height: 400,
                width: 340,
                modal: true,
                resizable: false,
                buttons: {
                    OK: function () {
                        var spread1 = $("#ss").data("spread");
                        var sheet = spread1.getActiveSheet();
                        sheet.isPaintSuspended(true);

                        var selections = sheet.getSelections();
                        if (selections) {
                            var ranges = [];
                            $.each(selections, function (i, v) {
                                ranges.push(new GcSpread.Sheets.Range(v.row, v.col, v.rowCount, v.colCount));
                            });
                            var cfs = sheet.getConditionalFormats();
                            var iconSetRule = new GcSpread.Sheets.IconSetRule();
                            iconSetRule.ranges = ranges;
                            iconSetRule.iconSetType(parseInt($("#iconSetType").val(), 10));
                            var $divs = $("#iconCriteriaSetting div");
                            var iconCriteria = iconSetRule.iconCriteria();
                            $.each($divs, function (i, v) {
                                var isGreaterThanOrEqualTo = parseInt($(v.children[0]).val(), 10) === 1;
                                var iconValueType = parseInt($(v.children[2]).val(), 10);
                                var iconValue = $(v.children[1]).val();
                                if (iconValueType !== GcSpread.Sheets.IconValueType.Formula) {
                                    iconValue = parseInt(iconValue, 10);
                                }
                                iconCriteria[i] = new GcSpread.Sheets.IconCriterion(isGreaterThanOrEqualTo, iconValueType, iconValue);
                            });
                            iconSetRule.reverseIconOrder($("#reverseIconOrder").prop("checked"));
                            iconSetRule.showIconOnly($("#showIconOnly").prop("checked"));
                            cfs.addRule(iconSetRule);
                        }

                        sheet.isPaintSuspended(false);
                        $(this).dialog("close");
                    },
                    Cancel: function () {
                        $(this).dialog("close");
                    }
                }
            });

            // border dialog
            $("#leftSide").change(function () {
                var checked = $("#leftSide").prop("checked");
                if (checked) {
                    $("#border11").css("border-left", "1px solid gray");
                    $("#border21").css("border-left", "1px solid gray");
                    $("#bordertable").css("border-left", "1px solid gray");
                } else {
                    $("#border11").css("border-left", "none");
                    $("#border21").css("border-left", "none");
                    $("#bordertable").css("border-left", "none");
                }
            });
            $("#topSide").change(function () {
                var checked = $("#topSide").prop("checked");
                if (checked) {
                    $("#border11").css("border-top", "1px solid gray");
                    $("#border12").css("border-top", "1px solid gray");
                    $("#bordertable").css("border-top", "1px solid gray");
                } else {
                    $("#border11").css("border-top", "none");
                    $("#border12").css("border-top", "none");
                    $("#bordertable").css("border-top", "none");
                }
            });
            $("#rightSide").change(function () {
                var checked = $("#rightSide").prop("checked");
                if (checked) {
                    $("#border12").css("border-right", "1px solid gray");
                    $("#border22").css("border-right", "1px solid gray");
                    $("#bordertable").css("border-right", "1px solid gray");
                } else {
                    $("#border12").css("border-right", "none");
                    $("#border22").css("border-right", "none");
                    $("#bordertable").css("border-right", "none");
                }
            });
            $("#bottomSide").change(function () {
                var checked = $("#bottomSide").prop("checked");
                if (checked) {
                    $("#border21").css("border-bottom", "1px solid gray");
                    $("#border22").css("border-bottom", "1px solid gray");
                    $("#bordertable").css("border-bottom", "1px solid gray");
                } else {
                    $("#border21").css("border-bottom", "none");
                    $("#border22").css("border-bottom", "none");
                    $("#bordertable").css("border-bottom", "none");
                }
            });
            $("#hInside").change(function () {
                var checked = $("#hInside").prop("checked");
                if (checked) {
                    $("#border11").css("border-bottom", "1px solid gray");
                    $("#border12").css("border-bottom", "1px solid gray");
                    $("#border21").css("border-top", "1px solid gray");
                    $("#border22").css("border-top", "1px solid gray");
                } else {
                    $("#border11").css("border-bottom", "none");
                    $("#border12").css("border-bottom", "none");
                    $("#border21").css("border-top", "none");
                    $("#border22").css("border-top", "none");
                }
            });
            $("#vInside").change(function () {
                var checked = $("#vInside").prop("checked");
                if (checked) {
                    $("#border11").css("border-right", "1px solid gray");
                    $("#border12").css("border-left", "1px solid gray");
                    $("#border21").css("border-right", "1px solid gray");
                    $("#border22").css("border-left", "1px solid gray");
                } else {
                    $("#border11").css("border-right", "none");
                    $("#border12").css("border-left", "none");
                    $("#border21").css("border-right", "none");
                    $("#border22").css("border-left", "none");
                }
            });
            $("#borderdialog").dialog({
                autoOpen: false,
                height: 450,
                width: 450,
                modal: true,
                resizable: false,
                buttons: {
                    OK: function () {
                        var spread = $("#ss").data("spread");
                        var sheet = spread.getActiveSheet();
                        sheet.isPaintSuspended(true);
                        var sels = sheet.getSelections();
                        var lineBorder = new GcSpread.Sheets.LineBorder($("#lineColor").val(), GcSpread.Sheets.LineStyle[$("#lineStyle").val()]);
                        for (var n = 0; n < sels.length; n++) {
                            var sel = getActualCellRange(sels[n], sheet.getRowCount(), sheet.getColumnCount());
                            sheet.setBorder(sel, lineBorder, {
                                left: $("#leftSide").prop("checked"),
                                top: $("#topSide").prop("checked"),
                                right: $("#rightSide").prop("checked"),
                                bottom: $("#bottomSide").prop("checked"),
                                innerHorizontal: $("#hInside").prop("checked"),
                                innerVertical: $("#vInside").prop("checked")
                            });
                        }
                        sheet.isPaintSuspended(false);
                        $(this).dialog("close");
                    },
                    Cancel: function () {
                        $(this).dialog("close");
                    }
                },
                open: function (event, ui) {
                    $("#lineStyle").val("empty");
                    $("#lineColor").val("Black");
                    $("#borderdialog :checkbox").removeAttr("checked");
                    $("#border11").css("border", "none");
                    $("#border12").css("border", "none");
                    $("#border21").css("border", "none");
                    $("#border22").css("border", "none");
                }
            });

            // cell type dialog
            $("#celltypedialog").dialog({
                autoOpen: false,
                height: 310,
                width: 300,
                modal: true,
                resizable: false,
                buttons: {
                    OK: function () {
                        var spread = $("#ss").data("spread");
                        var sheet = spread.getActiveSheet();
                        var cellType;
                        switch (selCellType) {
                            case "TextCell":
                                cellType = new GcSpread.Sheets.TextCellType();
                                break;
                            case "ComboCell":
                                cellType = new GcSpread.Sheets.ComboBoxCellType();
                                cellType.editorValueType(parseInt($("#selComboCellEditorValueType").val(), 10));
                                var itemsText = $("#txtComboCellItemsText").val().split(",");
                                var itemsValue = $("#txtComboCellItemsValue").val().split(",");
                                var itemsLength = itemsText.length > itemsValue.length ? itemsText.length : itemsValue.length;
                                var items = [];
                                for (var count = 0; count < itemsLength; count++) {
                                    var t = itemsText.length > count && itemsText[0] != "" ? itemsText[count] : undefined;
                                    var v = itemsValue.length > count && itemsValue[0] != "" ? itemsValue[count] : undefined;
                                    if (t != undefined && v != undefined) {
                                        items[count] = { text: t, value: v };
                                    }
                                    else if (t != undefined) {
                                        items[count] = { text: t };
                                    } else if (v != undefined) {
                                        items[count] = { value: v };
                                    }
                                }
                                cellType.items(items);
                                break;
                            case "CheckBoxCell":
                                cellType = new GcSpread.Sheets.CheckBoxCellType();
                                if ($("#txtCheckBoxCellTextCaption").val() != "") {
                                    cellType.caption($("#txtCheckBoxCellTextCaption").val());
                                }
                                if ($("#txtCheckBoxCellTextTrue").val() != "") {
                                    cellType.textTrue($("#txtCheckBoxCellTextTrue").val());
                                }
                                if ($("#txtCheckBoxCellTextIndeterminate").val() != "") {
                                    cellType.textIndeterminate($("#txtCheckBoxCellTextIndeterminate").val());
                                }
                                if ($("#txtCheckBoxCellTextFalse").val() != "") {
                                    cellType.textFalse($("#txtCheckBoxCellTextFalse").val());
                                }
                                cellType.textAlign(parseInt($("#selCheckBoxCellAlign").val(), 10));
                                cellType.isThreeState($("#ckbCheckBoxCellIsThreeState").prop("checked"));
                                break;
                            case "ButtonCell":
                                cellType = new GcSpread.Sheets.ButtonCellType();
                                if ($("#txtButtonCellMarginLeft").val() != "") {
                                    cellType.marginLeft(parseFloat($("#txtButtonCellMarginLeft").val()));
                                }
                                if ($("#txtButtonCellMarginTop").val() != "") {
                                    cellType.marginTop(parseFloat($("#txtButtonCellMarginTop").val()));
                                }
                                if ($("#txtButtonCellMarginRight").val() != "") {
                                    cellType.marginRight(parseFloat($("#txtButtonCellMarginRight").val()));
                                }
                                if ($("#txtButtonCellMarginBottom").val() != "") {
                                    cellType.marginBottom(parseFloat($("#txtButtonCellMarginBottom").val()));
                                }
                                if ($("#txtButtonCellText").val() != "") {
                                    cellType.text($("#txtButtonCellText").val());
                                }
                                cellType.buttonBackColor($("#txtButtonCellBackColor").css("background-color"));
                                break;
                            case "HyperLinkCell":
                                cellType = new GcSpread.Sheets.HyperLinkCellType();
                                cellType.linkColor($("#txtHyperLinkCellLinkColor").css("background-color"));
                                cellType.visitedLinkColor($("#txtHyperLinkCellVisitedLinkColor").css("background-color"));
                                if ($("#txtHyperLinkCellText").val() != "") {
                                    cellType.text($("#txtHyperLinkCellText").val());
                                }
                                if ($("#txtHyperLinkCellToolTip").val() != "") {
                                    cellType.linkToolTip($("#txtHyperLinkCellToolTip").val());
                                }
                                break;
                        }
                        sheet.isPaintSuspended(true);
                        sheet.suspendEvent();
                        var sels = sheet.getSelections();
                        for (var i = 0; i < sels.length; i++) {
                            var sel = getActualCellRange(sels[i], sheet.getRowCount(), sheet.getColumnCount());
                            for (var r = 0; r < sel.rowCount; r++) {
                                for (var c = 0; c < sel.colCount; c++) {
                                    sheet.setCellType(sel.row + r, sel.col + c, cellType, GcSpread.Sheets.SheetArea.viewport);
                                }
                            }
                        }
                        sheet.resumeEvent();
                        sheet.isPaintSuspended(false);
                        $(this).dialog("close");
                    },
                    Cancel: function () {
                        $(this).dialog("close");
                    }
                }
            });

            // color dialog
            $("#colordialog").dialog({
                autoOpen: false,
                height: 420,
                width: 474,
                modal: true,
                resizable: false,
                buttons: {
                    OK: function () {
                        var selectedColor = $("#selectedColor").val();

                        if (!selectedColor) {
                            return;
                        }

                        if (hexColorValueRegEx.test(selectedColor) === false) {
                            alert("Invalid color, please correct it.");
                            $("#selectedColor").focus();
                            return;
                        }

                        var spread = $("#ss").data("spread");
                        var sheet = spread.getActiveSheet();
                        sheet.isPaintSuspended(true);
                        var title = $("#colordialog").dialog("option", "title");
                        if (title == "Back Color") {
                            var sels = sheet.getSelections();
                            for (var n = 0; n < sels.length; n++) {
                                var sel = getActualCellRange(sels[n], sheet.getRowCount(), sheet.getColumnCount());
                                sheet.getCells(sel.row, sel.col, sel.row + sel.rowCount - 1, sel.col + sel.colCount - 1, GcSpread.Sheets.SheetArea.viewport).backColor(selectedColor);
                            }
                        } else if (title == "Fore Color") {
                            var sels = sheet.getSelections();
                            for (var n = 0; n < sels.length; n++) {
                                var sel = getActualCellRange(sels[n], sheet.getRowCount(), sheet.getColumnCount());
                                sheet.getCells(sel.row, sel.col, sel.row + sel.rowCount - 1, sel.col + sel.colCount - 1, GcSpread.Sheets.SheetArea.viewport).foreColor(selectedColor);
                            }
                        } else if (title == "Tab Strip Color") {
                            if (sheet) {
                                sheet.sheetTabColor(selectedColor);
                            }
                        } else if (title == "FrozenLineColor") {
                            if (sheet) {
                                sheet.frozenlineColor(selectedColor);
                            }
                        } else if (title == "SpreadBackColor") {
                            if (spread) {
                                spread.backColor(selectedColor);
                            }
                        } else if (title == "GrayAreaBackColor") {
                            if (spread) {
                                spread.grayAreaBackColor(selectedColor);
                            }
                        } else if (title == "SelectionBorderColor") {
                            if (sheet) {
                                sheet.selectionBorderColor(selectedColor);
                            }
                        } else if (title == "SelectionBackColor") {
                            if (sheet) {
                                sheet.selectionBackColor(selectedColor);
                            }
                        } else if (title == "Indicator Border Color") {
                            if (spread) {
                                spread.cutCopyIndicatorBorderColor(selectedColor);
                            }
                        } else if (title == "Bar Color") {
                            $("#color").css("background-color", selectedColor);
                        } else if (title == "Bar Border Color") {
                            $("#borderColor").css("background-color", selectedColor);
                        } else if (title == "Bar Negative Fill Color") {
                            $("#negativeFillColor").css("background-color", selectedColor);
                        } else if (title == "Bar Negative Border Color") {
                            $("#negativeBorderColor").css("background-color", selectedColor);
                        } else if (title == "Bar Axis Color") {
                            $("#axisColor").css("background-color", selectedColor);
                        } else if (title == "Min Color") {
                            $("#minColor").css("background-color", selectedColor);
                        } else if (title == "Mid Color") {
                            $("#midColor").css("background-color", selectedColor);
                        } else if (title == "Max Color") {
                            $("#maxColor").css("background-color", selectedColor);
                        } else if (title == "Picture Back Color") {
                            $("#pictureBackColor").css("background-color", selectedColor);
                        } else if (title == "Picture Border Color") {
                            $("#pictureBorderColor").css("background-color", selectedColor);
                        } else if (title == "Button Back Color") {
                            $("#txtButtonCellBackColor").css("background-color", selectedColor);
                        } else if (title == "Link Color") {
                            $("#txtHyperLinkCellLinkColor").css("background-color", selectedColor);
                        } else if (title == "Visited Link Color") {
                            $("#txtHyperLinkCellVisitedLinkColor").css("background-color", selectedColor);
                        } else if (title == "Comment Border Color") {
                            $("#txtBorderColor").css("background-color", selectedColor);
                        } else if (title == "Comment Fore Color") {
                            $("#txtForeColor").css("background-color", selectedColor);
                        } else if (title == "Comment Back Color") {
                            $("#txtBackColor").css("background-color", selectedColor);
                        } else if (title == "Bullet Color Scheme") {
                            $("#bulletColorScheme").css("background-color", selectedColor);
                        } else if (title == "HBar Color Scheme") {
                            $("#hbarColorScheme").css("background-color", selectedColor);
                        } else if (title == "VBar Color Scheme") {
                            $("#vbarColorScheme").css("background-color", selectedColor);
                        } else if (title == "Variance Positive Color") {
                            $("#variColorPositive").css("background-color", selectedColor);
                        } else if (title == "Variance Negative Color") {
                            $("#variColorNegative").css("background-color", selectedColor);
                        } /*else if (title == "Bullet Color Scheme") {
                            $("#bulletColorScheme").css("background-color", selectedColor);
                        } else if (title == "Bullet Color Scheme") {
                            $("#bulletColorScheme").css("background-color", selectedColor);
                        }*/
                        sheet.isPaintSuspended(false);
                        $(this).dialog("close");
                    },
                    Cancel: function () {
                        $(this).dialog("close");
                    }
                },
                open: function (event, ui) {
                    var providedColor = $("#colordialog").dialog("option", "color"),
                        rgbValues,
                        hasValue = false;

                    if (providedColor) {
                        if (hexColorValueRegEx.test(providedColor)) {
                            hasValue = true;
                        } else if (rgbValues = rgbColorValueRegEx.exec(providedColor)) {
                            providedColor = rgbToHex(parseInt(rgbValues[1]), parseInt(rgbValues[2]), parseInt(rgbValues[3]));
                            hasValue = true;
                        } else {
                            $("#colorSample").css("background-color", providedColor);
                            providedColor = $("#colorSample").css("background-color");
                            if (rgbValues = rgbColorValueRegEx.exec(providedColor)) {
                                providedColor = rgbToHex(parseInt(rgbValues[1]), parseInt(rgbValues[2]), parseInt(rgbValues[3]));
                                providedColor = providedColor.toUpperCase();
                                $("#selectedColor").val(providedColor);
                                $("#selectedColor").change();
                                return;
                            }
                        }
                    }

                    if (hasValue) {
                        providedColor = providedColor.toUpperCase();
                        $("#selectedColor").val(providedColor);
                        $("#selectedColor").change();
                    } else {
                        $("#selectedColor").val("");
                        $("#selectedColor").change();
                        $("#colorchart td.selected").removeClass("selected");
                        $("#colorSample").css("background-color", "transparent");
                    }
                }
            });

            // Freeze setting
            $("#freezesettingdialog").dialog({
                autoOpen: false,
                height: 280,
                width: 350,
                modal: true,
                resizable: false,
                buttons: {
                    OK: function () {
                        var spread = $("#ss").data("spread");
                        var sheet = spread.getActiveSheet();
                        sheet.isPaintSuspended(true);
                        sheet.suspendEvent();
                        var frozenRowCount = parseInt($("#frozenRowCount").val(), 10);
                        sheet.setFrozenRowCount(frozenRowCount);
                        var frozenColumnCount = parseInt($("#frozenColumnCount").val(), 10);
                        sheet.setFrozenColumnCount(frozenColumnCount);
                        var frozenTrailingRowCount = parseInt($("#frozenTrailingRowCount").val(), 10);
                        sheet.setFrozenTrailingRowCount(frozenTrailingRowCount);
                        var frozenTrailingColumnCount = parseInt($("#frozenTrailingColumnCount").val(), 10);
                        sheet.setFrozenTrailingColumnCount(frozenTrailingColumnCount);
                        sheet.isPaintSuspended(false);
                        $(this).dialog("close");
                    },
                    Cancel: function () {
                        $(this).dialog("close");
                    }
                }
            });
            //sheet visible
            $("#sheetList").bind('mouseover', updateSheetList);
            //add picture
            if (typeof FileReader === 'undefined') {
                $("#file_input").attr('disabled', 'disabled');
                $("#file_input1").attr('disabled', 'disabled');
            } else {
                $("#file_input").bind('change', function () {
                    var file = this.files[0];
                    if (!/image\/\w+/.test(file.type)) {
                        alert("The file muse be image!");
                        return false;
                    }
                    var reader = new FileReader();
                    reader.readAsDataURL(file);
                    reader.onload = function (e) {
                        pictureUrl = this.result;
                    }
                });
                $("#file_input1").bind('change', function () {
                    var file = this.files[0];
                    if (!/image\/\w+/.test(file.type)) {
                        alert("The file muse be image!");
                        return false;
                    }
                    var reader = new FileReader();
                    reader.readAsDataURL(file);
                    reader.onload = function (e) {
                        pictureUrl = this.result;
                    }
                });
            }

            // picture dialog
            $("#picturedialog").dialog({
                autoOpen: false,
                height: 400,
                width: 380,
                modal: true,
                resizable: false,
                buttons: {
                    OK: function () {
                        var spread = $("#ss").data("spread");
                        var sheet = spread.getActiveSheet();
                        sheet.isPaintSuspended(true);
                        if (isPictureAdd) {
                            var sel = sheet.getSelections()[0];
                            if (pictureUrl !== "" && sel) {
                                var cr = getActualRange(sel, sheet.getRowCount(), sheet.getColumnCount());
                                var name = getFloatingObjectName(sheet);
                                sheet.addPicture(name, pictureUrl, cr.row, cr.col)
                                    .backColor("#FFFFFF").borderColor("#000000")
                                    .borderStyle("solid").borderWidth(1).borderRadius(3);
                            }
                        } else {
                            var pictures = sheet.getPictures(),
                                    dynamicSize = $("#dynamicSize").prop("checked"),
                                    dynamicMove = $("#dynamicMove").prop("checked"),
                                    backColor = $("#pictureBackColor").css("background-color"),
                                    borderColor = $("#pictureBorderColor").css("background-color"),
                                    borderWidth = parseInt($("#pictureBorderWidth").val()),
                                    borderRadius = parseInt($("#pictureBorderRadius").val()),
                                    borderStyle = $("#pictureBorderStyle").val(),
                                    stretch = parseInt($("#pictureStretch").val());
                            if (borderWidth < 0) {
                                borderWidth = 0;
                            }
                            if (borderRadius < 0) {
                                borderRadius = 0;
                            }
                            for (var index = 0, len = pictures.length; index < len; index++) {
                                var picture = pictures[index];
                                if (picture && picture.isSelected()) {
                                    if (pictureUrl !== "") {
                                        picture.src(pictureUrl);
                                    }
                                    picture.dynamicMove(dynamicMove);
                                    picture.dynamicSize(dynamicSize);
                                    picture.backColor(backColor);
                                    picture.borderColor(borderColor);
                                    picture.borderWidth(borderWidth);
                                    picture.borderRadius(borderRadius);
                                    picture.borderStyle(borderStyle);
                                    picture.pictureStretch(stretch);
                                }
                            }
                        }
                        sheet.isPaintSuspended(false);
                        $(this).dialog("close");
                    },
                    Remove: function () {
                        var spread = $("#ss").data("spread");
                        var sheet = spread.getActiveSheet();
                        sheet.isPaintSuspended(true);
                        var pictures = sheet.getPictures(),
                                pictureNames = [];
                        for (var index = 0, len = pictures.length; index < len; index++) {
                            var picture = pictures[index];
                            if (picture && picture.isSelected()) {
                                pictureNames.push(picture.name());
                            }
                        }
                        for (var i = 0, len = pictureNames.length; i < len; i++) {
                            sheet.removePicture(pictureNames[i]);
                        }
                        sheet.isPaintSuspended(false);
                        $(this).dialog("close");
                    },
                    Cancel: function () {
                        $(this).dialog("close");
                    }
                },
                open: function (event, ui) {
                    $("#file_input").val("");
                    $("#file_input1").val("");
                }
            });

            // table dialog
            $("#tabledialog").dialog({
                autoOpen: false,
                height: 320,
                width: 265,
                modal: true,
                resizable: false,
                buttons: {
                    OK: function () {
                        var spread = $("#ss").data("spread");
                        var sheet = spread.getActiveSheet();
                        sheet.isPaintSuspended(true);
                        var table = null;
                        var name = $("#tableName").val();
                        var isCloseDialog = false;
                        if (isTableAdd) {
                            if (name === "" || !name) {
                                $("#ckName").text("Need table name.");
                            } else if (name && name !== "" && sheet.findTableByName(name)) {
                                $("#ckName").text("Table name exists.");
                            } else {
                                isCloseDialog = true;
                                tableName = name;
                                try {
                                    var cr = sheet.getSelections()[0];
                                    if (cr) {
                                        cr = getActualRange(cr, sheet.getRowCount(), sheet.getColumnCount());
                                        table = sheet.addTable(tableName, cr.row, cr.col, cr.rowCount, cr.colCount, getTableStyle());
                                        table.showHeader($("#showHeader").prop("checked"));
                                        table.showFooter($("#showFooter").prop("checked"));
                                        table.highlightFirstColumn($("#highlightFirstColumn").prop("checked"));
                                        table.highlightLastColumn($("#highlightLastColumn").prop("checked"));
                                        table.bandRows($("#bandRows").prop("checked"));
                                        table.bandColumns($("#bandColumns").prop("checked"));
                                    }
                                } catch (ex) {
                                    alert(!!ex.message ? ex.message : ex);
                                }
                            }
                        } else {
                            table = sheet.findTable(sheet.getActiveRowIndex(), sheet.getActiveColumnIndex());
                            if (name === "" || !name) {
                                $("#ckName").text("Need table name.");
                            } else if (name && name !== "" && name !== table.name() && sheet.findTableByName(name)) {
                                $("#ckName").text("Table name exists.");
                            } else {
                                isCloseDialog = true;
                                if (table) {
                                    table.showHeader($("#showHeader").prop("checked"));
                                    table.showFooter($("#showFooter").prop("checked"));
                                    table.highlightFirstColumn($("#highlightFirstColumn").prop("checked"));
                                    table.highlightLastColumn($("#highlightLastColumn").prop("checked"));
                                    table.bandRows($("#bandRows").prop("checked"));
                                    table.bandColumns($("#bandColumns").prop("checked"));
                                    var style = getTableStyle();
                                    if (style) {
                                        table.style(style);
                                    }
                                    table.name($("#tableName").val());
                                }
                            }
                        }

                        sheet.isPaintSuspended(false);
                        if (isCloseDialog) {
                            $(this).dialog("close");
                        }
                    },
                    Remove: function () {
                        var spread = $("#ss").data("spread");
                        var sheet = spread.getActiveSheet();
                        try {
                            var table = sheet.findTable(sheet.getActiveRowIndex(), sheet.getActiveColumnIndex());
                            if (table) {
                                sheet.removeTable(table);
                            }
                        } catch (ex) {
                            alert(!!ex.message ? ex.message : ex);
                        }
                        $(this).dialog("close");
                    },
                    Cancel: function () {
                        $(this).dialog("close");
                    }
                }
            });

            // comment dialog
            $("#commentdialog").dialog({
                autoOpen: false,
                height: 500,
                width: 420,
                modal: true,
                resizable: false,
                buttons: {
                    OK: function () {
                        var spread = $("#ss").data("spread");
                        var sheet = spread.getActiveSheet();
                        sheet.isPaintSuspended(true);
                        var activeRowIndex = sheet.getActiveRowIndex(), activeColumnIndex = sheet.getActiveColumnIndex();
                        if (isCommentAdd) {
                            var comment = new GcSpread.Sheets.Comment();
                            comment.text($("#txtText").val());
                            var location = $("#txtLocation").val();
                            if (location) {
                                var pos = location.split(",");
                                if (pos && pos.length === 2) {
                                    comment.location(new GcSpread.Sheets.Point(parseInt(pos[0]), parseInt(pos[1])));
                                }
                            }
                            comment.width(parseInt($("#txtWidth").val()));
                            comment.height(parseInt($("#txtHeight").val()));
                            sheet.setComment(activeRowIndex, activeColumnIndex, comment);
                        } else {
                            var comment = sheet.getComment(activeRowIndex, activeColumnIndex);
                            comment.fontFamily($("#txtFontFamily").val());
                            comment.fontStyle($("#comboBoxFontStyle").val());
                            comment.fontSize($("#txtFontSize").val());
                            comment.fontWeight($("#txtFontWeight").val());
                            comment.borderWidth(parseInt($("#txtBorderWidth").val()));
                            comment.borderStyle($("#comboBoxBorderStyle").val());
                            comment.borderColor($("#txtBorderColor").css("background-color"));
                            var padding = $("#txtPadding").val();
                            if (padding) {
                                var para = padding.split(",");
                                if (para.length === 1) {
                                    comment.padding(new GcSpread.Sheets.Padding(para[0]));
                                } else if (para.length === 4) {
                                    comment.padding(new GcSpread.Sheets.Padding(para[0], para[1], para[2], para[3]));
                                }
                            }
                            comment.textDecoration(parseInt($("#comboBoxTextDecoration").val()));
                            comment.opacity(parseFloat($("#txtOpacity").val()) / 100);
                            comment.foreColor($("#txtForeColor").css("background-color"));
                            comment.backColor($("#txtBackColor").css("background-color"));
                            comment.horizontalAlign(parseInt($("#comboBoxHorizontal").val()));
                            comment.displayMode(parseInt($("#comboBoxDisplayMode").val()));
                            comment.zIndex(parseInt($("#txtzIndex").val()));
                            comment.lockText($("#chkLockText").prop('checked'));
                            comment.dynamicMove($("#chkDynamicMove").prop('checked'));
                            comment.dynamicSize($("#chkDynamicSize").prop('checked'));
                            comment.showShadow($("#chkShowShadow").prop('checked'));
                        }
                        sheet.isPaintSuspended(false);
                        $(this).dialog("close");
                    },
                    Remove: function () {
                        var spread = $("#ss").data("spread");
                        var sheet = spread.getActiveSheet();
                        sheet.isPaintSuspended(true);
                        var sel = sheet.getSelections()[0];
                        if (sel) {
                            var cr = getActualRange(sel, sheet.getRowCount(), sheet.getColumnCount());
                            sheet.setComment(cr.row, cr.col, null);
                        }
                        sheet.isPaintSuspended(false);
                        $(this).dialog("close");
                    },
                    Cancel: function () {
                        $(this).dialog("close");
                    }
                }
            });

            // sparklineEx dialog
            function sparklineExTypeChanged() {
                var sparklineEx = $("#sparklineExType").val();
                $("#dataRangeInValid").text('');
                $("#locationRangeInValid").text('');
                switch (sparklineEx) {
                    case "BULLETSPARKLINE":
                        $("#commonSparkline").hide();
                        $("#bullet").show();
                        $("#hbar").hide();
                        $("#vbar").hide();
                        $("#vari").hide();
                        $("#bulletMeasure").val("");
                        $("#bulletTarget").val("");
                        $("#bulletMaxi").val("");
                        $("#bulletForecast").val("");
                        $("#bulletGood").val("");
                        $("#bulletBad").val("");
                        $("#bulletTickunit").val("");
                        $("#bulletColorScheme").css("background-color", "#A0A0A0");
                        $("#bulletVertical").prop("checked", false);
                        break;
                    case "HBARSPARKLINE":
                        $("#commonSparkline").hide();
                        $("#bullet").hide();
                        $("#hbar").show();
                        $("#vbar").hide();
                        $("#vari").hide();
                        $("#hbarValue").val("");
                        $("#hbarColorScheme").css("background-color", "gray");
                        break;
                    case "VBARSPARKLINE":
                        $("#commonSparkline").hide();
                        $("#bullet").hide();
                        $("#hbar").hide();
                        $("#vbar").show();
                        $("#vari").hide();
                        $("#vbarValue").val("");
                        $("#vbarColorScheme").css("background-color", "gray");
                        break;
                    case "VARISPARKLINE":
                        $("#commonSparkline").hide();
                        $("#bullet").hide();
                        $("#hbar").hide();
                        $("#vbar").hide();
                        $("#vari").show();
                        $("#variVariance").val("");
                        $("#variReference").val("");
                        $("#variMini").val("");
                        $("#variMaxi").val("");
                        $("#variMark").val("");
                        $("#variTickunit").val("");
                        $("#variColorPositive").css("background-color", "green");
                        $("#variColorNegative").css("background-color", "red");
                        break;
                    default:
                        $("#commonSparkline").show();
                        $("#bullet").hide();
                        $("#hbar").hide();
                        $("#vbar").hide();
                        $("#vari").hide();
                        break;
                }
            }
            $("#sparklineExType").bind("change", sparklineExTypeChanged);
            $("#sparklineexdialog").dialog({
                autoOpen: false,
                height: 320,
                width: 420,
                modal: true,
                resizable: false,
                buttons: {
                    OK: function () {
                        var spread = $("#ss").data("spread"),
                            sheet = spread.getActiveSheet(),
                            sel = sheet.getSelections()[0],
                            isValid = true,
                            sparklineEx = $("#sparklineExType").val();
                        if (sel) {
                            var cr = getActualRange(sel, sheet.getRowCount(), sheet.getColumnCount());
                            var formulaStr = '', row = cr.row, col = cr.col, direction = 0;
                            switch (sparklineEx) {
                                case "BULLETSPARKLINE":
                                    var measure = $("#bulletMeasure").val(),
                                        target = $("#bulletTarget").val(),
                                        maxi = $("#bulletMaxi").val(),
                                        good = $("#bulletGood").val(),
                                        bad = $("#bulletBad").val(),
                                        forecast = $("#bulletForecast").val(),
                                        tickunit = $("#bulletTickunit").val(),
                                        colorScheme = $("#bulletColorScheme").css("background-color"),
                                        vertical = $("#bulletVertical").prop("checked");
                                    formulaStr = '=' + sparklineEx + '(' + measure + ',' + target + ',' + maxi + ',' + good + ',' + bad + ',' + forecast + ',' + tickunit + ',' + '"' + colorScheme + '"' + ',' + vertical + ')';
                                    sheet.setFormula(row, col, formulaStr);
                                    break;
                                case "HBARSPARKLINE":
                                    var value = $("#hbarValue").val(),
                                        colorScheme = $("#hbarColorScheme").css("background-color");
                                    formulaStr = '=' + sparklineEx + '(' + value + ',' + '"' + colorScheme + '"' + ')';
                                    sheet.setFormula(row, col, formulaStr);
                                    break;
                                case "VBARSPARKLINE":
                                    var value = $("#vbarValue").val(),
                                        colorScheme = $("#vbarColorScheme").css("background-color");
                                    formulaStr = '=' + sparklineEx + '(' + value + ',' + '"' + colorScheme + '"' + ')';
                                    sheet.setFormula(row, col, formulaStr);
                                    break;
                                case "VARISPARKLINE":
                                    var variance = $("#variVariance").val(),
                                        reference = $("#variReference").val(),
                                        mini = $("#variMini").val(),
                                        maxi = $("#variMaxi").val(),
                                        mark = $("#variMark").val(),
                                        tickunit = $("#variTickunit").val(),
                                        legend = $("#variLegend").prop("checked"),
                                        colorPositive = $("#variColorPositive").css("background-color"),
                                        colorNegative = $("#variColorNegative").css("background-color"),
                                        vertical = $("#variVertical").prop("checked");
                                    formulaStr = '=' + sparklineEx + '(' + variance + ',' + reference + ',' + mini + ',' + maxi + ',' + mark + ',' + tickunit + ',' + legend + ',' + '"' + colorPositive + '"' + ',' + '"' + colorNegative + '"' + ',' + vertical + ')';
                                    sheet.setFormula(row, col, formulaStr);
                                    break;
                                case "CASCADESPARKLINE":
                                case "PARETOSPARKLINE":
                                    var dataRangeStr = $("#dataRange").val(),
                                        locationRangeStr = $("#locationRange").val(),
                                        dataRangeObj = parseStringToExternalRanges(dataRangeStr, sheet),
                                        locationRangeObj = parseStringToExternalRanges(locationRangeStr, sheet),
                                        vertical = false,
                                        dataRange, locationRange;
                                    if (dataRangeObj && dataRangeObj.length > 0 && dataRangeObj[0].range) {
                                        dataRange = dataRangeObj[0].range;
                                    }
                                    if (locationRangeObj && locationRangeObj.length > 0 && locationRangeObj[0].range) {
                                        locationRange = locationRangeObj[0].range;
                                    }
                                    if (locationRange && locationRange.rowCount < locationRange.colCount) {
                                        vertical = true;
                                    }
                                    if (!dataRange) {
                                        isValid = false;
                                        $("#dataRangeInValid").text('Range is invalid!');
                                    }
                                    if (!locationRange) {
                                        isValid = false;
                                        $("#locationRangeInValid").text('Range is invalid!');
                                    }
                                    if (isValid) {
                                    var pointCount = dataRange.rowCount * dataRange.colCount,
                                        i = 1;
                                    for (var r = locationRange.row; r < locationRange.row + locationRange.rowCount; r++) {
                                        for (var c = locationRange.col; c < locationRange.col + locationRange.colCount; c++) {
                                            if (i <= pointCount) {
                                                formulaStr = '=' + sparklineEx + '(' + dataRangeStr + ',' + i + ',,,,,,' + vertical + ')';
                                                sheet.setFormula(r, c, formulaStr);
                                                i++;
                                            }
                                        }
                                    }
                                    }
                                    break;
                                case "LINESPARKLINE":
                                case "COLUMNSPARKLINE":
                                case "WINLOSSSPARKLINE":
                                    if (cr.rowCount === 1) {
                                        direction = 1;
                                    } else if (cr.colCount === 1) {
                                        direction = 0;
                                    } else {
                                        $("#dataRangeInValid").text('Range should be in a single row or column.');
                                        isValid = false;
                                    }
                                default:
                                    var dataRangeStr = $("#dataRange").val(),
                                        locationRangeStr = $("#locationRange").val(),
                                        dataRangeObj = parseStringToExternalRanges(dataRangeStr, sheet),
                                        locationRangeObj = parseStringToExternalRanges(locationRangeStr, sheet),
                                        dataRange, locationRange;
                                    if (dataRangeObj && dataRangeObj.length > 0 && dataRangeObj[0].range) {
                                        dataRange = dataRangeObj[0].range;
                                    }
                                    if (locationRangeObj && locationRangeObj.length > 0 && locationRangeObj[0].range) {
                                        locationRange = locationRangeObj[0].range;
                                    }

                                    if (isValid) {
                                        $("#dataRangeInValid").text('');
                                        $("#locationRangeInValid").text('');
                                    }

                                    if (!dataRange) {
                                        isValid = false;
                                        $("#dataRangeInValid").text('Range is invalid!');
                                    }
                                    if (!locationRange) {
                                        isValid = false;
                                        $("#locationRangeInValid").text('Range is invalid!');
                                    }
                                    if (isValid) {
                                        if (sparklineEx === "LINESPARKLINE") {
                                            formulaStr = '=' + sparklineEx + '(' + dataRangeStr + ',' + direction + ')';
                                        } else if (sparklineEx === "COLUMNSPARKLINE") {
                                            formulaStr = '=' + sparklineEx + '(' + dataRangeStr + ',' + direction + ')';
                                        } else if (sparklineEx === "WINLOSSSPARKLINE") {
                                            formulaStr = '=' + sparklineEx + '(' + dataRangeStr + ',0' + direction + ')';
                                        } else {
                                            formulaStr = '=' + sparklineEx + '(' + dataRangeStr + ')';
                                        }
                                        row = locationRange.row;
                                        col = locationRange.col;
                                        sheet.setFormula(row, col, formulaStr);
                                    }
                                    break;
                            }
                        }
                        if (isValid) {
                            $(this).dialog("close");
                        }
                    },
                    Cancel: function () {
                        $(this).dialog("close");
                    }
                }
            });

            // ribbon
            $("#ribbon").wijribbon({
                click: function (e, cmd) {
                    var spread = $("#ss").data("spread");
                    var sheet = spread.getActiveSheet();
                    sheet.isPaintSuspended(true);
                    switch (cmd.commandName) {
                        case "cut":
                            GcSpread.Sheets.SpreadActions.cut.call(sheet);
                            break;
                        case "copy":
                            GcSpread.Sheets.SpreadActions.copy.call(sheet);
                            break;
                        case "paste":
                            GcSpread.Sheets.SpreadActions.paste.call(sheet);
                            break;
                        case "tabStop":
                            var sels = sheet.getSelections();
                            for (var n = 0; n < sels.length; n++) {
                                var sel = getActualCellRange(sels[n], sheet.getRowCount(), sheet.getColumnCount()),
                                        isTabStop = sheet.getCell(sel.row, sel.col, GcSpread.Sheets.SheetArea.viewport).tabStop();
                                if (isTabStop === false) {
                                    isTabStop = true;
                                } else {
                                    isTabStop = false;
                                }
                                sheet.getCells(sel.row, sel.col, sel.row + sel.rowCount - 1, sel.col + sel.colCount - 1, GcSpread.Sheets.SheetArea.viewport).tabStop(isTabStop);
                            }
                            break;
                        case "wrapText":
                            var sels = sheet.getSelections();
                            for (var n = 0; n < sels.length; n++) {
                                var sel = getActualCellRange(sels[n], sheet.getRowCount(), sheet.getColumnCount()),
                                        wordWrap = sheet.getCell(sel.row, sel.col, GcSpread.Sheets.SheetArea.viewport).wordWrap();
                                if (wordWrap === true) {
                                    wordWrap = false;
                                } else {
                                    wordWrap = true;
                                }
                                sheet.getCells(sel.row, sel.col, sel.row + sel.rowCount - 1, sel.col + sel.colCount - 1, GcSpread.Sheets.SheetArea.viewport).wordWrap(wordWrap);
                            }
                            break;
                        case "bold":
                        case "italic":
                            var styleEle = document.getElementById("colorSample");
                            if (cmd.commandName == "bold") {
                                setStyleFont(sheet, styleEle, "font-weight", ["700", "bold"], "400");
                            } else if (cmd.commandName == "italic") {
                                setStyleFont(sheet, styleEle, "font-style", ["italic"], "normal");
                            }
                            break;
                        case "borders":
                            $("#borderdialog").dialog("open");
                            break;
                        case "backcolor":
                        case "fontcolor":
                            var sels = sheet.getSelections(),
                                firstSelection = sels[0],
                                cell = sheet.getCell(firstSelection.row, firstSelection.col);
                            $("#colordialog").dialog({ title: cmd.commandName == "backcolor" ? "Back Color" : "Fore Color", color: cmd.commandName == "backcolor" ? cell.backColor() : cell.foreColor() });
                            $("#colordialog").dialog("open");
                            break;
                        case "Underline":
                            var sels = sheet.getSelections(),
                                    underline = GcSpread.Sheets.TextDecorationType.Underline;
                            for (var n = 0; n < sels.length; n++) {
                                var sel = getActualCellRange(sels[n], sheet.getRowCount(), sheet.getColumnCount()),
                                        textDecoration = sheet.getCell(sel.row, sel.col, GcSpread.Sheets.SheetArea.viewport).textDecoration();
                                if ((textDecoration & underline) === underline) {
                                    textDecoration = textDecoration - underline;
                                } else {
                                    textDecoration = textDecoration | underline;
                                }
                                sheet.getCells(sel.row, sel.col, sel.row + sel.rowCount - 1, sel.col + sel.colCount - 1, GcSpread.Sheets.SheetArea.viewport).textDecoration(textDecoration);
                            }
                            break;
                        case "Strikethrough":
                            var sels = sheet.getSelections(),
                                    lineThrough = GcSpread.Sheets.TextDecorationType.LineThrough;
                            for (var n = 0; n < sels.length; n++) {
                                var sel = getActualCellRange(sels[n], sheet.getRowCount(), sheet.getColumnCount()),
                                        textDecoration = sheet.getCell(sel.row, sel.col, GcSpread.Sheets.SheetArea.viewport).textDecoration();
                                if ((textDecoration & lineThrough) === lineThrough) {
                                    textDecoration = textDecoration - lineThrough;
                                } else {
                                    textDecoration = textDecoration | lineThrough;
                                }
                                sheet.getCells(sel.row, sel.col, sel.row + sel.rowCount - 1, sel.col + sel.colCount - 1, GcSpread.Sheets.SheetArea.viewport).textDecoration(textDecoration);
                            }
                            break;
                        case "Overline":
                            var sels = sheet.getSelections(),
                                    overline = GcSpread.Sheets.TextDecorationType.Overline;
                            for (var n = 0; n < sels.length; n++) {
                                var sel = getActualCellRange(sels[n], sheet.getRowCount(), sheet.getColumnCount()),
                                        textDecoration = sheet.getCell(sel.row, sel.col, GcSpread.Sheets.SheetArea.viewport).textDecoration();
                                if ((textDecoration & overline) === overline) {
                                    textDecoration = textDecoration - overline;
                                } else {
                                    textDecoration = textDecoration | overline;
                                }
                                sheet.getCells(sel.row, sel.col, sel.row + sel.rowCount - 1, sel.col + sel.colCount - 1, GcSpread.Sheets.SheetArea.viewport).textDecoration(textDecoration);
                            }
                            break;
                        case "merge":
                            var sels = sheet.getSelections();
                            var hasSpan = false;
                            for (var n = 0; n < sels.length; n++) {
                                var sel = getActualCellRange(sels[n], sheet.getRowCount(), sheet.getColumnCount());
                                if (sheet.getSpans(sel, GcSpread.Sheets.SheetArea.viewport).length > 0) {
                                    for (var i = 0; i < sel.rowCount; i++) {
                                        for (var j = 0; j < sel.colCount; j++) {
                                            sheet.removeSpan(i + sel.row, j + sel.col);
                                        }
                                    }
                                    hasSpan = true;
                                }
                            }
                            if (!hasSpan) {
                                for (var n = 0; n < sels.length; n++) {
                                    var sel = getActualCellRange(sels[n], sheet.getRowCount(), sheet.getColumnCount());
                                    sheet.addSpan(sel.row, sel.col, sel.rowCount, sel.colCount);
                                }
                            }
                            break;
                        case "justifyleft":
                        case "justifycenter":
                        case "justifyright":
                            var align = GcSpread.Sheets.HorizontalAlign.left;
                            if (cmd.commandName == "justifycenter") align = GcSpread.Sheets.HorizontalAlign.center;
                            if (cmd.commandName == "justifyright") align = GcSpread.Sheets.HorizontalAlign.right;
                            var sels = sheet.getSelections();
                            for (var n = 0; n < sels.length; n++) {
                                var sel = getActualCellRange(sels[n], sheet.getRowCount(), sheet.getColumnCount());
                                sheet.getCells(sel.row, sel.col, sel.row + sel.rowCount - 1, sel.col + sel.colCount - 1, GcSpread.Sheets.SheetArea.viewport).hAlign(align);
                            }
                            break;
                        case "increaseindent":
                        case "decreaseindent":
                            var sels = sheet.getSelections();
                            var offset = 1;
                            if (cmd.commandName == "decreaseindent") offset = -1;
                            for (var n = 0; n < sels.length; n++) {
                                var sel = getActualCellRange(sels[n], sheet.getRowCount(), sheet.getColumnCount());
                                for (var i = 0; i < sel.rowCount; i++) {
                                    for (var j = 0; j < sel.colCount; j++) {
                                        var indent = sheet.getCell(i + sel.row, j + sel.col, GcSpread.Sheets.SheetArea.viewport).textIndent();
                                        if (isNaN(indent)) indent = 0;
                                        sheet.getCell(i + sel.row, j + sel.col, GcSpread.Sheets.SheetArea.viewport).textIndent(indent + offset);
                                    }
                                }
                            }
                            break;
                        case "insertcol":
                            sheet.addColumns(sheet.getActiveColumnIndex(), 1);
                            break;
                        case "insertrow":
                            sheet.addRows(sheet.getActiveRowIndex(), 1);
                            break;
                        case "deleterow":
                            sheet.deleteRows(sheet.getActiveRowIndex(), 1);
                            break;
                        case "deletecol":
                            sheet.deleteColumns(sheet.getActiveColumnIndex(), 1);
                            break;
                        case "highlightcell":
                            $("#Rule1 option:eq(0)").attr("selected", "selected");
                            $("#Rule1").empty();
                            $("#Rule1").show();
                            $("#Rule1").append("<option value='0'>Cell Value</option>");
                            $("#Rule1").append("<option value='1'>Specific Text</option>");
                            $("#Rule1").append("<option value='2'>Date Occurring</option>");
                            $("#Rule1").append("<option value='5'>Unique</option>");
                            $("#Rule1").append("<option value='6'>Duplicate</option>");
                            var rule = "0";
                            var type = $("#ComparisonOperator1");
                            setEnumTypeOfCF(rule, type);
                            $("#conditionalformatdialog").dialog("option", {height: 200, width: 379, colorScale: false});
                            $("#conditionalformatdialog").dialog("open");
                            break;
                        case "topbottom":
                            $("#Rule1 option:eq(1)").attr("selected", "selected");
                            $("#Rule1").empty();
                            $("#Rule1").show();
                            $("#Rule1").append("<option value='4'>Top10</option>");
                            $("#Rule1").append("<option value='7'>Average</option>");
                            var rule = "4";
                            var type = $("#ComparisonOperator1");
                            setEnumTypeOfCF(rule, type);
                            $("#conditionalformatdialog").dialog("option", {height: 200, width: 256, colorScale: false});
                            $("#conditionalformatdialog").dialog("open");
                            break;
                        case "colorscale":
                            $("#Rule1 option:eq(2)").attr("selected", "selected");
                            $("#Rule1").empty();
                            $("#Rule1").show();
                            $("#Rule1").append("<option value='8'>2-Color Scale</option>");
                            $("#Rule1").append("<option value='9'>3-Color Scale</option>");
                            var rule = "8";
                            var type = $("#ComparisonOperator1");
                            setEnumTypeOfCF(rule, type);
                            $("#conditionalformatdialog").dialog("option", {height: 300, width: 409, colorScale: true});
                            $("#conditionalformatdialog").dialog("open");
                            break;
                        case "otherofconditionalformat":
                            $("#Rule1 option:eq(3)").attr("selected", "selected");
                            $("#Rule1").empty();
                            $("#Rule1").show();
                            $("#Rule1").append("<option value='3'>FormulaRule</option>");
                            var rule = "3";
                            var type = $("#ComparisonOperator1");
                            setEnumTypeOfCF(rule, type);
                            $("#conditionalformatdialog").dialog("option", {height: 200, width: 380, colorScale: false});
                            $("#conditionalformatdialog").dialog("open");
                            break;
                        case "databar":
                            $("#databardialog").dialog("open");
                            break;
                        case "iconset":
                            $("#iconSetType").val("0");
                            createIconCriteriaDOM();
                            $("#iconsetdialog").dialog("open");
                            break;
                        case "removeconditionalformats":
                            var cfs = sheet.getConditionalFormats();
                            var row = sheet.getActiveRowIndex(), col = sheet.getActiveColumnIndex();
                            var rules = cfs.getRules(row, col);
                            $.each(rules, function (i, v) {
                                cfs.removeRule(v);
                            });
                            sheet.isPaintSuspended(false);
                            break;
                        case "table":
                            var table = sheet.findTable(sheet.getActiveRowIndex(), sheet.getActiveColumnIndex());
                            $("#ckName").text("");
                            if (!table) {
                                $("#showHeader").attr("checked", true);
                                $("#showFooter").attr("checked", false);
                                $("#highlightFirstColumn").attr("checked", false);
                                $("#highlightLastColumn").attr("checked", false);
                                $("#bandRows").attr("checked", true);
                                $("#bandColumns").attr("checked", false);
                                tableName = getTableName(sheet);
                                $("#tableName").val(tableName);
                                isTableAdd = true;
                                $("#tabledialog").dialog({ title: "Add Table" });
                                $("#tabledialog").next().find("span").get(0).innerHTML = "Add";
                                $($("#tabledialog").next().find(".ui-dialog-buttonset button")[1]).css("display", "none");
                            } else {
                                $("#showHeader").attr("checked", table.showHeader());
                                $("#showFooter").attr("checked", table.showFooter());
                                $("#highlightFirstColumn").attr("checked", table.highlightFirstColumn());
                                $("#highlightLastColumn").attr("checked", table.highlightLastColumn());
                                $("#bandRows").attr("checked", table.bandRows());
                                $("#bandColumns").attr("checked", table.bandColumns());
                                var styleName = table.style().name();
                                $("#tableStyles option[value='" + styleName + "']").attr("selected", true);
                                $("#tableName").val(table.name());
                                isTableAdd = false;
                                $("#tabledialog").dialog({ title: "Design Table" });
                                $("#tabledialog").next().find("span").get(0).innerHTML = "Update";
                                $($("#tabledialog").next().find(".ui-dialog-buttonset button")[1]).css("display", "");
                            }
                            $("#tabledialog").dialog("open");
                            break;
                        case "picture":
                            var pictures = sheet.getPictures(),
                                    hasPictureSelected = false,
                                    picture;
                            for (var index = 0, len = pictures.length; index < len; index++) {
                                var item = pictures[index];
                                if (item && item.isSelected()) {
                                    hasPictureSelected = true;
                                    picture = item;
                                    break;
                                }
                            }
                            if (!hasPictureSelected) {
                                $("#picturedialog").dialog({ title: "Add Picture" });
                                $("#picturedialog").next().find("span").get(0).innerHTML = "Add";
                                $($("#picturedialog").next().find(".ui-dialog-buttonset button")[1]).css("display", "none");
                                $("#pictureSettingsOptions").hide();
                                $("#pictureAddOptions").show();
                                isPictureAdd = true;
                                $("#picturedialog").dialog("option", { height: 200, width:280 });
                            } else {
                                $("#picturedialog").dialog({ title: "Design Picture" });
                                $("#picturedialog").next().find("span").get(0).innerHTML = "Update";
                                $($("#picturedialog").next().find(".ui-dialog-buttonset button")[1]).css("display", "");
                                $("#pictureAddOptions").hide();
                                $("#pictureSettingsOptions").show();
                                $("#dynamicMove").attr("checked", picture.dynamicMove());
                                $("#dynamicSize").attr("checked", picture.dynamicSize());
                                $("#pictureBackColor").css("background-color", picture.backColor());
                                $("#pictureBorderColor").css("background-color", picture.borderColor());
                                $("#pictureBorderWidth").val(picture.borderWidth());
                                $("#pictureBorderRadius").val(picture.borderRadius());
                                var borderStyle = picture.borderStyle();
                                $("#pictureBorderStyle option[value='" + borderStyle + "']").attr("selected", true);
                                var pictureStretch = picture.pictureStretch();
                                $("#pictureStretch option[value='" + pictureStretch + "']").attr("selected", true);
                                isPictureAdd = false;
                                $("#picturedialog").dialog("option", { height: 360, width: 380 });
                            }
                            $("#picturedialog").dialog("open");
                            break;
                        case "sortaz":
                        case "sortza":
                            var sels = sheet.getSelections();
                            for (var n = 0; n < sels.length; n++) {
                                var sel = getActualCellRange(sels[n], sheet.getRowCount(), sheet.getColumnCount());
                                sheet.sortRange(sel.row, sel.col, sel.rowCount, sel.colCount, true, [
                                    { index: sel.col, ascending: cmd.commandName == "sortaz" }
                                ]);
                            }
                            break;
                        case "filter":
                            if (sheet.rowFilter()) {
                                sheet.rowFilter(null);
                            } else {
                                var sels = sheet.getSelections();
                                if (sels.length > 0) {
                                    var sel = sels[0];
                                    sheet.rowFilter(new GcSpread.Sheets.HideRowFilter(sel));
                                }
                            }
                            break;
                        case "group":
                            var sels = sheet.getSelections();
                            var sel = sels[0];

                            if (sel.col == -1) // row selection
                            {
                                var groupExtent = new GcSpread.Sheets.UndoRedo.GroupExtent(sel.row, sel.rowCount);
                                var action = new GcSpread.Sheets.UndoRedo.RowGroupUndoAction(sheet, groupExtent);
                                spread.doCommand(action);
                                $("#showRowGroup").attr("disabled", false);
                                if ($("#showRowGroup").attr("value") == "true") {
                                    $("#showRowGroupLabel").unbind("mouseup", rowlabelnoactive);
                                }
                                $("#showRowGroup").attr("value", "true");
                                $("#showRowGroupLabel").attr("disabled", false);
                                $("#showRowGroupLabel").removeClass("ui-state-disabled");
                                $("#showRowGroupLabel").unbind("mouseup", rowlabelactive);
                                sheet.showRowRangeGroup(true);
                            }
                            else if (sel.row == -1) // column selection
                            {
                                var groupExtent = new GcSpread.Sheets.UndoRedo.GroupExtent(sel.col, sel.colCount);
                                var action = new GcSpread.Sheets.UndoRedo.ColumnGroupUndoAction(sheet, groupExtent);
                                spread.doCommand(action);
                                $("#showColGroup").attr("disabled", false);
                                if ($("#showColGroup").attr("value") == "true") {
                                    $("#showColGroupLabel").unbind("mouseup", collabelnoactive);
                                }
                                $("#showColGroup").attr("value", "true");
                                $("#showColGroupLabel").attr("disabled", false);
                                $("#showColGroupLabel").removeClass("ui-state-disabled");
                                $("#showColGroupLabel").unbind("mouseup", collabelactive);
                                sheet.showColumnRangeGroup(true);
                            }
                            else // cell range selection
                            {
                                alert("please select a range of row or col");
                            }
                            break;
                        case "ungroup":
                            var sels = sheet.getSelections();
                            var sel = sels[0];

                            if (sel.col == -1 && sel.row == -1) // sheet selection
                            {
                                sheet.rowRangeGroup.ungroup(0, sheet.getRowCount());
                                sheet.colRangeGroup.ungroup(0, sheet.getColumnCount());
                            }
                            else if (sel.col == -1) // row selection
                            {
                                //sheet.rowRangeGroup.ungroup(sel.row, sel.rowCount);
                                var groupExtent = new GcSpread.Sheets.UndoRedo.GroupExtent(sel.row, sel.rowCount);
                                var action = new GcSpread.Sheets.UndoRedo.RowUngroupUndoAction(sheet, groupExtent);
                                spread.doCommand(action);
                                if (sheet.rowRangeGroup.getMaxLevel() < 0) {
                                    $("#showRowGroup").attr("disabled", true);
                                    $("#showRowGroup").attr("value", "true");
                                    $("#showRowGroupLabel").attr("disabled", true);
                                    $("#showRowGroupLabel").addClass("ui-state-disabled");
                                    $("#showRowGroupLabel").bind("mouseup", rowlabelnoactive);
                                }
                            }
                            else if (sel.row == -1) // column selection
                            {
                                //sheet.colRangeGroup.ungroup(sel.col, sel.colCount);
                                var groupExtent = new GcSpread.Sheets.UndoRedo.GroupExtent(sel.col, sel.colCount);
                                var action = new GcSpread.Sheets.UndoRedo.ColumnUngroupUndoAction(sheet, groupExtent);
                                spread.doCommand(action);
                                if (sheet.colRangeGroup.getMaxLevel() < 0) {
                                    $("#showColGroup").attr("disabled", true);
                                    $("#showColGroup").attr("value", "true");
                                    $("#showColGroupLabel").attr("disabled", true);
                                    $("#showColGroupLabel").addClass("ui-state-disabled");
                                    $("#showColGroupLabel").bind("mouseup", collabelnoactive);
                                }
                            }
                            else // cell range selection
                            {
                                alert("please select a range of row or col");
                            }
                            break;
                        case "showdetail":
                        case "hidedetail":
                            var sels = sheet.getSelections();
                            var sel = sels[0];

                            if (sel.col == -1 && sel.row == -1) // sheet selection
                            {
                            }
                            else if (sel.col == -1) // row selection
                            {
                                for (var i = 0; i < sel.rowCount; i++) {
                                    var rgi = sheet.rowRangeGroup.find(sel.row + i, 0);
                                    if (rgi) {
                                        sheet.rowRangeGroup.expand(rgi.level, cmd.commandName == "showdetail");
                                    }
                                }
                            }
                            else if (sel.row == -1) // column selection
                            {
                                for (var i = 0; i < sel.colCount; i++) {
                                    var rgi = sheet.colRangeGroup.find(sel.col + i, 0);
                                    if (rgi) {
                                        sheet.colRangeGroup.expand(rgi.level, cmd.commandName == "showdetail");
                                    }
                                }
                            }
                            else // cell range selection
                            {
                            }
                            break;
                        case "showrowrangegroup":
                            if (!$("#showRowGroup").attr("disabled")) {
                                sheet.showRowRangeGroup($("#showRowGroup").prop("checked"));
                            }
                            break;
                        case "showcolrangegroup":
                            if (!$("#showColGroup").attr("disabled")) {
                                sheet.showColumnRangeGroup($("#showColGroup").prop("checked"));
                            }
                            break;
                        case "datavalidation":
                            $("#datavalidationdialog").dialog("open");
                            break;
                        case "circleinvaliddata":
                            spread.highlightInvalidData(true);
                            break;
                        case "clearvalidationcircles":
                            spread.highlightInvalidData(false);
                            break;
                        case "textboxcelltype":
                            $("#comboCellOptions").hide();
                            $("#checkBoxCellOptions").hide();
                            $("#buttonCellOptions").hide();
                            $("#hyperlinkCellOptions").hide();
                            var cellType = new GcSpread.Sheets.TextCellType();
                            sheet.suspendEvent();
                            var sels = sheet.getSelections();
                            for (var i = 0; i < sels.length; i++) {
                                var sel = getActualCellRange(sels[i], sheet.getRowCount(), sheet.getColumnCount());
                                for (var r = 0; r < sel.rowCount; r++) {
                                    for (var c = 0; c < sel.colCount; c++) {
                                        sheet.setCellType(sel.row + r, sel.col + c, cellType, GcSpread.Sheets.SheetArea.viewport);
                                    }
                                }
                            }
                            sheet.resumeEvent();
                            break;
                        case "comboboxcelltype":
                            $("#comboCellOptions").show();
                            $("#checkBoxCellOptions").hide();
                            $("#buttonCellOptions").hide();
                            $("#hyperlinkCellOptions").hide();
                            $("#selComboCellEditorValueType").val("0");
                            $("#txtComboCellItemsText").val("");
                            $("#txtComboCellItemsValue").val("");
                            $("#celltypedialog").dialog("open");
                            selCellType = "ComboCell";
                            break;
                        case "checkboxcelltype":
                            $("#comboCellOptions").hide();
                            $("#checkBoxCellOptions").show();
                            $("#buttonCellOptions").hide();
                            $("#hyperlinkCellOptions").hide();
                            $("#txtCheckBoxCellTextCaption").val("");
                            $("#txtCheckBoxCellTextTrue").val("");
                            $("#txtCheckBoxCellTextIndeterminate").val("");
                            $("#txtCheckBoxCellTextFalse").val("");
                            $("#selCheckBoxCellAlign").val("0");
                            $("#ckbCheckBoxCellIsThreeState").prop("checked", false);
                            $("#celltypedialog").dialog("open");
                            selCellType = "CheckBoxCell";
                            break;
                        case "buttoncelltype":
                            $("#comboCellOptions").hide();
                            $("#checkBoxCellOptions").hide();
                            $("#buttonCellOptions").show();
                            $("#hyperlinkCellOptions").hide();
                            $("#txtButtonCellMarginLeft").val("");
                            $("#txtButtonCellMarginTop").val("");
                            $("#txtButtonCellMarginRight").val("");
                            $("#txtButtonCellMarginBottom").val("");
                            $("#txtButtonCellText").val("");
                            $("#txtButtonCellBackColor").css("background-color","#707070");
                            $("#celltypedialog").dialog("open");
                            selCellType = "ButtonCell";
                            break;
                        case "hyperlinkcelltype":
                            $("#comboCellOptions").hide();
                            $("#checkBoxCellOptions").hide();
                            $("#buttonCellOptions").hide();
                            $("#hyperlinkCellOptions").show();
                            $("#txtHyperLinkCellLinkColor").css("background-color","#0066CC");
                            $("#txtHyperLinkCellVisitedLinkColor").css("background-color","#3399FF");
                            $("#txtHyperLinkCellText").val("");
                            $("#txtHyperLinkCellToolTip").val("");
                            $("#celltypedialog").dialog("open");
                            selCellType = "HyperLinkCell";
                            break;
                        case "alloweditorreservedlocations":
                            sheet.allowEditorReservedLocations($("#alleditorreserved").attr("checked") === "checked" ? true : false);
                            break;
                        case "ClearCellType":
                            var sels = sheet.getSelections();
                            for (var i = 0; i < sels.length; i++) {
                                var sel = getActualCellRange(sels[i], sheet.getRowCount(), sheet.getColumnCount());
                                sheet.clear(sel.row, sel.col, sel.rowCount, sel.colCount, GcSpread.Sheets.SheetArea.viewport, GcSpread.Sheets.StorageType.Style);
                            }
                            break;
                        case "comment":
                            var comment = sheet.getComment(sheet.getActiveRowIndex(), sheet.getActiveColumnIndex());
                            if (!comment) {
                                $("#commentdialog").dialog({ title: "Add Comment" });
                                $("#commentdialog").next().find("span").get(0).innerHTML = "Add";
                                $($("#commentdialog").next().find(".ui-dialog-buttonset button")[1]).css("display", "none");
                                $("#commentSettingsOptions").hide();
                                $("#commentAddOptions").show();
                                isCommentAdd = true;
                                $("#txtText").val("");
                                $("#txtLocation").val("");
                                $("#txtWidth").val("");
                                $("#txtHeight").val("");
                                $("#commentdialog").dialog("option", {height: 220, width: 386});
                            } else {
                                $("#commentdialog").dialog({ title: "Design Comment" });
                                $("#commentdialog").next().find("span").get(0).innerHTML = "Update";
                                $($("#commentdialog").next().find(".ui-dialog-buttonset button")[1]).css("display", "");
                                $("#commentAddOptions").hide();
                                $("#commentSettingsOptions").show();
                                $("#txtFontFamily").val(comment.fontFamily());
                                $("#comboBoxFontStyle").val(comment.fontStyle());
                                $("#txtFontSize").val(comment.fontSize());
                                $("#txtFontWeight").val(comment.fontWeight());
                                $("#txtBorderWidth").val(comment.borderWidth());
                                $("#comboBoxBorderStyle").val(comment.borderStyle());
                                $("#txtBorderColor").css("background-color", comment.borderColor());
                                var padding = comment.padding();
                                if (padding) {
                                    $("#txtPadding").val(padding.left + ',' + padding.top + ',' + padding.right + ',' + padding.bottom);
                                } else {
                                    $("#txtPadding").val(0);
                                }
                                $("#comboBoxTextDecoration").val(comment.textDecoration());
                                $("#txtOpacity").val(comment.opacity() * 100);
                                $("#txtForeColor").css("background-color", comment.foreColor());
                                $("#txtBackColor").css("background-color", comment.backColor());
                                $("#comboBoxHorizontal").val(comment.horizontalAlign());
                                $("#comboBoxDisplayMode").val(comment.displayMode());
                                $("#txtzIndex").val(comment.zIndex());
                                $("#chkLockText").val(comment.lockText());
                                $("#chkDynamicMove").prop('checked', comment.dynamicMove());
                                $("#chkDynamicSize").prop('checked', comment.dynamicSize());
                                $("#chkShowShadow").prop('checked', comment.showShadow());
                                isCommentAdd = false;
                                $("#commentdialog").dialog("option", {height: 460, width: 416});
                            }
                            $("#commentdialog").dialog("open");
                            break;
                        case "sparklineex":
                            var sel = sheet.getSelections()[0],
                                formularType = "LINESPARKLINE",
                                dataRange = "";
                            if (sel) {
                                var cr = getActualRange(sel, sheet.getRowCount(), sheet.getColumnCount());
                                if (cr) {
                                    var formula = sheet.getFormula(cr.row, cr.col, GcSpread.Sheets.SheetArea.viewport);
                                    if (formula !== null && formula !== undefined) {
                                        var formulaIndex = formula.indexOf('(');
                                        formularType = formula.substring(0, formulaIndex);
                                    } else {
                                        dataRange = parseRangeToExpString(cr, spread);
                                    }
                                }
                            }
                            $("#dataRange").val(dataRange);
                            $("#locationRange").val('');
                            $("#sparklineExType").val(formularType);
                            sparklineExTypeChanged();
                            $("#sparklineexdialog").dialog("open");
                            break;
                        case "rowheader":
                            sheet.setRowHeaderVisible(!sheet.getRowHeaderVisible());
                            break;
                        case "columnheader":
                            sheet.setColumnHeaderVisible(!sheet.getColumnHeaderVisible());
                            break;
                        case "vgridline":
                            var vGridLine = sheet.gridline.showVerticalGridline;
                            var hGridLine = sheet.gridline.showHorizontalGridline;
                            sheet.setGridlineOptions({ showVerticalGridline: !vGridLine, showHorizontalGridline: hGridLine });
                            break;
                        case "hgridline":
                            var hGridLine = sheet.gridline.showHorizontalGridline;
                            var vGridLine = sheet.gridline.showVerticalGridline;
                            sheet.setGridlineOptions({ showVerticalGridline: vGridLine, showHorizontalGridline: !hGridLine });
                            break;
                        case "tabstrip":
                            spread.tabStripVisible(!spread.tabStripVisible());
                            break;
                        case "newtab":
                            spread.newTabVisible(!spread.newTabVisible());
                            break;
                        case "showhorizontalscrollbar":
                            var hScrollbar = spread.showHorizontalScrollbar();
                            spread.showHorizontalScrollbar(!hScrollbar);
                            break;
                        case "showverticalscrollbar":
                            var vScrollbar = spread.showVerticalScrollbar();
                            spread.showVerticalScrollbar(!vScrollbar);
                            break;
                        case "scrollbarMaxAlign":
                            var scrollMaxAlign = spread.scrollbarMaxAlign();
                            spread.scrollbarMaxAlign(!scrollMaxAlign);
                            break;
                        case "scrollbarShowMax":
                            var scrollShowMax = spread.scrollbarShowMax();
                            spread.scrollbarShowMax(!scrollShowMax);
                            break;
                        case "freezepane":
                            sheet.setFrozenRowCount(sheet.getActiveRowIndex());
                            sheet.setFrozenColumnCount(sheet.getActiveColumnIndex());
                            break;
                        case "unfreeze":
                            sheet.setFrozenRowCount(0);
                            sheet.setFrozenColumnCount(0);
                            sheet.setFrozenTrailingRowCount(0);
                            sheet.setFrozenTrailingColumnCount(0);
                            break;
                        case "frozenlinecolor":
                            showColorDialog("FrozenLineColor", sheet.frozenlineColor());
                            break;
                        case "freezesetting":
                            $("#freezesettingdialog").dialog("open");
                            $("#frozenColumnCount").val(sheet.getFrozenColumnCount());
                            $("#frozenRowCount").val(sheet.getFrozenRowCount());
                            $("#frozenTrailingColumnCount").val(sheet.getFrozenTrailingColumnCount());
                            $("#frozenTrailingRowCount").val(sheet.getFrozenTrailingRowCount());
                            break;
                        case "tabStripColor":
                            showColorDialog("Tab Strip Color", sheet.sheetTabColor());
                            break;
                        case "spreadbackcolor":
                            showColorDialog("SpreadBackColor", spread.backColor());
                            break;
                        case "grayareabackcolor":
                            showColorDialog("GrayAreaBackColor", spread.grayAreaBackColor());
                            break;
                        case "selectionbordercolor":
                            showColorDialog("SelectionBorderColor", sheet.selectionBorderColor());
                            break;
                        case "selectionbackcolor":
                            showColorDialog("SelectionBackColor", sheet.selectionBackColor());
                            break;
                        case "hideselection":
                            spread.hideSelection($("#hideSelection").prop("checked"));
                            break;
                        case "isr1c1":
                            var result = $("#isR1C1").prop("checked");
                            if (result) {
                                spread.referenceStyle(GcSpread.Sheets.ReferenceStyle.R1C1);
                            }
                            else {
                                spread.referenceStyle(GcSpread.Sheets.ReferenceStyle.A1);
                            }
                            break;
                        case "canuserdragdrop":
                            var result = $("#canUserDragDrop").prop("checked");
                            sheet.canUserDragDrop(result);
                            break;
                        case "canuserdragfill":
                            var result = $("#canUserDragFill").prop("checked");
                            sheet.canUserDragFill(result);
                            break;
                        case "canusereditformula":
                            var result = $("#canUserEditFormula").prop("checked");
                            spread.canUserEditFormula(result);
                            break;
                        case "showdragdroptip":
                            var dragDrop = $("#showDragDropTip").prop("checked");
                            spread.showDragDropTip(dragDrop);
                            break;
                        case "showdragfilltip":
                            var dragFill = $("#showDragFillTip").prop("checked");
                            spread.showDragFillTip(dragFill);
                            break;
                        case "autofitwithheadertext":
                            var autoFit = $("#autoFitWithHeaderText").prop("checked") ? GcSpread.Sheets.AutoFitType.CellWithHeader : GcSpread.Sheets.AutoFitType.Cell;
                            spread.autoFitType(autoFit);
                            break;
                        case "allowsheetreorder":
                            var isAllow = $("#allowSheetReorder").prop("checked");
                            spread.allowSheetReorder(isAllow);
                            break;
                        case "sheetVisible":
                            var sheetName = $("#sheetList").val();
                            if (sheetName && sheetName !== '') {
                                var visibleSheet = spread.getSheetFromName(sheetName);
                                if (visibleSheet && typeof (visibleSheet.visible) === 'function') {
                                    var visible = visibleSheet.visible();
                                    visibleSheet.visible(!visible);
                                }
                            }
                            break;
                        case "cutcopyindicatorvisible":
                            var isVisible = $("#cutCopyIndicatorVisible").prop("checked");
                            spread.cutCopyIndicatorVisible(isVisible);
                            break;
                        case "usetouchlayout":
                            var isUseTouch = $("#useTouchLayout").prop("checked");
                            spread.useTouchLayout(isUseTouch);
                            break;
                        case "showDragFillSmartTag":
                            var dragFillSmartTag = $("#showDragFillSmartTag").prop("checked");
                            spread.showDragFillSmartTag(dragFillSmartTag);
                            break;
                        case "cutcopyindicatorcolor":
                            showColorDialog("Indicator Border Color", spread.cutCopyIndicatorBorderColor());
                            break;
                        case "importexcel":
                            excelImport();
                            break;
                        case "exportexcel":
                            excelExport(spread);
                            break;
                        default:
                            if (cmd.commandName.substr(0, 1) == "f") {
                                var styleEle = document.getElementById("colorSample");
                                if (cmd.commandName.substr(0, 2) == "fn") {
                                    var fontFamily = document.getElementById(cmd.commandName)["title"];
                                    setStyleFont(sheet, styleEle, "font-family", [fontFamily], fontFamily);
                                }
                                if (cmd.commandName.substr(0, 2) == "fs") {
                                    var fontSize = document.getElementById(cmd.commandName)["title"];
                                    setStyleFont(sheet, styleEle, "font-size", [fontSize], fontSize);
                                }
                            } else if (cmd.commandName.substr(0, 1) == "s") {
                                if (cmd.commandName.substr(0, 2) == "sp") {
                                    var policy = 2;
                                    if (document.getElementById(cmd.commandName)["title"] == "Single") {
                                        policy = 0;
                                    } else if (document.getElementById(cmd.commandName)["title"] == "Range") {
                                        policy = 1;
                                    } else if (document.getElementById(cmd.commandName)["title"] == "MultiRange") {
                                        policy = 2;
                                    }
                                    sheet.selectionPolicy(policy);
                                }
                                if (cmd.commandName.substr(0, 2) == "su") {
                                    var unit = 0;
                                    if (document.getElementById(cmd.commandName)["title"] == "Cell") {
                                        unit = 0;
                                    } else if (document.getElementById(cmd.commandName)["title"] == "Row") {
                                        unit = 1;
                                    } else if (document.getElementById(cmd.commandName)["title"] == "Column") {
                                        unit = 2;
                                    }
                                    sheet.selectionUnit(unit);
                                }
                            } else if (cmd.commandName.substr(0, 1) == "t") {
                                if (cmd.commandName.substr(0, 2) == "ts") {
                                    var scrollTip = 2;
                                    if (document.getElementById(cmd.commandName)["title"] == "None") {
                                        scrollTip = 0;
                                    } else if (document.getElementById(cmd.commandName)["title"] == "Horizontal") {
                                        scrollTip = 1;
                                    } else if (document.getElementById(cmd.commandName)["title"] == "Vertical") {
                                        scrollTip = 2;
                                    } else if (document.getElementById(cmd.commandName)["title"] == "Both") {
                                        scrollTip = 3;
                                    }
                                    spread.showScrollTip(scrollTip);
                                }
                                if (cmd.commandName.substr(0, 2) == "tr") {
                                    var resizeTip = 0;
                                    if (document.getElementById(cmd.commandName)["title"] == "None") {
                                        resizeTip = 0;
                                    } else if (document.getElementById(cmd.commandName)["title"] == "Column") {
                                        resizeTip = 1;
                                    } else if (document.getElementById(cmd.commandName)["title"] == "Row") {
                                        resizeTip = 2;
                                    } else if (document.getElementById(cmd.commandName)["title"] == "Both") {
                                        resizeTip = 3;
                                    }
                                    spread.showResizeTip(resizeTip);
                                }
                            } else if (cmd.commandName.substr(0, 1) == "d") {
                                if (cmd.commandName.substr(0, 2) == "df") {
                                    var autoFillType = GcSpread.Sheets.AutoFillType.Auto;
                                    if (document.getElementById(cmd.commandName)["title"] == "CopyCells") {
                                        autoFillType = GcSpread.Sheets.AutoFillType.CopyCells;
                                    } else if (document.getElementById(cmd.commandName)["title"] == "FillSeries") {
                                        autoFillType = GcSpread.Sheets.AutoFillType.FillSeries;
                                    } else if (document.getElementById(cmd.commandName)["title"] == "FillFormattingOnly") {
                                        autoFillType = GcSpread.Sheets.AutoFillType.FillFormattingOnly;
                                    } else if (document.getElementById(cmd.commandName)["title"] == "FillWithoutFormatting") {
                                        autoFillType = GcSpread.Sheets.AutoFillType.FillWithoutFormatting;
                                    } else if (document.getElementById(cmd.commandName)["title"] == "Auto") {
                                        autoFillType = GcSpread.Sheets.AutoFillType.Auto;
                                    }
                                    spread.defaultDragFillType(autoFillType);
                                }
                            } else {
                                alert(cmd.commandName);
                            }

                            break;
                    }
                    sheet.isPaintSuspended(false);
                },
                create: function (e, ui) {
                    changeIcons();
                    $(".wijmo-wijribbon-group-label").hide();
                }
            });

            $("#ribbon").wijtabs({
                show: function (e, args) {
                    adjustHeight(args.index);
                }
            });

            //Initalize spread
            var spread = new GcSpread.Sheets.Spread($("#ss")[0], { sheetCount: 2 });
            initSpread();

            //window resize adjust
            screenAdption();
            var resizeTimeout = null;
            $(window).bind("resize", function () {
                if (resizeTimeout === null) {
                    resizeTimeout = setTimeout(function () {
                        screenAdption();
                        clearTimeout(resizeTimeout);
                        resizeTimeout = null;
                    }, 100);
                }
            });

            // color dialog
            $("#selectedColor").on('change keydown paste input', function() {
                var color = $(this).val();
                $("#colorchart td.selected").removeClass("selected");
                if (hexColorValueRegEx.test(color)) {
                    color = color.toUpperCase();
                    $("#colorchart td[bgColor='" + color + "'").addClass("selected");
                    $("#colorSample").css("background-color", color);
                }
            });

            //context menu
            var sheetArea = GcSpread.Sheets.SheetArea.viewport,
                isHideContextMenu = false;
            $("#ss").mouseup(function (e) {
                // hide context menu when the mouse down on SpreadJS
                if (e.button !== 2) {
                    $("#contextMenu").wijmenu("hideAllMenus");
                }
            });
            $("#ss").bind('contextmenu', function (e) {
                // move the context menu to the position of the mouse point
                var spread = $("#ss").data("spread");
                var sheet = spread.getActiveSheet();
                var target = getHitTest(e.pageX, e.pageY, sheet);
                isHideContextMenu = false;
                sheetArea = target.hitTestType;
                if (target.hitTestType === GcSpread.Sheets.SheetArea.colHeader) {
                    if (getCellInSelections(sheet.getSelections(), target.row, target.col) === null) {
                        sheet.setSelection(-1, target.col, sheet.getRowCount(), 1);
                    }
                    if (target.row !== undefined && target.col !== undefined) {
                        $(".context-header").show();
                        $(".context-cell").show();
                        showMergeContextMenu(sheet);
                    }
                } else if (target.hitTestType === GcSpread.Sheets.SheetArea.rowHeader) {
                    if (getCellInSelections(sheet.getSelections(), target.row, target.col) === null) {
                        sheet.setSelection(target.row, -1, 1, sheet.getColumnCount());
                    }
                    if (target.row !== undefined && target.col !== undefined) {
                        $(".context-header").show();
                        $(".context-cell").show();
                        showMergeContextMenu(sheet);
                    }
                } else if (target.hitTestType === GcSpread.Sheets.SheetArea.viewport) {
                    if (getCellInSelections(sheet.getSelections(), target.row, target.col) === null) {
                        sheet.clearSelection();
                        sheet.endEdit();
                        sheet.setActiveCell(target.row, target.col);
                    }
                    if (target.row !== undefined && target.col !== undefined) {
                        $(".context-header").hide();
                        $(".context-cell").show();
                        showMergeContextMenu(sheet);
                    } else {
                        isHideContextMenu = true;
                    }
                } else if (target.hitTestType === GcSpread.Sheets.SheetArea.corner) {
                    sheet.setSelection(-1, -1, sheet.getRowCount(), sheet.getColumnCount());
                    if (target.row !== undefined && target.col !== undefined) {
                        $(".context-header").hide();
                        $(".context-cell").show();
                    }
                }
                $("#contextMenu").wijmenu("option", "position", {
                    my: "left top",
                    of: e
                });
                $("#contextMenu").wijmenu("deactivate");
                return false;
            });
            $("#contextMenu").wijmenu({
                trigger: "#ss",
                triggerEvent: "rtclick",
                orientation: "vertical",
                showAnimation: { animated: 'slide', duration: 0, easing: null },
                hideAnimation: { animated: 'slide', duration: 0, easing: null },
                showing: function (e, item) {
                    if (isHideContextMenu) {
                        return false;
                    } else {
                        return true;
                    }
                },
                select: function (e, data) {
                    var options = data.item.options;
                    var spread = $("#ss").data("spread");
                    var sheet = spread.getActiveSheet();
                    switch (options.text) {
                        case "Cut":
                            GcSpread.Sheets.SpreadActions.cut.call(sheet);
                            break;
                        case "Copy":
                            GcSpread.Sheets.SpreadActions.copy.call(sheet);
                            break;
                        case "Paste":
                            GcSpread.Sheets.SpreadActions.paste.call(sheet);
                            break;
                        case "Insert":
                            if (sheetArea === GcSpread.Sheets.SheetArea.colHeader) {
                                sheet.addColumns(sheet.getActiveColumnIndex(), 1);
                            } else if (sheetArea === GcSpread.Sheets.SheetArea.rowHeader) {
                                sheet.addRows(sheet.getActiveRowIndex(), 1);
                            }
                            break;
                        case "Delete":
                            if (sheetArea === GcSpread.Sheets.SheetArea.colHeader) {
                                sheet.deleteColumns(sheet.getActiveColumnIndex(), 1);
                            } else if (sheetArea === GcSpread.Sheets.SheetArea.rowHeader) {
                                sheet.deleteRows(sheet.getActiveRowIndex(), 1);
                            }
                            break;
                        case "Merge":
                            var sel = sheet.getSelections();
                            if (sel.length > 0) {
                                sel = sel[sel.length - 1];
                                sheet.addSpan(sel.row, sel.col, sel.rowCount, sel.colCount, GcSpread.Sheets.SheetArea.viewport);
                            }
                            break;
                        case "UnMerge":
                            var sels = sheet.getSelections();
                            for (var i = 0; i < sels.length; i++) {
                                var sel = getActualCellRange(sels[i], sheet.getRowCount(), sheet.getColumnCount());
                                for (var r = 0; r < sel.rowCount; r++) {
                                    for (var c = 0; c < sel.colCount; c++) {
                                        var span = sheet.getSpan(r + sel.row, c + sel.col, GcSpread.Sheets.SheetArea.viewport);
                                        if (span) {
                                            sheet.removeSpan(span.row, span.col, GcSpread.Sheets.SheetArea.viewport);
                                        }
                                    }
                                }
                            }
                            break;
                        default:
                            break;
                    }
                }
            });

            //excel i/o
            $.support.cors = true;
            $("#importBtn").attr("disabled", true);
            $("#importBtn").addClass("ui-state-disabled");
            $("#serviceUrl").change(function () {
                if ($("#serviceUrl").val() !== '' && $("#import_excel_file").val() !== '') {
                    $("#importBtn").attr("disabled", false);
                    $("#importBtn").removeClass("ui-state-disabled");
                } else {
                    $("#importBtn").attr("disabled", true);
                    $("#importBtn").addClass("ui-state-disabled");
                }
            });
            $("#import_excel_file").change(function () {
                if ($("#serviceUrl").val() !== '' && $("#import_excel_file").val() !== '') {
                    $("#importBtn").attr("disabled", false);
                    $("#importBtn").removeClass("ui-state-disabled");
                } else {
                    $("#importBtn").attr("disabled", true);
                    $("#importBtn").addClass("ui-state-disabled");
                }
            });
        });

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-208280-14']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script>

</head>
<body>
    <ul id="contextMenu">
        <li class="context-clipboard"><a><span class="wijmo-wijmenu-text">Cut</span></a></li>
        <li class="context-clipboard"><a><span class="wijmo-wijmenu-text">Copy</span></a></li>
        <li class="context-clipboard"><a><span class="wijmo-wijmenu-text">Paste</span></a></li>
        <li class="context-header">-</li>
        <li class="context-header context-insert"><a><span class='wijmo-wijmenu-text'>Insert</span></a></li>
        <li class="context-header context-delete"><a><span class='wijmo-wijmenu-text'>Delete</span></a></li>
        <li class="context-cell">-</li>
        <li class="context-cell context-merge"><a><span class='wijmo-wijmenu-text'>Merge</span></a></li>
        <li class="context-cell context-unmerge"><a><span class='wijmo-wijmenu-text'>UnMerge</span></a></li>
    </ul>
    <div id="colordialog" title="Color">
        <table id="colorchart" style="width: 450px; height: 250px; border: 1px solid gray;" onclick="colorSelected(event);"
               cellspacing="0px">
            <tr>
                <td bgcolor="#FBEFEF"></td>
                <td bgcolor="#FBF2EF"></td>
                <td bgcolor="#FBF5EF"></td>
                <td bgcolor="#FBF8EF"></td>
                <td bgcolor="#FBFBEF"></td>
                <td bgcolor="#F8FBEF"></td>
                <td bgcolor="#F5FBEF"></td>
                <td bgcolor="#F2FBEF"></td>
                <td bgcolor="#EFFBEF"></td>
                <td bgcolor="#EFFBF2"></td>
                <td bgcolor="#EFFBF5"></td>
                <td bgcolor="#EFFBF8"></td>
                <td bgcolor="#EFFBFB"></td>
                <td bgcolor="#EFF8FB"></td>
                <td bgcolor="#EFF5FB"></td>
                <td bgcolor="#EFF2FB"></td>
                <td bgcolor="#EFEFFB"></td>
                <td bgcolor="#F2EFFB"></td>
                <td bgcolor="#F5EFFB"></td>
                <td bgcolor="#F8EFFB"></td>
                <td bgcolor="#FBEFFB"></td>
                <td bgcolor="#FBEFF8"></td>
                <td bgcolor="#FBEFF5"></td>
                <td bgcolor="#FBEFF2"></td>
                <td bgcolor="#FFFFFF"></td>
            </tr>
            <tr>
                <td bgcolor="#F8E0E0"></td>
                <td bgcolor="#F8E6E0"></td>
                <td bgcolor="#F8ECE0"></td>
                <td bgcolor="#F7F2E0"></td>
                <td bgcolor="#F7F8E0"></td>
                <td bgcolor="#F1F8E0"></td>
                <td bgcolor="#ECF8E0"></td>
                <td bgcolor="#E6F8E0"></td>
                <td bgcolor="#E0F8E0"></td>
                <td bgcolor="#E0F8E6"></td>
                <td bgcolor="#E0F8EC"></td>
                <td bgcolor="#E0F8F1"></td>
                <td bgcolor="#E0F8F7"></td>
                <td bgcolor="#E0F2F7"></td>
                <td bgcolor="#E0ECF8"></td>
                <td bgcolor="#E0E6F8"></td>
                <td bgcolor="#E0E0F8"></td>
                <td bgcolor="#E6E0F8"></td>
                <td bgcolor="#ECE0F8"></td>
                <td bgcolor="#F2E0F7"></td>
                <td bgcolor="#F8E0F7"></td>
                <td bgcolor="#F8E0F1"></td>
                <td bgcolor="#F8E0EC"></td>
                <td bgcolor="#F8E0E6"></td>
                <td bgcolor="#FAFAFA"></td>
            </tr>
            <tr>
                <td bgcolor="#F6CECE"></td>
                <td bgcolor="#F6D8CE"></td>
                <td bgcolor="#F6E3CE"></td>
                <td bgcolor="#F5ECCE"></td>
                <td bgcolor="#F5F6CE"></td>
                <td bgcolor="#ECF6CE"></td>
                <td bgcolor="#E3F6CE"></td>
                <td bgcolor="#D8F6CE"></td>
                <td bgcolor="#CEF6CE"></td>
                <td bgcolor="#CEF6D8"></td>
                <td bgcolor="#CEF6E3"></td>
                <td bgcolor="#CEF6EC"></td>
                <td bgcolor="#CEF6F5"></td>
                <td bgcolor="#CEECF5"></td>
                <td bgcolor="#CEE3F6"></td>
                <td bgcolor="#CED8F6"></td>
                <td bgcolor="#CECEF6"></td>
                <td bgcolor="#D8CEF6"></td>
                <td bgcolor="#E3CEF6"></td>
                <td bgcolor="#ECCEF5"></td>
                <td bgcolor="#F6CEF5"></td>
                <td bgcolor="#F6CEEC"></td>
                <td bgcolor="#F6CEE3"></td>
                <td bgcolor="#F6CED8"></td>
                <td bgcolor="#F2F2F2"></td>
            </tr>
            <tr>
                <td bgcolor="#F5A9A9"></td>
                <td bgcolor="#F5BCA9"></td>
                <td bgcolor="#F5D0A9"></td>
                <td bgcolor="#F3E2A9"></td>
                <td bgcolor="#F2F5A9"></td>
                <td bgcolor="#E1F5A9"></td>
                <td bgcolor="#D0F5A9"></td>
                <td bgcolor="#BCF5A9"></td>
                <td bgcolor="#A9F5A9"></td>
                <td bgcolor="#A9F5BC"></td>
                <td bgcolor="#A9F5D0"></td>
                <td bgcolor="#A9F5E1"></td>
                <td bgcolor="#A9F5F2"></td>
                <td bgcolor="#A9E2F3"></td>
                <td bgcolor="#A9D0F5"></td>
                <td bgcolor="#A9BCF5"></td>
                <td bgcolor="#A9A9F5"></td>
                <td bgcolor="#BCA9F5"></td>
                <td bgcolor="#D0A9F5"></td>
                <td bgcolor="#E2A9F3"></td>
                <td bgcolor="#F5A9F2"></td>
                <td bgcolor="#F5A9E1"></td>
                <td bgcolor="#F5A9D0"></td>
                <td bgcolor="#F5A9BC"></td>
                <td bgcolor="#E6E6E6"></td>
            </tr>
            <tr>
                <td bgcolor="#F78181"></td>
                <td bgcolor="#F79F81"></td>
                <td bgcolor="#F7BE81"></td>
                <td bgcolor="#F5DA81"></td>
                <td bgcolor="#F3F781"></td>
                <td bgcolor="#D8F781"></td>
                <td bgcolor="#BEF781"></td>
                <td bgcolor="#9FF781"></td>
                <td bgcolor="#81F781"></td>
                <td bgcolor="#81F79F"></td>
                <td bgcolor="#81F7BE"></td>
                <td bgcolor="#81F7D8"></td>
                <td bgcolor="#81F7F3"></td>
                <td bgcolor="#81DAF5"></td>
                <td bgcolor="#81BEF7"></td>
                <td bgcolor="#819FF7"></td>
                <td bgcolor="#8181F7"></td>
                <td bgcolor="#9F81F7"></td>
                <td bgcolor="#BE81F7"></td>
                <td bgcolor="#DA81F5"></td>
                <td bgcolor="#F781F3"></td>
                <td bgcolor="#F781D8"></td>
                <td bgcolor="#F781BE"></td>
                <td bgcolor="#F7819F"></td>
                <td bgcolor="#D8D8D8"></td>
            </tr>
            <tr>
                <td bgcolor="#FA5858"></td>
                <td bgcolor="#FA8258"></td>
                <td bgcolor="#FAAC58"></td>
                <td bgcolor="#F7D358"></td>
                <td bgcolor="#F4FA58"></td>
                <td bgcolor="#D0FA58"></td>
                <td bgcolor="#ACFA58"></td>
                <td bgcolor="#82FA58"></td>
                <td bgcolor="#58FA58"></td>
                <td bgcolor="#58FA82"></td>
                <td bgcolor="#58FAAC"></td>
                <td bgcolor="#58FAD0"></td>
                <td bgcolor="#58FAF4"></td>
                <td bgcolor="#58D3F7"></td>
                <td bgcolor="#58ACFA"></td>
                <td bgcolor="#5882FA"></td>
                <td bgcolor="#5858FA"></td>
                <td bgcolor="#8258FA"></td>
                <td bgcolor="#AC58FA"></td>
                <td bgcolor="#D358F7"></td>
                <td bgcolor="#FA58F4"></td>
                <td bgcolor="#FA58D0"></td>
                <td bgcolor="#FA58AC"></td>
                <td bgcolor="#FA5882"></td>
                <td bgcolor="#BDBDBD"></td>
            </tr>
            <tr>
                <td bgcolor="#FE2E2E"></td>
                <td bgcolor="#FE642E"></td>
                <td bgcolor="#FE9A2E"></td>
                <td bgcolor="#FACC2E"></td>
                <td bgcolor="#F7FE2E"></td>
                <td bgcolor="#C8FE2E"></td>
                <td bgcolor="#9AFE2E"></td>
                <td bgcolor="#64FE2E"></td>
                <td bgcolor="#2EFE2E"></td>
                <td bgcolor="#2EFE64"></td>
                <td bgcolor="#2EFE9A"></td>
                <td bgcolor="#2EFEC8"></td>
                <td bgcolor="#2EFEF7"></td>
                <td bgcolor="#2ECCFA"></td>
                <td bgcolor="#2E9AFE"></td>
                <td bgcolor="#2E64FE"></td>
                <td bgcolor="#2E2EFE"></td>
                <td bgcolor="#642EFE"></td>
                <td bgcolor="#9A2EFE"></td>
                <td bgcolor="#CC2EFA"></td>
                <td bgcolor="#FE2EF7"></td>
                <td bgcolor="#FE2EC8"></td>
                <td bgcolor="#FE2E9A"></td>
                <td bgcolor="#FE2E64"></td>
                <td bgcolor="#A4A4A4"></td>
            </tr>
            <tr>
                <td bgcolor="#FF0000"></td>
                <td bgcolor="#FF4000"></td>
                <td bgcolor="#FF8000"></td>
                <td bgcolor="#FFBF00"></td>
                <td bgcolor="#FFFF00"></td>
                <td bgcolor="#BFFF00"></td>
                <td bgcolor="#80FF00"></td>
                <td bgcolor="#40FF00"></td>
                <td bgcolor="#00FF00"></td>
                <td bgcolor="#00FF40"></td>
                <td bgcolor="#00FF80"></td>
                <td bgcolor="#00FFBF"></td>
                <td bgcolor="#00FFFF"></td>
                <td bgcolor="#00BFFF"></td>
                <td bgcolor="#0080FF"></td>
                <td bgcolor="#0040FF"></td>
                <td bgcolor="#0000FF"></td>
                <td bgcolor="#4000FF"></td>
                <td bgcolor="#8000FF"></td>
                <td bgcolor="#BF00FF"></td>
                <td bgcolor="#FF00FF"></td>
                <td bgcolor="#FF00BF"></td>
                <td bgcolor="#FF0080"></td>
                <td bgcolor="#FF0040"></td>
                <td bgcolor="#848484"></td>
            </tr>
            <tr>
                <td bgcolor="#DF0101"></td>
                <td bgcolor="#DF3A01"></td>
                <td bgcolor="#DF7401"></td>
                <td bgcolor="#DBA901"></td>
                <td bgcolor="#D7DF01"></td>
                <td bgcolor="#A5DF00"></td>
                <td bgcolor="#74DF00"></td>
                <td bgcolor="#3ADF00"></td>
                <td bgcolor="#01DF01"></td>
                <td bgcolor="#01DF3A"></td>
                <td bgcolor="#01DF74"></td>
                <td bgcolor="#01DFA5"></td>
                <td bgcolor="#01DFD7"></td>
                <td bgcolor="#01A9DB"></td>
                <td bgcolor="#0174DF"></td>
                <td bgcolor="#013ADF"></td>
                <td bgcolor="#0101DF"></td>
                <td bgcolor="#3A01DF"></td>
                <td bgcolor="#7401DF"></td>
                <td bgcolor="#A901DB"></td>
                <td bgcolor="#DF01D7"></td>
                <td bgcolor="#DF01A5"></td>
                <td bgcolor="#DF0174"></td>
                <td bgcolor="#DF013A"></td>
                <td bgcolor="#6E6E6E"></td>
            </tr>
            <tr>
                <td bgcolor="#B40404"></td>
                <td bgcolor="#B43104"></td>
                <td bgcolor="#B45F04"></td>
                <td bgcolor="#B18904"></td>
                <td bgcolor="#AEB404"></td>
                <td bgcolor="#86B404"></td>
                <td bgcolor="#5FB404"></td>
                <td bgcolor="#31B404"></td>
                <td bgcolor="#04B404"></td>
                <td bgcolor="#04B431"></td>
                <td bgcolor="#04B45F"></td>
                <td bgcolor="#04B486"></td>
                <td bgcolor="#04B4AE"></td>
                <td bgcolor="#0489B1"></td>
                <td bgcolor="#045FB4"></td>
                <td bgcolor="#0431B4"></td>
                <td bgcolor="#0404B4"></td>
                <td bgcolor="#3104B4"></td>
                <td bgcolor="#5F04B4"></td>
                <td bgcolor="#8904B1"></td>
                <td bgcolor="#B404AE"></td>
                <td bgcolor="#B40486"></td>
                <td bgcolor="#B4045F"></td>
                <td bgcolor="#B40431"></td>
                <td bgcolor="#585858"></td>
            </tr>
            <tr>
                <td bgcolor="#8A0808"></td>
                <td bgcolor="#8A2908"></td>
                <td bgcolor="#8A4B08"></td>
                <td bgcolor="#886A08"></td>
                <td bgcolor="#868A08"></td>
                <td bgcolor="#688A08"></td>
                <td bgcolor="#4B8A08"></td>
                <td bgcolor="#298A08"></td>
                <td bgcolor="#088A08"></td>
                <td bgcolor="#088A29"></td>
                <td bgcolor="#088A4B"></td>
                <td bgcolor="#088A68"></td>
                <td bgcolor="#088A85"></td>
                <td bgcolor="#086A87"></td>
                <td bgcolor="#084B8A"></td>
                <td bgcolor="#08298A"></td>
                <td bgcolor="#08088A"></td>
                <td bgcolor="#29088A"></td>
                <td bgcolor="#4B088A"></td>
                <td bgcolor="#6A0888"></td>
                <td bgcolor="#8A0886"></td>
                <td bgcolor="#8A0868"></td>
                <td bgcolor="#8A084B"></td>
                <td bgcolor="#8A0829"></td>
                <td bgcolor="#424242"></td>
            </tr>
            <tr>
                <td bgcolor="#610B0B"></td>
                <td bgcolor="#61210B"></td>
                <td bgcolor="#61380B"></td>
                <td bgcolor="#5F4C0B"></td>
                <td bgcolor="#5E610B"></td>
                <td bgcolor="#4B610B"></td>
                <td bgcolor="#38610B"></td>
                <td bgcolor="#21610B"></td>
                <td bgcolor="#0B610B"></td>
                <td bgcolor="#0B6121"></td>
                <td bgcolor="#0B6138"></td>
                <td bgcolor="#0B614B"></td>
                <td bgcolor="#0B615E"></td>
                <td bgcolor="#0B4C5F"></td>
                <td bgcolor="#0B3861"></td>
                <td bgcolor="#0B2161"></td>
                <td bgcolor="#0B0B61"></td>
                <td bgcolor="#210B61"></td>
                <td bgcolor="#380B61"></td>
                <td bgcolor="#4C0B5F"></td>
                <td bgcolor="#610B5E"></td>
                <td bgcolor="#610B4B"></td>
                <td bgcolor="#610B38"></td>
                <td bgcolor="#610B21"></td>
                <td bgcolor="#2E2E2E"></td>
            </tr>
            <tr>
                <td bgcolor="#3B0B0B"></td>
                <td bgcolor="#3B170B"></td>
                <td bgcolor="#3B240B"></td>
                <td bgcolor="#3A2F0B"></td>
                <td bgcolor="#393B0B"></td>
                <td bgcolor="#2E3B0B"></td>
                <td bgcolor="#243B0B"></td>
                <td bgcolor="#173B0B"></td>
                <td bgcolor="#0B3B0B"></td>
                <td bgcolor="#0B3B17"></td>
                <td bgcolor="#0B3B24"></td>
                <td bgcolor="#0B3B2E"></td>
                <td bgcolor="#0B3B39"></td>
                <td bgcolor="#0B2F3A"></td>
                <td bgcolor="#0B243B"></td>
                <td bgcolor="#0B173B"></td>
                <td bgcolor="#0B0B3B"></td>
                <td bgcolor="#170B3B"></td>
                <td bgcolor="#240B3B"></td>
                <td bgcolor="#2F0B3A"></td>
                <td bgcolor="#3B0B39"></td>
                <td bgcolor="#3B0B2E"></td>
                <td bgcolor="#3B0B24"></td>
                <td bgcolor="#3B0B17"></td>
                <td bgcolor="#1C1C1C"></td>
            </tr>
            <tr>
                <td bgcolor="#2A0A0A"></td>
                <td bgcolor="#2A120A"></td>
                <td bgcolor="#2A1B0A"></td>
                <td bgcolor="#29220A"></td>
                <td bgcolor="#292A0A"></td>
                <td bgcolor="#222A0A"></td>
                <td bgcolor="#1B2A0A"></td>
                <td bgcolor="#122A0A"></td>
                <td bgcolor="#0A2A0A"></td>
                <td bgcolor="#0A2A12"></td>
                <td bgcolor="#0A2A1B"></td>
                <td bgcolor="#0A2A22"></td>
                <td bgcolor="#0A2A29"></td>
                <td bgcolor="#0A2229"></td>
                <td bgcolor="#0A1B2A"></td>
                <td bgcolor="#0A122A"></td>
                <td bgcolor="#0A0A2A"></td>
                <td bgcolor="#120A2A"></td>
                <td bgcolor="#1B0A2A"></td>
                <td bgcolor="#220A29"></td>
                <td bgcolor="#2A0A29"></td>
                <td bgcolor="#2A0A22"></td>
                <td bgcolor="#2A0A1B"></td>
                <td bgcolor="#2A0A12"></td>
                <td bgcolor="#151515"></td>
            </tr>
            <tr>
                <td bgcolor="#190707"></td>
                <td bgcolor="#190B07"></td>
                <td bgcolor="#191007"></td>
                <td bgcolor="#181407"></td>
                <td bgcolor="#181907"></td>
                <td bgcolor="#141907"></td>
                <td bgcolor="#101907"></td>
                <td bgcolor="#0B1907"></td>
                <td bgcolor="#071907"></td>
                <td bgcolor="#07190B"></td>
                <td bgcolor="#071910"></td>
                <td bgcolor="#071914"></td>
                <td bgcolor="#071918"></td>
                <td bgcolor="#071418"></td>
                <td bgcolor="#071019"></td>
                <td bgcolor="#070B19"></td>
                <td bgcolor="#070719"></td>
                <td bgcolor="#0B0719"></td>
                <td bgcolor="#100719"></td>
                <td bgcolor="#140718"></td>
                <td bgcolor="#190718"></td>
                <td bgcolor="#190714"></td>
                <td bgcolor="#190710"></td>
                <td bgcolor="#19070B"></td>
                <td bgcolor="#000000"></td>
            </tr>
        </table>
        <br />
        Selected Color:
        <input id="selectedColor" type="text" style="width: 100px; margin:0 4px;" title="Provide color in #RRGGBB format" placeholder="#RRGGBB" />
        <input id="colorSample" type="text" disabled="disabled" style="border:1px solid gray;" />
    </div>
    <div id="borderdialog" title="Border">
        <div style="margin-left: 10px; margin-top: 10px;">
            <div class="dialogGroup">
                <span>
                    <label for="lineStyle" title="Line Style:">Line Style:</label>
                    <select id="lineStyle" style="margin: 0 4px;">
                        <option selected="selected" value="empty">Empty</option>
                        <option value="thin">Thin</option>
                        <option value="medium">Medium</option>
                        <option value="dashed">Dashed</option>
                        <option value="dotted">Dotted</option>
                        <option value="thick">Thick</option>
                        <option value="double">Double</option>
                        <option value="hair">Hair</option>
                        <option value="mediumDashed">MediumDashed</option>
                        <option value="dashDot">DashDot</option>
                        <option value="mediumDashDot">MediumDashDot</option>
                        <option value="dashDotDot">DashDotDot</option>
                        <option value="mediumDashDotDot">MediumDashDotDot</option>
                        <option value="slantedDashDot">SlantedDashDot</option>
                    </select>
                </span>
                <span>
                    <label for="lineColor" title="Line Color">Line Color:</label>
                    <select selected="selected" id="lineColor" style="margin: 0 4px;">
                        <option style="background-color: Black; color: White">Black</option>
                        <option style="background-color: White;">White</option>
                        <option style="background-color: Red;">Red</option>
                        <option style="background-color: Blue;">Blue</option>
                        <option style="background-color: Maroon;">Maroon</option>
                        <option style="background-color: Green;">Green</option>
                        <option style="background-color: Olive;">Olive</option>
                        <option style="background-color: Navy;">Navy</option>
                        <option style="background-color: Purple;">Purple</option>
                        <option style="background-color: Teal;">Teal</option>
                        <option style="background-color: Silver;">Silver</option>
                        <option style="background-color: Gray;">Gray</option>
                        <option style="background-color: Red;">Red</option>
                        <option style="background-color: Lime;">Lime</option>
                        <option style="background-color: Yellow;">Yellow</option>
                        <option style="background-color: Blue;">Blue</option>
                        <option style="background-color: Magenta;">Magenta</option>
                        <option style="background-color: Cyan;">Cyan</option>
                    </select>
                </span>
            </div>
            <div>
                <input type="button" id="noborder" value="None" onclick="noborderclick()"
                       style="width: 100px; height: 30px; margin: 10px" />
                <input type="button" id="Button1" value="Outline" onclick="outlineborderclick()"
                       style="width: 100px; height: 30px; margin: 10px" />
                <input type="button" id="allborder" value="All" onclick="allborderclick()"
                       style="width: 100px; height: 30px; margin: 10px" />
            </div>
            <div class="dialogGroup">
                <table style="width: 300px; height: 20px;">
                    <tr>
                        <td>
                            <input type="checkbox" id="topSide" /><label for="topSide">Top Side</label>
                        </td>
                        <td></td>
                        <td></td>
                        <td rowspan="3" colspan="3">
                            <table id="bordertable" cellspacing="0" style="width: 150px; height: 150px;">
                                <tr>
                                    <td id="border11" style="text-align: center">Text</td>
                                    <td id="border12" style="text-align: center">Text</td>
                                </tr>
                                <tr>
                                    <td id="border21" style="text-align: center">Text</td>
                                    <td id="border22" style="text-align: center">Text</td>
                                </tr>
                            </table>
                        </td>
                    </tr>
                    <tr></tr>
                    <tr>
                        <td>
                            <input type="checkbox" id="hInside" /><label for="hInside">Horizontal</label>
                        </td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                    <tr>
                        <td>
                            <input type="checkbox" id="bottomSide" /><label for="bottomSide">Bottom Side</label>
                        </td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                </table>
                <div style="margin-left: 80px; margin-top: 5px">
                    <input type="checkbox" id="leftSide" title="Left Side" /><label for="leftSide">Left Side</label>
                    <input type="checkbox" id="vInside" style="margin-left: 15px" /><label for="vInside">Vertical</label>
                    <input type="checkbox" id="rightSide" style="margin-left: 15px" /><label for="rightSide">Right Side</label>

                </div>
            </div>
        </div>
    </div>
    <div id="datavalidationdialog" title="Data Validation">
        <ul>
            <li><a href="#tabValidationSettings">Settings</a></li>
            <li><a href="#tabValidationInputMessage" id="validationInputMessge">Input Message</a></li>
            <li><a href="#tabValidationErrorAlert" id="validationErrorAlert">Error Alert</a></li>
        </ul>
        <div id="tabValidationSettings" style="background: #F0F0F0; border:0">
            <div style="margin-top: 20px; margin-left: 20px;">
                <div>
                    <span>Validation criteria</span>
                </div>
                <div style="margin-top: 10px">
                    <span>Allow:</span>
                </div>
                <div style="margin-top: 10px">
                    <select id="validatorTypes">
                        <option value="AnyValidator" selected>Any value</option>
                        <option value="NumberValidator">Number</option>
                        <option value="ListValidator">List</option>
                        <option value="FormulaListValidator">FormulaList</option>
                        <option value="DateValidator">Date</option>
                        <option value="TextLengthValidator">Text length</option>
                        <option value="FormulaValidator">Custom</option>
                    </select>
                    <input id="chkValidatorIgnoreBlank" type="checkbox" style="margin-top: 10px" /><label for="chkValidatorIgnoreBlank" class="wijmo-wijribbon-checkbox">IgnoreBlank</label>
                </div>
                <div style="margin-top: 10px; display:none" id="datatitle">
                    <span>Data:</span>
                </div>
                <div id="validatorTab1" style="margin-top: 10px">
                    <select id="validatorComparisonOperator">
                        <option value="6" selected>Between</option>
                        <option value="7">NotBetween</option>
                        <option value="0">EqualTo</option>
                        <option value="1">NotEqualTo</option>
                        <option value="2">GreaterThan</option>
                        <option value="4">LessThan</option>
                        <option value="3">GreaterThanOrEqualTo</option>
                        <option value="5">LessThanOrEqualTo</option>
                    </select>

                    <div style="margin-top: 10px">
                        <span id="rangeStart"></span>
                        <input id="txtValidatorValue1" placeholder="Value1" style="position: absolute;left: 90px;">
                    </div>
                    <div style="margin-top: 10px">
                        <span id="rangeEnd"></span>
                        <input id="txtValidatorValue2" placeholder="Value2" style="position: absolute;left: 90px;">
                    </div>
                    <div id="isTimeTab" style="margin-top: 10px">
                        <input id="chkIsTime" type="checkbox" /><label for="chkIsTime" class="wijmo-wijribbon-checkbox">
                            Is
                            Time
                        </label>
                    </div>
                    <div id="isIntTab" style="margin-top: 10px">
                        <input id="chkIsInteger" type="checkbox" /><label for="chkIsInteger" class="wijmo-wijribbon-checkbox">
                            Is
                            Integer
                        </label>
                    </div>
                </div>
                <div id="validatorTab2" style="margin-top: 10px">
                    <span id="rangevalidator"></span>
                    <input id="txtValidatorValue" placeholder="Value1">
                    <span id="prompt"></span>
                </div>
            </div>
        </div>
        <div id="tabValidationInputMessage"  style="background: #F0F0F0; border:0">
            <div style="margin-left: 20px; margin-top: 20px;">
                <div>
                    <input id="chkShowMessage" type="checkbox" /><label for="chkShowMessage" class="wijmo-wijribbon-checkbox"
                                                                        id="chkShowMessageLabel">
                        Show input message when cell
                        is selected.
                    </label>
                </div>
                <div style="margin-top: 10px; margin-left: 10px">
                    <span>When cell is selected,show this input message:</span>
                </div>
                <div style="margin-top: 20px; margin-left: 10px">
                    <div>Title:</div>
                    <input id="txtMessageTitle" placeholder="MessageTitle" style="width:88%" />
                </div>
                <div style="margin-top: 20px; margin-left: 10px">
                    <div>Message:</div>
                    <textarea rows="5" id="txtMessageMessage" placeholder="Message" style="width:88%"></textarea>
                </div>
            </div>
        </div>
        <div id="tabValidationErrorAlert" style="background: #F0F0F0; border:0">
            <div style="margin-left: 20px; margin-top: 20px;">
                <div>
                    <input id="chkShowError" type="checkbox" />
                    <label for="chkShowError" class="wijmo-wijribbon-checkbox" id="chkShowErrorLabel">show error alert after invalid data is entered</label>
                </div>
                <div style="margin-top: 10px; margin-left: 10px">
                    <span>When the user enters invalid data,show this error alert:</span>
                </div>
                <div style="margin-left: 10px; margin-top: 10px">
                    <select id="validatorErrorStyles">
                        <option value="0" selected>Stop</option>
                        <option value="1">Warning</option>
                        <option value="2">Information</option>
                    </select>
                </div>
                <div style="margin-top: 10px; margin-left: 10px">
                    <div>Title:</div>
                    <input id="txtErrorTitle" placeholder="ErrorTitle" style="width:88%" />
                </div>
                <div style="margin-top: 10px; margin-left: 10px">
                    <div>Message:</div>
                    <textarea rows="5" id="txtErrorMessage" placeholder="ErrorMessage" style="width:88%" ></textarea>
                </div>
            </div>
        </div>
    </div>
    <div id="conditionalformatdialog" title="Formatting Rule">
        <div style="margin-left: 5px; margin-top: 3px;">
            <div style="margin-left: 5px; margin-top: 10px">
                <span id="ruletext" style="font-weight:bold">Format only cells with:</span>
            </div>
            <div style="margin-left: 5px; margin-top: 10px">
                <span id="colorScaleStyle" style="width: 40px; display: none; display: -moz-inline-box;">Style:</span>
                <select id="Rule1">
                    <option value="0" selected>Cell Value</option>
                    <option value="1">Specific Text</option>
                    <option value="2">Dates Occurring</option>
                    <option value="3">Formula</option>
                    <option value="4">Top10</option>
                    <option value="5">Unique</option>
                    <option value="6">Duplicate</option>
                    <option value="7">Average</option>
                    <option value="8">2-Color Scale</option>
                    <option value="9">3-Color Scale</option>
                </select>
                <select id="ComparisonOperator1" style="margin-left: 3px">
                    <option value='0' selected>EqualsTo</option>
                    <option value='1'>NotEqualsTo</option>
                    <option value='2'>GreaterThan</option>
                    <option value='3'>GreaterThanOrEqualsTo</option>
                    <option value='4'>LessThan</option>
                    <option value='5'>LessThanOrEqualsTo</option>
                    <option value='6'>Between</option>
                    <option value='7'>NotBetween</option>
                </select>
                <input type="input" id="value1" style="width: 60px; margin-left: 3px">
                <span id="andtext" style="display: none; margin-left: 3px">and</span>
                <input type="input" id="value2" style="width: 60px; margin-left: 3px; display: none">
                <span id="formattext" style="display: none; margin-left: 5px"></span>
            </div>
            <div id="colorScale" style="display: none; margin-left: 5px; margin-top: 16px;">
                <div style="margin-left: 40px">
                    <span>Minimum</span>
                    <span id="midpoint" style="margin-left: 65px">Midpoint</span>
                    <span style="margin-left: 65px">Maximum</span>
                </div>
                <div style="margin-top: 10px">
                    <span style="width: 30px; display: inline-block; display: -moz-inline-box;">Type:</span>
                    <select id="minType" style="margin-left: 10px; width: 100px;">
                        <option value="0">Number</option>
                        <option value="1" selected>LowestValue</option>
                        <option value="3">Percent</option>
                        <option value="4">Percentile</option>
                        <option value="6">Formula</option>
                    </select>
                    <select id="midType" style="margin-left: 10px; width: 100px;">
                        <option value="0">Number</option>
                        <option value="3">Percent</option>
                        <option value="4" selected>Percentile</option>
                        <option value="6">Formula</option>
                    </select>
                    <select id="maxType" style="margin-left: 10px; width: 100px;">
                        <option value="0">Number</option>
                        <option value="2" selected>HighestValue</option>
                        <option value="3">Percent</option>
                        <option value="4">Percentile</option>
                        <option value="6">Formula</option>
                    </select>
                </div>
                <div style="margin-top: 10px">
                    <span style="width: 30px; display: inline-block; display: -moz-inline-box;">Value:</span>
                    <input id="minValue" type="text" value="" style="margin-left: 10px; width: 96px;" />
                    <input id="midValue" type="text" value="50" style="margin-left: 10px; width: 96px;" />
                    <input id="maxValue" type="text" value="" style="margin-left: 10px; width: 96px;" />
                </div>
                <div style="margin-top: 10px">
                    <span style="width: 30px; display: inline-block; display: -moz-inline-box;">Color:</span>
                    <input type="button" id="minColor" value="" style="margin-left: 10px; width: 100px; background: #F8696B" title="minColor" onclick="setColor(event, 'Min Color')" />
                    <input type="button" id="midColor" value="" style="margin-left: 10px; width: 100px; background: #FFEB84" title="midColor" onclick="setColor(event, 'Mid Color')" />
                    <input type="button" id="maxColor" value="" style="margin-left: 10px; width: 100px; background: #63BE7B" title="maxColor" onclick="setColor(event, 'Max Color')" />
                </div>
            </div>
        </div>
    </div>
    <div id="databardialog" title="Data Bars">
        <div style="margin-top: 4px; margin-right: 5px; border:1px solid gray; padding: 8px">
            <div>
                <b>Value</b>
            </div>
            <div style="height:16px">
                <div style="width: 100px; position:absolute; left:70px; text-align:center">Minimum</div>
                <div style="width: 100px; position:absolute; left:220px; text-align:center">Maximum</div>
            </div>
            <div style="margin-top: 8px">
                <span>Type:</span>
                <select id="minimumType" style="width: 100px; position:absolute; left:70px; height: 22px">
                    <option value="0">Number</option>
                    <option value="1">LowestValue</option>
                    <option value="3">Percent</option>
                    <option value="4">Percentile</option>
                    <option value="5" selected="selected">Automin</option>
                    <option value="6">Formula</option>
                </select>

                <select id="maximumType" style="width: 100px; position:absolute; left:220px; height: 22px">
                    <option value="0">Number</option>
                    <option value="2">HighestValue</option>
                    <option value="3">Percent</option>
                    <option value="4">Percentile</option>
                    <option value="6">Formula</option>
                    <option value="7" selected="selected">Automax</option>
                </select>
            </div>
            <div style="margin-top: 16px;">
                <span >Values:</span>
                <input id="minimumValue" type="text" style="width: 96px; position:absolute; left:70px;" placeholder="minimumValue">

                <input id="maximumValue" type="text" style="width: 96px; position:absolute; left:220px;" placeholder="maximumValue">
            </div>

            <div style="margin-top: 18px">
                <b>Appearance</b>
            </div>
            <div style="margin-top: 8px;">
                <input type="checkbox" id="showBarOnly" />
                <label for="showBarOnly">Show Bar Only</label>
            </div>
            <div style="margin-top: 8px;">
                <input type="checkbox" id="gradient" />
                <label for="gradient" style="width: 160px; display: inline-block; display: -moz-inline-box;">Gradient</label>
                <span style="width: 80px; display: inline-block; display: -moz-inline-box;">Color:</span>
                <input type="button" id="color" value="" title="barcolor" style="width:80px; background:#638EC6" onclick="setColor(event, 'Bar Color')" />
            </div>
            <div style="margin-top: 8px;">
                <input type="checkbox" id="showBorder" />
                <label for="showBorder" style="width: 160px; display: inline-block; display: -moz-inline-box;">Show Border</label>
                <span style="width: 80px; display: inline-block; display: -moz-inline-box;">Border Color:</span>
                <input type="button" id="borderColor" value="" title="barbordercolor" style="width:80px; background:#000000" onclick="setColor(event, 'Bar Border Color')" />
            </div>
            <div style="margin-top: 10px;">
                <span class="dialogLabel">Bar Direction:</span>
                <select id="dataBarDirection" style="height: 22px">
                    <option value="0" selected="selected">Left-to-Right</option>
                    <option value="1">Right-to-Left</option>
                </select>
            </div>
            <div style="margin-top: 8px;">
                <input type="checkbox" id="useNegativeFillColor" />
                <label for="useNegativeFillColor" style="width: 160px; display: inline-block; display: -moz-inline-box;">Use Negative Fill Color</label>
                <span style="width: 130px; display: inline-block; display: -moz-inline-box;">Negative Fill Color:</span>
                <input type="button" id="negativeFillColor" value="" title="barnegativefillcolor" style="width:50px; background:#FF0000" onclick="setColor(event, 'Bar Negative Fill Color')" />
            </div>
            <div style="margin-top: 8px;">
                <input type="checkbox" id="useNegativeBorderColor" />
                <label for="useNegativeBorderColor" style="width: 160px; display: inline-block; display: -moz-inline-box;">Use Negative Border Color</label>
                <span style="width: 130px; display: inline-block; display: -moz-inline-box;">Negative Border Color:</span>
                <input type="button" id="negativeBorderColor" value="" title="barnegativebordercolor" style="width:50px; background:#000000" onclick="setColor(event, 'Bar Negative Border Color')" />
            </div>
            <div style="margin-top: 8px;">
                <span class="dialogLabel">Axis Position:</span>
                <select id="axisPosition" style="height: 22px;">
                    <option value="0" selected="selected">Automatic</option>
                    <option value="1">CellMidPoint</option>
                    <option value="2">None</option>
                </select>
                <span style="margin-left: 4px; width: 130px; display: inline-block; display: -moz-inline-box;">Axis Color:</span>
                <input type="button" id="axisColor" value="" title="baraxiscolor" style="width:50px; background:#000000" onclick="setColor(event, 'Bar Axis Color')" />
            </div>
        </div>
    </div>
    <div id="iconsetdialog" title="Icon Sets">
        <div style="margin-left: 20px; margin-top: 20px; font-size: 12px">
            <div style="margin-top: 10px">
                <span>Icon Style:</span>
                <select id="iconSetType" style="margin-left: 40px">
                    <option value="0" selected="selected">ThreeArrowsColored</option>
                    <option value="1">ThreeArrowsGray</option>
                    <option value="2">ThreeTriangles</option>
                    <option value="3">ThreeStars</option>
                    <option value="4">ThreeFlags</option>
                    <option value="5">ThreeTrafficLightsUnrimmed</option>
                    <option value="6">ThreeTrafficLightsRimmed</option>
                    <option value="7">ThreeSigns</option>
                    <option value="8">ThreeSymbolsCircled</option>
                    <option value="9">ThreeSymbolsUncircled</option>
                    <option value="10">FourArrowsColored</option>
                    <option value="11">FourArrowsGray</option>
                    <option value="12">FourRedToBlack</option>
                    <option value="13">FourRatings</option>
                    <option value="14">FourTrafficLights</option>
                    <option value="15">FiveArrowsColored</option>
                    <option value="16">FiveArrowsGray</option>
                    <option value="17">FiveRatings</option>
                    <option value="18">FiveQuarters</option>
                    <option value="19">FiveBoxes</option>
                </select>
            </div>
            <div style="margin-top: 10px">
                <input type="checkbox" id="showIconOnly" />
                <label for="showIconOnly">Show Icon Only</label>
                <input type="checkbox" id="reverseIconOrder" style="margin-left: 40px" />
                <label for="reverseIconOrder">Reverse Icon Order</label>
            </div>
            
            <div style="margin-top: 20px;">
                <span>Display each icon according to these rules:</span>
            </div>
            <div id="iconCriteriaSetting" style="margin-top: 10px">
            </div>
        </div>
    </div>
    <div id="celltypedialog" title="Cell Type">
        <div style="margin-left: 10px; margin-top: 10px; font-size: 12px">
            <div id="comboCellOptions">
                <div>
                    <span style="width: 100px; display: inline-block; display: -moz-inline-box;">EditorValueType: </span>
                    <select id="selComboCellEditorValueType">
                        <option value="0" selected="selected">Text</option>
                        <option value="1">Index</option>
                        <option value="2">Value</option>
                    </select>
                </div>
                <div style="margin-top: 10px">
                    <span style="width: 100px; display: inline-block; display: -moz-inline-box;">Items Text:</span>
                    <input id="txtComboCellItemsText" placeholder="(eg:123,456,789)" />
                </div>
                <div style="margin-top: 10px">
                    <span style="width: 100px; display: inline-block; display: -moz-inline-box;">Items Value:</span>
                    <input id="txtComboCellItemsValue" placeholder="(eg:abc,def,ghi)" />
                </div>
            </div>
            <div id="checkBoxCellOptions">
                <div>
                    <span style="width: 100px; display: inline-block; display: -moz-inline-box;">caption:</span>
                    <input type="text" id="txtCheckBoxCellTextCaption" />
                </div>
                <div style="margin-top: 10px">
                    <span style="width: 100px; display: inline-block; display: -moz-inline-box;">textTrue:</span>
                    <input type="text" id="txtCheckBoxCellTextTrue" value="" />
                </div>
                <div style="margin-top: 10px">
                    <span style="width: 100px; display: inline-block; display: -moz-inline-box;">textIndeterminate:</span>
                    <input type="text" id="txtCheckBoxCellTextIndeterminate" value="" />
                </div>
                <div style="margin-top: 10px">
                    <span style="width: 100px; display: inline-block; display: -moz-inline-box;">textFalse:</span>
                    <input type="text" id="txtCheckBoxCellTextFalse" value="" />
                </div>
                <div style="margin-top: 10px">
                    <span style="width: 100px; display: inline-block; display: -moz-inline-box;">textAlign:</span>
                    <select id="selCheckBoxCellAlign">
                        <option value="0" selected="selected">top</option>
                        <option value="1">bottom</option>
                        <option value="2">left</option>
                        <option value="3">right</option>
                    </select>
                </div>
                <div style="margin-top: 10px">
                    <input type="checkbox" id="ckbCheckBoxCellIsThreeState" />
                    <label for="ckbCheckBoxCellIsThreeState">isThreeState</label>
                </div>
            </div>
            <div id="buttonCellOptions">
                <div>
                    <span style="width: 100px; display: inline-block; display: -moz-inline-box;">margin-left:</span>
                    <input type="text" id="txtButtonCellMarginLeft" style="margin-left: 10px;width: 143px;" />
                </div>
                <div style="margin-top: 10px">
                    <span style="width: 100px; display: inline-block; display: -moz-inline-box;">margin-top:</span>
                    <input type="text" id="txtButtonCellMarginTop" style="margin-left: 10px;width: 143px;" />
                </div>
                <div style="margin-top: 10px">
                    <span style="width: 100px; display: inline-block; display: -moz-inline-box;">margin-right:</span>
                    <input type="text" id="txtButtonCellMarginRight" style="margin-left: 10px;width: 143px;" />
                </div>
                <div style="margin-top: 10px">
                    <span style="width: 100px; display: inline-block; display: -moz-inline-box;">margin-bottom:</span>
                    <input type="text" id="txtButtonCellMarginBottom" style="margin-left: 10px;width: 143px;" />
                </div>
                <div style="margin-top: 10px">
                    <span style="width: 100px; display: inline-block; display: -moz-inline-box;">text:</span>
                    <input type="text" id="txtButtonCellText" value="" style="margin-left: 10px;width: 143px;" />
                </div>
                <div style="margin-top: 10px">
                    <span style="width: 100px; display: inline-block; display: -moz-inline-box;">backColor:</span>
                    <input type="button" id="txtButtonCellBackColor" style="margin-left: 10px; width: 147px; background: #707070;" onclick="setColor(event, 'Button Back Color')"/>
                </div>
            </div>
            <div id="hyperlinkCellOptions">
                <div style="margin-top: 10px">
                    <span style="width: 100px; display: inline-block; display: -moz-inline-box;">linkColor:</span>
                    <input type="button" id="txtHyperLinkCellLinkColor" style="margin-left: 10px;width: 147px; background: #0066CC" onclick="setColor(event, 'Link Color')"/>
                </div>
                <div style="margin-top: 10px">
                    <span style="width: 100px; display: inline-block; display: -moz-inline-box;">visitedLinkColor:</span>
                    <input type="text" id="txtHyperLinkCellVisitedLinkColor" style="margin-left: 10px;width: 147px; background: #3399ff" onclick="setColor(event, 'Visited Link Color')"/>
                </div>
                <div style="margin-top: 10px">
                    <span style="width: 100px; display: inline-block; display: -moz-inline-box;">text:</span>
                    <input type="text" id="txtHyperLinkCellText" style="margin-left: 10px;width: 143px;" />
                </div>
                <div style="margin-top: 10px">
                    <span style="width: 100px; display: inline-block; display: -moz-inline-box;">linkToolTip:</span>
                    <input type="text" id="txtHyperLinkCellToolTip" style="margin-left: 10px;width: 143px;" />
                </div>
            </div>
        </div>
    </div>
    <div id="freezesettingdialog" title="Freeze Setting">
        <div style="margin-left: 10px; margin-top: 10px; font-size: 12px">
            <div id="Div1">
                <div style="margin-top: 10px">
                    <span style="width: 160px; display: inline-block; display: -moz-inline-box;">FrozenColumnCount:</span>
                    <input id="frozenColumnCount" />
                </div>
                <div style="margin-top: 10px">
                    <span style="width: 160px; display: inline-block; display: -moz-inline-box;">FrozenRowCount:</span>
                    <input id="frozenRowCount" />
                </div>
                <div style="margin-top: 10px">
                    <span style="width: 160px; display: inline-block; display: -moz-inline-box;">FrozenTrailingColumnCount:</span>
                    <input id="frozenTrailingColumnCount" />
                </div>
                <div style="margin-top: 10px">
                    <span style="width: 160px; display: inline-block; display: -moz-inline-box;">FrozenTrailingRowCount:</span>
                    <input id="frozenTrailingRowCount" />
                </div>
            </div>
        </div>
    </div>
    <div id="tabledialog" title="Table">
        <div style="margin-left: 10px; margin-top: 10px; font-size: 12px">
            <div>
                <span>Table Style Options:</span>
            </div>
            <div style="margin-top: 10px">
                <input type="checkbox" id="showHeader" />
                <label for="showHeader">Header Row</label>
                <input type="checkbox" id="highlightFirstColumn" style="margin-left:30px" />
                <label for="highlightFirstColumn">First Column</label>
            </div>
            <div style="margin-top: 10px">
                <input type="checkbox" id="showFooter" />
                <label for="showFooter">Total Row</label>
                <input type="checkbox" id="highlightLastColumn" style="margin-left:42px" />
                <label for="highlightLastColumn">Last Column</label>
            </div>
            <div style="margin-top: 10px">
                <input type="checkbox" id="bandRows" />
                <label for="bandRows">Banded Row</label>
                <input type="checkbox" id="bandColumns" style="margin-left:29px" />
                <label for="bandColumns">Banded Column</label>
            </div>
            <div style="margin-top: 20px">
                <label for="tableStyles">Table Styles:</label>
                <select id="tableStyles" style="margin-left: 54px;width:104px;">
                    <option value="Light1">Light1</option>
                    <option value="Light2">Light2</option>
                    <option value="Light3">Light3</option>
                    <option value="Light4">Light4</option>
                    <option value="Light5">Light5</option>
                    <option value="Light6">Light6</option>
                    <option value="Light7">Light7</option>
                    <option value="Light8">Light8</option>
                    <option value="Light9">Light9</option>
                    <option value="Light10">Light10</option>
                    <option value="Light11">Light11</option>
                    <option value="Light12">Light12</option>
                    <option value="Light13">Light13</option>
                    <option value="Light14">Light14</option>
                    <option value="Light15">Light15</option>
                    <option value="Light16">Light16</option>
                    <option value="Light17">Light17</option>
                    <option value="Light18">Light18</option>
                    <option value="Light19">Light19</option>
                    <option value="Light20">Light20</option>
                    <option value="Light21">Light21</option>

                    <option value="Medium1">Medium1</option>
                    <option value="Medium2" selected='selected'>Medium2</option>
                    <option value="Medium3<">Medium3</option>
                    <option value="Medium4<">Medium4</option>
                    <option value="Medium5<">Medium5</option>
                    <option value="Medium6<">Medium6</option>
                    <option value="Medium7<">Medium7</option>
                    <option value="Medium8<">Medium8</option>
                    <option value="Medium9<">Medium9</option>
                    <option value="Medium10">Medium10</option>
                    <option value="Medium11">Medium11</option>
                    <option value="Medium12">Medium12</option>
                    <option value="Medium13">Medium13</option>
                    <option value="Medium14">Medium14</option>
                    <option value="Medium15">Medium15</option>
                    <option value="Medium16">Medium16</option>
                    <option value="Medium17">Medium17</option>
                    <option value="Medium18">Medium18</option>
                    <option value="Medium19">Medium19</option>
                    <option value="Medium20">Medium20</option>
                    <option value="Medium21">Medium21</option>
                    <option value="Medium22">Medium22</option>
                    <option value="Medium23">Medium23</option>
                    <option value="Medium24">Medium24</option>
                    <option value="Medium25">Medium25</option>
                    <option value="Medium26">Medium26</option>
                    <option value="Medium27">Medium27</option>
                    <option value="Medium28">Medium28</option>

                    <option value="Dark1">Dark1</option>
                    <option value="Dark2">Dark2</option>
                    <option value="Dark3">Dark3</option>
                    <option value="Dark4">Dark4</option>
                    <option value="Dark5">Dark5</option>
                    <option value="Dark6">Dark6</option>
                    <option value="Dark7">Dark7</option>
                    <option value="Dark8">Dark8</option>
                    <option value="Dark9">Dark9</option>
                    <option value="Dark10">Dark10</option>
                    <option value="Dark11">Dark11</option>
                </select>
            </div>
            <div style="margin-top: 10px">
                <label for="tableName">Table Name:</label>
                <input type="text" id="tableName" style="margin-left: 53px;width: 100px" />
                <label id="ckName"></label>
            </div>
        </div>
    </div>
    <div id="picturedialog" title="Picture">
        <div style="margin-left: 10px; margin-top: 10px; font-size: 12px">
            <div id="pictureAddOptions">
                <div>
                    <span>Picture Options:</span>
                </div>
                <div style="margin-top: 10px">
                    <span>Image:</span>
                    <input type="file" name="image" id="file_input" />
                </div>
            </div>
            <div id="pictureSettingsOptions">
                <div>
                    <span>Picture Options:</span>
                </div>
                <div style="margin-top: 10px">
                    <span>Image:</span>
                    <input type="file" name="image" id="file_input1" />
                </div>
                <div style="margin-top: 10px">
                    <input type="checkbox" id="dynamicSize" />
                    <label for="dynamicSize">DynamicSize</label>
                    <input type="checkbox" id="dynamicMove" style="margin-left:80px" />
                    <label for="dynamicMove">DynamicMove</label>
                </div>
                <div style="margin-top: 10px">
                    <span class="dialogLabel">BackColor:</span>
                    <input type="button" id="pictureBackColor" value="" title="pictureBackColor" style="width:74px; margin-left:4px;" onclick="setColor(event, 'Picture Back Color')" />
                    <span style="margin-left: 25px;width: 71px; display: inline-block; display: -moz-inline-box;">BorderColor:</span>
                    <input type="button" id="pictureBorderColor" value="" title="pictureBorderColor" style="width:74px" onclick="setColor(event, 'Picture Border Color')" />
                </div>
                <div style="margin-top: 10px">
                    <label for="pictureBorderWidth">Border Width:</label>
                    <input type="text" id="pictureBorderWidth" style="margin-left: 10px;width: 70px" />
                    <label for="pictureBorderRadius" style="margin-left: 10px">Border Radius:</label>
                    <input type="text" id="pictureBorderRadius" style="margin-left: 10px;width: 70px" />
                </div>
                <div style="margin-top: 10px">
                    <label for="pictureBorderStyle" style="width: 70px">Border Style:</label>
                    <select id="pictureBorderStyle" style="margin-left: 17px; width:74px">
                        <option value="solid" selected="selected">solid</option>
                        <option value="dotted">dotted</option>
                        <option value="dashed">dashed</option>
                        <option value="double">double</option>
                        <option value="groove">groove</option>
                        <option value="ridge">ridge</option>
                        <option value="inset">inset</option>
                        <option value="outset">outset</option>
                    </select>
                </div>
                <div style="margin-top: 10px">
                    <label for="pictureStretch" style="width: 70px">Picture strecth:</label>
                    <select id="pictureStretch" style="margin-left: 5px; width:74px">
                        <option value="0" selected="selected">Stretch</option>
                        <option value="1">Center</option>
                        <option value="2">Zoom</option>
                        <option value="3">None</option>
                    </select>
                </div>
            </div>
        </div>
    </div>
    <div id="commentdialog" title="Comment">
        <div style="margin-left: 10px; margin-top: 10px; font-size: 12px">
            <div id="commentAddOptions">
                <div>
                    <span>Comment Options:</span>
                </div>
                <div style="margin-top: 10px">
                    <label for="txtText" style="width: 50px; display: inline-block; display: -moz-inline-box;">Text:</label>
                    <input id="txtText" type="text" style="width:100px" />
                    <label for="txtLocation" style="width: 60px; display: inline-block; display: -moz-inline-box;margin-left:20px;">Location:</label>
                    <input id="txtLocation" type="text" style="width:100px" placeholder="9,-18" />
                </div>
                <div style="margin-top: 10px">
                    <label for="txtWidth" style="width: 50px; display: inline-block; display: -moz-inline-box;">Width:</label>
                    <input id="txtWidth" type="text" style="width:100px" />
                    <label for="txtHeight" style="width: 60px; display: inline-block; display: -moz-inline-box;margin-left:20px;">Height:</label>
                    <input id="txtHeight" type="text" style="width:100px" />
                </div>
            </div>
            <div id="commentSettingsOptions">
                <div>
                    <span>Comment Options:</span>
                </div>
                <div style="margin-top: 10px">
                    <label for="txtFontFamily" class="dialogLabel">FontFamily:</label>
                    <input id="txtFontFamily" type="text" style="width:100px" />
                    <label for="txtFontStyle" class="dialogRightLabel">FontStyle:</label>
                    <select id="comboBoxFontStyle" style="width:104px;height:22px">
                        <option value="normal">normal</option>
                        <option value="italic">italic</option>
                        <option value="oblique">oblique</option>
                        <option value="inherit">inherit</option>
                    </select>
                </div>
                <div style="margin-top: 10px">
                    <label for="txtFontSize" class="dialogLabel">FontSize:</label>
                    <input id="txtFontSize" type="text" style="width:100px" />
                    <label for="txtFontWeight" class="dialogRightLabel">FontWeight:</label>
                    <input id="txtFontWeight" type="text" style="width:100px" />
                </div>
                <div style="margin-top: 10px">
                    <label for="txtBorderWidth" class="dialogLabel">BorderWidth:</label>
                    <input id="txtBorderWidth" type="text" style="width:100px" />
                    <label for="txtBorderStyle" class="dialogRightLabel">BorderStyle:</label>
                    <select id="comboBoxBorderStyle" style="width:104px;height:22px">
                        <option value="none">none</option>
                        <option value="hidden">hidden</option>
                        <option value="dotted">dotted</option>
                        <option value="dashed">dashed</option>
                        <option value="solid">solid</option>
                        <option value="double">double</option>
                        <option value="groove">groove</option>
                        <option value="ridge">ridge</option>
                        <option value="inset">inset</option>
                        <option value="outset">outset</option>
                    </select>
                </div>
                <div style="margin-top: 10px">
                    <label for="txtBorderColor" class="dialogLabel">BorderColor:</label>
                    <input id="txtBorderColor" type="button" style="width:104px;" onclick="setColor(event, 'Comment Border Color')" />
                    <label for="txtPadding" class="dialogRightLabel">Padding:</label>
                    <input id="txtPadding" type="text" style="width:100px" />
                </div>
                <div style="margin-top: 10px">
                    <label for="txtTextDecoration" class="dialogLabel">TextDecoration:</label>
                    <select id="comboBoxTextDecoration" style="width:90px; height:22px;margin-left:14px">
                        <option value="0">none</option>
                        <option value="1">underline</option>
                        <option value="2">overline</option>
                        <option value="3">linethrough</option>
                    </select>
                    <label for="txtOpacity" class="dialogRightLabel">Opacity:</label>
                    <input id="txtOpacity" type="text" style="width:90px;margin-right:2px" />%
                </div>
                <div style="margin-top: 10px">
                    <label for="txtForeColor" class="dialogLabel">ForeColor:</label>
                    <input id="txtForeColor" type="button" style="width:104px" onclick="setColor(event, 'Comment Fore Color')"/>
                    <label for="txtBackColor" class="dialogRightLabel">BackColor:</label>
                    <input id="txtBackColor" type="button" style="width:104px" onclick="setColor(event, 'Comment Back Color')" />
                </div>
                <div style="margin-top: 10px">
                    <label for="txtHorizontal" class="dialogLabel">Horizontal:</label>
                    <select id="comboBoxHorizontal" style="width:104px;height:22px">
                        <option value="0">left</option>
                        <option value="1">center</option>
                        <option value="2">right</option>
                        <option value="3">general</option>
                    </select>
                    <label for="txtDisplayMode" class="dialogRightLabel">DisplayMode:</label>
                    <select id="comboBoxDisplayMode" style="width:104px;height:22px">
                        <option value="1">AlwaysShown</option>
                        <option value="2">HoverShown</option>
                    </select>
                </div>
                <div style="margin-top: 10px">
                    <label for="txtzIndex" class="dialogLabel">zIndex</label>
                    <input id="txtzIndex" type="text" style="width:100px" />
                </div>
                <div style="margin-top: 10px">
                    <input id="chkDynamicSize" type="checkbox" checked="checked" />
                    <label for="chkDynamicSize">dynamicSize</label>
                    <input id="chkDynamicMove" type="checkbox" checked="checked" />
                    <label for="chkDynamicMove">dynamicMove</label>
                    <input id="chkLockText" type="checkbox" checked="checked" />
                    <label for="chkLockText">LockText</label>
                    <input id="chkShowShadow" type="checkbox" />
                    <label for="chkShowShadow">showShadow</label>
                </div>
            </div>
        </div>
    </div>
    <div id="sparklineexdialog" title="SparklineEx">
        <div style="margin-left: 10px; margin-top: 10px; font-size: 12px">
            <div style="margin-top: 10px">
                <label class="dialogLabel">Type:</label>
                <select id="sparklineExType" style="width:104px;height:22px;">
                    <option value="LINESPARKLINE">Line</option>
                    <option value="COLUMNSPARKLINE">Column</option>
                    <option value="WINLOSSSPARKLINE">Win/Loss</option>
                    <option value="PIESPARKLINE">Pie</option>
                    <option value="AREASPARKLINE">Area</option>
                    <option value="SCATTERSPARKLINE">Scatter</option>
                    <option value="SPREADSPARKLINE">Spread</option>
                    <option value="STACKEDSPARKLINE">Stacked</option>
                    <option value="BULLETSPARKLINE">Bullet</option>
                    <option value="HBARSPARKLINE">Hbar</option>
                    <option value="VBARSPARKLINE">Vbar</option>
                    <option value="VARISPARKLINE">Variance</option>
                    <option value="BOXPLOTSPARKLINE">BoxPlot</option>
                    <option value="CASCADESPARKLINE">Cascade</option>
                    <option value="PARETOSPARKLINE">Pareto</option>
                </select>
            </div>
            <div id="commonSparkline">
                <div style="margin-top: 10px">
                    <fieldset>
                        <legend>Choose the data that you want</legend>
                        <label class="dialogLabel" style="width:100px">Data Range:</label>
                        <input id="dataRange" type="text" style="width:100px" />
                        <label id="dataRangeInValid" style="display: block;"></label>
                    </fieldset>
                </div>
                <div style="margin-top: 10px">
                    <fieldset>
                        <legend>Choose where you want the sparkline to be placed</legend>
                        <label class="dialogLabel" style="width:100px">Location Range:</label>
                        <input id="locationRange" type="text" style="width:100px" />
                        <label id="locationRangeInValid" style="display: block;"></label>
                    </fieldset>
                </div>
            </div>
            <div id="bullet" style="margin-top: 10px">
                <div class="dialogRow">
                    <label class="dialogLabel">Measure:</label>
                    <input id="bulletMeasure" type="text" class="dialogInput" />
                    <label class="dialogLabel" style="margin-left:4px;">Target:</label>
                    <input id="bulletTarget" type="text" class="dialogInput" />
                </div>
                <div class="dialogRow">
                    <label class="dialogLabel">Maxi:</label>
                    <input id="bulletMaxi" type="text" class="dialogInput" />
                    <label class="dialogLabel" style="margin-left:4px;">Forecast:</label>
                    <input id="bulletForecast" type="text" class="dialogInput" />
                </div>
                <div class="dialogRow">
                    <label class="dialogLabel">Good:</label>
                    <input id="bulletGood" type="text" class="dialogInput" />
                    <label class="dialogLabel" style="margin-left:4px;">Bad:</label>
                    <input id="bulletBad" type="text" class="dialogInput" />
                </div>
                <div class="dialogRow">
                    <label class="dialogLabel">Tickunit:</label>
                    <input id="bulletTickunit" type="text" class="dialogInput" />
                    <label class="dialogLabel" style="margin-left:4px;">ColorScheme:</label>
                    <input id="bulletColorScheme" type="button" class="dialogInput" style="width: 104px; background: #A0A0A0;" onclick="setColor(event, 'Bullet Color Scheme')" />
                </div>
                <div class="dialogRow">
                    <input id="bulletVertical" type="checkbox" />
                    <label for="bulletVertical" class="dialogLabel">Vertical</label>
                </div>
            </div>
            <div id="hbar" style="margin-top: 10px">
                <div class="dialogRow">
                    <label class="dialogLabel">Value:</label>
                    <input id="hbarValue" type="text" class="dialogInput" />
                </div>
                <div class="dialogRow">
                    <label class="dialogLabel">ColorScheme:</label>
                    <input id="hbarColorScheme" type="button" class="dialogInput" style="width: 104px; background: gray;" onclick="setColor(event, 'HBar Color Scheme')" />
                </div>
            </div>
            <div id="vbar" style="margin-top: 10px">
                <div class="dialogRow">
                    <label class="dialogLabel">Value:</label>
                    <input id="vbarValue" type="text" class="dialogInput" />
                </div>
                <div class="dialogRow">
                    <label class="dialogLabel">ColorScheme:</label>
                    <input id="vbarColorScheme" type="button" class="dialogInput" style="width: 104px; background: gray;" onclick="setColor(event, 'VBar Color Scheme')" />
                </div>
            </div>
            <div id="vari" style="margin-top: 10px">
                <div class="dialogRow">
                    <label class="dialogLabel">Variance:</label>
                    <input id="variVariance" type="text" class="dialogInput" />
                    <label class="dialogLabel" style="margin-left:4px;">Reference:</label>
                    <input id="variReference" type="text" class="dialogInput" />
                </div>
                <div class="dialogRow">
                    <label class="dialogLabel">Mini:</label>
                    <input id="variMini" type="text" class="dialogInput" />
                    <label class="dialogLabel" style="margin-left:4px;">Maxi:</label>
                    <input id="variMaxi" type="text" class="dialogInput" />
                </div>
                <div class="dialogRow">
                    <label class="dialogLabel">Mark:</label>
                    <input id="variMark" type="text" class="dialogInput" />
                    <label class="dialogLabel" style="margin-left:4px;">TickUnit:</label>
                    <input id="variTickunit" type="text" class="dialogInput" />
                </div>
                <div class="dialogRow">
                    <label class="dialogLabel">ColorPositive:</label>
                    <input id="variColorPositive" type="button" class="dialogInput" style="width: 104px; background: green;" onclick="setColor(event, 'Variance Positive Color')" />
                    <label class="dialogLabel" style="margin-left:4px;">ColorNegative:</label>
                    <input id="variColorNegative" type="button" class="dialogInput" style="width: 104px; background: red;" onclick="setColor(event, 'Variance Negative Color')" />
                </div>
                <div class="dialogRow">
                    <input id="variLegend" type="checkbox" style="margin-left:100px;"/>
                    <label for="variLegend">Legend</label>
                    <input id="variVertical" type="checkbox" style="margin-left:140px;" />
                    <label for="variVertical">Vertical</label>
                </div>
            </div>
        </div>
    </div>
    <div id="ribbon">
        <ul>
            <li><a href="#tabHome">HOME</a></li>
            <li><a href="#tabData">DATA</a></li>
            <li><a href="#tabView">VIEW</a></li>
            <li><a href="#tabSettings">SETTINGS</a></li>
            <li><a href="#tabTheme">THEME</a></li>
            <li><a href="#tabImportExport">EXCEL I/O</a></li>
        </ul>
        <div id="tabHome">
            <ul>
                <li id="clipboardgroup">
                    <button title="Paste" class="wijmo-wijribbon-bigbutton" name="paste">
                        <div class="wijmo-wijribbon-table"></div>
                        <span>Paste</span>
                    </button>
                    <span class="wijmo-wijribbon-list">
                        <div>
                            <button title="Cut" class="wijmo-wijribbon-cut" name="cut">
                                <span>Cut</span>
                            </button>
                        </div>
                        <div>
                            <button title="Copy" class="wijmo-wijribbon-copy" name="copy">
                                <span>Copy</span>
                            </button>
                        </div>
                    </span>

                    <div>Clipboard</div>
                </li>
                <li id="fontgroup">
                    <div>
                        <span>
                            <button title="Font Name" name="fontname">Font Name</button>
                            <ul>
                                <li>
                                    <input type="radio" id="C1Editor1_ctl74" name="fontname" />
                                    <label for="C1Editor1_ctl74" name="fn1" id="fn1" title="Arial">Arial</label>
                                </li>
                                <li>
                                    <input type="radio" id="C1Editor1_ctl76" name="fontname" />
                                    <label for="C1Editor1_ctl76" name="fn2" id="fn2" title="Courier New">
                                        Courier New
                                    </label>
                                </li>
                                <li>
                                    <input type="radio" id="C1Editor1_ctl78" name="fontname" />
                                    <label for="C1Editor1_ctl78" name="fn3" id="fn3"
                                           title="Garamond">
                                        Garamond
                                    </label>
                                </li>
                                <li>
                                    <input type="radio" id="C1Editor1_ctl80" name="fontname" />
                                    <label for="C1Editor1_ctl80" name="fn4" id="fn4" title="Tahoma">Tahoma</label>
                                </li>
                                <li>
                                    <input type="radio" id="C1Editor1_ctl82" name="fontname" />
                                    <label for="C1Editor1_ctl82" name="fn5" id="fn5" title="Times New Roman">
                                        Times New Roman
                                    </label>
                                </li>
                                <li>
                                    <input type="radio" id="C1Editor1_ctl84" name="fontname" />
                                    <label for="C1Editor1_ctl84" name="fn6" id="fn6" title="Verdana">Verdana</label>
                                </li>
                                <li>
                                    <input type="radio" id="C1Editor1_ctl86" name="fontname" />
                                    <label for="C1Editor1_ctl86" name="fn7" id="fn7"
                                           title="Wingdings">
                                        Wingdings
                                    </label>
                                </li>
                            </ul>
                        </span>
                        <span>
                            <button title="Font Size" name="fontsize">Font Size</button>
                            <ul>
                                <li>
                                    <input type="radio" id="C1Editor1_ctl104" name="fontsize" />
                                    <label for="C1Editor1_ctl104" name="fs1" id="fs1"
                                           title="xx-small">
                                        VerySmall
                                    </label>
                                </li>
                                <li>
                                    <input type="radio" id="C1Editor1_ctl106" name="fontsize" />
                                    <label for="C1Editor1_ctl106" name="fs2" id="fs2"
                                           title="x-small">
                                        Smaller
                                    </label>
                                </li>
                                <li>
                                    <input type="radio" id="C1Editor1_ctl108" name="fontsize" />
                                    <label for="C1Editor1_ctl108" name="fs3" id="fs3" title="small">Small</label>
                                </li>
                                <li>
                                    <input type="radio" id="C1Editor1_ctl110" name="fontsize" />
                                    <label for="C1Editor1_ctl110" name="fs4" id="fs4" title="medium">Medium</label>
                                </li>
                                <li>
                                    <input type="radio" id="C1Editor1_ctl112" name="fontsize" />
                                    <label for="C1Editor1_ctl112" name="fs5" id="fs5" title="large">Large</label>
                                </li>
                                <li>
                                    <input type="radio" id="C1Editor1_ctl114" name="fontsize" />
                                    <label for="C1Editor1_ctl114" name="fs6" id="fs6" title="x-large">Larger</label>
                                </li>
                                <li>
                                    <input type="radio" id="C1Editor1_ctl116" name="fontsize" />
                                    <label for="C1Editor1_ctl116" name="fs7" id="fs7"
                                           title="xx-large">
                                        VeryLarge
                                    </label>
                                </li>
                                <li>
                                    <input type="radio" id="C1Editor1_ctl117" name="fontsize" />
                                    <label for="C1Editor1_ctl117" name="fs8" id="fs8" title="40pt">40pt</label>
                                </li>
                            </ul>
                        </span>
                        <span>
                            <button title="TabStop" class="wijmo-wijribbon-checkbox" name="tabStop">TabStop</button>
                        </span>
                        <span>
                            <button title="Wrap Text" class="wijmo-wijribbon-wordwrap" name="wrapText">Wrap Text</button>
                        </span>
                    </div>
                    <div>
                        <span class="wijmo-wijribbon-list">
                            <button title="Bold" class="wijmo-wijribbon-bold" name="bold"></button>
                            <button title="Italic" class="wijmo-wijribbon-italic" name="italic"></button>
                            <button title="Borders" class="wijmo-wijribbon-borders" name="borders"></button>
                            <button title="Background Color" class="wijmo-wijribbon-bgcolor" name="backcolor"></button>
                            <button title="Font Color" class="wijmo-wijribbon-color" name="fontcolor"></button>
                            <button title="Underline" class="wijmo-wijribbon-underline" name="Underline"></button>
                            <button title="Strikethrough" class="wijmo-wijribbon-strike" name="Strikethrough"></button>
                            <button title="Overline" class="wijmo-wijribbon-checkbox" name="Overline">Overline</button>
                        </span>
                    </div>
                    <div>Style</div>
                </li>
                <li id="alignmentgroup">
                    <span class="wijmo-wijribbon-list">
                        <div>
                            <span>
                                <button title="Left Align" class="wijmo-wijribbon-justifyleft" name="justifyleft"></button>
                                <button title="Center Align" class="wijmo-wijribbon-justifycenter" name="justifycenter"></button>
                                <button title="Right Align" class="wijmo-wijribbon-justifyright" name="justifyright"></button>
                            </span>
                        </div>
                        <div>
                            <button title="Merge Cell" class="wijmo-wijribbon-inserttable" name="merge">
                                <span>Merge Cell</span>
                            </button>
                        </div>
                    </span>
                    <span class="wijmo-wijribbon-list">
                        <div>
                            <button title="Increase Indent" class="wijmo-wijribbon-indent" name="increaseindent"></button>
                        </div>
                        <div>
                            <button title="Decrease Indent" class="wijmo-wijribbon-outdent" name="decreaseindent"></button>
                        </div>
                    </span>

                    <div>Alignment</div>
                </li>
                <li id="cellsgroup">
                    <span class="wijmo-wijribbon-list">
                        <div>
                            <button title="Insert Column" class="wijmo-wijribbon-insertcol" name="insertcol">
                                Insert
                                Column
                            </button>
                        </div>
                        <div>
                            <button title="Insert Row" class="wijmo-wijribbon-insertrow" name="insertrow">
                                Insert
                                Row
                            </button>
                        </div>
                    </span>
                    <span class="wijmo-wijribbon-list">
                        <div>
                            <button title="Delete Column" class="wijmo-wijribbon-deletecol" name="deletecol">
                                Delete
                                Column
                            </button>
                        </div>
                        <div>
                            <button title="Delete Row" class="wijmo-wijribbon-deleterow" name="deleterow">
                                Delete
                                Row
                            </button>
                        </div>
                    </span>

                    <div>Cells</div>
                </li>
                <li id="conditionalformat">
                    <div>
                        <span class="wijmo-wijribbon-list">
                            <button title="Conditional Formatting" name="conditionalformatting">
                                Conditional Formatting
                            </button>
                            <ul>
                                <li>
                                    <input type="radio" id="ConditionalFormat_1" name="conditionalformatting" />
                                    <label for="ConditionalFormat_1" name="highlightcell" id="highlightcell" title="Highlight Cell Rules">Highlight Cell Rules</label>
                                </li>
                                <li>
                                    <input type="radio" id="ConditionalFormat_2" name="conditionalformatting" />
                                    <label for="ConditionalFormat_2" name="topbottom" id="topbottom" title="Top/Bottom Rules">Top/Bottom Rules</label>
                                </li>
                                <li>
                                    <input type="radio" id="ConditionalFormat_3" name="conditionalformatting" />
                                    <label for="ConditionalFormat_3" name="databar" id="databar" title="Data Bars">Data Bars</label>
                                </li>
                                <li>
                                    <input type="radio" id="ConditionalFormat_4" name="conditionalformatting" />
                                    <label for="ConditionalFormat_4" name="colorscale" id="colorscale" title="Color Scales">Color Scales</label>
                                </li>
                                <li>
                                    <input type="radio" id="ConditionalFormat_5" name="conditionalformatting" />
                                    <label for="ConditionalFormat_5" name="iconset" id="iconset" title="Icon Sets">Icon Sets</label>
                                </li>
                                <li>
                                    <input type="radio" id="ConditionalFormat_6" name="conditionalformatting" />
                                    <label for="ConditionalFormat_6" name="otherofconditionalformat" id="otherofconditionalformat" title="Others">Others</label>
                                </li>
                            </ul>
                            <div>
                                <button title="Remove Conditional Formats" class="wijmo-wijribbon-inserttable"
                                        name="removeconditionalformats">
                                    <span>Remove Conditional Formats</span>
                                </button>
                            </div>
                        </span>
                    </div>
                    <div>Conditional Formatting</div>
                </li>
                <li id="table">
                    <div>
                        <span class="wijmo-wijribbon-list">
                            <div>
                                <button title="Table" class="wijmo-wijribbon-bigbutton" name="table">
                                    <div class="wijmo-wijribbon-table"></div>
                                    <span>Table</span>
                                </button>
                            </div>
                        </span>
                    </div>
                    <div>Format as Table</div>
                </li>
                <li id="picture">
                    <span class="wijmo-wijribbon-list">
                        <div>
                            <button title="Picture" class="wijmo-wijribbon-bigbutton"
                                    name="picture">
                                <div class="wijmo-wijribbon-table"></div>
                                <span>Picture</span>
                            </button>
                        </div>
                    </span>
                    <div>Illustrations</div>
                </li>
            </ul>
        </div>
        <div id="tabData">
            <ul>
                <li id="sortfilter">
                    <span class="wijmo-wijribbon-list">
                        <div>
                            <button title="Sort A-Z" class="wijmo-wijribbon-sort" name="sortaz">
                                <span>Sort A-Z</span>
                            </button>
                        </div>
                        <div>
                            <button title="Sort Z-A" class="wijmo-wijribbon-sort" name="sortza">
                                <span>Sort Z-A</span>
                            </button>
                        </div>
                    </span>
                    <button title="Filter" class="wijmo-wijribbon-bigbutton" name="filter" style="width:48px;">
                        <div class="wijmo-wijribbon-spelling"></div>
                        <span>Fitler</span>
                    </button>
                    <div>Sort & Filter</div>
                </li>
                <li id="outline">
                    <button title="Group" class="wijmo-wijribbon-bigbutton" name="group">
                        <div class="wijmo-wijribbon-table"></div>
                        <span>Group</span>
                    </button>
                    <button title="UnGroup" class="wijmo-wijribbon-bigbutton" name="ungroup" style="width: 54px;">
                        <div class="wijmo-wijribbon-table"></div>
                        <span>UnGroup</span>
                    </button>
                    <span class="wijmo-wijribbon-list">
                        <div>
                            <button title="Show Detail" class="wijmo-wijribbon-showdetail" name="showdetail">
                                <span>Show Detail</span>
                            </button>
                        </div>
                        <div>
                            <button title="Hide Detail" class="wijmo-wijribbon-hidedetail" name="hidedetail">
                                <span>Hide Detail</span>
                            </button>
                        </div>
                    </span>
                    <span class="wijmo-wijribbon-list">
                        <div>
                            <input type="checkbox" id="showRowGroup" />
                            <label id="showRowGroupLabel" for="showRowGroup" name="showrowrangegroup"
                                   class="wijmo-wijribbon-checkbox">
                                ShowRowRangeGroup
                            </label>
                        </div>
                        <div>
                            <input type="checkbox" id="showColGroup" />
                            <label id="showColGroupLabel" for="showColGroup" name="showcolrangegroup"
                                   class="wijmo-wijribbon-checkbox">
                                ShowColRangeGroup
                            </label>
                        </div>
                    </span>

                    <div>Outline</div>
                </li>
                <li id="validationui">
                    <div>
                        <span class="wijmo-wijribbon-list">
                            <div>
                                <button title="Data Validation" class="wijmo-wijribbon-bigbutton" style="width:80px;"
                                        name="datavalidation">
                                    <div class="wijmo-wijribbon-table"></div>
                                    <span>Data Validation</span>
                                </button>
                            </div>
                        </span>
                        <span class="wijmo-wijribbon-list">
                            <div>
                                <button title="Circle Invalid Data" class="wijmo-wijribbon-inserttable"
                                        name="circleinvaliddata">
                                    <span>Circle Invalid Data</span>
                                </button>
                            </div>
                            <div>
                                <button title="Clear Validation Circles" class="wijmo-wijribbon-inserttable"
                                        name="clearvalidationcircles">
                                    <span>Clear Validation Circles</span>
                                </button>
                            </div>
                        </span>
                    </div>
                    <div>Validation UI</div>
                </li>
                <li id="tabcelltype">
                    <div>
                        <span class="wijmo-wijribbon-list">
                            <div>
                                <button title="Cell Type" name="celltypebutton">
                                    Cell Type
                                </button>
                                <ul>
                                    <li>
                                        <input type="radio" id="CellType_1" name="celltypebutton" />
                                        <label for="CellType_1" name="textboxcelltype" id="textboxcelltype" title="TextBoxCellType">TextBoxCellType</label>
                                    </li>
                                    <li>
                                        <input type="radio" id="CellType_2" name="celltypebutton" />
                                        <label for="CellType_2" name="comboboxcelltype" id="comboboxcelltype" title="ComboBoxCellType">ComboBoxCellType</label>
                                    </li>
                                    <li>
                                        <input type="radio" id="CellType_3" name="celltypebutton" />
                                        <label for="CellType_3" name="checkboxcelltype" id="checkboxcelltype" title="CheckBoxCellType">CheckBoxCellType</label>
                                    </li>
                                    <li>
                                        <input type="radio" id="CellType_4" name="celltypebutton" />
                                        <label for="CellType_4" name="buttoncelltype" id="buttoncelltype" title="ButtonCellType">ButtonCellType</label>
                                    </li>
                                    <li>
                                        <input type="radio" id="CellType_5" name="celltypebutton" />
                                        <label for="CellType_5" name="hyperlinkcelltype" id="hyperlinkcelltype" title="HyperLinkCellType">HyperLinkCellType</label>
                                    </li>
                                </ul>
                            </div>
                        </span>
                        <span class="wijmo-wijribbon-list">
                            <div>
                                <input type="checkbox" id="alleditorreserved" />
                                <label id="alleditorreservedlocationslabel" for="alleditorreserved" name="alloweditorreservedlocations"
                                       class="wijmo-wijribbon-checkbox">
                                    allowEditorReservedLocations
                                </label>
                            </div>
                            <div>
                                <button title="Clear CellType" class="wijmo-wijribbon-inserttable"
                                        name="ClearCellType">
                                    Clear CellType
                                </button>
                            </div>
                        </span>
                    </div>
                    <div>Cell Type</div>
                </li>
                <li id="comment">
                    <span class="wijmo-wijribbon-list">
                        <div>
                            <button title="Comment" class="wijmo-wijribbon-bigbutton"
                                    name="comment" style="width:60px">
                                <div class="wijmo-wijribbon-table"></div>
                                <span>Comment</span>
                            </button>
                        </div>
                    </span>
                    <div>Comment</div>
                </li>
                <li id="sparklineEx">
                    <span class="wijmo-wijribbon-list">
                        <div>
                            <button title="SparklineEx" class="wijmo-wijribbon-bigbutton"
                                    name="sparklineex" style="width: 60px;">
                                <div class="wijmo-wijribbon-table"></div>
                                <span>SparklineEx</span>
                            </button>
                        </div>
                    </span>
                    <div>SparklineEx</div>
                </li>
            </ul>
        </div>
        <div id="tabView">
            <ul>
                <li id="showhide">
                    <span class="wijmo-wijribbon-list">
                        <div>
                            <button name="rowheader" class="wijmo-wijribbon-checkbox">Row Header</button>
                        </div>
                        <div>
                            <button name="columnheader" class="wijmo-wijribbon-checkbox">Column Header</button>
                        </div>
                    </span>
                    <span class="wijmo-wijribbon-list">
                        <div>
                            <button name="vgridline" class="wijmo-wijribbon-checkbox">Vertical Gridline</button>
                        </div>
                        <div>
                            <button name="hgridline" class="wijmo-wijribbon-checkbox">Horizontal Gridline</button>
                        </div>
                    </span>
                    <span class="wijmo-wijribbon-list">
                        <div>
                            <button name="tabstrip" class="wijmo-wijribbon-checkbox">TabStrip</button>
                        </div>
                        <div>
                            <button name="newtab" class="wijmo-wijribbon-checkbox">NewTab</button>
                        </div>
                    </span>
                    <span class="wijmo-wijribbon-list">
                        <div>
                            <button name="showhorizontalscrollbar" class="wijmo-wijribbon-checkbox">HScrollbar</button>
                        </div>
                        <div>
                            <button name="showverticalscrollbar" class="wijmo-wijribbon-checkbox">VScrollbar</button>
                        </div>
                    </span>
                    <span class="wijmo-wijribbon-list">
                        <div>
                            <button name="scrollbarMaxAlign" class="wijmo-wijribbon-checkbox">ScrollbarMaxAlign</button>
                        </div>
                        <div>
                            <button name="scrollbarShowMax" class="wijmo-wijribbon-checkbox">ScrollbarShowMax</button>
                        </div>
                    </span>
                    <div>Show/Hide</div>
                </li>
                <li id="viewport">
                    <button title="Freeze Pane" class="wijmo-wijribbon-bigbutton" name="freezepane">
                        <div class="wijmo-wijribbon-table"></div>
                        <span>Freeze</span>
                    </button>
                    <button title="UnFreeze" class="wijmo-wijribbon-bigbutton" name="unfreeze" style="width: 54px;">
                        <div class="wijmo-wijribbon-table"></div>
                        <span>UnFreeze</span>
                    </button>
                    <span class="wijmo-wijribbon-list">
                        <div>
                            <button id="setFrozenLineColor" title="FrozenLineColor"
                                    class="wijmo-wijribbon-bgcolor" name="frozenlinecolor">
                                FrozenLineColor
                            </button>
                        </div>
                        <div>
                            <button title="Freeze Setting" class="wijmo-wijribbon-inserttable"
                                    name="freezesetting">
                                <div class="wijmo-wijribbon-table"></div>
                                <span>Freeze Setting</span>
                            </button>
                        </div>
                    </span>

                    <div>Viewport</div>
                </li>
                <li id="setcolor">
                    <span class="wijmo-wijribbon-list">

                        <div>
                            <button id="setTabStripColor" title="Tab Strip Color"
                                    class="wijmo-wijribbon-bgcolor" name="tabStripColor">
                                TabStripColor
                            </button>
                        </div>
                    </span>
                    <span class="wijmo-wijribbon-list">
                        <div>
                            <button id="setSpreadBackColor" title="SpreadBackColor"
                                    class="wijmo-wijribbon-bgcolor" name="spreadbackcolor">
                                SpreadBackColor
                            </button>
                        </div>
                        <div>
                            <button id="setGrayAreaBackColor" title="GrayAreaBackColor"
                                    class="wijmo-wijribbon-bgcolor" name="grayareabackcolor">
                                GrayAreaBackColor
                            </button>
                        </div>
                    </span>
                    <span class="wijmo-wijribbon-list">
                        <div>
                            <button id="setSelectionBorderColor" title="SelectionBorderColor"
                                    class="wijmo-wijribbon-bgcolor" name="selectionbordercolor">
                                SelectionBorderColor
                            </button>
                        </div>
                        <div>
                            <button id="setSelectionBackColor" title="SelectionBackColor"
                                    class="wijmo-wijribbon-bgcolor" name="selectionbackcolor">
                                SelectionBackColor
                            </button>
                        </div>
                    </span>

                    <div>Color</div>
                </li>
            </ul>
        </div>
        <div id="tabSettings">
            <ul>
                <li id="selectiongroup">
                    <div>
                        <span class="wijmo-wijribbon-list">
                            <div>
                                <button title="SelectionPolicy" name="selectionpolicy">SelectionPolicy</button>
                                <ul>
                                    <li>
                                        <input type="radio" id="SelectionPolicy_1" name="selectionpolicy" />
                                        <label for="SelectionPolicy_1" name="sp1" id="sp1" title="Single">Single</label>
                                    </li>
                                    <li>
                                        <input type="radio" id="SelectionPolicy_2" name="selectionpolicy" />
                                        <label for="SelectionPolicy_2" name="sp2" id="sp2" title="Range">Range</label>
                                    </li>
                                    <li>
                                        <input type="radio" id="SelectionPolicy_3" name="selectionpolicy" />
                                        <label for="SelectionPolicy_3" name="sp3" id="sp3"
                                               title="MultiRange">
                                            MultiRange
                                        </label>
                                    </li>
                                </ul>
                            </div>
                            <div>
                                <button title="SelectionUnit" name="selectionunit">SelectionUnit</button>
                                <ul>
                                    <li>
                                        <input type="radio" id="SelectionUnit_1" name="selectionunit" />
                                        <label for="SelectionUnit_1" name="su1" id="su1" title="Cell">Cell</label>
                                    </li>
                                    <li>
                                        <input type="radio" id="SelectionUnit_2" name="selectionunit" />
                                        <label for="SelectionUnit_2" name="su2" id="su2" title="Row">Row</label>
                                    </li>
                                    <li>
                                        <input type="radio" id="SelectionUnit_3" name="selectionunit" />
                                        <label for="SelectionUnit_3" name="su3" id="su3" title="Column">Column</label>
                                    </li>
                                </ul>
                            </div>
                            </span>
                        <span class="wijmo-wijribbon-list">
                            <div>
                                <input type="checkbox" id="hideSelection" />
                                <label id="hideSelectionLabel" for="hideSelection" class="wijmo-wijribbon-checkbox" name="hideselection">
                                    HideSelection
                                </label>
                            </div>
                        </span>
                    </div>
                    <div>Selection Mode</div>
                </li>
                <li id="tabedit">
                    <div>
                        <span class="wijmo-wijribbon-list">
                            <div>
                                <input type="checkbox" id="isR1C1" />
                                <label id="isR1C1Label" for="isR1C1" name="isr1c1"
                                       class="wijmo-wijribbon-checkbox">
                                    IsR1C1
                                </label>
                            </div>
                            <div>
                                <input type="checkbox" id="canUserDragDrop" />
                                <label id="canUserDragDropLabel" for="canUserDragDrop" name="canuserdragdrop"
                                       class="wijmo-wijribbon-checkbox">
                                    CanUserDragDrop
                                </label>
                            </div>
                        </span>
                        <span class="wijmo-wijribbon-list">
                            <div>
                                <input type="checkbox" id="canUserDragFill" />
                                <label id="canUserDragFillLabel" for="canUserDragFill" name="canuserdragfill"
                                       class="wijmo-wijribbon-checkbox">
                                    CanUserDragFill
                                </label>
                            </div>
                            <div>
                                <input type="checkbox" id="canUserEditFormula" />
                                <label id="canUserEditFormulaLabel" for="canUserEditFormula" name="canusereditformula"
                                       class="wijmo-wijribbon-checkbox">
                                    CanUserEditFormula
                                </label>
                            </div>
                        </span>
                    </div>
                    <div>Edit</div>
                </li>
                <li id="tabtip">
                    <div>
                        <span class="wijmo-wijribbon-list">
                            <div>
                                <button title="ShowScrollTip" name="showscrolltip">ScrollTip</button>
                                <ul>
                                    <li>
                                        <input type="radio" id="ShowScrollTip_1" name="showscrolltip" />
                                        <label for="ShowScrollTip_1" name="ts1" id="ts1" title="None">None</label>
                                    </li>
                                    <li>
                                        <input type="radio" id="ShowScrollTip_2" name="showscrolltip" />
                                        <label for="ShowScrollTip_2" name="ts2" id="ts2" title="Horizontal">Horizontal</label>
                                    </li>
                                    <li>
                                        <input type="radio" id="ShowScrollTip_3" name="showscrolltip" />
                                        <label for="ShowScrollTip_3" name="ts3" id="ts3" title="Vertical">Vertical</label>
                                    </li>
                                    <li>
                                        <input type="radio" id="ShowScrollTip_4" name="showscrolltip" />
                                        <label for="ShowScrollTip_4" name="ts4" id="ts4" title="Both">Both</label>
                                    </li>
                                </ul>
                            </div>
                            <div>
                                <button title="ShowResizeTip" name="showresizetip">ResizeTip</button>
                                <ul>
                                    <li>
                                        <input type="radio" id="ShowResizeTip_1" name="showscrolltip" />
                                        <label for="ShowResizeTip_1" name="tr1" id="tr1" title="None">None</label>
                                    </li>
                                    <li>
                                        <input type="radio" id="ShowResizeTip_2" name="showscrolltip" />
                                        <label for="ShowResizeTip_2" name="tr2" id="tr2" title="Column">Column</label>
                                    </li>
                                    <li>
                                        <input type="radio" id="ShowResizeTip_3" name="showscrolltip" />
                                        <label for="ShowResizeTip_3" name="tr3" id="tr3" title="Row">Row</label>
                                    </li>
                                    <li>
                                        <input type="radio" id="ShowResizeTip_4" name="showscrolltip" />
                                        <label for="ShowResizeTip_4" name="tr4" id="tr4" title="Both">Both</label>
                                    </li>
                                </ul>
                            </div>
                        </span>
                        <span class="wijmo-wijribbon-list">
                            <div>
                                <input type="checkbox" id="showDragDropTip" />
                                <label id="showDragDropTipLabel" for="showDragDropTip" name="showdragdroptip"
                                       title="showDragDropTip" class="wijmo-wijribbon-checkbox">
                                    DragDropTip
                                </label>
                            </div>
                            <div>
                                <input type="checkbox" id="showDragFillTip" />
                                <label id="showDragFillTipLabel" for="showDragFillTip" name="showdragfilltip"
                                       title="showDragFillTip" class="wijmo-wijribbon-checkbox">
                                    DragFillTip
                                </label>
                            </div>
                        </span>
                    </div>
                    <div>Show Tip</div>
                </li>
                <li id="tab">
                    <div>
                        <span class="wijmo-wijribbon-list">
                            <div>
                                <input type="checkbox" id="autoFitWithHeaderText" />
                                <label id="autoFitWithHeaderTextLabel" for="autoFitWithHeaderText" name="autofitwithheadertext"
                                       title="AutoFit With Header Text" class="wijmo-wijribbon-checkbox">
                                    AutoFitWithHeaderText
                                </label>
                            </div>
                            <div>
                                <input type="checkbox" id="allowSheetReorder" />
                                <label id="allowSheetReorderLabel" for="allowSheetReorder" name="allowsheetreorder"
                                       title="Allow Sheet Order" class="wijmo-wijribbon-checkbox">
                                    AllowSheetReorder
                                </label>
                            </div>
                        </span>
                        <span class="wijmo-wijribbon-list">
                            <div style="padding:0.4em 0">
                                <span style="padding-left: 10px; color:black; font-family:'Segoe UI';font-size:9pt;font-weight:normal;">Sheet List</span>
                                <select id="sheetList" style="font-family:'Segoe UI';font-size:9pt;font-weight:normal;"></select>
                            </div>
                            <div>
                                <button title="Sheet Visible" class="wijmo-wijribbon-checkbox"
                                        name="sheetVisible">
                                    Sheet Visible
                                </button>
                            </div>
                        </span>
                        <span class="wijmo-wijribbon-list">
                            <div>
                                <input type="checkbox" id="cutCopyIndicatorVisible" />
                                <label id="cutCopyIndicatorVisibleLabel" for="cutCopyIndicatorVisible" name="cutcopyindicatorvisible"
                                       title="Cut/Copy Indicator Visible" class="wijmo-wijribbon-checkbox">
                                    Cut/Copy Indicator
                                </label>
                            </div>
                            <div>
                                <button id="cutCopyIndicatorColor" title="Cut Copy Indicator Border Color"
                                        class="wijmo-wijribbon-bgcolor" name="cutcopyindicatorcolor">
                                    Indicator Border Color
                                </button>
                            </div>
                        </span>
                        <span class="wijmo-wijribbon-list">
                            <div>
                                <input type="checkbox" id="useTouchLayout" />
                                <label id="useTouchLayoutLabel" for="useTouchLayout" name="usetouchlayout"
                                       title="Use Touch Layout" class="wijmo-wijribbon-checkbox">
                                    UseTouchLayout
                                </label>
                            </div>
                        </span>
                    </div>
                    <div>General</div>
                </li>
                <li id="dragFill">
                    <div>
                        <span class="wijmo-wijribbon-list">
                            <div>
                                <button title="DefaultDragFillType" name="defaultDragFillType">DefaultDragFillType</button>
                                <ul>
                                    <li>
                                        <input type="radio" id="DragFillType_1" name="defaultDragFillType" />
                                        <label for="DragFillType_1" name="df1" id="df1" title="CopyCells">CopyCells</label>
                                    </li>
                                    <li>
                                        <input type="radio" id="DragFillType_2" name="defaultDragFillType" />
                                        <label for="DragFillType_2" name="df2" id="df2" title="FillSeries">FillSeries</label>
                                    </li>
                                    <li>
                                        <input type="radio" id="DragFillType_3" name="defaultDragFillType" />
                                        <label for="DragFillType_3" name="df3" id="df3" title="FillFormattingOnly">FillFormattingOnly</label>
                                    </li>
                                    <li>
                                        <input type="radio" id="DragFillType_4" name="defaultDragFillType" />
                                        <label for="DragFillType_4" name="df4" id="df4" title="FillWithoutFormatting">FillWithoutFormatting</label>
                                    </li>
                                    <li>
                                        <input type="radio" id="DragFillType_5" name="defaultDragFillType" />
                                        <label for="DragFillType_5" name="df5" id="df5" title="Auto">Auto</label>
                                    </li>
                                </ul>
                            </div>
                            <div>
                                <input type="checkbox" id="showDragFillSmartTag" />
                                <label id="Label2" for="showDragFillSmartTag" name="showDragFillSmartTag"
                                       title="DragFill SmartTag" class="wijmo-wijribbon-checkbox">
                                    DragFillSmartTag
                                </label>
                            </div>
                        </span>
                    </div>
                    <div>DragFill</div>
                </li>
            </ul>
        </div>
        <div id="tabTheme">
            <ul class="premium-themes ui-helper-reset ui-helper-clearfix">
                <li>
                    <a href="http://cdn.wijmo.com/themes/arctic/jquery-wijmo.css" title="Arctic" rel="Arctic">
                        <img src="http://wijmo.com/demo/themes/theme-explore/images/themes/arctic.png" alt="Arctic"
                             class="theme-title"></img>
                    </a>
                    <a href="http://cdn.wijmo.com/themes/aristo/jquery-wijmo.css" title="Aristo" rel="Aristo">
                        <img src="http://wijmo.com/demo/themes/theme-explore/images/themes/aristo.png" alt="Aristo"
                             class="theme-title"></img>
                    </a>
                    <a href="http://cdn.wijmo.com/themes/rocket/jquery-wijmo.css" title="Rocket" rel="Rocket">
                        <img src="http://wijmo.com/demo/themes/theme-explore/images/themes/rocket.png" alt="Rocket"
                             class="theme-title"></img>
                    </a>
                    <a href="http://cdn.wijmo.com/themes/midnight/jquery-wijmo.css" title="Midnight" rel="Midnight">
                        <img src="http://wijmo.com/demo/themes/theme-explore/images/themes/midnight.png" alt="Midnight"
                             class="theme-title"></img>
                    </a>
                    <a href="http://cdn.wijmo.com/themes/sterling/jquery-wijmo.css" title="Sterling" rel="Sterling">
                        <img src="http://wijmo.com/demo/themes/theme-explore/images/themes/sterling.png" alt="Sterling"
                             class="theme-title"></img>
                    </a>
                    <a href="http://cdn.wijmo.com/themes/cobalt/jquery-wijmo.css" title="Cobalt" rel="Cobalt">
                        <img src="http://wijmo.com/demo/themes/theme-explore/images/themes/cobalt.png" alt="Cobalt"
                             class="theme-title"></img>
                    </a>

                    <div>Wijmo Themes</div>
                </li>
                <li id="jQueryThemes">
                    <div>
                        <a href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.11/themes/black-tie/jquery-ui.css"
                           title="Black Tie" rel="Black Tie">
                            <img src="http://wijmo.com/demo/themes/theme-explore/images/themes/blacktie.png" alt="Black Tie"
                                 class="theme-smalltitle" />
                        </a>
                        <a href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.11/themes/blitzer/jquery-ui.css"
                           title="Blitzer" rel="Blitzer">
                            <img src="http://wijmo.com/demo/themes/theme-explore/images/themes/blitzer.png" alt="Blitzer"
                                 class="theme-smalltitle" />
                        </a>
                        <a href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.11/themes/cupertino/jquery-ui.css"
                           title="Cupertino" rel="Cupertino">
                            <img src="http://wijmo.com/demo/themes/theme-explore/images/themes/cupertino.png" alt="Cupertino"
                                 class="theme-smalltitle" />
                        </a>
                        <a href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.11/themes/dark-hive/jquery-ui.css"
                           title="Dark Hive" rel="Dark Hive">
                            <img src="http://wijmo.com/demo/themes/theme-explore/images/themes/darkhive.png" alt="Dark Hive"
                                 class="theme-smalltitle" />
                        </a>
                        <a href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.11/themes/dot-luv/jquery-ui.css"
                           title="Dot Luv" rel="Dot Luv">
                            <img src="http://wijmo.com/demo/themes/theme-explore/images/themes/dotluv.png" alt="Dot Luv"
                                 class="theme-smalltitle" />
                        </a>
                        <a href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.11/themes/eggplant/jquery-ui.css"
                           title="Eggplant" rel="Eggplant">
                            <img src="http://wijmo.com/demo/themes/theme-explore/images/themes/eggplant.png" alt="Eggplant"
                                 class="theme-smalltitle" />
                        </a>
                        <a href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.11/themes/excite-bike/jquery-ui.css"
                           title="Excite Bike" rel="Excite Bike">
                            <img src="http://wijmo.com/demo/themes/theme-explore/images/themes/excitebike.png" alt="Excite Bike"
                                 class="theme-smalltitle" />
                        </a>
                        <a href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.11/themes/flick/jquery-ui.css" title="Flick"
                           rel="Flick">
                            <img src="http://wijmo.com/demo/themes/theme-explore/images/themes/flick.png" alt="Flick"
                                 class="theme-smalltitle" />
                        </a>
                        <a href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.11/themes/hot-sneaks/jquery-ui.css"
                           title="Hot Sneaks" rel="Hot Sneaks">
                            <img src="http://wijmo.com/demo/themes/theme-explore/images/themes/hotsneaks.png" alt="Hot Sneaks"
                                 class="theme-smalltitle" />
                        </a>
                        <a href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.11/themes/humanity/jquery-ui.css"
                           title="Humanity" rel="Humanity">
                            <img src="http://wijmo.com/demo/themes/theme-explore/images/themes/humanity.png" alt="Humanity"
                                 class="theme-smalltitle" />
                        </a>
                        <a href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.11/themes/le-frog/jquery-ui.css"
                           title="Le Frog" rel="Le Frog">
                            <img src="http://wijmo.com/demo/themes/theme-explore/images/themes/lefrog.png" alt="Le Frog"
                                 class="theme-smalltitle" />
                        </a>
                        <a href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.11/themes/mint-choc/jquery-ui.css"
                           title="Mint Chocolate" rel="Mint Chocolate">
                            <img src="http://wijmo.com/demo/themes/theme-explore/images/themes/mintchoc.png"
                                 alt="Mint Chocolate" class="theme-smalltitle" />
                        </a>
                    </div>
                    <div>
                        <a href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.11/themes/overcast/jquery-ui.css"
                           title="Overcast" rel="Overcast">
                            <img src="http://wijmo.com/demo/themes/theme-explore/images/themes/overcast.png" alt="Overcast"
                                 class="theme-smalltitle" />
                        </a>
                        <a href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.11/themes/pepper-grinder/jquery-ui.css"
                           title="Pepper Grinder" rel="Pepper Grinder">
                            <img src="http://wijmo.com/demo/themes/theme-explore/images/themes/peppergrinder.png"
                                 alt="Pepper Grinder" class="theme-smalltitle" />
                        </a>
                        <a href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.11/themes/redmond/jquery-ui.css"
                           title="Redmond" rel="Redmond">
                            <img src="http://wijmo.com/demo/themes/theme-explore/images/themes/redmond.png" alt="Redmond"
                                 class="theme-smalltitle" />
                        </a>
                        <a href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.11/themes/smoothness/jquery-ui.css"
                           title="Smoothness" rel="Smoothness">
                            <img src="http://wijmo.com/demo/themes/theme-explore/images/themes/smoothness.png" alt="Smoothness"
                                 class="theme-smalltitle" />
                        </a>
                        <a href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.11/themes/south-street/jquery-ui.css"
                           title="South Street" rel="South Street">
                            <img src="http://wijmo.com/demo/themes/theme-explore/images/themes/southstreet.png"
                                 alt="South Street" class="theme-smalltitle" />
                        </a>
                        <a href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.11/themes/start/jquery-ui.css" title="Start"
                           rel="Start">
                            <img src="http://wijmo.com/demo/themes/theme-explore/images/themes/start.png" alt="Start"
                                 class="theme-smalltitle" />
                        </a>
                        <a href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.11/themes/sunny/jquery-ui.css" title="Sunny"
                           rel="Sunny">
                            <img src="http://wijmo.com/demo/themes/theme-explore/images/themes/sunny.png" alt="Sunny"
                                 class="theme-smalltitle" />
                        </a>
                        <a href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.11/themes/swanky-purse/jquery-ui.css"
                           title="Swanky Purse" rel="Swanky Purse">
                            <img src="http://wijmo.com/demo/themes/theme-explore/images/themes/swankypurse.png"
                                 alt="Swanky Purse" class="theme-smalltitle" />
                        </a>
                        <a href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.11/themes/trontastic/jquery-ui.css"
                           title="Trontasic" rel="Trontasic">
                            <img src="http://wijmo.com/demo/themes/theme-explore/images/themes/trontastic.png" alt="Trontasic"
                                 class="theme-smalltitle" />
                        </a>
                        <a href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.11/themes/ui-darkness/jquery-ui.css"
                           title="UI Darkness" rel="UI Darkness">
                            <img src="http://wijmo.com/demo/themes/theme-explore/images/themes/uidarkness.png" alt="UI Darkness"
                                 class="theme-smalltitle" />
                        </a>
                        <a href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.11/themes/ui-lightness/jquery-ui.css"
                           title="UI Lightness" rel="UI Lightness">
                            <img src="http://wijmo.com/demo/themes/theme-explore/images/themes/uilightness.png"
                                 alt="UI Lightness" class="theme-smalltitle" />
                        </a>
                        <a href="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.11/themes/vader/jquery-ui.css" title="Vader"
                           rel="Vader">
                            <img src="http://wijmo.com/demo/themes/theme-explore/images/themes/vader.png" alt="Vader"
                                 class="theme-smalltitle" />
                        </a>
                    </div>
                    <div>JQuery Themes</div>
                </li>
            </ul>
        </div>
        <div id="tabImportExport">
            <ul>
                <li id="excelio">
                    <span class="wijmo-wijribbon-list">
                        <div>
                            <label for="serviceUrl" style="width: 70px; margin-top: 10px; margin-left: 6px; display: inline-block; display: -moz-inline-box;color:black;font-family:'Segoe UI';font-size:9pt;font-weight:normal;">Server Url:</label>
                            <input type="text" id="serviceUrl" value="http://localhost/ExcelIO" style="width: 200px; margin-top: 10px; display: inline-block; display: -moz-inline-box;">
                        </div>
                    </span>
                    <span class="wijmo-wijribbon-list">
                        <div>
                            <input type="file" name="files[]" multiple id="import_excel_file" accept=".xlsx,.xls" style="width: 250px; margin-left: 20px; margin-top: 10px; display: inline-block; display: -moz-inline-box;font-family:'Segoe UI';font-size:9pt;" />
                        </div>
                        <div>
                            <label for="exportFileName" style="margin-left: 20px; display: inline-block; display: -moz-inline-box;color:black;font-family:'Segoe UI';font-size:9pt;font-weight:normal;">Export file name:</label>
                            <input type="text" id="exportFileName" placeholder="Export file name" style="width: 120px; margin-left: 8px; margin-top: 8px;display: inline-block; display: -moz-inline-box;">
                        </div>
                    </span>
                    <span class="wijmo-wijribbon-list">
                        <button id="importBtn" title="Import" class="wijmo-wijribbon-bigbutton" name="importexcel">
                            <div class="wijmo-wijribbon-table"></div>
                            <span>Import</span>
                        </button>
                    </span>
                    <span class="wijmo-wijribbon-list">
                        <button title="Export" class="wijmo-wijribbon-bigbutton" name="exportexcel">
                            <div class="wijmo-wijribbon-table"></div>
                            <span>Export</span>
                        </button>
                    </span>
                </li>
            </ul>
        </div>
    </div>
    <table id="formulaBar" style="width: 100%;">
        <tr>
            <td style="width: 100px; border-color:#ABABAB;">
                <input type="text" id="positionbox" disabled="disabled" style="text-align: center; height: 18px;margin: 0;"></input>
            </td>
            <td>
                <div id="formulabox" contenteditable="true" spellcheck="false" style="line-height: 16px;border: 1px solid #ABABAB; overflow: hidden; padding: 3px; height: 16px;margin: 0;"></div>
            </td>
        </tr>
    </table>

    <div id="controlPanel" style="bottom: 0;">
        <div id="ss" style="border: solid gray 1px;">
        </div>
    </div>
    <table id="statusBar" style="width: 100%;height: auto;padding-top:6px;">
            <tr>
                <td style="background-color: #217346;">
                    <span id="rapidInputMode" style="font-family: 'Segoe UI'; font-size: 9pt; margin-left:16px; color: white" />
                </td>
                <td style="width: 300px; background-color: #217346;">
                    <input type="range" min="25" max="400" value="100" step="5" style="width: 100%; margin: 0;border: none; padding: 0;"
                           onchange="zoomFactor_Changed(this.value/100)" />
                </td>
            </tr>
        </table>
</body>
</html>
