/*
 *
 * SpreadJS Library 8.40.20151.0
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License. 
 * spread.sales@grapecity.com
 * http://spread.grapecity.com/Pages/Spread-JS-License/
 *
 *
 **/
var GcSpread;(function(n){(function(t){var s,f,e,o,h,c,l;t.feature("search",["core.common","core.sheet_ui","core.stringResource"]);var i=null,r=Math.max,u=Math.min;(function(n){n[n.All=0]="All";n[n.HasValue=1]="HasValue";n[n.HasStyle=2]="HasStyle"})(t.EnumeratorOption||(t.EnumeratorOption={}));s=t.EnumeratorOption;f=function(){function f(t,i){if(this.actualEndRow=-1,this.isActualEndRowSet=!1,this.isBlockRange=!1,this.options=1,!t)throw new Error(n.Sheets.SR.Exp_SheetIsNull);var r=this;r.worksheet=t;r.sheetArea=i.sheetArea;r.searchOrder=i.searchOrder;r.rowStart=i.rowStart;r.columnStart=i.columnStart;r.rowEnd=i.rowEnd;r.columnEnd=i.columnEnd;r.findBeginRow=i.findBeginRow;r.findBeginColumn=i.findBeginColumn;r.init();r.block=r.worksheet}return f.prototype.init=function(){this.currentRow=-1;this.currentColumn=-1},f.prototype.moveNext=function(){var n=this;if(n.currentRow===-1&&n.currentColumn===-1&&n.rowStart<=n.rowEnd&&n.columnStart<=n.columnEnd&&(n.currentRow=n.findBeginRow,n.currentColumn=n.findBeginColumn,n.isIndexAcceptable(n.currentRow,n.currentColumn)&&!n.skipCurrent()))return!0;if(n.rowStart<=n.rowEnd&&n.columnStart<=n.columnEnd)while(n.tryMoveNext())if(!n.skipCurrent())return!0;return n.currentRow=-1,n.currentColumn=-1,!1},f.prototype.isIndexAcceptable=function(n,t){var r=this;return(r.options&1)>0&&r.block&&(r.block.getValue(n,t,r.sheetArea)!==i||r.block.getFormula(n,t,r.sheetArea)!==i||r.block.getTag(n,t,r.sheetArea)!==i)?!0:r.options===0},f.prototype.skipCurrent=function(){return!1},f.prototype.tryMoveNext=function(){var n=this,t=n.currentRow,i=n.currentColumn,f=!1,r,u;return(n.options&1)>0&&(r={value:t},u={value:i},n.nextValue(r,u)&&(t=r.value,i=u.value,f=!0)),n.options===1&&(f?(n.currentRow=t,n.currentColumn=i):(n.currentRow=-1,n.currentColumn=-1)),!(n.currentRow===-1&&n.currentColumn===-1)},f.prototype.nextValue=function(n,t){while(this.next(n,t))if(this.isIndexAcceptable(n.value,t.value))return!0;return!1},f.prototype.nextZOrder=function(n,t,i){var r=this,e,u,f;if(n){if(e=r.getNextNonEmptyColumnInRow(n,t.value,i.value+1),e!==-1&&(i.value=e,r.isZOrderOver(t.value,i.value)))return!0;do if(u=n.nextNonNullRow(t.value),u===-1||u>r.rowEnd?t.value=-1:(u!==-1&&(t.value=u),u!==-1&&u<t.value&&(t.value=u)),t.value!==-1){i.value=t.value===r.rowStart||r.isBlockRange?r.columnStart-1:-1;do if(f=r.getNextNonEmptyColumnInRow(n,t.value,i.value+1),f===-1||f>r.columnEnd?i.value=-1:(f!==-1&&(i.value=f),f!==-1&&f<i.value&&(i.value=f)),i.value!==-1)return r.isZOrderOver(t.value,i.value);while(i.value!==-1)}while(t.value!==-1)}return!1},f.prototype.getNextNonEmptyColumnInRow=function(n,t,r){for(var u=r;u<=this.columnEnd;u++)if(n.getValue(t,u)!==i)return u;return-1},f.prototype.isZOrderOver=function(n,t){var i=this;if(i.isBlockRange)return n>=i.rowStart&&n<=i.getActualEndRow()&&t>=i.columnStart&&t<=i.actualEndColumn();else if(n>i.getActualEndRow()||n===i.getActualEndRow()&&(t<0||t>i.actualEndColumn())||n<i.rowStart||n===i.rowStart&&t<i.columnStart)return!1;return!0},f.prototype.getActualEndRow=function(){var n=this,t,i,f;return n.isActualEndRowSet?n.actualEndRow:(t=-1,i=!1,(n.options&1)>0&&n.block&&(f=n.block.getRowCount(n.sheetArea)-1,t=r(t,f),i=!0),t=i?u(t,n.rowEnd):n.rowEnd,n.actualEndRow=t,n.isActualEndRowSet=!0,n.actualEndRow)},f.prototype.actualEndColumn=function(){return this.columnEnd},f.prototype.next=function(n,t){var i=this,r,u;if(i.searchOrder===0)return r=i.getActualEndColumnZOrder(n.value),t.value+1<=r?(t.value+=1,i.isZOrderOver(n.value,t.value)):n.value+1<=i.getActualEndRow()?(n.value+=1,t.value=i.isBlockRange?i.columnStart:0,i.isZOrderOver(n.value,t.value)):!1;else if(i.searchOrder===1)return u=i.getActualEndRowNOrder(t.value),n.value+1<=u?(n.value+=1,i.isNOrderOver(n.value,t.value)):t.value+1<=i.actualEndColumn()?(t.value+=1,n.value=i.isBlockRange?i.rowStart:0,i.isNOrderOver(n.value,t.value)):!1;return!1},f.prototype.getActualEndColumnZOrder=function(n){var t=this,i,f;return n>=t.rowStart&&n<=t.rowEnd?(i=-1,f=!1,(t.options&1)>0&&t.block&&(i=r(i,t.block.getColumnCount(t.sheetArea)-1),f=!0),n===t.rowEnd||t.isBlockRange?f?u(i,t.columnEnd):t.columnEnd:f?r(i,t.worksheet.getColumnCount(t.sheetArea)-1):t.worksheet.getColumnCount(t.sheetArea)-1):-1},f.prototype.getActualEndRowNOrder=function(n){var t=this,i,f;return n>=t.columnStart&&n<=t.columnEnd?(i=-1,f=!1,(t.options&1)>0&&t.block&&(i=r(i,t.rowEnd),f=!0),n===t.columnEnd||t.isBlockRange?f?u(i,t.rowEnd):t.rowEnd:f?r(i,t.worksheet.getRowCount(t.sheetArea)-1):t.worksheet.getRowCount(t.sheetArea)-1):-1},f.prototype.isNOrderOver=function(n,t){var i=this;if(i.isBlockRange)return n>=i.rowStart&&n<=i.getActualEndRow()&&t>=i.columnStart&&t<=i.actualEndColumn();else if(t>i.actualEndColumn()||t===i.actualEndColumn()&&(n<0||n>i.getActualEndRow())||t<i.columnStart||t===i.columnStart&&n<i.rowStart)return!1;return!0},f.prototype.current=function(){var n=this;return 0<=n.currentRow&&n.currentRow<n.worksheet.getRowCount(n.sheetArea)&&0<=n.currentColumn&&n.currentColumn<n.worksheet.getColumnCount(n.sheetArea)?new t.Cell(n.worksheet,n.currentRow,n.currentColumn,n.sheetArea):i},f}();t.CellsEnumerator=f;e=function(){function n(){var n=this;n.startSheetIndex=-1;n.endSheetIndex=-1;n.searchString=i;n.searchFlags=0;n.searchOrder=0;n.searchTarget=1;n.sheetArea=3;n.rowStart=-1;n.columnStart=-1;n.rowEnd=-1;n.columnEnd=-1;n.findBeginRow=-1;n.findBeginColumn=-1}return n}();t.SearchCondition=e;o=function(){function n(){var n=this;n.searchFoundFlag=0;n.foundSheetIndex=-1;n.foundRowIndex=-1;n.foundColumnIndex=-1;n.foundString=i}return n}();t.SearchResult=o,function(n){n[n.None=0]="None";n[n.IgnoreCase=1]="IgnoreCase";n[n.ExactMatch=2]="ExactMatch";n[n.UseWildCards=4]="UseWildCards";n[n.BlockRange=8]="BlockRange"}(t.SearchFlags||(t.SearchFlags={}));h=t.SearchFlags,function(n){n[n.ZOrder=0]="ZOrder";n[n.NOrder=1]="NOrder"}(t.SearchOrder||(t.SearchOrder={}));c=t.SearchOrder,function(n){n[n.None=0]="None";n[n.CellText=1]="CellText";n[n.CellTag=4]="CellTag";n[n.CellFormula=8]="CellFormula"}(t.SearchFoundFlags||(t.SearchFoundFlags={}));l=t.SearchFoundFlags})(n.Sheets||(n.Sheets={}));var t=n.Sheets})(GcSpread||(GcSpread={}))
