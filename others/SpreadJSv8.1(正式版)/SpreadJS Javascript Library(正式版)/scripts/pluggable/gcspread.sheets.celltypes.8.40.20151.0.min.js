/*
 *
 * SpreadJS Library 8.40.20151.0
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License. 
 * spread.sales@grapecity.com
 * http://spread.grapecity.com/Pages/Spread-JS-License/
 *
 *
 **/
var __extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},GcSpread;(function(n){(function(n){var tr,ir,rr,ui,fi,ei,oi;n.feature("celltype",["core.common","core.sheet_action","core.basecelltype"]);var vr="undefined",t=null,i=undefined,l=Math.max,kt=Math.min,ct=Math.floor,li=Math.round,f=window.document,s="position",h="absolute",tt="margin",c="font",r="left",vt="right",e="top",yr="bottom",yt="alphabetic",pr="middle",dt="center",d="gcUIElement",et="tabindex",a="none",w="0",ai="#F6FAFB",vi="#D2DBEB",ot="#34B4E3",gt="#A6F4FF",v=".gcEditingInput",ni="keydown"+v,ti="keyup"+v,ii="mousedown"+v,ri="mouseup"+v,yi="mouseout"+v,pi="mousemove"+v,wi="click"+v,b="width",y="height",st="padding",it="hidden",wr="visibility",br="word-wrap",rt="overflow",pt="resize",ut="border",ft="outline",wt="box-shadow",g="box-sizing",k="color",bi="border-width",ki="border-style",di="border-color",lt="white-space",u="background-color",ht="z-index",gi="max-width",nr="max-height";(function(n){n[n.Text=0]="Text";n[n.Index=1]="Index";n[n.Value=2]="Value"})(n.EditorValueType||(n.EditorValueType={}));tr=n.EditorValueType,function(n){n[n.top=0]="top";n[n.bottom=1]="bottom";n[n.left=2]="left";n[n.right=3]="right"}(n.CheckBoxTextAlign||(n.CheckBoxTextAlign={}));ir=n.CheckBoxTextAlign,function(n){n[n.Blank=0]="Blank";n[n.Self=1]="Self";n[n.Parent=2]="Parent";n[n.Top=3]="Top"}(n.HyperLinkTargetType||(n.HyperLinkTargetType={}));rr=n.HyperLinkTargetType;ui=function(o){function v(){o.call(this);var n=this;n.allowOverflow=!1;n.typeName="5";n._checkboxSize=12;n._caption="";n._textTrue="";n._textIndeterminate="";n._textFalse="";n._textAlign=3;n._isThreeState=!1}return __extends(v,o),v.prototype.paintValue=function(u,f,e,o,s,h,c,l){var et,rt;if(u){u.save();u.rect(e,o,s,h);u.clip();u.beginPath();var y=this,d=this.getText(f,l),g=0,p=0,ft=l.sheet;ft&&(g=ft._getStringWidthByCanvas(d,c.font),p=ft._getFontHeight(c.font),d&&(et=d.split(/\r\n|\r|\n/),p*=et.length));var a=y._checkboxSize/2,ot=new n.Rect(++e,++o,--s,--h),w=parseInt((e+y._getCheckBoxLeft(c,ot,g)).toString()),v=parseInt((o+y._getCheckBoxTop(c,ot,p)).toString()),it=r,nt=w+1;c.hAlign===1?(it=dt,nt+=a):c.hAlign===2&&(it=vt,nt+=a*2);rt=c.font;rt&&u.font!==rt&&(u.font=rt);c.foreColor&&(u.fillStyle=c.foreColor);var b=c.textDecoration,tt=l.fontInfo.fontSize,ut=tt>8?ct((tt-8)/5+2):1,k=p/2-tt/2+ut-1;u.textBaseline!==yt&&(u.textBaseline=yt);y._textAlign===2?(u.textAlign=vt,u.fillText(d,w+1-2,v+a+p/2-k),b&&y._renderTextDecoration(u,b,w+1-2,v+a+p/2-k,g,tt,ut)):y._textAlign===0&&(u.textAlign=it,u.fillText(d,nt,v-2-k),b&&y._renderTextDecoration(u,b,nt,v-2-k,g,p));u.strokeStyle="black";u.strokeRect(w+.5,v+.5,a*2+.05,a*2+.05);u.fillStyle="white";u.fillRect(w+1,v+1,a*2-1,a*2-1);y._isThreeState&&(f===t||f===i)?(u.beginPath(),u.fillStyle="green",u.rect(w+3,v+3,(a-2.5)*2,(a-2.5)*2),u.fill()):!!f==!0&&(u.beginPath(),u.lineWidth=2.5,u.moveTo(w+3,v+a),u.lineTo(w+a,v+a*2-3.5),u.lineTo(w+a*2-1.5,v+3),u.stroke());c.foreColor&&(u.fillStyle=c.foreColor);y._textAlign===3?(u.textAlign=r,u.fillText(d,w+1+a*2+2,v+a+p/2-k),b&&y._renderTextDecoration(u,b,w+1+a*2+2,v+a+p/2-k,g,tt,ut)):y._textAlign===1&&(u.textAlign=it,u.fillText(d,nt,v+a*2+2+p-k),b&&y._renderTextDecoration(u,b,nt,v+a*2+2+p-k,g,tt,ut));u.restore()}},v.prototype.getText=function(n,t){return this._getDisplayText(n)},v.prototype.focus=function(n,t){n&&n.focus()},v.prototype._formatEditorValue=function(n,t,i,r){return i},v.prototype._getCheckBoxLeft=function(n,t,i,r){var u=t.x-1,o=t.width+1,s=0,f=0,e=this,h;return e._textAlign===0||e._textAlign===1?(f=u+5,n.hAlign===1?f=u+o/2-e._checkboxSize/2:n.hAlign===2&&(f=u+o-5-e._checkboxSize)):e._textAlign===2?(s=e._checkboxSize+i,f=u+5+i,n.hAlign===1?f=u+o/2-s/2+i:n.hAlign===2&&(f=u+o-5-s+i)):(s=e._checkboxSize+i,f=u+5,n.hAlign===1?f=u+o/2-s/2:n.hAlign===2&&(f=u+o-5-s)),h=f-u,r&&$.browser.msie&&(h-=3),h},v.prototype._getCheckBoxTop=function(n,t,i,r){var u=t.y-1,e=t.height+1,o=0,f=0,s=this,h;return s._textAlign===0?(o=s._checkboxSize+i,f=u+5+i,n.vAlign===1?f=u+e/2-o/2+i:n.vAlign===2&&(f=u+e-5-o+i)):s._textAlign===1?(o=s._checkboxSize+i,f=u+5,n.vAlign===1?f=u+e/2-o/2:n.vAlign===2&&(f=u+e-5-o)):(f=u+5,n.vAlign===1?f=u+e/2-s._checkboxSize/2:n.vAlign===2&&(f=u+e-5-s._checkboxSize)),h=f-u,r&&$.browser.msie&&(h-=3),h},v.prototype.createEditorElement=function(t){var l=f.createElement("div"),v=t&&t.sheet&&t.sheet.parent&&t.sheet.parent._host,p=n.util.getPreferredZIndex(v)+1e3,i=$(l),r,e,o;return i.css(s,h).css(tt,w).css(st,w).css(rt,it).css(pt,a).css(ut,"2px #5292f7 solid").css(ft,a).css(wt,"1px 2px 5px rgba(0,0,0,0.4)").css(g,"content-box").css(ht,p).attr(et,1).attr(d,"gcEditingInput"),r=$("<input/>"),r.attr("type","checkbox"),i.append(r),e=$("<span><\/span>"),e.css(s,h).css(c,"normal 10pt Arial").css("cursor","default").css(lt,"nowrap"),i.append(e),o=$("<div><\/div>"),o.css(s,h).css(u,"green").css(b,(this._checkboxSize/2-2.5)*2).css(y,(this._checkboxSize/2-2.5)*2),i.append(o),l},v.prototype._getNextState=function(n){return this._isThreeState?n===t||n===i?!1:!!n==!0?t:!0:!n},v.prototype.setEditorValue=function(n,r,u){if(n&&n.children[0]&&n.children[1]&&n.children[2]){var f=u&&u.sheet&&u.sheet._startEditByKeydown;f||(r=this._getNextState(r));this._isThreeState?r===t||r===i?(n.children[0].checked=!1,$(n.children[2]).show()):(n.children[0].checked=!!r,$(n.children[2]).hide()):n.children[0].checked=!!r;$(n.children[1]).text(this._getDisplayText(r))}},v.prototype.getEditorValue=function(n,i){return n&&n.children[0]&&n.children[1]&&n.children[2]?this._isThreeState?$(n.children[2]).is(":visible")?t:n.children[0].checked:n.children[0].checked:t},v.prototype._triggerButtonClicked=function(n,t,i,r){var u=n.parent;u&&u.triggerButtonClicked({sheet:n,sheetName:n._name,row:t,col:i,sheetArea:r})},v.prototype.activateEditor=function(t,i,f,o){var h=t&&o&&o.sheet,s;if(h){var c=$(t),l=h._eventHandler._getCanvasPosition(),a=h._bounds;c.css(e,l.top+a.y+f.y-2).css(r,l.left+a.x+f.x-2).css(u,i.backColor?i.backColor:"white");s=this;c.bind(ii,function(t){n.util.cancelDefault(t)});c.bind(ri,function(n){var r=s.getEditorValue(t,o);s.setEditorValue(t,r,o);s.updateEditor(t,i,f,o);s._triggerButtonClicked(h,h._activeRowIndex,h._activeColIndex,o.sheetArea)});c.bind(ni,function(t){if(t.keyCode!==32||t.ctrlKey||t.shiftKey||t.altKey)t.keyCode!==8||t.ctrlKey||t.shiftKey||t.altKey||n.util.cancelDefault(t);else return s._isKeyDown=!0,n.util.cancelDefault(t),!1});c.bind(ti,function(n){if(s._isKeyDown&&n.keyCode===32&&!n.ctrlKey&&!n.shiftKey&&!n.altKey){s._isKeyDown=!1;var r=s.getEditorValue(t,o);s.setEditorValue(t,r,o);s.updateEditor(t,i,f,o);s._triggerButtonClicked(h,h._activeRowIndex,h._activeColIndex,o.sheetArea)}});t.children[0]&&$(t.children[0]).bind("click",function(t){n.util.cancelDefault(t)})}},v.prototype.updateEditor=function(n,i,u,f){var l=n&&f&&f.sheet,p,d,a,v,w,rt,h,y,ut,ft;if(l){$(n).width(u.width).height(u.height);var et=$(n),g=l._render,nt=l._eventHandler._getCanvasPosition(),tt=l._bounds;et.css(e,nt.top+tt.y+u.y-2).css(r,nt.left+tt.x+u.x-2);var o=n.children[0],it=n.children[1],b=n.children[2];if(o&&it&&b){p=$(it);d=p.text();i.foreColor&&p.css(k,i.foreColor);a=t;a=i.font?i.font:g._getDefaultFont();l._zoomFactor>1&&(a=g._getZoomFont(a));p.css(c,a);v=l._getStringWidth(d,a);w=l._getFontHeight(a);d&&(rt=d.split(/\r\n|\r|\n/),w*=rt.length);var s=this,ot=s._getCheckBoxLeft(i,u,v,!0),st=s._getCheckBoxTop(i,u,w,!0);$(o).css("margin-left",ot).css("margin-top",st);h=0;y=0;s._textAlign===0?(h=o.offsetLeft,i.hAlign===1?h=o.offsetLeft+s._checkboxSize/2-v/2:i.hAlign===2&&(h=o.offsetLeft+s._checkboxSize-v),y=o.offsetTop-w):s._textAlign===1?(h=o.offsetLeft,i.hAlign===1?h=o.offsetLeft+s._checkboxSize/2-v/2:i.hAlign===2&&(h=o.offsetLeft+s._checkboxSize-v),y=o.offsetTop+o.offsetHeight):s._textAlign===2?(h=o.offsetLeft-v-2,y=o.offsetTop+s._checkboxSize/2-w/2):(h=o.offsetLeft+o.offsetWidth+2,y=o.offsetTop+s._checkboxSize/2-w/2);$.browser.msie&&(h+=3,y+=3);p.css(r,h).css(e,y);s._isThreeState?(ut=o.offsetLeft+(o.offsetWidth-b.offsetWidth)/2,ft=o.offsetTop+(o.offsetHeight-b.offsetHeight)/2,$(b).css(r,ut).css(e,ft).toggle().toggle()):$(b).hide();i.textDecoration&&s._setEditStatusTextDecoration(p,i.textDecoration)}}},v.prototype.caption=function(n){return arguments.length===0?this._caption:(this._caption=n,this)},v.prototype.textTrue=function(n){return arguments.length===0?this._textTrue:(this._textTrue=n,this)},v.prototype.textIndeterminate=function(n){return arguments.length===0?this._textIndeterminate:(this._textIndeterminate=n,this)},v.prototype.textFalse=function(n){return arguments.length===0?this._textFalse:(this._textFalse=n,this)},v.prototype._getDisplayText=function(n){var r=this;return r._isThreeState&&(n===t||n===i)?r._textIndeterminate||r._caption:!!n==!0?r._textTrue||r._caption:r._textFalse||r._caption},v.prototype.textAlign=function(n){return arguments.length===0?this._textAlign:(this._textAlign=n,this)},v.prototype.isThreeState=function(n){return arguments.length===0?this._isThreeState:(this._isThreeState=n,this)},v.prototype.getHitInfo=function(n,r,u,f,e){if(e){var o=e.sheetArea;if(o===t||o===i||o===3)return{x:n,y:r,row:e.row,col:e.col,cellRect:f,sheetArea:o,isReservedLocation:!0,sheet:e.sheet}}return t},v.prototype.processMouseDown=function(n){if(!n)return!1;n.isReservedLocation&&(this._isMouseDownReservedLocation=!0)},v.prototype.processMouseUp=function(r){var e,f;if(!r)return!1;if(e=this,f=r.sheet,e._isMouseDownReservedLocation&&f&&r.isReservedLocation){e._isMouseDownReservedLocation=!1;var s=r.row,h=r.col,o=r.sheetArea,u=f._getModel(o).getNode(s,h,!0);if(u._isFirstMouseUp)delete u._isFirstMouseUp,u._mouseupToken&&(window.clearTimeout(u._mouseupToken),delete u._mouseupToken);else{if(o===t||o===i||o===3){var c=f.getValue(s,h,o),l=e._getNextState(c),a={row:s,col:h,newValue:l,autoFormat:!0},v=new n.UndoRedo.CellEditUndoAction(f,a);f._doCommand(v)}return e._triggerButtonClicked(f,s,h,r.sheetArea),u._isFirstMouseUp=!0,u._mouseupToken=window.setTimeout(function(){delete u._isFirstMouseUp;u._mouseupToken&&(window.clearTimeout(u._mouseupToken),delete u._mouseupToken)},250),!0}}return!1},v.prototype.processMouseLeave=function(n){if(!n)return!1;this._isMouseDownReservedLocation=!1},v.prototype.isReservedKey=function(n,t){return n.keyCode===32&&!n.ctrlKey&&!n.shiftKey&&!n.altKey?!0:!1},v.prototype.processKeyUp=function(t,i){var r=i.sheet;if(!r)return!1;var u=r.getActiveRowIndex(),f=r.getActiveColumnIndex(),e=r._getSheetArea(r.activeRowViewportIndex,r.activeColViewportIndex),o=r.getValue(u,f,e),s=this._getNextState(o),h={row:u,col:f,newValue:s,autoFormat:!0},c=new n.UndoRedo.CellEditUndoAction(r,h);return r._doCommand(c),this._triggerButtonClicked(r,u,f,i.sheetArea),!0},v.prototype.getAutoFitWidth=function(t,i,r,u,f){var e=this,o=n.CellTypeContext.getAutoFitWidth(t,e._getDisplayText(t),r,u,f);return e._textAlign===0||e._textAlign===1?o=l(o,e._checkboxSize):o+=e._checkboxSize,o+5+2},v.prototype.getAutoFitHeight=function(t,i,r,u,f){var e=this,o=n.CellTypeContext.getAutoFitHeight(t,e._getDisplayText(t),r,u,f);return e._textAlign===0||e._textAlign===1?o+=e._checkboxSize:o=l(o,e._checkboxSize),o+5},v.prototype._cancelDefaultKeydown=function(t){t.keyCode!==32||t.ctrlKey||t.shiftKey||t.altKey||n.util.cancelDefault(t)},v.prototype.isImeAware=function(n){return!1},v.prototype._isDefaultValue=function(n,t){switch(n){case"caption":return t==="";case"textTrue":return t==="";case"textIndeterminate":return t==="";case"textFalse":return t==="";case"textAlign":return t===3;case"isThreeState":return t===!1;default:return!1}},v.prototype.toJSON=function(){var n=this,r={typeName:n.typeName,caption:n.caption(),textTrue:n.textTrue(),textIndeterminate:n.textIndeterminate(),textFalse:n.textFalse(),textAlign:n.textAlign(),isThreeState:n.isThreeState()},u={},t,i;for(t in r)i=r[t],n._isDefaultValue(t,i)||(u[t]=i);return u},v.prototype.fromJSON=function(n,r){if(n){var u=this;n.caption&&u.caption(n.caption);n.textTrue&&u.textTrue(n.textTrue);n.textIndeterminate&&u.textIndeterminate(n.textIndeterminate);n.textFalse&&u.textFalse(n.textFalse);n.textAlign!==t&&n.textAlign!==i&&u.textAlign(n.textAlign);n.isThreeState!==t&&n.isThreeState!==i&&u.isThreeState(n.isThreeState)}},v}(n.TextCellType);n.CheckBoxCellType=ui;fi=function(o){function l(){o.call(this);var n=this;n.allowOverflow=!1;n.typeName="6";n._marginTop=2;n._marginRight=2;n._marginBottom=2;n._marginLeft=2;n._text="";n._buttonBackColor=t;n._buttonBorderColor="#707070";n._eventNameSpace=".buttonCellType"}return __extends(l,o),l.prototype.paintValue=function(n,t,i,r,u,f,e,s){var p,y,w;if(n){var h=this,c=i+h._marginLeft,l=r+h._marginTop,a=u-h._marginLeft-h._marginRight,v=f-h._marginTop-h._marginBottom,b=c+a>i&&c<i+u&&l+v>r&&l<r+f;a-2>0&&v-2>0&&b&&(n.save(),(c<i||c+a>i+u||l<r||l+v>r+f)&&(n.rect(i,r,u,f),n.clip()),n.beginPath(),p=h._buttonBorderColor,p&&n.strokeStyle!==p&&(n.strokeStyle=p),n.strokeRect(c+.5,l+.5,a-1,v-1),y=h._buttonBackColor,y||(w=n.createLinearGradient(i+u/2,r,i+u/2,r+f),w.addColorStop(.125,ai),w.addColorStop(1,vi),y=w),n.fillStyle!==y&&(n.fillStyle=y),n.fillRect(c+1,l+1,a-2,v-2),n.restore(),h._text&&o.prototype.paintValue.call(this,n,h._text,c,l,a,v,e,s))}},l.prototype.focus=function(n,t){n&&n.focus()},l.prototype._formatEditorValue=function(n,t,i,r){return i},l.prototype.createEditorElement=function(t){var u=f.createElement("div"),o=t&&t.sheet&&t.sheet.parent&&t.sheet.parent._host,l=n.util.getPreferredZIndex(o)+1e3,e=$(u),i,r;return e.css(s,h).css(tt,w).css(st,w).css(rt,it).css(pt,a).css(ut,"2px #5292f7 solid").css(ft,a).css(wt,"1px 2px 5px rgba(0,0,0,0.4)").css(g,"content-box").css("user-select",a).css(ht,l).attr(et,1).attr(d,"gcEditingInput"),i=$("<div><\/div>"),i.css(s,h).css(rt,it).css(ut,"1px "+this._buttonBorderColor+" solid"),e.append(i),r=$("<span><\/span>"),r.css(s,h).css(lt,"nowrap").css(c,"normal 10pt Arial").css("cursor","default"),i.append(r),u},l.prototype.setEditorValue=function(n,t,i){var r=n&&n.children[0]&&n.children[0].children[0];r&&$(r).html(this._text)},l.prototype.getEditorValue=function(n,i){return n?n._oldValue:t},l.prototype._triggerButtonClicked=function(n,t,i,r){var u=n.parent;u&&u.triggerButtonClicked({sheet:n,sheetName:n._name,row:t,col:i,sheetArea:r})},l.prototype._setButtonBackgroundColor=function(n,t){n.removeClass("gradientButton");t?n.css(u,t):n.addClass("gradientButton")},l.prototype.activateEditor=function(t,i,f,o){var c=t&&o&&o.sheet,s,l,h;if(c){var a=$(t),v=c._eventHandler._getCanvasPosition(),y=c._bounds;a.css(e,v.top+y.y+f.y-2).css(r,v.left+y.x+f.x-2).css(u,i.backColor?i.backColor:"white");s=this;l=t.children[0];l&&(h=$(l),a.bind(ni,function(t){if(t.keyCode!==32||t.ctrlKey||t.shiftKey||t.altKey)t.keyCode!==8||t.ctrlKey||t.shiftKey||t.altKey||n.util.cancelDefault(t);else return s._isKeyDown||s._setButtonBackgroundColor(h,ot),s._isKeyDown=!0,n.util.cancelDefault(t),!1}),a.bind(ti,function(n){!s._isKeyDown||n.keyCode!==32||n.ctrlKey||n.shiftKey||n.altKey||(s._isKeyDown=!1,s._setButtonBackgroundColor(h,s._buttonBackColor),s._triggerButtonClicked(c,c._activeRowIndex,c._activeColIndex,o.sheetArea))}),h.bind(ii,function(n){n.button!==2&&(s._isMouseDown=!0,s._setButtonBackgroundColor(h,ot))}),h.bind(ri,function(n){n.button!==2&&(s._isMouseDown=!1,s._setButtonBackgroundColor(h,gt))}),h.bind(wi,function(n){s._triggerButtonClicked(c,c._activeRowIndex,c._activeColIndex,o.sheetArea)}),h.bind(pi,function(n){s._isMouseDown?s._setButtonBackgroundColor(h,ot):s._setButtonBackgroundColor(h,gt)}),h.bind(yi,function(n){var t=n.relatedTarget;t!==l&&t!==l.children[0]&&s._setButtonBackgroundColor(h,s._buttonBackColor)}))}},l.prototype.updateEditor=function(n,i,u,f){var s=n&&f&&f.sheet,v,o,h,b,a,l,d,y,it,p,w;if(s){var rt=$(n),g=s._render,nt=s._eventHandler._getCanvasPosition(),tt=s._bounds;rt.css(e,nt.top+tt.y+u.y-2).css(r,nt.left+tt.x+u.x-2).width(u.width).height(u.height);v=n.children[0];v&&(o=this,h=$(v),h.width(u.width-o._marginLeft-o._marginRight).height(u.height-o._marginTop-o._marginBottom).css("margin-top",o._marginTop-1).css("margin-left",o._marginLeft-1),o._setButtonBackgroundColor(h,o._buttonBackColor),b=v.children[0],b&&(a=$(b),i.foreColor&&a.css(k,i.foreColor),l=t,l=i.font?i.font:g._getDefaultFont(),s._zoomFactor>1&&(l=g._getZoomFont(l)),a.css(c,l),d=s._getStringWidth(o._text,l),y=s._getFontHeight(l),o._text&&(it=o._text.split(/\r\n|\r|\n/),y*=it.length),p=0,i.vAlign===1?p=h.height()/2-y/2:i.vAlign===2&&(p=h.height()-y),w=0,i.hAlign===1?w=h.width()/2-d/2:i.hAlign===2&&(w=h.width()-d),a.css(e,p).css(r,w),i.textDecoration&&o._setEditStatusTextDecoration(a,i.textDecoration)))}},l.prototype.marginTop=function(n){return arguments.length===0?this._marginTop:(this._marginTop=n,this)},l.prototype.marginRight=function(n){return arguments.length===0?this._marginRight:(this._marginRight=n,this)},l.prototype.marginBottom=function(n){return arguments.length===0?this._marginBottom:(this._marginBottom=n,this)},l.prototype.marginLeft=function(n){return arguments.length===0?this._marginLeft:(this._marginLeft=n,this)},l.prototype.text=function(n){return arguments.length===0?this._text:(this._text=n,this)},l.prototype.buttonBackColor=function(n){return arguments.length===0?this._buttonBackColor:(this._buttonBackColor=n,this)},l.prototype.getHitInfo=function(n,r,u,f,e){var s=this,o;if(!e)return t;if(o=e.sheetArea,(o===t||o===i||o===3)&&f){var c=f.x+s._marginLeft,l=f.x+f.width-s._marginRight,a=f.y+s._marginTop,v=f.y+f.height-s._marginBottom,h={x:n,y:r,row:e.row,col:e.col,cellRect:f,sheetArea:o,sheet:e.sheet};return c<=n&&n<=l&&a<=r&&r<=v&&(h.isReservedLocation=!0),h}return t},l.prototype.processMouseDown=function(n){if(!n)return!1;var t=this,i=n.sheet;return i&&n.isReservedLocation&&!t._isMouseDownReservedLocation?(t._originButtonBackColor=t._buttonBackColor,t._isMouseDownReservedLocation=!0,t._buttonBackColor=ot,i.repaint(n.cellRect),!0):!1},l.prototype.processMouseUp=function(n){var i,r;if(!n)return!1;if(i=this,r=n.sheet,i._isMouseDownReservedLocation&&r&&n.isReservedLocation){i._buttonBackColor=i._originButtonBackColor;r.repaint(n.cellRect);i._isMouseDownReservedLocation=!1;var u=n.row,f=n.col,e=n.sheetArea,t=r._getModel(e).getNode(u,f,!0);if(t._isFirstMouseUp)delete t._isFirstMouseUp,t._mouseupToken&&(window.clearTimeout(t._mouseupToken),delete t._mouseupToken);else return i._triggerButtonClicked(r,u,f,n.sheetArea),t._isFirstMouseUp=!0,t._mouseupToken=window.setTimeout(function(){delete t._isFirstMouseUp;t._mouseupToken&&(window.clearTimeout(t._mouseupToken),delete t._mouseupToken)},250),!0}return!1},l.prototype.processMouseLeave=function(n){if(!n)return!1;var t=this,i=n.sheet;i&&t._isMouseDownReservedLocation&&(t._buttonBackColor=t._originButtonBackColor,i.repaint(n.cellRect),t._isMouseDownReservedLocation=!1)},l.prototype.processKeyDown=function(t,i){var u=i&&i.sheet,r;if(!u)return!1;if(r=this,!r._isKeyPressed){var e=u.getActiveRowIndex(),o=u.getActiveColumnIndex(),f=u.getCellRect(e,o,u.activeRowViewportIndex,u.activeColViewportIndex);return r._originButtonBackColor=r._buttonBackColor,r._buttonBackColor=ot,u.repaint(f),u._bind(n.Events.SelectionChanged+r._eventNameSpace,function(t,i){u._unbind(n.Events.SelectionChanged+r._eventNameSpace);r._isKeyPressed=!1;r._buttonBackColor=r._originButtonBackColor;u.repaint(f)}),r._isKeyPressed=!0,!0}return!1},l.prototype.processKeyUp=function(t,i){var r=i.sheet,u;if(!r)return!1;if(u=this,u._isKeyPressed){var f=r.getActiveRowIndex(),e=r.getActiveColumnIndex(),o=r.getCellRect(f,e,r.activeRowViewportIndex,r.activeColViewportIndex);return u._buttonBackColor=u._originButtonBackColor,r.repaint(o),r._unbind(n.Events.SelectionChanged+u._eventNameSpace),u._triggerButtonClicked(r,f,e,i.sheetArea),u._isKeyPressed=!1,!0}return!1},l.prototype.isReservedKey=function(n,t){return n.keyCode===32&&!n.ctrlKey&&!n.shiftKey&&!n.altKey?!0:!1},l.prototype.getAutoFitWidth=function(t,i,r,u,f){var e=this,o=n.CellTypeContext.getAutoFitWidth(t,e._text,r,u,f);return o+e._marginLeft+e._marginRight},l.prototype.getAutoFitHeight=function(t,i,r,u,f){var e=this,o=n.CellTypeContext.getAutoFitHeight(t,e._text,r,u,f);return o+e._marginTop+e._marginBottom},l.prototype._cancelDefaultKeydown=function(t){t.keyCode!==32||t.ctrlKey||t.shiftKey||t.altKey||n.util.cancelDefault(t)},l.prototype.isImeAware=function(n){return!1},l.prototype._isDefaultValue=function(n,i){switch(n){case"marginTop":return i===2;case"marginRight":return i===2;case"marginBottom":return i===2;case"marginLeft":return i===2;case"text":return i==="";case"buttonBackColor":return i===t;default:return!1}},l.prototype.toJSON=function(){var n=this,r={typeName:n.typeName,marginTop:n.marginTop(),marginRight:n.marginRight(),marginBottom:n.marginBottom(),marginLeft:n.marginLeft(),text:n.text(),buttonBackColor:n.buttonBackColor()},u={},t,i;for(t in r)i=r[t],n._isDefaultValue(t,i)||(u[t]=i);return u},l.prototype.fromJSON=function(n,r){if(n){var u=this;n.marginTop!==t&&n.marginTop!==i&&u.marginTop(n.marginTop);n.marginRight!==t&&n.marginRight!==i&&u.marginRight(n.marginRight);n.marginBottom!==t&&n.marginBottom!==i&&u.marginBottom(n.marginBottom);n.marginLeft!==t&&n.marginLeft!==i&&u.marginLeft(n.marginLeft);n.text&&u.text(n.text);n.buttonBackColor&&u.buttonBackColor(n.buttonBackColor)}},l}(n.TextCellType);n.ButtonCellType=fi;ei=function(o){function v(){o.call(this);var n=this;n.allowOverflow=!1;n.typeName="8";n._link="";n._linkColor="#0066cc";n._visitedLinkColor="#3399ff";n._text="";n._linkToolTip="";n._id=v._getUniqueId();n._target=0}return __extends(v,o),v.prototype.paintValue=function(t,i,u,f,e,o,s,h){var v=this,p,tt,it,k,d,pt,g,et,c,kt,nt;if(!v._actived&&t&&(p=v.getText(i,h),p)){p=p.replace(/\s+/g," ");var ot=!1,st=h.sheet._getModel().getNode(h.row,h.col),ht=st&&st.hyperlinkInfo;ht&&(v._id===ht.id?ot=ht.visited:delete st.hyperlinkInfo);t.save();t.beginPath();tt=ot?v._visitedLinkColor:v._linkColor;tt&&t.fillStyle!==tt&&(t.fillStyle=tt);it=s.font;it&&t.font!==it&&(t.font=it);var rt=s.hAlign,lt=s.vAlign,w=t.measureText(p).width,y=h.lineHeight,ut=v._calcPosition(new n.Rect(u,f,e,o),w,y,rt,lt),b={x:u,y:f,width:e,height:o};(ut.x+w>b.width||ut.y+y>b.height)&&(t.rect(b.x,b.y,b.width,b.height),t.clip(),t.beginPath());k=2;d=r;rt===1?w<e-3&&(k=e/2,d=dt):rt===2&&w<e-3&&(k=e-2,d=vt);t.textAlign!==d&&(t.textAlign=d);var a=$.browser.mozilla?5:2,wt=yt,ft=h.fontInfo.fontSize,bt=ft>8?ct((ft-8)/5+2):1,at=y/2-ft/2+bt-1;a+=y-at;lt===1?y<o&&(a=$.browser.mozilla?o/2+1:$.browser.msie?o/2+.5:o/2,ct(a)!==a&&(a=a+.5),a+=y/2-at):lt===2&&(a=o-2.5-at);t.textBaseline!==wt&&(t.textBaseline=wt);t.fillText(p,u+k,f+a);pt=s.textDecoration;pt&&v._renderTextDecoration(t,pt,u+k,f+a,w,ft,bt);g=u+ut.x;et=g+w;rt===2||(g=g+1,et=et+1);c=f+ut.y+y;s.vAlign===2&&(c=c-.5);c=c-l(0,li(y/9)-1);ct(c)===c&&(c=c+.5);kt=c;t.beginPath();nt=v._linkColor;ot&&(nt=v._visitedLinkColor);nt&&t.strokeStyle!==nt&&(t.strokeStyle=nt);t.lineWidth=1;t.moveTo(g,c);t.lineTo(et,kt);t.stroke();t.restore()}},v.prototype.getText=function(n,t){return this._text||n},v.prototype.createEditorElement=function(t){var r=f.createElement("div"),o=t&&t.sheet&&t.sheet.parent&&t.sheet.parent._host,c=n.util.getPreferredZIndex(o)+1e3,u=$(r),i,e;u.css(tt,w).css(st,w).css(ut,a).css(s,h).css(rt,it).css(g,"content-box").css(lt,"nowrap").css(ht,c).attr(d,"gcEditor").attr(et,1).css(ft,a);switch(this._target){case 0:i="_blank";break;case 1:i="_self";break;case 2:i="_parent";break;case 3:i="_top";break}return e=f.createElement("a"),$(e).css(tt,w).css(ft,a).css("display","block").attr("target",i).appendTo(u),r},v.prototype._triggerButtonClicked=function(n,t,i,r){var u=n.parent;u&&(n._startEditByKeydown||u.triggerButtonClicked({sheet:n,sheetName:n._name,row:t,col:i,sheetArea:r}))},v.prototype.activateEditor=function(i,o,c,l){var a,y,v,b,nt,p,ut;if(i&&c){if(a=l&&l.sheet,y=$(i),y.css(u,o&&o.backColor||"white"),a){var ft=a._eventHandler._getCanvasPosition(),et=a._bounds,ot=ft.top+et.y+c.y,st=ft.left+et.x+c.x;y.css(e,ot).css(r,st)}y.bind("keydown",function(t){t.keyCode!==8||t.ctrlKey||t.shiftKey||t.altKey||n.util.cancelDefault(t)});v=this;b=y.children()[0];b&&(nt=$(b),nt.bind("click",function(){if(nt.css(k,v._visitedLinkColor),a){var n=a._activeRowIndex,t=a._activeColIndex,i=a._getModel().getNode(n,t,!0);i.hyperlinkInfo={id:v._id,visited:!0};v._triggerButtonClicked(a,n,t,l.sheetArea)}}));p=f.createElement("div");$(p).css(tt,w).css(s,h).css(rt,it).css(g,"content-box").attr(d,"gcEditingInput").css(bi,"1px").css(ki,"solid").css(u,"transparent");ut=a&&a._getHost();ut&&ut.insertBefore(p,t);v._clip=p;v._actived=!0}},v.prototype.deactivateEditor=function(n,t){var i=t&&t.sheet,r,u;this._clip&&(r=i&&i._getHost(),r&&r.removeChild(this._clip));n&&($(n).unbind("keydown"),u=$(n).children()[0],u&&$(u).unbind("click"));o.prototype.deactivateEditor.call(this,n,t);this._actived=!1;i&&i.repaint()},v.prototype.updateEditor=function(n,i,u,f){var l,p,w,v,a;if(n&&u){var o=this,s=f&&f.sheet,y=s&&s._render,rt=n,h=$(rt),b=h.children()[0];if(b&&(l=$(b),o._link&&l.attr("href",o._link),p=o._text||o._link,p&&l.text(p),l.attr("title",o._linkToolTip),w=!1,v=s?s._getModel().getNode(s._activeRowIndex,s._activeColIndex):t,v&&v.hyperlinkInfo&&(o._id===v.hyperlinkInfo.id?w=v.hyperlinkInfo.visited:delete v.hyperlinkInfo),w?l.css(k,o._visitedLinkColor):l.css(k,o._linkColor),a=i&&i.font?i.font:t,!a&&y&&(a=y._getDefaultFont()),y&&s._zoomFactor>1&&(a=y._getZoomFont(a)),a&&l.css(c,a)),i&&s){h.css(gi,u.width-2);h.css(nr,u.height-2);var d=s._eventHandler._getCanvasPosition(),g=s._bounds,nt=d.top+g.y+u.y,tt=d.left+g.x+u.x,it=o._calcPosition(u,h.width(),h.height(),i.hAlign,i.vAlign);h.css(e,nt+it.y).css(r,tt+it.x);o._clip&&$(o._clip).css(e,nt).css(r,tt).height(u.height-3).width(u.width-3).css(di,i.backColor||"white");i.textDecoration&&o._setEditStatusTextDecoration(h,i.textDecoration)}}},v.prototype.getEditorValue=function(n,t){return this._link},v.prototype.setEditorValue=function(n,t,i){this._link=t},v.prototype._formatEditorValue=function(n,t,i,r){return i},v.prototype.getHitInfo=function(n,r,u,f,e){if(e){var o=e.sheetArea;if((o===t||o===i||o===3)&&u&&f)return{x:n,y:r,row:e.row,col:e.col,cellStyle:u,cellRect:f,sheetArea:o,isFocusAware:!0,sheet:e.sheet}}return t},v.prototype.processMouseDown=function(n){if(n){var t=n.sheet;t&&!t.isEditing()&&(n.isReservedLocation=this._isHitHyperlink(n,t)?!0:!1,n.isReservedLocation&&(this._isMouseDownLink=!0))}},v.prototype.processMouseUp=function(n){var t,i,r,u;if(n&&(t=n.sheet,t&&!t.isEditing())){if(i=this,n.isReservedLocation=i._isHitHyperlink(n,t)?!0:!1,n.isReservedLocation&&i._isMouseDownLink){if(r=t.getValue(n.row,n.col,n.sheetArea),r)switch(i._target){case 0:window.open(r,"_blank");break;case 1:window.open(r,"_self");break;case 2:window.open(r,"_parent");break;case 3:window.open(r,"_top");break}u=t._getModel(n.sheetArea).getNode(n.row,n.col,!0);u.hyperlinkInfo={id:i._id,visited:!0};t.repaint(n.cellRect);i._triggerButtonClicked(t,n.row,n.col,n.sheetArea)}i._isMouseDownLink=!1}},v.prototype.processMouseMove=function(n){var t,r,i;n&&(t=n.sheet,t)&&(t.isEditing()&&t.getActiveRowIndex()===n.row&&t.getActiveColumnIndex()===n.col||(n.isReservedLocation=this._isHitHyperlink(n,t)?!0:!1,n.isReservedLocation?(this._showLinkToolTip(t,n),i=t._getCanvas(),i&&(r=t.getValue(n.row,n.col,n.sheetArea),i.style.cursor=r?"pointer":"text")):(this._hideLinkToolTip(t),i=t._getCanvas(),i&&(i.style.cursor="default"))))},v.prototype.processMouseLeave=function(n){var t,i;this._isMouseDownLink=!1;t=n.sheet;this._hideLinkToolTip(t);t&&(i=t._getCanvas(),i&&(i.style.cursor="default"))},v.prototype._isHitHyperlink=function(n,t){var f=n.cellStyle,i=n.cellRect,o=t._render,s=n.x,h=n.y,r=this._text||this._link,e;if(r||(r=t.getValue(n.row,n.col,n.sheetArea)),!r)return!1;r=r.replace(/\s+/g," ");e=f&&f.font?f.font:o._getDefaultFont();t._zoomFactor>1&&(e=o._getZoomFont(e));var u=this._getLinkRect(r,f.hAlign,f.vAlign,e,i,t),c=i.x+u.x,l=kt(i.x+u.x+u.width,i.x+i.width),a=i.y+u.y,v=kt(i.y+u.y+u.height,i.y+i.height);return c<=s&&s<l&&a<=h&&h<v?!0:!1},v.prototype._showLinkToolTip=function(n,i){var f,u,o;if(this._linkToolTip){f=this._getLinkToolTipElement();u=$(f);u.text(this._linkToolTip);var s=n._eventHandler._getCanvasPosition(),h=s.left+i.x,c=s.top+i.y+20;u.parent().length===0&&(o=n&&n._getHost(),o&&o.insertBefore(f,t),u.css(e,c).css(r,h))}},v.prototype._hideLinkToolTip=function(n){if(this._linkToolTipElement){var i=n&&n._getHost();i&&i.removeChild(this._linkToolTipElement);this._linkToolTipElement=t}},v.prototype._getLinkToolTipElement=function(){if(!this._linkToolTipElement){var n=f.createElement("div");n.className="gcHyperLinkCellTypeToolTip";$(n).css(s,h).css(tt,w).css(st,2).css(ut,"1px #c0c0c0 solid").css(wt,"1px 2px 5px rgba(0,0,0,0.4)").css(g,"content-box").css(u,"#ffffff").css(c,"9pt Arial");this._linkToolTipElement=n}return this._linkToolTipElement},v.prototype._getLinkRect=function(n,t,i,r,u,f){var p=v._getEditorElement(f),e=$(p),l=e.children()[0],o,h;l&&(o=$(l),o.text(n?n:""),r&&o.css(c,r));var a=e.width(),y=e.height(),s={x:0,y:0,width:a,height:y};return u&&(h=this._calcPosition(u,a,y,t,i),s.x=h.x,s.y=h.y),s},v.prototype._calcPosition=function(n,t,i,r,u){var f=1,e=1,o=n.width-3,s=n.height-3;return r===1?f=f+l(0,(o-t)/2):r===2&&(f=f+l(0,o-t)),u===1?e=e+l(0,(s-i)/2):u===2&&(e=e+l(0,s-i)),{x:f,y:e}},v.prototype.isReservedKey=function(n,t){return n.keyCode===32&&!n.ctrlKey&&!n.shiftKey&&!n.altKey?!0:!1},v.prototype.processKeyUp=function(n,t){var i=t.sheet,o;if(!i)return!1;var u=i.getActiveRowIndex(),f=i.getActiveColumnIndex(),e=i._getSheetArea(i.activeRowViewportIndex,i.activeColViewportIndex),r=i.getValue(u,f,e),s=i.getCellRect(u,f,i.activeRowViewportIndex,i.activeColViewportIndex);if(r){r=r.toString();switch(this._target){case 0:window.open(r,"_blank");break;case 1:window.open(r,"_self");break;case 2:window.open(r,"_parent");break;case 3:window.open(r,"_top");break}}return o=i._getModel(e).getNode(u,f,!0),o.hyperlinkInfo={id:this._id,visited:!0},i.repaint(s),this._triggerButtonClicked(i,u,f,t.sheetArea),!0},v.prototype.linkColor=function(n){return arguments.length===0?this._linkColor:(this._linkColor=n,this)},v.prototype.visitedLinkColor=function(n){return arguments.length===0?this._visitedLinkColor:(this._visitedLinkColor=n,this)},v.prototype.text=function(n){return arguments.length===0?this._text:(this._text=n,this)},v.prototype.linkToolTip=function(n){return arguments.length===0?this._linkToolTip:(this._linkToolTip=n,this)},v.prototype.target=function(n){return arguments.length===0?this._target:(this._target=n,this)},v.prototype.getAutoFitWidth=function(n,t,i,r,u){var f=u&&u.sheet;if(f){var e=this,o=f._render,s=e._text||n,h=i&&i.font?i.font:o._getZoomFont(o._getDefaultFont()),c=e._getLinkRect(s,i.hAlign,i.vAlign,h,null,f);return c.width}else return 0},v.prototype.getAutoFitHeight=function(n,t,i,r,u){var f=u&&u.sheet,s;if(f){var h=this._text||n,o=f._render,e=i&&i.font?i.font:o._getDefaultFont();return r>1&&(e=o._getZoomFont(e)),s=this._getLinkRect(h,i.hAlign,i.vAlign,e,null,f),s.height}else return 0},v.prototype.isImeAware=function(n){return!1},v.prototype._isDefaultValue=function(n,t){switch(n){case"linkColor":return t==="#0066cc";case"visitedLinkColor":return t==="#3399ff";case"text":return t==="";case"linkToolTip":return t==="";case"target":return t===0;default:return!1}},v.prototype.toJSON=function(){var n=this,r={typeName:n.typeName,linkColor:n._linkColor,visitedLinkColor:n._visitedLinkColor,text:n._text,linkToolTip:n._linkToolTip,target:n._target},u={},t,i;for(t in r)i=r[t],n._isDefaultValue(t,i)||(u[t]=i);return u},v.prototype.fromJSON=function(n,r){if(n){var u=this;n.linkColor!==i&&n.linkColor!==t&&(u._linkColor=n.linkColor);n.visitedLinkColor!==i&&n.visitedLinkColor!==t&&(u._visitedLinkColor=n.visitedLinkColor);n.text!==i&&n.text!==t&&(u._text=n.text);n.linkToolTip!==i&&n.linkToolTip!==t&&(u._linkToolTip=n.linkToolTip);n.target!==i&&n.target!==t&&(u._target=n.target)}},v._getUniqueId=function(){var n=this;return(n._id===i||n._id===t)&&(n._id=0),"id_"+n._id++},v._getEditorElement=function(n){var r=this;if(!r._editorElement){var i=v.prototype.createEditorElement({sheet:n}),u=i.style,f=n&&n._getHost();f&&f.insertBefore(i,t);u.visibility=it;u.top="-10000px";u.left="-10000px";i.className="gcHyperLinkCellTypeEditor";r._editorElement=i}return r._editorElement},v}(n.TextCellType);n.HyperLinkCellType=ei;oi=function(t){function r(){t.call(this);this.typeName=""}return __extends(r,t),r.prototype.paint=function(t,i,r,u,f,e,o,s){var h,c;t&&(n.CellTypeContext.paintBackground(t,r,u,f,e,o.backColor,o.backgroundImage,o.backgroundImageLayout,s.imageLoader),h=n.CellTypeContext.paintConditionalFormats(t,i,r,u,f,e,o,s),s.showBarIconOnly=h,n.CellTypeContext.paintSparkline(t,r,u,f,e,s.sparkline),c=n.CellTypeContext.paintSparklineEx(t,i,r,u,f,e,s.sheet),s.cellOverflowLayout||h||c||this.paintValue(t,i,r,u,f,e,o,s))},r.prototype.createEditorElement=function(n){},r.prototype.getEditorValue=function(n,t){},r.prototype.setEditorValue=function(n,t,i){},r.prototype.activateEditor=function(n,t,i,r){var u=n&&r&&r.sheet,f;if(u){f=u._eventHandler;this.isImeAware(r)&&f._resetFocusHolder();var e=f._getCanvasPosition(),o=u._bounds,s=e.top+o.y+i.y-2,h=e.left+o.x+i.x-2;$(n).css("top",s).css("left",h)}},r.prototype.deactivateEditor=function(n,t){var i,r;n&&(i=n._editingLocator,i&&(r=t&&t.sheet&&t.sheet._getHost(),r&&r.removeChild(i)))},r.prototype.updateEditor=function(n,t,i,r){n&&$(n).width(i.width).height(i.height)},r.prototype.updateImeMode=function(n,i,r){t.prototype.updateImeMode.call(this,n,i,r)},r.prototype.getHitInfo=function(n,t,i,r,u){return null},r.prototype.processMouseDown=function(n){},r.prototype.processMouseMove=function(n){},r.prototype.processMouseUp=function(n){},r.prototype.processMouseEnter=function(n){},r.prototype.processMouseLeave=function(n){},r.prototype.isReservedKey=function(n,t){return!1},r.prototype.processKeyDown=function(n,t){return!1},r.prototype.processKeyUp=function(n,t){return!1},r.prototype.isEditingValueChanged=function(n,t,i){return n!==t},r.prototype.getAutoFitWidth=function(t,i,r,u,f){return n.CellTypeContext.getAutoFitWidth(t,i,r,u,f)},r.prototype.getAutoFitHeight=function(t,i,r,u,f){return n.CellTypeContext.getAutoFitHeight(t,i,r,u,f)},r.prototype.isImeAware=function(n){return!1},r.prototype.toJSON=function(){var t={};for(var n in this)this.hasOwnProperty(n)&&(t[n]=this[n]);return t},r.prototype.fromJSON=function(n){if(n)for(var t in n)n[t]!==i&&(this[t]=n[t])},r}(n.BaseCellType);n.CustomCellType=oi;var nt=17,ur=20,p=1,at=4,si=2,hi=at,fr=function(r){function u(){r.call(this);var n=this;n.typeName="7";n._editorValueType=0;n._items=[];n._itemHeight=22;n._editable=!1;n._autoFormatValue=!1;n._hasInPlaceEditor=!1}return __extends(u,r),u.prototype.editorValueType=function(n){return arguments.length===0?this._editorValueType:(this._editorValueType=n,this)},u.prototype.items=function(n){return arguments.length===0?this._items:(this._items=n,this)},u.prototype.itemHeight=function(n){return arguments.length===0?this._itemHeight:(this._itemHeight=n,this)},u.prototype.editable=function(n){return arguments.length===0?this._editable:(this._editable=n,this)},u.prototype.isReservedKey=function(n,t){return this._hasInPlaceEditor?!0:!1},u.prototype.paint=function(t,i,r,u,f,e,o,s){var h,c;t&&(n.CellTypeContext.paintBackground(t,r,u,f,e,o.backColor,o.backgroundImage,o.backgroundImageLayout,s.imageLoader),h=n.CellTypeContext.paintConditionalFormats(t,i,r,u,f,e,o,s),s.showBarIconOnly=h,n.CellTypeContext.paintSparkline(t,r,u,f,e,s.sparkline),c=n.CellTypeContext.paintSparklineEx(t,i,r,u,f,e,s.sheet),s.cellOverflowLayout||h||c||this.paintValue(t,i,r,u,f,e,o,s))},u.prototype.paintValue=function(n,t,i,u,f,e,o,s){var h=nt,c=l(0,f-h-1);o.hAlign!==3||this._autoFormatValue||(o.hAlign=0);o.wordWrap&&(o.wordWrap=!1);c>0&&e>0&&r.prototype.paintValue.call(this,n,this.getText(t,s),i,u,c,e,o,s);n.save();(h>f||h>e)&&(n.rect(i,u,f,e),n.clip());n.beginPath();n.beginPath();n.lineWidth=2;n.fillStyle="#000000";n.moveTo(i+f-h+4,u+(e-2)/2-2.5);n.lineTo(i+f-h+7,u+(e-2)/2+3.5);n.lineTo(i+f-h+10,u+(e-2)/2-2.5);n.fill();n.restore()},u.prototype.getText=function(n,t){return n},u.prototype.createEditorElement=function(t){var f=t&&t.sheet&&t.sheet.parent&&t.sheet.parent._host,e=n.util.getPreferredZIndex(f)+1e3,u=t.sheet.defaults,i=new sr(0,0,u.colWidth,u.rowHeight,e),r;return i.editorValueType(this._editorValueType),i.items(this._items),i.itemHeight(this._itemHeight),i.editable(this._editable),r=i.getComboBox(),Object.defineProperty(r,"comboBox",{value:i,writable:!1}),r},u.prototype.getEditorValue=function(n,t){var i=n.comboBox;return i&&(this._autoFormatValue=!i._isEditorValueInItems),i&&i.editorValue()},u.prototype.setEditorValue=function(n,t,i){var r=n.comboBox;r&&r.editorValue(t)},u.prototype.focus=function(n,t){if(n){var i=n.comboBox;i&&i.focus()}},u.prototype.selectAll=function(n,t){if(n){var i=n.comboBox;i&&i.selectAll()}},u.prototype.activateEditor=function(t,i,r,u){var f=u.sheet,l=u.row,a=u.col,e=t.comboBox,s,h,c;e&&(e.editorValueType(this._editorValueType),e.items(this._items),e.itemHeight(this._itemHeight),e.editable(this._editable),s=e._dropDownList,s.bind(o,function(t,i){var r=i.keyCode;r===37?(f._editorStatus=1,n.SpreadActions.navigationLeft.apply(f)):r===39?(f._editorStatus=1,n.SpreadActions.navigationRight.apply(f)):r===9?n.SpreadActions.commitInputNavigationTabNext.apply(f):r===13?n.SpreadActions.commitInputNavigationDown.apply(f):r===27?n.SpreadActions.cancelInput.apply(f):i.isMouse===!0&&e._isDisplayMode===!0&&f.endEdit()}),h=e._comboBoxEditor,h.bind(o,function(n,t){t.isMouse===!0&&f.endEdit()}),c=e._dropDownButton,c.bind(o,function(n,t){t.isMouse===!0&&f.endEdit()}));this._hasInPlaceEditor=!0},u.prototype.deactivateEditor=function(n,t){var i,r,u;if(n&&(i=n.comboBox,i)){var f=i._dropDownList,e=i._comboBoxEditor,s=i._dropDownButton;f.unbind(o);e.unbind(o);s.unbind(o);i.closeDropDownList();i._isDisplayMode=!1;r=n._editingLocator;r&&(u=t&&t.sheet&&t.sheet._getHost(),u&&u.removeChild(r))}this._hasInPlaceEditor=!1},u.prototype.updateEditor=function(n,t,i,r){var f=n&&r&&r.sheet,u,e,o,s;f&&(u=n.comboBox,t&&u&&(e=f._render,u.updateStyle(t.backColor,t.foreColor,e._getZoomFont(t.font||e._getDefaultFont()))),i&&u&&(o=f._eventHandler._getCanvasPosition(),s=f._bounds,u.updateLocationAndSize(o.left+s.x+i.x-1,o.top+s.y+i.y-1,i.width+1,i.height+1)))},u.prototype.format=function(n,u,f,e){var v=this,l=v._editorValueType,s=v._items,a,h,c,o;if(s&&(a=s.length,l!==0))if(l===1)h=parseInt(n),0<=h&&h<a&&(o=s[h],o!==i&&o!==t&&(n=o.hasOwnProperty("text")?o.text:o));else if(l===2)for(c=0;c<a;c++)if(o=s[c],o&&o.hasOwnProperty("value")&&o.value===n){n=o.text;break}return r.prototype.format.call(this,n,u,f)},u.prototype.parse=function(n,t,i){var c=this,s=c._editorValueType,o=c._items,e=r.prototype.parse.call(this,n,t),h,f,u;if(o)if(h=o.length,s===0)return e;else if(s===1){for(f=0;f<h;f++)if(u=o[f],u&&u.hasOwnProperty("text")&&u.text===e||u===e)return f}else if(s===2)for(f=0;f<h;f++)if(u=o[f],u&&u.hasOwnProperty("text")&&u.text===e)return u.value;return e},u.prototype.getHitInfo=function(n,r,u,f,e){var o,c,s,h;return e?(o=e.sheetArea,c=e.sheet,(o===t||o===i||o===3)&&f)?(s=f.x+f.width,h={x:n,y:r,row:e.row,col:e.col,cellStyle:u,cellRect:f,sheetArea:o,sheet:c},s-nt<=n&&n<s&&(h.isReservedLocation=!0),h):t:t},u.prototype.processMouseDown=function(n){var u=n.sheet,f=n.sheetArea,e,r,o;(f===t||f===i||f===3)&&n.isReservedLocation&&u&&(u.startEdit(),e=u._editor,r=e&&e.comboBox,r&&(o=$.browser&&$.browser.mozilla,o&&(r._dropDownButton._showTime=(new Date).valueOf()),r.showDropDownList(),r._isDisplayMode=!0))},u.prototype.getAutoFitWidth=function(t,i,r,u,f){var e=n.CellTypeContext.getAutoFitWidth(t,i,r,u,f);return e+nt},u.prototype.getAutoFitHeight=function(t,i,r,u,f){return n.CellTypeContext.getAutoFitHeight(t,i,r,u,f)},u.prototype.isImeAware=function(n){return!0},u.prototype._isDefaultValue=function(n,t){switch(n){case"editorValueType":return t===0;case"items":return t===[];case"itemHeight":return t===22;case"editable":return t===!1;default:return!1}},u.prototype.toJSON=function(){var n=this,r={typeName:n.typeName,editorValueType:n.editorValueType(),items:n.items(),itemHeight:n.itemHeight(),editable:n.editable()},u={},t,i;for(t in r)i=r[t],n._isDefaultValue(t,i)||(u[t]=i);return u},u.prototype.fromJSON=function(n,r){n&&(n.editorValueType!==t&&n.editorValueType!==i&&this.editorValueType(n.editorValueType),n.items!==t&&n.items!==i&&this.items(n.items),n.itemHeight!==t&&n.itemHeight!==i&&this.itemHeight(n.itemHeight),n.editable!==t&&n.editable!==i&&this.editable(n.editable))},u}(n.BaseCellType);n.ComboBoxCellType=fr;var ci="click",er="mouseenter",or="mouseleave",bt="keydown",kr="keyup",o="EndEdit"+v,sr=function(){function n(n,t,i,u,o){var s=this,c,h;s._DOMObject=f.createElement("div");s._DOMObject.className="gcComboBox";s._bindEvent();s._setDefaultCSS(o);$(s._DOMObject).css(r,n).css(e,t).css(b,i).css(y,u);c=l(0,i-nt);s._comboBoxEditor=new hr(this,0,0,c,u);s._comboBoxEditor.appendTo(this._DOMObject);s._dropDownButton=new cr(this,c,0,i-c,u);s._dropDownButton.appendTo(this._DOMObject);h=new ar(0,u-2*p,i-2*p,u,o);h.bind(h.CloseDropDown,function(){s._comboBoxEditor.focus()});h.bind(h.ShowDropDown,function(){s._comboBoxEditor.focus()});h.bind(h.SelectedIndexChanged,function(n){s.onSelectedIndexChanged(n)});h.appendTo(this._DOMObject);s._dropDownList=h;s._editorValueType=0;s._items=[]}return n.prototype._bindEvent=function(){var n=this,t=$(this._DOMObject);t.bind(bt,function(t){n._onKeydown.call(n,t)})},n.prototype._onKeydown=function(n){this._dropDownList&&this._dropDownList._onKeydown(n)},n.prototype._setDefaultCSS=function(n){$(this._DOMObject).css(s,h).css(ht,n||0).attr(d,"gcComboBox")},n.prototype.getComboBox=function(){return this._DOMObject},n.prototype.updateLocationAndSize=function(n,t,i,u){var f,o;$(this._DOMObject).css(r,n).css(e,t).css(b,i).css(y,u);f=l(0,i-nt);this._comboBoxEditor.updateLocationAndSize(0,0,f,u);this._dropDownButton.updateLocationAndSize(f,0,i-f,u);o=this._dropDownList;o.updateLocation(0,u-2*p);o.width(i-2*p);o._updateItemWidth()},n.prototype.updateStyle=function(n,t,i){this._comboBoxEditor.updateStyle(n,t,i);this._dropDownButton.updateStyle(n,t,i);this._dropDownList.updateStyle(n,t,i)},n.prototype.isDropDownListShown=function(){return this._dropDownList.isShown()},n.prototype.showDropDownList=function(){this._dropDownList.show()},n.prototype.closeDropDownList=function(){this._dropDownList.close()},n.prototype.toggleDropDownListShow=function(){this._dropDownList.toggleShow()},n.prototype.items=function(n){return arguments.length===0?this._items:(this._items=n,this._dropDownList.items(n),this)},n.prototype.itemHeight=function(n){return arguments.length===0?this._dropDownList.itemHeight():(this._dropDownList.itemHeight(n),this)},n.prototype.editable=function(n){return arguments.length===0?this._comboBoxEditor.editable():(this._comboBoxEditor.editable(n),this)},n.prototype.editorValueType=function(n){return arguments.length===0?this._editorValueType:(this._editorValueType=n,this)},n.prototype.editorValue=function(n){return arguments.length===0?this._editorValue:(n!==this._editorValue&&(this._editorValue=n,this._updateEditorValue(n)),this)},n.prototype._updateEditorValue=function(n){var t=this,i=t.valueToText(n);t._comboBoxEditor.text(i);t._dropDownList.selectByText(i)},n.prototype.valueToText=function(n){var u,f=this,s=f._items,h=s.length,c=f._editorValueType,e,o,r;f._isEditorValueInItems=!0;switch(c){case 1:r=s[n];u=r&&r.hasOwnProperty("text")?r.text:r;u===i&&(u=n,f._isEditorValueInItems=!1);break;case 0:for(u=n,e=0;e<h;e++)if(r=s[e],r&&r.hasOwnProperty("text")&&r.text===n||r===n)break;e>=h&&(f._isEditorValueInItems=!1);break;case 2:for(o=0;o<h;o++)if(r=s[o],r&&r.hasOwnProperty("value")&&r.value===n){u=r.text;break}o>=h&&(u=n,f._isEditorValueInItems=!1);break;default:break}return(n===t||n===i)&&(u=""),u},n.prototype.textToValue=function(n){var s=this,e=s._items,h=e.length,o=s._editorValueType,u=n,r,f,t;if(o!==0)if(o===1)for(r=0;r<h;r++)t=e[r],(t&&t.hasOwnProperty("text")&&t.text===n||t===n)&&(u=r);else if(o===2)for(f=0;f<h;f++)t=e[f],t&&t.hasOwnProperty("text")&&t.text===n?u=t.value:t===n&&(u=i);return u},n.prototype.onSelectedIndexChanged=function(n){var r=this,f=r._dropDownList,e=f.selectedIndex(),u=f.getSelectedValue(e,r._items,r._editorValueType);u!==t&&u!==i&&r.editorValue(u)},n.prototype.autoSelectByText=function(n){var t,r,u,i;if(n){for(r=this._items,u=r.length,t=0;t<u;t++)if(i=r[t],i.hasOwnProperty("text")&&(i=i.text),i.toString().substr(0,n.length)===n)break;t>=u&&(t=-1)}else t=-1;this._dropDownList.setSelectedIndexInternal(t)},n.prototype.focus=function(){this._comboBoxEditor.focus()},n.prototype.selectAll=function(){this._comboBoxEditor.selectAll()},n}(),hr=function(){function n(n,t,i,r,u){var e=this;e._comboBox=n;e._editable=!1;e._divObject=f.createElement("div");e._textareaObject=f.createElement("textarea");e._DOMObject=e._divObject;e._DOMObject.className="gcComboBoxEditor";e._setDefaultCSS();e._bindEvent();e.updateLocationAndSize(t,i,r,u)}return n.prototype._setDefaultCSS=function(){var n=p+"px solid black";$(this._DOMObject).css(tt,0).css(rt,"hidden").css(pt,a).css(s,h).css("border-bottom",n).css("border-left",n).css("border-top",n).css(st,si+"px 0px 0px "+at+"px").css(ft,a).css(u,"white").css(lt,"nowrap").css(g,"content-box").attr(d,"gcComboBoxEditor").attr(et,-1)},n.prototype._bindEvent=function(){var n=this;$(this._textareaObject).bind({keyup:function(t){var i=n._DOMObject.value,r;n._text=i;r=n._comboBox.textToValue(i);n._comboBox.editorValue(r);n._comboBox.autoSelectByText(i);n._removeTip()},mouseenter:function(){n._updateTip()},mouseleave:function(){n._removeTip()}});$(this._divObject).bind({click:function(t){n._comboBox._isDisplayMode?n._trigger(o,{isMouse:!0}):n._comboBox.toggleDropDownListShow()},mouseenter:function(){n._updateTip()},mouseleave:function(){n._removeTip()}})},n.prototype._removeTip=function(){$(this._DOMObject).removeAttr("title")},n.prototype._updateTip=function(){if(this._comboBox&&this._comboBox._dropDownList){var t=this._comboBox._dropDownList.measureText(this._text),n=$(this._DOMObject),i=n.width();t>i+at?n.attr("title",this._text):n.removeAttr("title")}},n.prototype.updateLocationAndSize=function(n,t,i,u){i-=p;u-=2*p;$(this._DOMObject).css(r,n).css(e,t).css(b,i-at).css(y,u-si)},n.prototype._getLocationAndSize=function(){var n=$(this._DOMObject);return{left:parseInt(n.css(r)),top:parseInt(n.css(e)),width:parseInt(n.css(b)),height:parseInt(n.css(y))}},n.prototype._getStyle=function(){var n=$(this._DOMObject);return{backColor:n.css(u),foreColor:n.css(k),font:n.css(c)}},n.prototype.updateStyle=function(n,t,i){$(this._DOMObject).css(u,n).css(k,t).css(c,i)},n.prototype.appendTo=function(n){n.appendChild(this._DOMObject)},n.prototype.editable=function(n){if(arguments.length===0)return this._editable;else if(this._editable!==n)return this._editable=n,this._changeEditor(n),this},n.prototype._changeEditor=function(n){var t=this,u=t._comboBox.getComboBox(),i=t._getLocationAndSize(),r=t._getStyle();u.removeChild(t._DOMObject);t._DOMObject=n?t._textareaObject:t._divObject;$(t._DOMObject).appendTo(u);t._setDefaultCSS();t.updateStyle(r.backColor,r.foreColor,r.font);t.updateLocationAndSize(i.left,i.top,i.width,i.height)},n.prototype.text=function(n){if(arguments.length===0)return this._text;else if(n!==this._text){this._text=n;var t=this._DOMObject.tagName.toUpperCase();t==="DIV"?this._DOMObject.textContent=n:this._DOMObject.value=n}},n.prototype.focus=function(){var n=this._DOMObject;n.focus();n.tagName.toUpperCase()==="TEXTAREA"&&(n.selectionStart=n.value.length)},n.prototype.selectAll=function(){var n=this._DOMObject;n.tagName.toUpperCase()==="TEXTAREA"&&n.select()},n.prototype.bind=function(n,t,i){$(this._DOMObject).bind(n,t,i)},n.prototype.unbind=function(n,t){$(this._DOMObject).unbind(n,t)},n.prototype._trigger=function(n,t){$(this._DOMObject).trigger(n,t)},n}(),cr=function(){function n(n,t,i,r,u){this._comboBox=n;this._DOMObject=f.createElement("div");this._DOMObject.className="gcDropDownButton";this._setDefaultCSS();this._bindEvent();var e=f.createElement("canvas");e.className="gcDropDownButtonIcon";this._canvas=e;this.updateLocationAndSize(t,i,r,u);this._DOMObject.appendChild(e)}return n.prototype._setDefaultCSS=function(){var n=p+"px solid black";$(this._DOMObject).css("border-top",n).css("border-right",n).css("border-bottom",n).css(s,h).css(u,"white").css(g,"content-box").attr(d,"gcDropDownButton")},n.prototype._bindEvent=function(){var n=this;$(this._DOMObject).bind(ci,function(t){var r,u;n._showTime!==i&&(r=n._showTime,n._showTime=i,u=(new Date).valueOf(),u-r<100)||(n._comboBox._isDisplayMode?n._trigger(o,{isMouse:!0}):n._comboBox.toggleDropDownListShow())})},n.prototype._paintIcon=function(){var t=this._canvas;if(t){var i=t.width,r=t.height,n=t.getContext("2d");n.beginPath();n.lineWidth=2;n.fillStyle="#000000";n.moveTo(i-nt+4,(r-2)/2-2.5);n.lineTo(i-nt+7,(r-2)/2+3.5);n.lineTo(i-nt+10,(r-2)/2-2.5);n.fill()}},n.prototype.updateLocationAndSize=function(n,t,i,u){i-=p;u-=2*p;$(this._DOMObject).css(r,n).css(e,t).css(b,i).css(y,u);$(this._canvas).attr(b,i).attr(y,u);this._paintIcon()},n.prototype.updateStyle=function(n,t,i){$(this._DOMObject).css(u,n).css(k,t).css(c,i)},n.prototype.appendTo=function(n){n.appendChild(this._DOMObject)},n.prototype.bind=function(n,t,i){$(this._DOMObject).bind(n,t,i)},n.prototype.unbind=function(n,t){$(this._DOMObject).unbind(n,t)},n.prototype._trigger=function(n,t){$(this._DOMObject).trigger(n,t)},n}(),lr=function(){function n(n,t,i,r,u){this._DOMObject=f.createElement("div");this._isShown=!1;this._setDefaultCSS(u);this._width=i;this._height=r;$(this._DOMObject).css(b,i).css(y,r);this.updateLocation(n,t)}return n.prototype._setDefaultCSS=function(n){$(this._DOMObject).css(s,h).css(ut,"1px solid").css(u,"white").css(ht,n||0).css(ft,a).css("display","none").css("cursor","default").css(g,"content-box").attr(d,"gcDropDownWindow").attr(et,-1)},n.prototype.show=function(){this.isShown(!0)},n.prototype.close=function(){this.isShown(!1)},n.prototype.toggleShow=function(){this.isShown(!this._isShown)},n.prototype.isShown=function(n){return arguments.length===0?this._isShown:(n!==this._isShown&&(this._isShown=n,this._updateIsShown()),this)},n.prototype._updateIsShown=function(){this._isShown?this._show():this._close()},n.prototype._show=function(){$(this._DOMObject).show()},n.prototype._close=function(){$(this._DOMObject).hide()},n.prototype.width=function(n){if(arguments.length===0)return this._width;else n>0&&(this._width=n,this._updateWidth())},n.prototype._updateWidth=function(){$(this._DOMObject).css(b,this._width)},n.prototype.height=function(n){if(arguments.length===0)return this._height;else n>0&&(this._height=n,this._updateHeight())},n.prototype._updateHeight=function(){$(this._DOMObject).css(y,this._height)},n.prototype.font=function(n){if(arguments.length===0)return this._font;else this._font=n,this._updateFont()},n.prototype._updateFont=function(){$(this._DOMObject).css(c,this._font)},n.prototype.updateLocation=function(n,t){$(this._DOMObject).css(r,n).css(e,t)},n.prototype.updateStyle=function(n,t,i){$(this._DOMObject).css(u,n).css(k,t);this.font(i)},n.prototype.appendTo=function(n){n.appendChild(this._DOMObject)},n}(),ar=function(r){function e(t,i,u,e,o){r.call(this,t,i,u,e,o);this._itemCount=0;this.SCROLLBAR_SIZE=18;this.HOVER_COLOR="lightgrey";this.SELECTED_COLOR="#1E90FF";this.ShowDropDown="ShowDropDown"+v;this.CloseDropDown="CloseDropDown"+v;this.SelectedIndexChanged="SelectedIndexChanged"+v;this._DOMObject.className="gcDropDownList";this._divList=f.createElement("div");this._divList.className="gcDivList";this._DOMObject.appendChild(this._divList);this._scrollablePanel=new n.ScrollablePanel(this._DOMObject,this._divList);this._itemHeight=22;this._itemCountPerPage=ur;this._selectedIndex=-1}return __extends(e,r),e.prototype._show=function(){r.prototype._show.call(this);this._bindEvent();this._isNeedVScrollbar=!1;this._updateItemHeight();this._updateItemWidth();this._isNeedVScrollbar&&(this._scrollablePanel.verticalSmallChange($(this._divList).children().height()),this._scrollablePanel.refreshLayout(!1));this._addSelectedEffect();this._trigger(this.ShowDropDown,{})},e.prototype._close=function(){this._unbindEvent();this._removeSelectedEffect();r.prototype._close.call(this);this._trigger(this.CloseDropDown,{})},e.prototype.items=function(n){if(arguments.length===0)return this._items;else if(n)return this._items=n,this._updateItems(),this},e.prototype._updateItems=function(){this._removeDivListItems();this._addAllItems()},e.prototype._appendMeasureSpanToBody=function(){this._measureSpan=f.createElement("span");$(this._measureSpan).css("display","none").css(c,this.font());f.body.appendChild(this._measureSpan)},e.prototype._removeMeasureSpanFromBody=function(){f.body.removeChild(this._measureSpan)},e.prototype._measureTextWidth=function(n){return this._measureSpan.textContent=n,$(this._measureSpan).width()+2+hi},e.prototype._measureTextHeight=function(n){return this._measureSpan.textContent=n,$(this._measureSpan).height()},e.prototype._addAllItems=function(){var i=this._items,n,r,t;if(i)for(n=0,r=i.length;n<r;n++)t=i[n],this._addItem(t.hasOwnProperty("text")?t.text:t)},e.prototype._addItem=function(n){var u="gcItem"+this._itemCount,t=f.createElement("div"),i,r;t.className=u;i=f.createElement("span");i.textContent=n.toString();i.style.paddingLeft=hi+"px";t.appendChild(i);this._divList.appendChild(t);this._itemCount++;r=this;$(t).bind(ci,function(n){r._onMouseClickItem(this,n)}).bind(er,function(n){r._onMouseEnterItem(this,n)}).bind(or,function(n){r._onMouseLeaveItem(this,n)})},e.prototype._onMouseClickItem=function(n,t){var i=$(n).index();this.selectedIndex(i);this.close();this._trigger(o,{isMouse:!0})},e.prototype._onMouseEnterItem=function(n,t){var i=$(n);n.oldBackColor=i.css(u);i.css(u,this.HOVER_COLOR)},e.prototype._onMouseLeaveItem=function(n,t){$(n).css(u,n.oldBackColor||"")},e.prototype._addSelectedEffect=function(){var n=this._selectedIndex;0<=n&&n<this._itemCount&&($(this._divList).children("div:nth("+n+")").css(u,this.SELECTED_COLOR),this.scrollToIndex(n))},e.prototype._removeSelectedEffect=function(){var n=this._selectedIndex;0<=n&&n<this._itemCount&&$(this._divList).children("div:nth("+n+")").css(u,"")},e.prototype._bindEvent=function(){var n=this;$(this._DOMObject).bind(bt,function(t){n._onKeydown.call(n,t)})},e.prototype._unbindEvent=function(){$(this._DOMObject).unbind(bt)},e.prototype._onKeydown=function(n){this._navigation(n)},e.prototype._navigation=function(t){if(!t.ctrlKey&&!t.shiftKey&&!t.altKey){var f=this.isShown(),e=1,u=this._itemCount,r=this._selectedIndex,i=0;switch(t.which){case 38:r>=0&&r<u&&(i=r-e);i>=0&&i<u&&this.selectedIndex(i);f&&this.scrollToIndex(i);n.util.cancelDefault(t);break;case 40:r>=0&&r<u&&(i=r+e);i>=0&&i<u&&this.selectedIndex(i);f&&this.scrollToIndex(i);n.util.cancelDefault(t);break;case 13:this.selectedIndex(this._selectedIndex);this.close();this._trigger(o,{keyCode:t.keyCode});n.util.cancelDefault(t);break;case 27:this.close();this._trigger(o,{keyCode:t.keyCode});n.util.cancelDefault(t);break;case 37:this.selectedIndex(this._selectedIndex);this.close();this._trigger(o,{keyCode:t.keyCode});n.util.cancelDefault(t);break;case 39:this.selectedIndex(this._selectedIndex);this.close();this._trigger(o,{keyCode:t.keyCode});n.util.cancelDefault(t);break;case 9:this.selectedIndex(this._selectedIndex);this.close();this._trigger(o,{keyCode:t.keyCode});n.util.cancelDefault(t);break;default:break}}},e.prototype._removeDivListItems=function(){while(this._divList.firstChild)this._divList.removeChild(this._divList.firstChild);this._itemCount=0},e.prototype.getSelectedValue=function(n,r,u){var f=r[n],e;if(f!==t&&f!==i)switch(u){case 1:e=n;break;case 0:e=f.hasOwnProperty("text")?f.text:f;break;case 2:f.hasOwnProperty("value")&&(e=f.value);break;default:break}return e},e.prototype.setSelectedIndexInternal=function(n){this._removeSelectedEffect();this._selectedIndex=n;this._addSelectedEffect()},e.prototype.selectedIndex=function(n){if(arguments.length===0)return this._selectedIndex;else 0<=n&&n<this._itemCount&&(this.setSelectedIndexInternal(n),this._trigger(this.SelectedIndexChanged,{}))},e.prototype.selectByText=function(n){var r=this._items,t,i;if(r){for(t=0;t<r.length;t++)if(i=r[t],i.hasOwnProperty("text")&&(i=i.text),n===i)break;this.setSelectedIndexInternal(t)}},e.prototype.itemCountPerPage=function(n){if(arguments.length===0)return this._itemCountPerPage;else n>0&&(this._itemCountPerPage=n)},e.prototype._recalcHeight=function(n,t){var i,r=this._itemCount;r<=t?i=r*n:(i=t*n,this._isNeedVScrollbar=!0);this.height(i)},e.prototype.measureText=function(n){this._appendMeasureSpanToBody();var t=this._measureTextWidth(n);return this._removeMeasureSpanFromBody(),t},e.prototype.getLongestItemWidth=function(){var n,u,t,i,f,r;if(this._appendMeasureSpanToBody(),n=0,t=this._items,t)for(i=0,f=t.length;i<f;i++)r=t[i],u=this._measureTextWidth(r.hasOwnProperty("text")?r.text:r),u>n&&(n=u);return this._removeMeasureSpanFromBody(),n},e.prototype._updateWidth=function(){r.prototype._updateWidth.call(this);this._scrollablePanel.refreshLayout(!1)},e.prototype._updateHeight=function(){r.prototype._updateHeight.call(this);this._scrollablePanel.refreshLayout(!1)},e.prototype.itemHeight=function(n){if(arguments.length===0)return this._itemHeight;else n>0&&(this._itemHeight=n)},e.prototype._updateItemHeight=function(){var n,r;this._appendMeasureSpanToBody();n=this._items[0];(n===t||n===i)&&(n="");r=l(this._itemHeight,this._measureTextHeight(n));$(this._divList).children().css(y,r);this._recalcHeight(r,this._itemCountPerPage);this._removeMeasureSpanFromBody()},e.prototype._updateItemWidth=function(){var t=this.getLongestItemWidth(),n=0;this._isNeedVScrollbar===!0&&(n=this.SCROLLBAR_SIZE);this.width()<t+n&&this.width(t+n)},e.prototype.scrollToIndex=function(n){if(n>=0&&n<this._itemCount){var t=this._divList.childNodes[n];this._scrollablePanel.scrollChildIntoView(t)}},e.prototype.bind=function(n,t,i){$(this._DOMObject).bind(n,t,i)},e.prototype.unbind=function(n,t){$(this._DOMObject).unbind(n,t)},e.prototype._trigger=function(n,t){$(this._DOMObject).trigger(n,t)},e}(lr)})(n.Sheets||(n.Sheets={}));var t=n.Sheets})(GcSpread||(GcSpread={}))
