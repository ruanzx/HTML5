/*
 *
 * SpreadJS Library 8.40.20151.0
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License. 
 * spread.sales@grapecity.com
 * http://spread.grapecity.com/Pages/Spread-JS-License/
 *
 *
 **/
var __extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},GcSpread;(function(n){(function(n){var dt,gt,o,w,d,c,yt,g,nt,pt,tt,it,b,rt,ut,wt,ft,p,et,ot,k,st,ht,u,l,ct,lt,at,s,vt,bt,kt;n.feature("conditionalFormat",["core.common","core.globalize","core.stringResource","core.theme","core.imageLoader"]);var t=null,i=undefined,h="undefined",f=Math.min,e=Math.max,a=Math.abs,v=Math.floor,r=n.Calc.Convert,y=n.StringHelper.TrimStart;(function(n){n[n.RelationCondition=0]="RelationCondition";n[n.NumberCondition=1]="NumberCondition";n[n.TextCondition=2]="TextCondition";n[n.ColorCondition=3]="ColorCondition";n[n.FormulaCondition=4]="FormulaCondition";n[n.DateCondition=5]="DateCondition";n[n.DateExCondition=6]="DateExCondition";n[n.TextLengthCondition=7]="TextLengthCondition";n[n.Top10Condition=8]="Top10Condition";n[n.UniqueCondition=9]="UniqueCondition";n[n.AverageCondition=10]="AverageCondition";n[n.CellValueCondition=11]="CellValueCondition";n[n.AreaCondition=12]="AreaCondition"})(n.ConditionType||(n.ConditionType={}));dt=n.ConditionType,function(n){n[n.ConditionRuleBase=0]="ConditionRuleBase";n[n.CellValueRule=1]="CellValueRule";n[n.SpecificTextRule=2]="SpecificTextRule";n[n.FormulaRule=3]="FormulaRule";n[n.DateOccurringRule=4]="DateOccurringRule";n[n.Top10Rule=5]="Top10Rule";n[n.UniqueRule=6]="UniqueRule";n[n.DuplicateRule=7]="DuplicateRule";n[n.AverageRule=8]="AverageRule";n[n.ScaleRule=9]="ScaleRule";n[n.TwoScaleRule=10]="TwoScaleRule";n[n.ThreeScaleRule=11]="ThreeScaleRule";n[n.DataBarRule=12]="DataBarRule";n[n.IconSetRule=13]="IconSetRule"}(n.RuleType||(n.RuleType={}));gt=n.RuleType;o=function(){function i(n){var i=this;i.condition=t;i.ranges=t;i.style=t;i._priority=1;i._stopIfTrue=!1;i.style=n}return i.prototype.hasNoReference=function(){return!(this.ranges&&this.ranges.length>0)},i.prototype.evaluate=function(n,i,r,u){var f=this,e,o;return f.contains(i,r)?(f.initCondition(),e={baseRow:0,baseCol:0},f.getBaseCoordinate(e),f.condition.adjustOffset(i-e.baseRow,r-e.baseCol),o=t,f.condition.evaluate(n,i,r,u)&&(o=f.getExpected()),f.condition.adjustOffset(0,0),o):t},i.prototype.contains=function(n,t){var r=this.ranges,u,f,i;if(r)for(u=r.length,i=0;i<u;i++)if(f=this.ranges[i],f.contains(n,t))return!0;return!1},i.prototype.createCondition=function(){return null},i.prototype.initCondition=function(){this.condition||(this.condition=this.createCondition())},i.prototype.priority=function(){return this._priority},i.prototype.stopIfTrue=function(n){return arguments.length===0?this._stopIfTrue:(this._stopIfTrue=n,this)},i.prototype.getExpected=function(){return this.style},i.prototype.reset=function(){var n=this;n.ranges=t;n.condition=t;n.style=t;n._stopIfTrue=!1;n._priority=1},i.prototype.intersects=function(n,t,i,r){var f=this.ranges,e,o,u;if(f)for(e=f.length,u=0;u<e;u++)if(o=f[u],o.intersect(n,t,i,r))return!0;return!1},i.prototype.isScaleRule=function(){return!1},i.prototype.getBaseCoordinate=function(n){var t,i,r;if(n.baseRow=Number.MAX_VALUE,n.baseCol=Number.MAX_VALUE,t=this,t.ranges&&t.ranges.length>0)for(i=0;i<t.ranges.length;i++)r=t.ranges[i],n.baseRow=f(r.row,n.baseRow),n.baseCol=f(r.col,n.baseCol);else n.baseRow=0,n.baseCol=0},i.prototype._addRows=function(t,i){var f=this,e,u,r;if(f.ranges)for(e=f.ranges.length,u=0;u<e;u++)r=f.ranges[u],r.row>=t?f.ranges[u]=new n.Range(r.row+i,r.col,r.rowCount,r.colCount):r.row<t&&t<r.row+r.rowCount&&(f.ranges[u]=new n.Range(r.row,r.col,r.rowCount+i,r.colCount))},i.prototype._addColumns=function(t,i){var f=this,e,u,r;if(f.ranges)for(e=f.ranges.length,u=0;u<e;u++)r=f.ranges[u],r.col>=t?f.ranges[u]=new n.Range(r.row,r.col+i,r.rowCount,r.colCount):r.col<t&&t<r.col+r.colCount&&(f.ranges[u]=new n.Range(r.row,r.col,r.rowCount,r.colCount+i))},i.prototype._removeRows=function(t,i){var u=this,o,c,e,r,s,l,h,a;if(u.ranges){for(o=[],c=u.ranges.length,e=0;e<c;e++)r=u.ranges[e],r.row>t?r.row+r.rowCount<=t+i?o.push(r):u.ranges[e]=new n.Range(r.row-i,r.col,r.rowCount,r.colCount):r.row<=t&&t<r.row+r.rowCount&&(s=new n.Range(r.row,r.col,r.rowCount-f(r.row+r.rowCount-t,i),r.colCount),s.colCount===0||s.rowCount===0?o.push(r):u.ranges[e]=s);for(l=o.length,h=0;h<l;h++)a=o[h],n.ArrayHelper.remove(u.ranges,a)}},i.prototype._removeColumns=function(t,i){var u=this,o,c,e,r,s,l,h,a;if(u.ranges){for(o=[],c=u.ranges.length,e=0;e<c;e++)r=u.ranges[e],r.col>t?r.col+r.colCount<=t+i?o.push(r):u.ranges[e]=new n.Range(r.row,r.col-i,r.rowCount,r.colCount):r.col<=t&&t<r.col+r.colCount&&(s=new n.Range(r.row,r.col,r.rowCount,r.colCount-f(r.col+r.colCount-t,i)),s.colCount===0||s.rowCount===0?o.push(r):u.ranges[e]=s);for(l=o.length,h=0;h<l;h++)a=o[h],n.ArrayHelper.remove(u.ranges,a)}},i.prototype._isDefaultValue=function(n,i){switch(n){case"ranges":return i===t;case"style":return i===t;case"priority":return i===1;case"stopIfTrue":return i===!1;default:return!1}},i.prototype.toJSON=function(){},i.prototype.fromJSON=function(n,t){},i}();n.ConditionRuleBase=o;w=function(){function n(n,i,r){var u=this;u.conditionType="RelationCondition";u.compareType=1;u.item1=t;u.item2=t;u.ignoreBlank=!1;u._dict=t;u.compareType=n;u.item1=i;u.item2=r}return n.prototype.adjustOffset=function(n,t){},n.prototype.create=function(t,i,r){return new n(t,i,r)},n.prototype._getActualValue=function(n,t,i,r,u){if(n&&t&&t.conditionType==="ColorCondition"){var f=n.getActualStyle(i,r);f&&(t.compareType===0?u=f.backColor:t.compareType===1&&(u=f.foreColor))}return u},n.prototype.evaluate=function(n,r,u,f,e){var o=this,h,c,s;if(o.item1&&(o.item1.ignoreBlank=o.ignoreBlank,h=arguments.length<5?o._getActualValue(n,o.item1,r,u,f):f),o.item2&&(o.item2.ignoreBlank=o.ignoreBlank,c=arguments.length<5?o._getActualValue(n,o.item2,r,u,f):e),o.compareType===1)return(s=o.item1===i||o.item1===t?!1:o.item1.evaluate(n,r,u,h),!s)?!1:o.item2===i||o.item2===t?!1:o.item2.evaluate(n,r,u,c);else if(o.compareType===0)return(s=o.item1===i||o.item1===t?!1:o.item1.evaluate(n,r,u,h),s)?!0:o.item2===i||o.item2===t?!1:o.item2.evaluate(n,r,u,c);return!1},n.prototype.reset=function(){var n=this;n.ignoreBlank=!1;n.compareType=1;n.item1=t;n.item2=t},n.prototype._getConditionTypeDictionary=function(){if(!this._dict){var t={};t[0]=n;t[1]=yt;t[2]=nt;t[3]=pt;t[4]=it;t[5]=b;t[6]=ut;t[7]=wt;t[8]=p;t[9]=k;t[10]=ht;t[11]=c;t[12]=bt;this._dict=t}return this._dict},n.prototype.toJSON=function(){var n=this,e={compareType:n.compareType,item1:n.item1?n.item1.toJSON():t,item2:n.item2?n.item2.toJSON():t,conType:0,ignoreBlank:n.ignoreBlank},u={},r,f;for(r in e)f=e[r],n._isDefaultValue(r,f)||(u[r]=f);return $.isEmptyObject(u)?i:u},n.prototype._isDefaultValue=function(n,i){switch(n){case"ignoreBlank":return i===!1;case"item1":return i===t;case"item2":return i===t;default:return!1}},n.prototype.fromJSON=function(n,r){var u,e;if(n){if(u=this,n.compareType!==t&&n.compareType!==i&&(u.compareType=n.compareType),n.item1!==t&&n.item1!==i){var f=t,c=u._getConditionTypeDictionary(),o=n.item1.conType;typeof o===h&&(o=0);e=c[o];e&&(f=new e,f.fromJSON(n.item1,r));u.item1=f}if(n.item2!==t&&n.item2!==i){var f=t,c=u._getConditionTypeDictionary(),s=n.item2.conType;typeof s===h&&(s=0);e=c[s];e&&(f=new e,f.fromJSON(n.item2,r));u.item2=f}n.ignoreBlank!==t&&n.ignoreBlank!==i&&(u.ignoreBlank=n.ignoreBlank)}},n.prototype.getFormulas=function(){var n=[],t=this;return t.item1&&t.item1.getFormulas&&(n=this.item1.getFormulas()),t.item2&&t.item2.getFormulas&&(n=n.length>0?n.concat(this.item2.getFormulas()):this.item2.getFormulas()),n},n.prototype.setFormulas=function(n){var t=this,i;t.item1&&t.item1.getFormulas&&t.item2&&t.item2.getFormulas?(i=t.item1.getFormulas().length,i!==0&&t.item1.setFormulas(n.slice(0,i)),t.item2.setFormulas(n.slice(i))):t.item1&&t.item1.setFormulas?t.item1.setFormulas(n):t.item2&&t.item2.setFormulas&&t.item2.setFormulas(n)},n}();n.RelationCondition=w;d=function(r){function u(n,t,i,u){r.call(this,u);this.operator=n;this.value1=typeof t=="string"?$.trim(t):t;this.value2=typeof i=="string"?$.trim(i):i}return __extends(u,r),u.prototype.createCondition=function(){var n=this,e=n.isFormula(n.value1)?y(n.value1,"="):t,h=n.isFormula(n.value1)?t:n.value1,s=n.isFormula(n.value2)?y(n.value2,"="):t,l=n.isFormula(n.value2)?t:n.value2,u,f,i=n.operator,r=t,o;if(i===6)return u=new c(3,n.value1,e),u.treatNullValueAsZero=!0,f=new c(5,n.value2,s),f.treatNullValueAsZero=!0,new w(1,u,f);else if(i===7)return u=new c(4,n.value1,e),u.treatNullValueAsZero=!0,f=new c(2,n.value2,s),f.treatNullValueAsZero=!0,new w(0,u,f);else i===0?r=0:i===2?r=2:i===3?r=3:i===4?r=4:i===5?r=5:i===1&&(r=1);return r!==t?(o=new c(r,n.value1,e),o.treatNullValueAsZero=!0,o):t},u.prototype.reset=function(){var n=this;n.operator=6;n.value1=t;n.value2=t;n.style=t;n._stopIfTrue=!1;n._priority=1},u.prototype.isFormula=function(n){return n!==i&&n!==t&&n[0]==="="},u.prototype.toJSON=function(){var n=this,f={ruleType:1,ranges:n.ranges,style:n.style,operator:n.operator,value1:n.value1,value2:n.value2,priority:n._priority,stopIfTrue:n._stopIfTrue},r={},t,u;for(t in f)u=f[t],n._isDefaultValue(t,u)||(r[t]=u);return $.isEmptyObject(r)?i:r},u.prototype.fromJSON=function(r,u){var f,o,e;if(r){if(f=this,r.ranges)for(f.ranges=[],o=0;o<r.ranges.length;o++)e=r.ranges[o],f.ranges.push(new n.Range(e.row,e.col,e.rowCount,e.colCount));r.style&&(f.style=new n.Style,f.style.fromJSON(r.style,u));r.operator!==t&&r.operator!==i&&(f.operator=r.operator);r.value1!==t&&r.value1!==i&&(f.value1=r.value1);r.value2!==t&&r.value2!==i&&(f.value2=r.value2);r.priority!==t&&r.priority!==i&&(f._priority=r.priority);r.stopIfTrue!==t&&r.stopIfTrue!==i&&(f._stopIfTrue=r.stopIfTrue)}},u}(o);n.CellValueRule=d;c=function(){function n(n,i,r){var u=this;u.compareType=t;u.treatNullValueAsZero=!1;u.compareType=n;u.expected=i;u.formula=r}return n.prototype.adjustOffset=function(n,t){},n.prototype.getExpected=function(n,i,r,u){var f=this,e,o;return f.formula&&f.formula.length>0?(e=n.getCalcService(),!e)?f.expected:(o=e.parse(t,f.formula,i,r),e.evaluateParsedFormula(n._getSheetSource(),o,i,r,!1)):f.expected},n.prototype.evaluate=function(n,t,i,r){var u=this.getExpected(n,t,i);return this.checkCondition(u,r)},n.prototype.isSatisfyingCondition=function(n){var i=this.getExpected(t,0,0);return this.checkCondition(i,n)},n.prototype.checkCondition=function(n,u){var f=this,e=0,c=!1,a,o,v,l,s,h;if(typeof n=="boolean"){a=n;switch(f.compareType){case 0:return u===n;case 1:return u!==n;case 2:return f._compareBool(a,u)<0;case 3:return f._compareBool(a,u)<=0;case 4:return f._compareBool(a,u)>0;case 5:return!!f._compareBool(a,u);default:break}}try{u===i||u===t?f.treatNullValueAsZero?(c=!0,e=0):(c=!1,e=u):(l={value:undefined},r.rD(u,l)?(e=l.value,c=!isNaN(e)):c=!1)}catch(y){c=!1}if((u===i||u===t)&&(n===i||n===t))switch(f.compareType){case 0:case 3:case 5:return!0;case 1:case 2:case 4:return!1;default:return!1}if(c){o=0;v=!1;try{l={value:undefined};r.rD(n,l)&&(o=l.value,v=!0)}catch(p){}if(!v){switch(f.compareType){case 0:return!1;case 1:return!0}return!1}switch(f.compareType){case 0:return e===o;case 1:return e!==o;case 2:return e>o;case 3:return e>=o;case 4:return e<o;case 5:return e<=o}}else if(typeof u=="string"){if(s=t,typeof n=="string")s=n;else{switch(f.compareType){case 0:return!1;case 1:return!0}return!1}h=u;switch(f.compareType){case 0:return h===s;case 1:return h!==s;case 2:return s<h;case 3:return s<=h;case 4:return s>h;case 5:return s>=h}}return!1},n.prototype._compareBool=function(n,t){return n===t?0:n===!1&&t===!0?-1:1},n.prototype._isDefaultValue=function(n,t){switch(n){case"treatNullValueAsZero":return t===!1;default:return!1}},n.prototype.toJSON=function(){var n=this,f={compareType:n.compareType,expected:n.expected,formula:n.formula,conType:11,treatNullValueAsZero:n.treatNullValueAsZero},r={},t,u;for(t in f)u=f[t],n._isDefaultValue(t,u)||(r[t]=u);return $.isEmptyObject(r)?i:r},n.prototype.fromJSON=function(n,r){if(n){var u=this;n.compareType!==t&&n.compareType!==i&&(u.compareType=n.compareType);n.expected!==t&&n.expected!==i&&(u.expected=n.expected);n.formula!==t&&n.formula!==i&&(u.formula=n.formula);n.treatNullValueAsZero!==t&&n.treatNullValueAsZero!==i&&(u.treatNullValueAsZero=n.treatNullValueAsZero)}},n.prototype.getFormulas=function(){return this.formula?[this.formula]:[]},n.prototype.setFormulas=function(n){this.formula=n[0]},n}();n.CellValueCondition=c;yt=function(){function n(n,t,i){var r=this;r.compareType=0;r.conditionType="NumberCondition";r.ignoreBlank=!1;r.integerValue=!1;r.compareType=n;r.expected=t;r.formula=typeof i=="string"?y($.trim(i),"="):i}return n.prototype.evaluate=function(n,i,r,u){var f=this.getExpected(n,i,r);return this.integerValue&&(f=isNaN(f)?t:parseInt(f,10)),this.checkCondition(f,u)},n.prototype.checkCondition=function(n,r){var f=this,u,e;if((r===i||r===t||r==="")&&f.ignoreBlank)return!0;if(isNaN(r))return!1;if(n===i||n===t)if(f.ignoreBlank)return!0;else n=0;u=0;try{u=parseFloat(r)}catch(o){return!1}if(f.integerValue===!0&&(e=u-v(u)==0,e===!1))return!1;switch(f.compareType){case 0:return u===n;case 1:return u!==n;case 2:return u>n;case 3:return u>=n;case 4:return u<n;case 5:return u<=n}return!1},n.prototype.getExpected=function(n,t,i){var r=this,u;return r.formula&&r.formula.length>0?(u=n.getCalcService(),!u)?r.expected:u.evaluate(n._getSheetSource(),r.formula,t,i):r.expected},n.prototype.reset=function(){var n=this;n.expected=t;n.ignoreBlank=!1;n.compareType=0;n.integerValue=!1},n.prototype._isDefaultValue=function(n,t){switch(n){case"ignoreBlank":return t===!1;case"integerValue":return t===!1;default:return!1}},n.prototype.toJSON=function(){var n=this,f={compareType:n.compareType,expected:n.expected,formula:n.formula,conType:1,ignoreBlank:n.ignoreBlank,integerValue:n.integerValue},r={},t,u;for(t in f)u=f[t],n._isDefaultValue(t,u)||(r[t]=u);return $.isEmptyObject(r)?i:r},n.prototype.fromJSON=function(n,r){if(n){var u=this;n.compareType!==t&&n.compareType!==i&&(u.compareType=n.compareType);n.expected!==t&&n.expected!==i&&(u.expected=n.expected);n.formula!==t&&n.formula!==i&&(u.formula=n.formula);n.ignoreBlank!==t&&n.ignoreBlank!==i&&(u.ignoreBlank=n.ignoreBlank);n.integerValue!==t&&n.integerValue!==i&&(u.integerValue=n.integerValue)}},n.prototype.getFormulas=function(){return this.formula?[this.formula]:[]},n.prototype.setFormulas=function(n){this.formula=n[0]},n}();n.NumberCondition=yt;g=function(r){function u(n,t,i){r.call(this,i);this.text=t;this.operator=n}return __extends(u,r),u.prototype.createCondition=function(){var n,i;switch(this.operator){case 2:n=2;break;case 3:n=4;break;case 0:n=6;break;case 1:n=7;break;default:n=0;break}return i=new nt(n,this.text,t),i.ignoreCase=!0,i},u.prototype.reset=function(){var n=this;n.operator=0;n.text="";n.style=t;n._stopIfTrue=!1;n._priority=1},u.prototype.toJSON=function(){var n=this,f={ruleType:2,ranges:n.ranges,style:n.style,operator:n.operator,text:n.text,priority:n._priority,stopIfTrue:n._stopIfTrue},r={},t,u;for(t in f)u=f[t],n._isDefaultValue(t,u)||(r[t]=u);return $.isEmptyObject(r)?i:r},u.prototype.fromJSON=function(r,u){var f,o,e;if(r){if(f=this,r.ranges)for(f.ranges=[],o=0;o<r.ranges.length;o++)e=r.ranges[o],f.ranges.push(new n.Range(e.row,e.col,e.rowCount,e.colCount));r.style&&(f.style=new n.Style,f.style.fromJSON(r.style,u));r.operator!==t&&r.operator!==i&&(f.operator=r.operator);r.text!==t&&r.text!==i&&(f.text=r.text);r.priority!==t&&r.priority!==i&&(f._priority=r.priority);r.stopIfTrue!==t&&r.stopIfTrue!==i&&(f._stopIfTrue=r.stopIfTrue)}},u}(o);n.SpecificTextRule=g;nt=function(){function n(n,i,r){var u=this;u.forceValue2Text=!1;u.useWildCards=!0;u.regex=t;u.ignoreCase=!1;u.conditionType="TextCondition";u.questionMarkWildcard="?";u.questionMarkWildcardRegularExpression=".";u.asteriskWildcard="*";u.asteriskWildcardRegularExpression="[.\n]*";u.ignoreBlank=!1;u.compareType=n;u.expected=i;u.formula=typeof r=="string"?y($.trim(r),"="):r}return n.prototype.adjustOffset=function(n,t){},n.prototype.evaluate=function(n,r,u,f){var e=this,o=t,s;if(e.forceValue2Text===!0||typeof f=="string"||typeof f=="number")o=f!==i&&f!==t?f.toString():"";else{if(f instanceof Date)return e.compareType===2||e.compareType===4||e.compareType===6?!1:e.compareType===3||e.compareType===5||e.compareType===7;o=f!==i&&f!==t?f.toString():""}if(e.ignoreBlank&&(o===i||o===t||o===""))return!0;if(s=e.getExpectedString(n,r,u),e.hasWildcard(s)&&typeof f=="number")return e.compareType===3||e.compareType===7||e.compareType===5||e.compareType===1;switch(e.compareType){case 0:return e.isEquals(s,o);case 1:return!e.isEquals(s,o);case 2:return e.isStartWith(s,o);case 3:return!e.isStartWith(s,o);case 4:return e.isEndWith(s,o);case 5:return!e.isEndWith(s,o);case 6:return e.isContains(s,o);case 7:return!e.isContains(s,o)}return!1},n.prototype.getExpectedString=function(n,r,u){var f=this.getExpected(n,r,u);return f===i||f===t?t:f.toString()},n.prototype.getExpected=function(n,i,r){var u=this,f,e;return u.formula&&u.formula.length>0?(f=n.getCalcService(),!f)?u.expected:(e=f.parse(t,u.formula,i,r),f.evaluateParsedFormula(n._getSheetSource(),e,i,r,!1)):u.expected},n.prototype.hasWildcard=function(n){return n===i||n===t||n===""?!1:n.indexOf(this.asteriskWildcard)>-1||n.indexOf(this.questionMarkWildcard)>-1},n.prototype.isEquals=function(n,r){var u=this,f,e,o;return u.useWildCards&&u.hasWildcard(n)?(f=u.createEqualsRegex(n),f&&(e=r===i&&r===t?"":r,f.lastIndex=-1,e!==i&&e!==t))?e.search(f)>-1:!1:r!==i&&r!==t&&r!==""?(o=n!==i&&n!==t?n:"",u.ignoreCase?o.toLowerCase()===r.toLowerCase():o===r):n===i||n===t||n===""},n.prototype.createEqualsRegex=function(n){var i=this,r,u,f,e;if(i.regex)return i.regex;n=i.encodeExpression(n);r=n;u=new RegExp("\\"+i.questionMarkWildcard,"g");r=r.replace(u,i.questionMarkWildcardRegularExpression);u=new RegExp("\\"+i.asteriskWildcard,"g");r=r.replace(u,i.asteriskWildcardRegularExpression);f=t;try{e=i.ignoreCase?"ig":"g";f=new RegExp("^"+r+"$",e)}catch(o){return t}return f},n.prototype.encodeExpression=function(n){if(!n)return t;var i=n;return i=i.replace(/\^/g,"\\^"),i=i.replace(/\$/g,"\\$"),i=i.replace(/\(/g,"\\("),i=i.replace(/\)/g,"\\)"),i=i.replace(/\[/g,"\\["),i=i.replace(/\]/g,"\\]"),i=i.replace(/\{/g,"\\{"),i=i.replace(/\}/g,"\\}"),i=i.replace(/\./g,"\\."),i=i.replace(/\+/g,"\\+"),i.replace(/\|/g,"\\|")},n.prototype.isStartWith=function(n,r){var o=this,u,s,f,e;return o.useWildCards&&o.hasWildcard(n)?(s=o.createStartWithRegex(n),s&&(u=r===i||r===t?"":r,s.lastIndex=-1,u!==i&&u!==t))?u.search(s)>-1:!1:r!==i&&r!==t&&r!==""?n===i||n===t?!1:(f=n,u=r,o.ignoreCase&&(f=f.toLowerCase(),u=u.toLowerCase()),e=u.match("^"+f),e!==i&&e!==t&&e.length>0?e[0]===f:!1):n===i||n===t||n===""},n.prototype.createStartWithRegex=function(n){var i=this,r,u,f,e;if(i.regex)return i.regex;n=i.encodeExpression(n);r=n;u=new RegExp("\\"+i.questionMarkWildcard,"g");r=r.replace(u,i.questionMarkWildcardRegularExpression);u=new RegExp("\\"+i.asteriskWildcard,"g");r=r.replace(u,i.asteriskWildcardRegularExpression);f=t;try{e=i.ignoreCase?"ig":"g";f=n[0]===i.asteriskWildcard?new RegExp(r,e):new RegExp("^"+r,e)}catch(o){return t}return f},n.prototype.isEndWith=function(n,r){var o=this,u,s,f,e;return o.useWildCards&&o.hasWildcard(n)?(s=o.createEndWithRegex(n),s&&(u=r===i||r===t?"":r,s.lastIndex=-1,u!==i&&u!==t))?u.search(s)>-1:!1:r!==i&&r!==t&&r!==""?n===i||n===t?!1:(f=n,u=r,o.ignoreCase&&(f=f.toLowerCase(),u=u.toLowerCase()),e=u.match(f+"$"),e!==i&&e!==t&&e.length>0?e[0]===f:!1):n===i||n===t||n===""},n.prototype.createEndWithRegex=function(n){var i=this,r,u,f,e;if(i.regex)return i.regex;n=i.encodeExpression(n);r=n;u=new RegExp("\\"+i.questionMarkWildcard,"g");r=r.replace(u,i.questionMarkWildcardRegularExpression);u=new RegExp("\\"+i.asteriskWildcard,"g");r=r.replace(u,i.asteriskWildcardRegularExpression);f=t;try{e=i.ignoreCase?"ig":"g";f=n[n.length-1]===i.asteriskWildcard?new RegExp(r,e):new RegExp(r+"$",e)}catch(o){return t}return f},n.prototype.isContains=function(n,r){var f=this,u,e,o;return f.useWildCards&&f.hasWildcard(n)?(e=f.createContainsRegex(n),e&&(u=r===i||r===t?"":r,e.lastIndex=-1,u!==i&&u!==t))?u.search(e)>-1:!1:r!==i&&r!==t&&r!==""?n===i||n===t?!1:(o=n,u=r,f.ignoreCase&&(o=o.toLowerCase(),u=u.toLowerCase()),u.indexOf(o)>-1):n===i||n===t||n===""},n.prototype.createContainsRegex=function(n){var i=this,r,u,f,e;if(i.regex)return i.regex;n=i.encodeExpression(n);r=n;u=new RegExp("\\"+i.questionMarkWildcard,"g");r=r.replace(u,i.questionMarkWildcardRegularExpression);u=new RegExp("\\"+i.asteriskWildcard,"g");r=r.replace(u,i.asteriskWildcardRegularExpression);f=t;try{e=i.ignoreCase?"ig":"g";f=new RegExp(r,e)}catch(o){return t}return f},n.prototype.reset=function(){var n=this;n.expected=t;n.ignoreBlank=!1;n.compareType=0;n.useWildCards=!0;n.ignoreCase=!1;n.forceValue2Text=!1},n.prototype._isDefaultValue=function(n,i){switch(n){case"forceValue2Text":return i===!1;case"useWildCards":return i===!0;case"ignoreCase":return i===!1;case"regex":return i===t;case"ignoreBlank":return i===!1;default:return!1}},n.prototype.toJSON=function(){var n=this,r={compareType:n.compareType,expected:n.expected,formula:n.formula,forceValue2Text:n.forceValue2Text,useWildCards:n.useWildCards,ignoreCase:n.ignoreCase,regex:n.regex,conType:2,ignoreBlank:n.ignoreBlank},u={},t,i;for(t in r)i=r[t],n._isDefaultValue(t,i)||(u[t]=i);return u},n.prototype.fromJSON=function(n,r){if(n){var u=this;n.compareType!==t&&n.compareType!==i&&(u.compareType=n.compareType);n.expected!==t&&n.expected!==i&&(u.expected=n.expected);n.formula!==t&&n.formula!==i&&(u.formula=n.formula);n.forceValue2Text!==t&&n.forceValue2Text!==i&&(u.forceValue2Text=n.forceValue2Text);n.useWildCards!==t&&n.useWildCards!==i&&(u.useWildCards=n.useWildCards);n.ignoreCase!==t&&n.ignoreCase!==i&&(u.ignoreCase=n.ignoreCase);n.regex!==t&&n.regex!==i&&(u.regex=n.regex);n.ignoreBlank!==t&&n.ignoreBlank!==i&&(u.ignoreBlank=n.ignoreBlank)}},n.prototype.getFormulas=function(){return this.formula?[this.formula]:[]},n.prototype.setFormulas=function(n){this.formula=n[0]},n}();n.TextCondition=nt;pt=function(){function r(n,t){this.conditionType="ColorCondition";this.ignoreBlank=!1;this.compareType=n;this.expected=t}return r.prototype.evaluate=function(n,t,i,r){return this.isEqualsColor(n,r)},r.prototype.isEqualsColor=function(n,r){var o=this,u=o.getColorFromString(o.expected),f,e;if(u!==i&&u!==t&&u!==""){if(f=o.getColorFromString(r),f!==i&&f!==t&&f!=="")return f.a===u.a&&f.r===u.r&&f.g===u.g&&f.b===u.b;else if(o.compareType===0?n&&n.getDefaultStyle&&(e=n.getDefaultStyle().backColor):o.compareType===1&&n&&n.getDefaultStyle&&(e=n.getDefaultStyle().foreColor),e)return u.a===e.a&&u.r===e.r&&u.g===e.g&&u.b===e.b}else if(o.ignoreBlank)return!0;return!1},r.prototype.getColorFromString=function(r){return r===i||r===t||r===""?t:n._Color.parse(r)},r.prototype.reset=function(){this.expected=t;this.ignoreBlank=!1;this.compareType=0},r.prototype._isDefaultValue=function(n,t){switch(n){case"ignoreBlank":return t===!1;default:return!1}},r.prototype.toJSON=function(){var n=this,r={compareType:n.compareType,expected:n.expected,conType:3,ignoreBlank:n.ignoreBlank},u={},t,i;for(t in r)i=r[t],n._isDefaultValue(t,i)||(u[t]=i);return u},r.prototype.fromJSON=function(n,r){n&&(n.compareType!==t&&n.compareType!==i&&(this.compareType=n.compareType),n.expected!==t&&n.expected!==i&&(this.expected=n.expected),n.ignoreBlank!==t&&n.ignoreBlank!==i&&(this.ignoreBlank=n.ignoreBlank))},r}();n.ColorCondition=pt;tt=function(r){function u(t,i){if(r.call(this,i),t&&typeof t!="string")throw new Error(n.SR.Exp_InvalidArgument);this.formula=t}return __extends(u,r),u.prototype.createCondition=function(){var n=this,i=new it(4,!n.formula||n.formula===""?t:n.formula);return n.ranges&&n.ranges.length>0&&(i._baseRow=n.ranges[0].row,i._baseCol=n.ranges[0].col),i},u.prototype.reset=function(){var n=this;n.formula=t;n.style=t;n._stopIfTrue=!1;n._priority=1},u.prototype.isFormula=function(n){return n&&n[0]==="="},u.prototype.toJSON=function(){var n=this,r={ruleType:3,ranges:n.ranges,style:n.style,formula:n.formula,priority:n._priority,stopIfTrue:n._stopIfTrue},u={},t,i;for(t in r)i=r[t],n._isDefaultValue(t,i)||(u[t]=i);return u},u.prototype.fromJSON=function(r,u){var f,o,e;if(r){if(f=this,r.ranges)for(f.ranges=[],o=0;o<r.ranges.length;o++)e=r.ranges[o],f.ranges.push(new n.Range(e.row,e.col,e.rowCount,e.colCount));r.style&&(f.style=new n.Style,f.style.fromJSON(r.style,u));r.formula!==t&&r.formula!==i&&(f.formula=r.formula);r.priority!==t&&r.priority!==i&&(f._priority=r.priority);r.stopIfTrue!==t&&r.stopIfTrue!==i&&(f._stopIfTrue=r.stopIfTrue)}},u}(o);n.FormulaRule=tt;it=function(){function u(n,i){var r=this,u,f;r.expected=t;r.ignoreBlank=!1;r.conditionType="FormulaCondition";r._baseRow=t;r._baseCol=t;r._expr=t;r.customValueType=n;u=i;typeof u=="string"&&(f=$.trim(u),u=f[0]==="="?f.substr(1):f);r.formula=u}return u.prototype.adjustOffset=function(n,t){},u.prototype.evaluate=function(u,f,e,o){var s,h,c;if(!n.util.hasCalc())return!1;if(s=this,s.customValueType===4){if(h=s.getExpected(u,f,e),s.ignoreBlank&&(h===i||h===t||h===""))return!0;try{return r.B(h)}catch(l){return!1}}else{c=r.err;switch(s.customValueType){case 0:return o===i||o===t||o==="";case 1:return o!==i&&o!==t&&o!=="";case 2:return c(o);case 3:return!c(o)}}return!1},u.prototype.getExpected=function(u,f,e){var o=this,y,s,a,v,l,h,c,p,w;if(o.formula&&o.formula.length>0){if(y=u.getCalcService(),!y)return o.expected;if(o._expr||((o._baseRow===i||o._baseRow===t)&&(o._baseCol===i||o._baseCol===t)&&(o._baseRow=f,o._baseCol=e),o._expr=y.parse(t,o.formula,o._baseRow,o._baseCol)),s=y.evaluateParsedFormula(u._getSheetSource(),o._expr,f,e,!0),r.ref(s)){for(a=s.getRowCount(0),v=s.getColumnCount(0),l=[],h=0;h<a;h++)for(l[h]=[],c=0;c<v;c++)l[h][c]=s.getValue(0,h,c);s=l}else if(r.arr(s)){for(a=s.getRowCount(),v=s.getColumnCount(),l=[],h=0;h<a;h++)for(l[h]=[],c=0;c<v;c++)l[h][c]=s.getValue(h,c);s=l}return s instanceof Array?(a=s.length,v=s[0].length,a===1&&v===1)?s[0][0]:(p=f-o._baseRow,w=e-o._baseCol,p<a&&w<v?s[p][w]:n.Calc.Errors.NotAvailable):s}else return o.expected},u.prototype.reset=function(){var n=this;n.expected=t;n.ignoreBlank=!1;n.customValueType=0;n._expr=t;n._baseRow=t;n._baseCol=t},u.prototype._isDefaultValue=function(n,i){switch(n){case"expected":return i===t;case"ignoreBlank":return i===!1;default:return!1}},u.prototype.toJSON=function(){var n=this,r={customValueType:n.customValueType,expected:n.expected,formula:n.formula,conType:4,ignoreBlank:n.ignoreBlank},u={},t,i;for(t in r)i=r[t],n._isDefaultValue(t,i)||(u[t]=i);return u},u.prototype.fromJSON=function(n,r){if(n){var u=this;n.customValueType!==t&&n.customValueType!==i&&(u.customValueType=n.customValueType);n.expected!==t&&n.expected!==i&&(u.expected=n.expected);n.formula!==t&&n.formula!==i&&(u.formula=n.formula);n.ignoreBlank!==t&&n.ignoreBlank!==i&&(u.ignoreBlank=n.ignoreBlank)}},u.prototype.getFormulas=function(){return this.formula?[this.formula]:[]},u.prototype.setFormulas=function(n){this.formula=n[0];this._expr=null},u}();n.FormulaCondition=it;b=function(){function r(n,t,i){var r=this;r.conditionType="DateCondition";r.ignoreBlank=!1;r.compareType=n;r.expected=t;r.formula=typeof i=="string"?y($.trim(i),"="):i}return r.prototype.evaluate=function(n,r,u,f){var e=this,o;if((f===i||f===t||f==="")&&e.ignoreBlank)return!0;if(!(f instanceof Date))return!1;if(o=e.getExpectedDateTime(n,r,u),o===i||o===t)return!!e.ignoreBlank;switch(e.compareType){case 0:return e.isEquals(o,f);case 1:return!e.isEquals(o,f);case 4:return e.isAfter(o,f);case 5:return e.isAfter(o,f)||e.isEquals(o,f);case 2:return e.isBefore(o,f);case 3:return e.isBefore(o,f)||e.isEquals(o,f)}return!1},r.prototype.getExpectedDateTime=function(i,r,u){var f=this.getExpected(i,r,u);if(f instanceof Date)return f;else if(typeof f=="string")return n._DateTimeHelper.parseLocale(f);return t},r.prototype.getExpected=function(n,i,r){var u=this,f,e;return u.formula&&u.formula.length>0?(f=n.getCalcService(),!f)?u.expected:(e=f.parse(t,u.formula,i,r),f.evaluateParsedFormula(n._getSheetSource(),e,i,r,!1)):u.expected},r.prototype.isEquals=function(n,t){return n.getYear()===t.getYear()&&n.getMonth()===t.getMonth()&&n.getDate()===t.getDate()},r.prototype.isAfter=function(n,t){var i=this.createDayEnding(n);return t>i},r.prototype.createDayEnding=function(n){return new Date(n.getFullYear(),n.getMonth(),n.getDate(),23,59,59,999)},r.prototype.isBefore=function(n,t){var i=this.createDayBeginning(n);return t<i},r.prototype.createDayBeginning=function(n){return new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0,0)},r.prototype.reset=function(){this.expected=t;this.ignoreBlank=!1;this.compareType=0},r.prototype._isDefaultValue=function(n,t){switch(n){case"ignoreBlank":return t===!1;default:return!1}},r.prototype.toJSON=function(){var n=this,r={compareType:n.compareType,expected:n.expected,formula:n.formula,conType:5,ignoreBlank:n.ignoreBlank},u={},t,i;for(t in r)i=r[t],n._isDefaultValue(t,i)||(u[t]=i);return u},r.prototype.fromJSON=function(n,r){if(n){var u=this;n.compareType!==t&&n.compareType!==i&&(u.compareType=n.compareType);n.expected!==t&&n.expected!==i&&(u.expected=$.type(n.expected)==="string"?new Date(n.expected):n.expected);n.formula!==t&&n.formula!==i&&(u.formula=n.formula);n.ignoreBlank!==t&&n.ignoreBlank!==i&&(u.ignoreBlank=n.ignoreBlank)}},r.prototype.getFormulas=function(){return this.formula?[this.formula]:[]},r.prototype.setFormulas=function(n){this.formula=n[0]},r}();n.DateCondition=b;rt=function(r){function u(n,t){r.call(this,t);this.type=n}return __extends(u,r),u.prototype.createCondition=function(){return new ut(this.type)},u.prototype.reset=function(){var n=this;n.type=0;n.style=t;n._stopIfTrue=!1;n._priority=1},u.prototype.toJSON=function(){var n=this,r={ruleType:4,ranges:n.ranges,style:n.style,type:n.type,priority:n._priority,stopIfTrue:n._stopIfTrue},u={},t,i;for(t in r)i=r[t],n._isDefaultValue(t,i)||(u[t]=i);return u},u.prototype.fromJSON=function(r,u){var f,o,e;if(r){if(f=this,r.ranges)for(f.ranges=[],o=0;o<r.ranges.length;o++)e=r.ranges[o],f.ranges.push(new n.Range(e.row,e.col,e.rowCount,e.colCount));r.style&&(f.style=new n.Style,f.style.fromJSON(r.style,u));r.type!==t&&r.type!==i&&(f.type=r.type);r.priority!==t&&r.priority!==i&&(f._priority=r.priority);r.stopIfTrue!==t&&r.stopIfTrue!==i&&(f._stopIfTrue=r.stopIfTrue)}},u}(o);n.DateOccurringRule=rt;ut=function(){function n(n){var i=this;i.ignoreBlank=!1;i.formula=t;i.expectTypeId=0;i.conditionType="DateExCondition";i.expected=n}return n.prototype.adjustOffset=function(n,t){},n.prototype.evaluate=function(n,r,u,f){var e=this.getExpectedInt(n,r,u);return e!==i&&e!==t?this.checkCondition(e,f):!1},n.prototype.getExpectedInt=function(n,i,r){var u=this.getExpected(n,i,r);return u=parseInt(u,10),isNaN(u)?t:u},n.prototype.getExpected=function(n,i,r){var u=this,f,e;return u.formula&&u.formula.length>0?(f=n.getCalcService(),!f)?u.expected:(e=f.parse(t,u.formula,i,r),f.evaluateParsedFormula(n._getSheetSource(),e,i,r,!1)):u.expected},n.prototype.checkCondition=function(n,u){var s=this,l=u,o,k,d,g,nt,tt,it,y,rt,ut,a,p,v;if(s.ignoreBlank&&(l===i||l===t||l===""))return!0;try{l=r.DT(l)}catch(st){return!1}if(s.expectTypeId===0){var h=t,c=t,e=new Date,f=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds());switch(n){case 3:f.setDate(f.getDate()-6);h=new Date(f.getFullYear(),f.getMonth(),f.getDate(),0,0,0,0);c=new Date(e.getFullYear(),e.getMonth(),e.getDate(),23,59,59,999);break;case 1:f.setDate(f.getDate()-1);h=new Date(f.getFullYear(),f.getMonth(),f.getDate(),0,0,0,0);c=new Date(f.getFullYear(),f.getMonth(),f.getDate(),23,59,59,999);break;case 0:h=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0);c=new Date(e.getFullYear(),e.getMonth(),e.getDate(),23,59,59,999);break;case 2:f.setDate(f.getDate()+1);h=new Date(f.getFullYear(),f.getMonth(),f.getDate(),0,0,0,0);c=new Date(f.getFullYear(),f.getMonth(),f.getDate(),23,59,59,999);break;case 8:k=e;k.setDate(e.getDate()-e.getDay()-7);d=f;d.setDate(f.getDate()-f.getDay()-1);h=new Date(k.getFullYear(),k.getMonth(),k.getDate(),0,0,0,0);c=new Date(d.getFullYear(),d.getMonth(),d.getDate(),23,59,59,999);break;case 7:g=e;g.setDate(e.getDate()-e.getDay());nt=f;nt.setDate(f.getDate()-f.getDay()+6);h=new Date(g.getFullYear(),g.getMonth(),g.getDate(),0,0,0,0);c=new Date(nt.getFullYear(),nt.getMonth(),nt.getDate(),23,59,59,999);break;case 9:tt=e;tt.setDate(e.getDate()-e.getDay()+7);it=f;it.setDate(f.getDate()-f.getDay()+13);h=new Date(tt.getFullYear(),tt.getMonth(),tt.getDate(),0,0,0,0);c=new Date(it.getFullYear(),it.getMonth(),it.getDate(),23,59,59,999);break;case 5:y=e;y.setDate(1);y.setMonth(e.getMonth()-1);rt=f;rt.setDate(0);h=new Date(y.getFullYear(),y.getMonth(),y.getDate(),0,0,0,0);c=new Date(rt.getFullYear(),rt.getMonth(),rt.getDate(),23,59,59,999);break;case 4:ut=e;ut.setDate(1);a=f;a.setDate(1);a.setMonth(f.getMonth()+1);a.setDate(0);h=new Date(ut.getFullYear(),ut.getMonth(),ut.getDate(),0,0,0,0);c=new Date(a.getFullYear(),a.getMonth(),a.getDate(),23,59,59,999);break;case 6:p=e;p.setDate(1);p.setMonth(e.getMonth()+1);v=f;v.setDate(1);v.setMonth(f.getMonth()+2);v.setDate(0);h=new Date(p.getFullYear(),p.getMonth(),p.getDate(),0,0,0,0);c=new Date(v.getFullYear(),v.getMonth(),v.getDate(),23,59,59,999);break}if(h!==i&&h!==t&&c!==i&&c!==t){var ft=new b(5,h,t),et=new b(3,c,t),ot=new w(1,ft,et);return ot.evaluate(t,0,0,l)}}else if(s.expectTypeId===1){if(o=s.getExpectedInt(t,0,0),o!==i&&o!==t)return s.isEqualsYear(o,l)}else if(s.expectTypeId===2){if(o=s.getExpectedInt(t,0,0),o!==i&&o!==t)return s.isEqualsQuarter(o,l)}else if(s.expectTypeId===3){if(o=s.getExpectedInt(t,0,0),o!==i&&o!==t)return s.isEqualsMonth(o,l)}else if(s.expectTypeId===4){if(o=s.getExpectedInt(t,0,0),o!==i&&o!==t)return s.isEqualsWeek(o,l)}else if(s.expectTypeId===5&&(o=s.getExpectedInt(t,0,0),o!==i&&o!==t))return s.isEqualsDay(o,l);return!1},n.prototype.isEqualsYear=function(n,t){return n===t.getFullYear()},n.prototype.isEqualsQuarter=function(n,t){switch(n){case 0:return t.getMonth()>=0&&t.getMonth()<=2;case 1:return t.getMonth()>=3&&t.getMonth()<=5;case 2:return t.getMonth()>=6&&t.getMonth()<=8;case 3:return t.getMonth()>=9&&t.getMonth()<=11}return!1},n.prototype.isEqualsMonth=function(n,t){return n===t.getMonth()},n.prototype.isEqualsWeek=function(n,t){return n===t.getDay()},n.prototype.isEqualsDay=function(n,t){return n===t.getDate()},n.prototype.reset=function(){this.expected=t;this.ignoreBlank=!1;this.expectTypeId=0},n.prototype._isDefaultValue=function(n,i){switch(n){case"ignoreBlank":return i===!1;case"formula":return i===t;case"expectTypeId":return i===0;default:return!1}},n.prototype.toJSON=function(){var n=this,r={ignoreBlank:n.ignoreBlank,formula:n.formula,expected:n.expected,expectTypeId:n.expectTypeId,conType:6},u={},t,i;for(t in r)i=r[t],n._isDefaultValue(t,i)||(u[t]=i);return u},n.prototype.fromJSON=function(n,r){if(n){var u=this;n.ignoreBlank!==t&&n.ignoreBlank!==i&&(u.ignoreBlank=n.ignoreBlank);n.formula!==t&&n.formula!==i&&(u.formula=n.formula);n.expected!==t&&n.expected!==i&&(u.expected=n.expected);n.expectTypeId!==t&&n.expectTypeId!==i&&(u.expectTypeId=n.expectTypeId)}},n.fromDay=function(t){var i=new n(t);return i.expectTypeId=5,i},n.fromMonth=function(t){var i=new n(t);return i.expectTypeId=3,i},n.fromQuarter=function(t){var i=new n(t);return i.expectTypeId=2,i},n.fromWeek=function(t){var i=new n(t);return i.expectTypeId=4,i},n.fromYear=function(t){var i=new n(t);return i.expectTypeId=1,i},n.prototype.getFormulas=function(){return this.formula?[this.formula]:[]},n.prototype.setFormulas=function(n){this.formula=n[0]},n}();n.DateExCondition=ut;wt=function(){function n(n,t,i){var r=this;r.ignoreBlank=!1;r.conditionType="TextLengthCondition";r.compareType=n;r.expected=t;r.formula=typeof i=="string"?y($.trim(i),"="):i}return n.prototype.evaluate=function(n,r,u,f){if(f===i||f===t||f==="")return this.ignoreBlank;var o=f===i||f===t?0:f.length,e=this.getExpectedInt(n,r,u);if(typeof e=="number")switch(this.compareType){case 0:return o===e;case 2:return o>e;case 3:return o>=e;case 4:return o<e;case 5:return o<=e;case 1:return o!==e}return!1},n.prototype.getExpectedInt=function(n,i,r){var u=this.getExpected(n,i,r);return u=parseInt(u,10),isNaN(u)?t:u},n.prototype.getExpected=function(n,i,r){var u=this,f,e;return u.formula&&u.formula.length>0?(f=n.getCalcService(),!f)?u.expected:(e=f.parse(t,u.formula,i,r),f.evaluateParsedFormula(n._getSheetSource(),e,i,r,!1)):u.expected},n.prototype.reset=function(){this.expected=t;this.ignoreBlank=!1;this.compareType=0},n.prototype._isDefaultValue=function(n,t){switch(n){case"ignoreBlank":return t===!1;default:return!1}},n.prototype.toJSON=function(){var n=this,r={compareType:n.compareType,expected:n.expected,formula:n.formula,conType:7,ignoreBlank:n.ignoreBlank},u={},t,i;for(t in r)i=r[t],n._isDefaultValue(t,i)||(u[t]=i);return u},n.prototype.fromJSON=function(n,r){if(n){var u=this;n.compareType!==t&&n.compareType!==i&&(u.compareType=n.compareType);n.expected!==t&&n.expected!==i&&(u.expected=n.expected);n.formula!==t&&n.formula!==i&&(u.formula=n.formula);n.ignoreBlank!==t&&n.ignoreBlank!==i&&(u.ignoreBlank=n.ignoreBlank)}},n.prototype.getFormulas=function(){return this.formula?[this.formula]:[]},n.prototype.setFormulas=function(n){this.formula=n[0]},n}();n.TextLengthCondition=wt;ft=function(r){function u(n,t,i){r.call(this,i);this.type=n;this.rank=t}return __extends(u,r),u.prototype.createCondition=function(){return new p(this.type,this.rank,this.ranges)},u.prototype.reset=function(){var n=this;n.type=0;n.rank=10;n.style=t;n._stopIfTrue=!1;n._priority=1},u.prototype.toJSON=function(){var n=this,r={ruleType:5,ranges:n.ranges,style:n.style,type:n.type,rank:n.rank,priority:n._priority,stopIfTrue:n._stopIfTrue},u={},t,i;for(t in r)i=r[t],n._isDefaultValue(t,i)||(u[t]=i);return u},u.prototype.fromJSON=function(r,u){var f,o,e;if(r){if(f=this,r.ranges)for(f.ranges=[],o=0;o<r.ranges.length;o++)e=r.ranges[o],f.ranges.push(new n.Range(e.row,e.col,e.rowCount,e.colCount));r.style&&(f.style=new n.Style,f.style.fromJSON(r.style,u));r.type!==t&&r.type!==i&&(f.type=r.type);r.rank!==t&&r.rank!==i&&(f.rank=r.rank);r.priority!==t&&r.priority!==i&&(f._priority=r.priority);r.stopIfTrue!==t&&r.stopIfTrue!==i&&(f._stopIfTrue=r.stopIfTrue)}},u}(o);n.Top10Rule=ft;p=function(){function u(n,i,r){var u=this;u.isPercent=!1;u.ignoreBlank=!1;u.conditionType="Top10Condition";u.formula=t;u.expected=i;u.type=n;u.ranges=r}return u.prototype.adjustOffset=function(n,t){},u.prototype.evaluate=function(r,u,f,e){var o=this,s,h,c;if(e===i||e===t||e==="")return o.ignoreBlank;if(s=o.getExpectedInt(r,u,f),s!==i&&s!==t&&(h=t,o.type===0?h=o.getMaxValues(r,s,o.ranges):o.type===1&&(h=o.getMinValues(r,s,o.ranges)),h)){c=0;try{c=o._toDouble(e)}catch(l){return!1}if(n.ArrayHelper.contains(h,c))return!0}return!1},u.prototype.getExpectedInt=function(n,i,r){var u=this.getExpected(n,i,r);return u=parseInt(u,10),isNaN(u)||!isFinite(u)?t:u},u.prototype.getExpected=function(n,i,r){var u=this,f,e;return u.formula&&u.formula.length>0?(f=n.getCalcService(),!f)?u.expected:(e=f.parse(t,u.formula,i,r),f.evaluateParsedFormula(n._getSheetSource(),e,i,r,!1)):u.expected},u.prototype.adjustRange=function(t,i){return new n.Range(t.row,t.col,Math.min(t.rowCount,i.getRowCount()),Math.min(t.colCount,i.getColumnCount()))},u.prototype.getMaxValues=function(i,r,u){var f=[],a,v,y,c,g;if(!u)return f;var o=Number.MAX_VALUE,p=0,nt=u.length,s,w,b,k,d,l,e;for(a=0;a<nt;a++)for(s=u[a],s=this.adjustRange(s,i),w=s.rowCount,b=s.colCount,v=0;v<w;v++)for(k=v+s.row,y=0;y<b;y++)if(d=y+s.col,l=i.getValue(k,d),e=this._toDouble(l),typeof l!==h&&l!==t&&typeof e!==h&&e!==t)try{if(p<r)f.push(e),e<o&&(o=e),p++;else if(e>o&&(n.ArrayHelper.remove(f,o),f.push(e),n.ArrayHelper.indexOf(f,o)<0))for(o=e,c=0,g=f.length;c<g;c++)f[c]<o&&(o=f[c])}catch(tt){}return f},u.prototype.getMinValues=function(i,r,u){var f=[],a,v,y,c,g;if(!u)return f;var o=-Number.MAX_VALUE,p=0,nt=u.length,s,w,b,k,d,l,e;for(a=0;a<nt;a++)for(s=u[a],s=this.adjustRange(s,i),w=s.rowCount,b=s.colCount,v=0;v<w;v++)for(k=v+s.row,y=0;y<b;y++)if(d=y+s.col,l=i.getValue(k,d),e=this._toDouble(l),typeof l!==h&&l!==t&&typeof e!==h&&e!==t)try{if(p<r)f.push(e),e>o&&(o=e),p++;else if(e<o&&(n.ArrayHelper.remove(f,o),f.push(e),n.ArrayHelper.indexOf(f,o)<0))for(o=e,c=0,g=f.length;c<g;c++)f[c]>o&&(o=f[c])}catch(tt){}return f},u.prototype.reset=function(){var n=this;n.expected=t;n.ignoreBlank=!1;n.type=0;n.isPercent=!1;n.ranges=t},u.prototype._toDouble=function(i){return(typeof i=="number"||i instanceof Date)&&n.util.hasCalc()?r.D(i):t},u.prototype._isDefaultValue=function(n,i){switch(n){case"formula":return i===t;case"isPercent":return i===!1;case"ignoreBlank":return i===!1;default:return!1}},u.prototype.toJSON=function(){var n=this,r={expected:n.expected,formula:n.formula,type:n.type,isPercent:n.isPercent,ignoreBlank:n.ignoreBlank,ranges:n.ranges,conType:8},u={},t,i;for(t in r)i=r[t],n._isDefaultValue(t,i)||(u[t]=i);return u},u.prototype.fromJSON=function(r,u){var f,o,e;if(r&&(f=this,r.expected!==t&&r.expected!==i&&(f.expected=r.expected),r.formula!==t&&r.formula!==i&&(f.formula=r.formula),r.type!==t&&r.type!==i&&(f.type=r.type),r.isPercent!==t&&r.isPercent!==i&&(f.isPercent=r.isPercent),r.ignoreBlank!==t&&r.ignoreBlank!==i&&(f.ignoreBlank=r.ignoreBlank),r.ranges))for(f.ranges=[],o=0;o<r.ranges.length;o++)e=r.ranges[o],f.ranges.push(new n.Range(e.row,e.col,e.rowCount,e.colCount))},u.prototype.getFormulas=function(){return this.formula?[this.formula]:[]},u.prototype.setFormulas=function(n){this.formula=n[0]},u}();n.Top10Condition=p;et=function(r){function u(n){r.call(this,n)}return __extends(u,r),u.prototype.createCondition=function(){return new k(!1,this.ranges)},u.prototype.toJSON=function(){var n=this,r={ruleType:6,ranges:n.ranges,style:n.style,priority:n._priority,stopIfTrue:n._stopIfTrue},u={},t,i;for(t in r)i=r[t],n._isDefaultValue(t,i)||(u[t]=i);return u},u.prototype.fromJSON=function(r,u){var f,o,e;if(r){if(f=this,r.ranges)for(f.ranges=[],o=0;o<r.ranges.length;o++)e=r.ranges[o],f.ranges.push(new n.Range(e.row,e.col,e.rowCount,e.colCount));r.style&&(f.style=new n.Style,f.style.fromJSON(r.style,u));r.priority!==t&&r.priority!==i&&(f._priority=r.priority);r.stopIfTrue!==t&&r.stopIfTrue!==i&&(f._stopIfTrue=r.stopIfTrue)}},u}(o);n.UniqueRule=et;ot=function(r){function u(n){r.call(this,n)}return __extends(u,r),u.prototype.createCondition=function(){return new k(!0,this.ranges)},u.prototype.toJSON=function(){var n=this,r={ruleType:7,ranges:n.ranges,style:n.style,priority:n._priority,stopIfTrue:n._stopIfTrue},u={},t,i;for(t in r)i=r[t],n._isDefaultValue(t,i)||(u[t]=i);return u},u.prototype.fromJSON=function(r,u){var f,o,e;if(r){if(f=this,r.ranges)for(f.ranges=[],o=0;o<r.ranges.length;o++)e=r.ranges[o],f.ranges.push(new n.Range(e.row,e.col,e.rowCount,e.colCount));r.style&&(f.style=new n.Style,f.style.fromJSON(r.style,u));r.priority!==t&&r.priority!==i&&(f._priority=r.priority);r.stopIfTrue!==t&&r.stopIfTrue!==i&&(f._stopIfTrue=r.stopIfTrue)}},u}(o);n.DuplicateRule=ot;k=function(){function u(n,i){var r=this;r.conditionType="UniqueCondition";r.ignoreBlank=!1;r.formula=t;r.expected=n;r.ranges=i}return u.prototype.adjustOffset=function(n,t){},u.prototype.evaluate=function(u,f,e,o){var c=this,s=o,h,l;return s===i||s===t||s===""?c.ignoreBlank:(n.util.hasCalc()&&r.num(s)&&(s=r.D(s)),h=c.getExpectedBoolean(u,f,e),h!==i&&h!==t)?(l=c.getDuplicated(u,c.ranges),l!==i&&l!==t)?n.ArrayHelper.contains(l,s)?h===!0:h!==!0:h!==!0:!1},u.prototype.getExpectedBoolean=function(n,i,u){var f=this.getExpected(n,i,u);try{return r.B(f)}catch(e){return t}},u.prototype.getExpected=function(n,i,r){var u=this,f,e;return u.formula&&u.formula.length>0?(f=n.getCalcService(),!f)?u.expected:(e=f.parse(t,u.formula,i,r),f.evaluateParsedFormula(n._getSheetSource(),e,i,r,!1)):u.expected},u.prototype.adjustRange=function(t,i){return new n.Range(t.row,t.col,Math.min(t.rowCount,i.getRowCount()),Math.min(t.colCount,i.getColumnCount()))},u.prototype.getDuplicated=function(u,f){var e=[],p=[],w,l,o,a,b,v,k,s;if(f){for(w=f.length,l=0;l<w;l++)for(o=f[l],o=this.adjustRange(o,u),a=0;a<o.rowCount;a++)for(b=a+o.row,v=0;v<o.colCount;v++)k=v+o.col,s=u.getValue(b,k,3),s!==i&&s!==t&&n.util.hasCalc()&&r.num(s)&&(s=r.D(s)),e.push(s);e.sort();for(var h=0,c=0,d=e.length,y=e[h];c<d;)e[c]!==y&&(c!==h+1&&p.push(y),h=c,y=e[h]),c++;h!==d-1&&p.push(y)}return e=t,p},u.prototype._containsKey=function(n,t){for(var r=n.length,i=0;i<r;i++)if(n[i].key===t)return!0;return!1},u.prototype.reset=function(){this.expected=t;this.ignoreBlank=!1;this.ranges=t},u.prototype._isDefaultValue=function(n,i){switch(n){case"formula":return i===t;case"ignoreBlank":return i===!1;default:return!1}},u.prototype.toJSON=function(){var n=this,r={expected:n.expected,formula:n.formula,ranges:n.ranges,conType:9,ignoreBlank:n.ignoreBlank},u={},t,i;for(t in r)i=r[t],n._isDefaultValue(t,i)||(u[t]=i);return u},u.prototype.fromJSON=function(r,u){var f,o,e;if(r){if(f=this,r.expected!==t&&r.expected!==i&&(f.expected=r.expected),r.formula!==t&&r.formula!==i&&(f.formula=r.formula),r.ranges)for(f.ranges=[],o=0;o<r.ranges.length;o++)e=r.ranges[o],f.ranges.push(new n.Range(e.row,e.col,e.rowCount,e.colCount));r.ignoreBlank!==t&&r.ignoreBlank!==i&&(f.ignoreBlank=r.ignoreBlank)}},u.prototype.getFormulas=function(){return this.formula?[this.formula]:[]},u.prototype.setFormulas=function(n){this.formula=n[0]},u}();n.UniqueCondition=k;st=function(r){function u(n,t){r.call(this,t);this.type=n}return __extends(u,r),u.prototype.createCondition=function(){return new ht(this.type,this.ranges)},u.prototype.reset=function(){var n=this;n.type=0;n.style=t;n._stopIfTrue=!1;n._priority=1},u.prototype.toJSON=function(){var n=this,r={ruleType:8,ranges:n.ranges,style:n.style,type:n.type,priority:n._priority,stopIfTrue:n._stopIfTrue},u={},t,i;for(t in r)i=r[t],n._isDefaultValue(t,i)||(u[t]=i);return u},u.prototype.fromJSON=function(r,u){var f,o,e;if(r){if(f=this,r.ranges)for(f.ranges=[],o=0;o<r.ranges.length;o++)e=r.ranges[o],f.ranges.push(new n.Range(e.row,e.col,e.rowCount,e.colCount));r.style&&(f.style=new n.Style,f.style.fromJSON(r.style,u));r.type!==t&&r.type!==i&&(f.type=r.type);r.priority!==t&&r.priority!==i&&(f._priority=r.priority);r.stopIfTrue!==t&&r.stopIfTrue!==i&&(f._stopIfTrue=r.stopIfTrue)}},u}(o);n.AverageRule=st;ht=function(){function u(n,i){var r=this;r.conditionType="AverageCondition";r.ignoreBlank=!1;r._expr=t;r._stdevExpr=t;r.type=n;r.ranges=i}return u.prototype.adjustOffset=function(n,t){},u.prototype.evaluate=function(u,f,e,o){var l,a,c;if(!n.util.hasCalc())return!1;if(l=this,l.ignoreBlank&&(o===i||o===t||o===""))return!0;a=r.D;l._rebuildFormula();var h=l.getExpectedDouble(u,f,e),s=t,v=l._stdevExpr?l._getExpectedByExpression(u,l._stdevExpr,f,e):t;if(v!==i&&v!==t)try{s=a(v)}catch(y){s=NaN}if(r.num(o)&&(c=a(o),!isNaN(h)))switch(l.type){case 0:return c>h;case 1:return c<h;case 2:return c>=h;case 3:return c<=h;case 4:return isNaN(s)?!1:c>h+s;case 5:return isNaN(s)?!1:c<h-s;case 6:return isNaN(s)?!1:c>h+2*s;case 7:return isNaN(s)?!1:c<h-2*s;case 8:return isNaN(s)?!1:c>h+3*s;case 9:return isNaN(s)?!1:c<h-3*s}return!1},u.prototype._rebuildFormula=function(){var n=this;n.ranges&&(n._expr=n._createExpression("AVERAGE",n.ranges),(n.type===4||n.type===5||n.type===6||n.type===7||n.type===8||n.type===9)&&(n._stdevExpr=n._createExpression("STDEV",n.ranges)))},u.prototype._createExpression=function(i,u){var o,c,e,f;if(!n.util.hasCalc())return t;var s=n.Calc.Expressions,l=n.Calc.Functions,h=l.findGlobalFunction(i);if(h){for(o=[],c=u.length,e=0;e<c;e++)if(f=u[e],f instanceof s.Expression)o[e]=f;else if(f instanceof n.Range)o[e]=new s.RangeExpression(f.row,f.col,f.row+f.rowCount-1,f.col+f.colCount-1);else if(r.num(f)&&!isNaN(f=r.D(f)))o[e]=new s.DoubleExpression(f,f.toString());else throw n.SR.Exp_NotSupport;return new s.FunctionExpression(h,o)}return t},u.prototype.getExpectedDouble=function(n,t,i){var u=this.getExpected(n,t,i);try{return r.D(u)}catch(f){return NaN}},u.prototype.getExpected=function(n,i,r){var u=n.getCalcService(),f;return u?(f=u.unparseWithoutCulture(t,this._expr,i,r),this._expr=u.parse(t,f,i,r),u.evaluateParsedFormula(n._getSheetSource(),this._expr,i,r,!1)):t},u.prototype._getExpectedByExpression=function(n,i,r,u){var f=n.getCalcService(),e;return f?(e=f.unparseWithoutCulture(t,i,r,u),i=f.parse(t,e,r,u),f.evaluateParsedFormula(n._getSheetSource(),i,r,u,!1)):t},u.prototype.reset=function(){var n=this;n.ignoreBlank=!1;n.type=0;n.ranges=t;n._expr=t;n._stdevExpr=t},u.prototype._isDefaultValue=function(n,t){switch(n){case"ignoreBlank":return t===!1;default:return!1}},u.prototype.toJSON=function(){var n=this,r={type:n.type,ranges:n.ranges,conType:10,ignoreBlank:n.ignoreBlank},u={},t,i;for(t in r)i=r[t],n._isDefaultValue(t,i)||(u[t]=i);return u},u.prototype.fromJSON=function(r,u){var f,o,e;if(r){if(f=this,r.type!==t&&r.type!==i&&(f.type=r.type),r.ranges)for(f.ranges=[],o=0;o<r.ranges.length;o++)e=r.ranges[o],f.ranges.push(new n.Range(e.row,e.col,e.rowCount,e.colCount));r.ignoreBlank!==t&&r.ignoreBlank!==i&&(f.ignoreBlank=r.ignoreBlank)}},u}();n.AverageCondition=ht;u=function(){function n(n,t){this.type=n;this.value=t}return n}();n.ScaleValue=u;l=function(u){function f(n,i,r){u.call(this,t);var f=this;f.expected=[];f.lowestValueCached=t;f.highestValueCached=t;f.cached=!1;f._oldRanges=t;f.scales=[n,i,r]}return __extends(f,u),f.prototype.stopIfTrue=function(){return this._stopIfTrue},f.prototype.isScaleRule=function(){return!0},f.prototype.createCondition=function(){return t},f.prototype._calculateLowestValueEx=function(n){var i=(new p).getMinValues(n,1,this.ranges);return i.length>0?i[0]:t},f.prototype._calculateHighestValueEx=function(n){var i=(new p).getMaxValues(n,1,this.ranges);return i.length>0?i[0]:t},f.prototype._cloneRanges=function(t){for(var u=[],f=t.length,i,r=0;r<f;r++)i=t[r],u.push(new n.Range(i.row,i.col,i.rowCount,i.colCount));return u},f.prototype._rangesChanged=function(){var t=this._oldRanges,r=this.ranges,u,i,n;if(!t)return!1;if(u=t.length,i=r.length,u!==i)return!0;for(n=0;n<i;n++)if(!t[n].equals(r[n]))return!0;return!1},f.prototype._tryCache=function(n){var t=this;t._rangesChanged()&&(t._clearCache(),t._oldRanges=t._cloneRanges(t.ranges));t.cached===!1&&(t.lowestValueCached=t._calculateLowestValueEx(n),t.highestValueCached=t._calculateHighestValueEx(n),t.cached=!0)},f.prototype._clearCache=function(){this.lowestValueCached=t;this.highestValueCached=t;this.cached=!1},f.prototype._calculateFormula=function(n,i,r,u){var f,e;return u&&u.length>0?(f=n.getCalcService(),!f)?t:(e=f.parse(t,u,i,r),f.evaluateParsedFormula(n._getSheetSource(),e,i,r,!1)):t},f.prototype._isFormula=function(n){return n&&n[0]==="="},f.prototype._trimFormula=function(n){return n===i||n===t||n===""?t:n[0]==="="?n.substr(1):n},f.prototype._calculateValue=function(n,i,u,f){var e=t;if(this._isFormula(f))e=this._calculateFormula(n,i,u,this._trimFormula(f.toString()));else try{e=r.D(f)}catch(o){e=NaN}return e},f.prototype._getHighestValue=function(n){return this._tryCache(n),this.highestValueCached},f.prototype._getLowestValue=function(n){return this._tryCache(n),this.lowestValueCached},f.prototype._calculatePercent=function(n,i,r,u){var e=this._calculateValue(n,i,r,u),f,o;return!isNaN(e)&&0<=e&&e<=100&&(f=this._getLowestValue(n),o=this._getHighestValue(n),typeof f!==h&&f!==t&&typeof o!==h&&o!==t)?f+(o-f)*e/100:t},f.prototype._calculatePercentile=function(n,i,u,f){var e=this._calculateValue(n,i,u,f),o;if(!isNaN(e)&&0<=e&&e<=100){var h=0,c=this.ranges,l=c.length;for(o=0;o<l;o++){var a=this._createExpression("PERCENTILE",[c[o],e/100]),s=n.getCalcService(),v=s.unparseWithoutCulture(t,a,i,u),a=s.parse(t,v,i,u),y=s.evaluateParsedFormula(n._getSheetSource(),a,i,u,!1);try{h+=r.D(y)}catch(p){}}return h/l}return t},f.prototype._getActualValue=function(n,i,r,u,f){var e=this,o=e.scales[u],s,h;if(o)switch(o.type){case 6:return e._calculateValue(n,i,r,o.value);case 2:return e._getHighestValue(n);case 1:return e._getLowestValue(n);case 0:return e._calculateValue(n,i,r,o.value);case 3:return e._calculatePercent(n,i,r,o.value);case 4:return e._calculatePercentile(n,i,r,o.value);case 7:return s=e._getHighestValue(n),s<0?0:s;case 5:return h=e._getLowestValue(n),h>0?0:h}return t},f.prototype._evaluate2Scale=function(n,t,i){return n<=t?0:n>=i?1:(n-t)/(i-t)},f.prototype.evaluate=function(n,u,f,e){var s=this,a;if(s._tryCache(n),s.contains(u,f)){if(e===i||e===t)return t;try{var c=r.D(e),o=s._getActualValue(n,u,f,0),l=s._getActualValue(n,u,f,1),h=s._getActualValue(n,u,f,2);if(isNaN(l)){if(!isNaN(o)&&!isNaN(h))return o>h?t:s._evaluate2Scale(c,o,h)}else if(!isNaN(o)&&!isNaN(h)&&!isNaN(l))return o>h?t:c<o?0:c>=h?2:(a=s._evaluate2Scale(l,o,h),o<=c&&c<=l?s._evaluate2Scale(c,o,l):1+s._evaluate2Scale(c,o,h))}catch(v){return t}}return t},f.prototype._evaluateColor=function(i,r,u){if(0<=i&&i<=1){var f=n._Color.parse(r),e=n._Color.parse(u),o=f.a*(1-i)+e.a*i,s=f.r*(1-i)+e.r*i,h=f.g*(1-i)+e.g*i,c=f.b*(1-i)+e.b*i;return new n._Color(parseFloat(o/255),parseInt(s,10),parseInt(h,10),parseInt(c,10)).toString()}return t},f.prototype._createExpression=function(i,u){var o,c,e,f;if(!n.util.hasCalc())return t;var s=n.Calc.Expressions,l=n.Calc.Functions,h=l.findGlobalFunction(i);if(h){for(o=[],c=u.length,e=0;e<c;e++)if(f=u[e],f instanceof s.Expression)o[e]=f;else if(f instanceof n.Range)o[e]=new s.RangeExpression(f.row,f.col,f.row+f.rowCount-1,f.col+f.colCount-1);else if(r.num(f)&&!isNaN(f=r.D(f)))o[e]=new s.DoubleExpression(f,f.toString());else throw n.SR.Exp_NotSupport;return new s.FunctionExpression(h,o)}return t},f.prototype._addRows=function(n,t){u.prototype._addRows.call(this,n,t);this._clearCache()},f.prototype._addColumns=function(n,t){u.prototype._addColumns.call(this,n,t);this._clearCache()},f.prototype._removeRows=function(n,t){u.prototype._removeRows.call(this,n,t);this._clearCache()},f.prototype._removeColumns=function(n,t){u.prototype._removeColumns.call(this,n,t);this._clearCache()},f}(o);n.ScaleRule=l;ct=function(f){function e(i,r,e,o,s,h){var c=i,l=r,a=e,v=o,y=s,p=h,w,b;arguments.length===0&&(c=1,l=t,a=new n._Color(0,255,255,255).toString(),v=2,y=t,p=new n._Color(255,99,190,123).toString());w=new u(c,l);b=new u(v,y);f.call(this,w,t,b);this.expected[0]=a;this.expected[2]=p}return __extends(e,f),e.prototype.evaluate=function(n,u,f,e){var s,l;if(e!==i&&e!==t){s=NaN;try{r.num(e)&&(s=r.D(e))}catch(a){return t}if(isNaN(s))return t;var o=this,h=o._getActualValue(n,u,f,0),c=o._getActualValue(n,u,f,2);if(h!==i&&h!==t&&c!==i&&c!==t)return l=o._evaluate2Scale(s,h,c),o._evaluateColor(l,o.expected[0],o.expected[2])}return t},e.prototype._init=function(){var i=this;i.scales=new Array(3);i.scales[0]=new u(1,t);i.scales[2]=new u(2,t);i.expected=new Array(3);i.expected[0]=new n._Color(0,255,255,255).toString();i.expected[2]=new n._Color(255,99,190,123).toString()},e.prototype.reset=function(){var n=this;n.ranges=t;n.condition=t;n.style=t;n._stopIfTrue=!1;n._priority=1;n._init()},e.prototype.getMinimumType=function(){var n=this.scales;return n&&n.length===3?n[0].type:t},e.prototype.setMinimumType=function(n){var t=this.scales;t&&t.length===3&&(t[0].type=n)},e.prototype.getMinimumValue=function(){var n=this.scales;return n&&n.length===3?n[0].value:t},e.prototype.setMinimumValue=function(n){var t=this.scales;t&&t.length===3&&(t[0].value=n)},e.prototype.getMinimumColor=function(){return this.expected&&this.expected.length===3?this.expected[0]:t},e.prototype.setMinimumColor=function(n){this.expected&&this.expected.length===3&&(this.expected[0]=n)},e.prototype.getMaximumType=function(){var n=this.scales;return n&&n.length===3?n[2].type:t},e.prototype.setMaximumType=function(n){var t=this.scales;t&&t.length===3&&(t[2].type=n)},e.prototype.getMaximumValue=function(){var n=this.scales;return n&&n.length===3?n[2].value:t},e.prototype.setMaximumValue=function(n){var t=this.scales;t&&t.length===3&&(t[2].value=n)},e.prototype.getMaximumColor=function(){return this.expected&&this.expected.length===3?this.expected[2]:t},e.prototype.setMaximumColor=function(n){this.expected&&this.expected.length===3&&(this.expected[2]=n)},e.prototype._isDefaultValue=function(n,i){switch(n){case"ranges":return i===t;case"priority":return i===1;case"stopIfTrue":return i===!1;default:return!1}},e.prototype.toJSON=function(){var n=this,r={ruleType:10,ranges:n.ranges,minType:n.getMinimumType(),minValue:n.getMinimumValue(),minColor:n.getMinimumColor(),maxType:n.getMaximumType(),maxValue:n.getMaximumValue(),maxColor:n.getMaximumColor(),priority:n._priority},u={},t,i;for(t in r)i=r[t],n._isDefaultValue(t,i)||(u[t]=i);return u},e.prototype.fromJSON=function(r,u){var f,o,e;if(r){if(f=this,r.ranges)for(f.ranges=[],o=0;o<r.ranges.length;o++)e=r.ranges[o],f.ranges.push(new n.Range(e.row,e.col,e.rowCount,e.colCount));r.minType!==t&&r.minType!==i&&f.setMinimumType(r.minType);r.minValue!==t&&r.minValue!==i&&f.setMinimumValue(r.minValue);r.minColor!==t&&r.minColor!==i&&f.setMinimumColor(r.minColor);r.maxType!==t&&r.maxType!==i&&f.setMaximumType(r.maxType);r.maxValue!==t&&r.maxValue!==i&&f.setMaximumValue(r.maxValue);r.maxColor!==t&&r.maxColor!==i&&f.setMaximumColor(r.maxColor);r.priority!==t&&r.priority!==i&&(f._priority=r.priority);f._stopIfTrue=!1}},e}(l);n.TwoScaleRule=ct;lt=function(f){function e(i,r,e,o,s,h,c,l,a){var v=i,y=r,p=e,w=o,b=s,k=h,d=c,g=l,nt=a;arguments.length===0&&(v=1,y=t,p=new n._Color(255,248,105,107).toString(),w=4,b=50,k=new n._Color(255,255,235,132).toString(),d=2,g=t,nt=new n._Color(255,99,190,123).toString());f.call(this,new u(v,y),new u(w,b),new u(d,g));this.expected[0]=p;this.expected[1]=k;this.expected[2]=nt}return __extends(e,f),e.prototype.evaluate=function(n,u,f,e){var o=this,s,a;if(o._evaluator=n,e!==i&&e!==t){s=NaN;try{r.num(e)&&(s=r.D(e))}catch(v){return t}if(isNaN(s))return t;var h=o._getActualValue(n,u,f,0),c=o._getActualValue(n,u,f,1),l=o._getActualValue(n,u,f,2);if(h!==i&&h!==t&&l!==i||l!==t&&c!==i&&c!==t)return h>l?t:s<h?o.expected[0]:s>=l?o.expected[2]:h<=s&&s<=c?(a=o._evaluate2Scale(s,h,c),o._evaluateColor(a,o.expected[0],o.expected[1])):(a=o._evaluate2Scale(s,c,l),o._evaluateColor(a,o.expected[1],o.expected[2]))}return t},e.prototype._init=function(){var i=this;i.scales=new Array(3);i.scales[0]=new u(1,t);i.scales[1]=new u(4,50);i.scales[2]=new u(2,t);i.expected=new Array(3);i.expected[0]=new n._Color(255,248,105,107).toString();i.expected[1]=new n._Color(255,255,235,132).toString();i.expected[2]=new n._Color(255,99,190,123).toString()},e.prototype.reset=function(){var n=this;n.ranges=t;n.condition=t;n.style=t;n._init();n._evaluator=t;n._stopIfTrue=!1;n._priority=1},e.prototype.getMinimumType=function(){var n=this.scales;return n&&n.length===3?n[0].type:t},e.prototype.setMinimumType=function(n){var t=this.scales;t&&t.length===3&&(t[0].type=n)},e.prototype.getMinimumValue=function(){var n=this.scales;return n&&n.length===3?n[0].value:t},e.prototype.setMinimumValue=function(n){var t=this.scales;t&&t.length===3&&(t[0].value=n)},e.prototype.getMinimumColor=function(){return this.expected&&this.expected.length===3?this.expected[0]:t},e.prototype.setMinimumColor=function(n){this.expected&&this.expected.length===3&&(this.expected[0]=n)},e.prototype.getMidpointType=function(){var n=this.scales;return n&&n.length===3?n[1].type:t},e.prototype.setMidpointType=function(n){var t=this.scales;t&&t.length===3&&(t[1].type=n)},e.prototype.getMidpointValue=function(){var n=this,i=n.scales;if(i&&i.length===3){if(n._evaluator)if(i[1].type===2)return n._getHighestValue(n._evaluator);else if(i[1].type===1)return n._getLowestValue(n._evaluator);return i[1].value}return t},e.prototype.setMidpointValue=function(n){var t=this.scales;t&&t.length===3&&(t[1].value=n)},e.prototype.getMidpointColor=function(){return this.expected&&this.expected.length===3?this.expected[1]:t},e.prototype.setMidpointColor=function(n){this.expected&&this.expected.length===3&&(this.expected[1]=n)},e.prototype.getMaximumType=function(){var n=this.scales;return n&&n.length===3?n[2].type:t},e.prototype.setMaximumType=function(n){var t=this.scales;t&&t.length===3&&(t[2].type=n)},e.prototype.getMaximumValue=function(){var n=this.scales;return n&&n.length===3?n[2].value:t},e.prototype.setMaximumValue=function(n){var t=this.scales;t&&t.length===3&&(t[2].value=n)},e.prototype.getMaximumColor=function(){return this.expected&&this.expected.length===3?this.expected[2]:t},e.prototype.setMaximumColor=function(n){this.expected&&this.expected.length===3&&(this.expected[2]=n)},e.prototype._isDefaultValue=function(n,i){switch(n){case"ranges":return i===t;case"priority":return i===1;case"stopIfTrue":return i===!1;default:return!1}},e.prototype.toJSON=function(){var n=this,r={ruleType:11,ranges:n.ranges,minType:n.getMinimumType(),minValue:n.getMinimumValue(),minColor:n.getMinimumColor(),midType:n.getMidpointType(),midValue:n.getMidpointValue(),midColor:n.getMidpointColor(),maxType:n.getMaximumType(),maxValue:n.getMaximumValue(),maxColor:n.getMaximumColor(),priority:n._priority},u={},t,i;for(t in r)i=r[t],n._isDefaultValue(t,i)||(u[t]=i);return u},e.prototype.fromJSON=function(r,u){var f,o,e;if(r){if(f=this,r.ranges)for(f.ranges=[],o=0;o<r.ranges.length;o++)e=r.ranges[o],f.ranges.push(new n.Range(e.row,e.col,e.rowCount,e.colCount));r.minType!==t&&r.minType!==i&&f.setMinimumType(r.minType);r.minValue!==t&&r.minValue!==i&&f.setMinimumValue(r.minValue);r.minColor!==t&&r.minColor!==i&&f.setMinimumColor(r.minColor);r.midType!==t&&r.midType!==i&&f.setMidpointType(r.midType);r.midValue!==t&&r.midValue!==i&&f.setMidpointValue(r.midValue);r.midColor!==t&&r.midColor!==i&&f.setMidpointColor(r.midColor);r.maxType!==t&&r.maxType!==i&&f.setMaximumType(r.maxType);r.maxValue!==t&&r.maxValue!==i&&f.setMaximumValue(r.maxValue);r.maxColor!==t&&r.maxColor!==i&&f.setMaximumColor(r.maxColor);r.priority!==t&&r.priority!==i&&(f._priority=r.priority);f._stopIfTrue=!1}},e}(l);n.ThreeScaleRule=lt;at=function(f){function e(i,r,e,o,s){var h=i,c=r,l=e,a=o,v=s,y,p;arguments.length===0&&(h=5,c=t,l=7,a=t,v=new n._Color(255,99,142,198).toString());y=new u(h,c);p=new u(l,a);f.call(this,y,t,p);this._init(v)}return __extends(e,f),e.prototype._init=function(n){var t=this;t._gradient=!0;t._color=n;t._showBorder=!1;t._borderColor="black";t._dataBarDirection=0;t._negativeFillColor="red";t._useNegativeFillColor=!0;t._negativeBorderColor="black";t._useNegativeBorderColor=!1;t._axisPosition=0;t._axisColor="black";t._showBarOnly=!1},e.prototype.reset=function(){var i=this;i.ranges=t;i.condition=t;i.style=t;i._init(new n._Color(255,99,142,198).toString());i._stopIfTrue=!1;i._priority=1;i.scales=[];i.scales[0]=new u(5,t);i.scales[2]=new u(7,t);i.expected=[]},e.prototype._calcuteMinValue=function(n,i,r,u,f){var e=this,h=e.scales[u],s=t,o;if(h)if(h.type===6||h.type===4){for(o=0;o<e.ranges.length;o++)if(e.ranges[o].intersect(i,-1,1,-1)){s=e.ranges[o];break}if(s)return e._getActualValue(n,s.row,s.col,0,f)}else return e._getActualValue(n,i,r,0,f);return t},e.prototype._calcuteMaxValue=function(n,i,r,u,f){var e=this,h=e.scales[u],s=t,o;if(h)if(h.type===6||h.type===4){for(o=0;o<e.ranges.length;o++)if(e.ranges[o].intersect(i,-1,1,-1)){s=e.ranges[o];break}if(s)return e._getActualValue(n,s.row,s.col,2,f)}else return e._getActualValue(n,i,r,2,f);return t},e.prototype._evaluateNoneScale=function(n,t,i,r){return(r=0,i===t)?n<t?[0,r]:n>i?[1,r]:[.5,r]:n>=i?[1,r]:n<=t?[0,r]:[(n-t)/(i-t),r]},e.prototype._evaluateMidScale=function(n,t,i,r){var u,f,e;if(r=.5,u=a(i-t),i>0&&t>=0)return i===t?[.5,r]:n>=i?[.5,r]:n<=t?[t/i*.5,r]:[a(n/i)*.5,r];else if(i>0&&t<0)return f=i>a(t)?.5:i/u,e=i>a(t)?t/u:-.5,n>0?n>=i?[f,r]:[n/i*f,r]:n<0?n<=t?[e,r]:[n/t*e,r]:[0,r];else if(i<=0&&t<0)return i===t?[-.5,r]:n>=i?[-i/t*.5,r]:n<=t?[-.5,r]:[-n/t*.5,r];else if(i===0&&t===0)return[0,r];return r=-1,[-1,r]},e.prototype._evaluateAutoScale=function(n,t,i,r){var u=a(i-t);if(i>0&&t>=0)return(r=0,t===i)?n<t?[0,r]:n>i?[1,r]:[.5,r]:n<=t?[0,r]:n>=i?[1,r]:[(n-t)/u,r];else if(i>0&&t<0)return r=a(t)/u,n>=i?[1-r,r]:n<=t?[-r,r]:n===0?[0,r]:[(+n)/u,r];else if(i<=0&&t<0)return(r=1,i===t)?n<t?[-1,r]:n>i?[0,r]:[-.5,r]:n>=i?[-0,r]:n<=t?[-1,r]:[(n-i)/u,r];else if(i===0&&t===0)return r=.5,n>0?[.5,r]:n<0?[-.5,r]:[0,r];return r=-1,[-1,r]},e.prototype._evaluateScale=function(n,t,i,r){var u=this;return u._axisPosition===0?u._evaluateAutoScale(n,t,i,r):u._axisPosition===1?u._evaluateMidScale(n,t,i,r):u._evaluateNoneScale(n,t,i,r)},e.paintDataBar=function(t,i,r,u,f,e){var p=new n.Rect(r+2,u+2,f-4,e-4),s=p.x,h=p.y,o=v(a(p.width*i.scale)),c=p.height,w,y,l;if(i.axisLocation===0)i.scale<=0&&(o=0);else if(i.axisLocation===1)i.scale<0?s=s+p.width-o:o=0;else{var b=v(p.width*i.axisLocation+s)+.5,k=p.y,g=1,ut=e-1;for(t.lineWidth=g,t.strokeStyle=i.axisColor,t.beginPath(),w=0;w<=ut;w+=2)i.direction===1?(t.moveTo(2*r+f-b,k+w),t.lineTo(2*r+f-b,k+w+1)):(t.moveTo(b,k+w),t.lineTo(b,k+w+1));t.stroke();i.scale>0?s=b+g:i.scale<0?s=b-o:o=0}if(i.showBorder&&(s=v(s)+.5,o-=1,h+=.5,c-=1),o>=0&&c>=0){if(y=i.fillColor,i.isGradient){l=.9;y=i.direction===1?t.createLinearGradient(2*r+f-s-o,h,2*r+f-s,h+c):t.createLinearGradient(s,h,s+o,h+c);var d=n._Color.parse(i.fillColor),nt=new n._Color(d.a,v(255*l+d.r*(1-l)),v(255*l+d.g*(1-l)),v(255*l+d.b*(1-l))).toString(),tt=i.scale<0?1-l:l,it=i.fillColor,rt=i.scale<0?1:0;i.direction===1?(y.addColorStop(tt,it),y.addColorStop(rt,nt)):(y.addColorStop(tt,nt),y.addColorStop(rt,it))}t.fillStyle!==y&&(t.fillStyle=y);i.direction===1?t.fillRect(2*r+f-s-o,h,o,c):t.fillRect(s,h,o,c);i.showBorder&&o>0&&c>0&&(t.strokeStyle=i.borderColor,i.direction===1?t.strokeRect(2*r+f-s-o,h,o,c):t.strokeRect(s,h,o,c))}},e.prototype.evaluate=function(u,f,e,o){var v=o,l,p,y,a,w,b,k;if(v!==t&&v!==i){l=NaN;try{r.num(v)&&(l=r.D(v))}catch(d){return t}if(isNaN(l))return t;var s=this,h=s._calcuteMinValue(u,f,e,0,o),c=s._calcuteMaxValue(u,f,e,2,o);if(h instanceof Date&&(h=new n._DateTimeHelper(h).toOADate()),c instanceof Date&&(c=new n._DateTimeHelper(c).toOADate()),h!==t&&h!==i&&c!==t&&c!==i)return(h>c&&(p=c,c=h,h=p),a=s._evaluateScale(l,h,c,y),!a||a.length<2)?t:(w=a[0],y=a[1],b=l<0&&s._useNegativeFillColor?s._negativeFillColor:s._color,k=l<0&&s._useNegativeBorderColor?s._negativeBorderColor:s._borderColor,{fillColor:b,borderColor:k,showBorder:s._showBorder,axisColor:s._axisColor,isGradient:s._gradient,direction:s._dataBarDirection,axisLocation:y,scale:w,showBarOnly:s._showBarOnly})}return t},e.prototype.minimumType=function(n){var r=this,i=r.scales;return arguments.length===0?i&&i.length===3?i[0].type:t:(i&&i.length===3&&(i[0].type=n),r)},e.prototype.minimumValue=function(n){var r=this,i=r.scales;return arguments.length===0?i&&i.length===3?i[0].value:t:(i&&i.length===3&&(i[0].value=n),r)},e.prototype.maximumType=function(n){var r=this,i=r.scales;return arguments.length===0?i&&i.length===3?i[2].type:t:(i&&i.length===3&&(i[2].type=n),r)},e.prototype.maximumValue=function(n){var r=this,i=r.scales;return arguments.length===0?i&&i.length===3?i[2].value:t:(i&&i.length===3&&(i[2].value=n),r)},e.prototype.gradient=function(n){return arguments.length===0?this._gradient:(this._gradient=n,this)},e.prototype.color=function(n){return arguments.length===0?this._color:(this._color=n,this)},e.prototype.showBorder=function(n){return arguments.length===0?this._showBorder:(this._showBorder=n,this)},e.prototype.borderColor=function(n){return arguments.length===0?this._borderColor:(this._borderColor=n,this)},e.prototype.dataBarDirection=function(n){return arguments.length===0?this._dataBarDirection:(this._dataBarDirection=n,this)},e.prototype.negativeFillColor=function(n){return arguments.length===0?this._negativeFillColor:(this._negativeFillColor=n,this)},e.prototype.useNegativeFillColor=function(n){return arguments.length===0?this._useNegativeFillColor:(this._useNegativeFillColor=n,this)},e.prototype.negativeBorderColor=function(n){return arguments.length===0?this._negativeBorderColor:(this._negativeBorderColor=n,this)},e.prototype.useNegativeBorderColor=function(n){return arguments.length===0?this._useNegativeBorderColor:(this._useNegativeBorderColor=n,this)},e.prototype.axisPosition=function(n){return arguments.length===0?this._axisPosition:(this._axisPosition=n,this)},e.prototype.axisColor=function(n){return arguments.length===0?this._axisColor:(this._axisColor=n,this)},e.prototype.showBarOnly=function(n){return arguments.length===0?this._showBarOnly:(this._showBarOnly=n,this)},e.prototype._isDefaultValue=function(n,i){switch(n){case"ranges":return i===t;case"gradient":return i===!0;case"showBorder":return i===!1;case"borderColor":return i==="black";case"dataBarDirection":return i===0;case"negativeFillColor":return i==="red";case"useNegativeFillColor":return i===!0;case"negativeBorderColor":return i==="black";case"useNegativeBorderColor":return i===!1;case"axisPosition":return i===0;case"axisColor":return i==="black";case"showBarOnly":return i===!1;case"priority":return i===1;case"stopIfTrue":return i===!1}},e.prototype.toJSON=function(){var n=this,r={ruleType:12,ranges:n.ranges,minType:n.minimumType(),minValue:n.minimumValue(),maxType:n.maximumType(),maxValue:n.maximumValue(),gradient:n.gradient(),color:n.color(),showBorder:n.showBorder(),borderColor:n.borderColor(),dataBarDirection:n.dataBarDirection(),negativeFillColor:n.negativeFillColor(),useNegativeFillColor:n.useNegativeFillColor(),negativeBorderColor:n.negativeBorderColor(),useNegativeBorderColor:n.useNegativeBorderColor(),axisPosition:n.axisPosition(),axisColor:n.axisColor(),showBarOnly:n.showBarOnly(),priority:n._priority},u={},t,i;for(t in r)i=r[t],n._isDefaultValue(t,i)||(u[t]=i);return u},e.prototype.fromJSON=function(r,u){var f,o,e;if(r){if(f=this,r.ranges)for(f.ranges=[],o=0;o<r.ranges.length;o++)e=r.ranges[o],f.ranges.push(new n.Range(e.row,e.col,e.rowCount,e.colCount));r.minType!==t&&r.minType!==i&&f.minimumType(r.minType);r.minValue!==t&&r.minValue!==i&&f.minimumValue(r.minValue);r.maxType!==t&&r.maxType!==i&&f.maximumType(r.maxType);r.maxValue!==t&&r.maxValue!==i&&f.maximumValue(r.maxValue);r.gradient!==t&&r.gradient!==i&&f.gradient(r.gradient);r.color!==t&&r.color!==i&&f.color(r.color);r.showBorder!==t&&r.showBorder!==i&&f.showBorder(r.showBorder);r.borderColor!==t&&r.borderColor!==i&&f.borderColor(r.borderColor);r.dataBarDirection!==t&&r.dataBarDirection!==i&&f.dataBarDirection(r.dataBarDirection);r.negativeFillColor!==t&&r.negativeFillColor!==i&&f.negativeFillColor(r.negativeFillColor);r.useNegativeFillColor!==t&&r.useNegativeFillColor!==i&&f.useNegativeFillColor(r.useNegativeFillColor);r.negativeBorderColor!==t&&r.negativeBorderColor!==i&&f.negativeBorderColor(r.negativeBorderColor);r.useNegativeBorderColor!==t&&r.useNegativeBorderColor!==i&&f.useNegativeBorderColor(r.useNegativeBorderColor);r.axisPosition!==t&&r.axisPosition!==i&&f.axisPosition(r.axisPosition);r.axisColor!==t&&r.axisColor!==i&&f.axisColor(r.axisColor);r.showBarOnly!==t&&r.showBarOnly!==i&&f.showBarOnly(r.showBarOnly);r.priority!==t&&r.priority!==i&&(f._priority=r.priority);f._stopIfTrue=!1}},e}(l);n.DataBarRule=at;s=function(){function n(n,t,i){this.isGreaterThanOrEqualTo=n;this.iconValueType=t;this.iconValue=i}return n}();n.IconCriterion=s;vt=function(u){function f(n){var i=n;arguments.length===0&&(i=0);u.call(this,t,t,t);this._init(i)}return __extends(f,u),f.prototype._initIconSetType=function(n){var t=this;t._iconSetType=n;t._iconSetType>=0&&t._iconSetType<=9?(t._iconCriteria=new Array(2),t._iconCriteria[0]=new s(!0,4,33),t._iconCriteria[1]=new s(!0,4,67)):t._iconSetType>=10&&t._iconSetType<=14?(t._iconCriteria=new Array(3),t._iconCriteria[0]=new s(!0,4,25),t._iconCriteria[1]=new s(!0,4,50),t._iconCriteria[2]=new s(!0,4,75)):t._iconSetType>=15&&t._iconSetType<=19?(t._iconCriteria=new Array(4),t._iconCriteria[0]=new s(!0,4,20),t._iconCriteria[1]=new s(!0,4,40),t._iconCriteria[2]=new s(!0,4,60),t._iconCriteria[3]=new s(!0,4,80)):t._iconSetType>19&&(t._iconCriteria=[])},f.prototype._init=function(n){this._showIconOnly=!1;this._reverseIconOrder=!1;this._initIconSetType(n)},f.prototype._modifyIconIndex=function(n){var t=this._iconCriteria.length+1;return this._reverseIconOrder&&t>2?t-1-n:n},f.prototype._getActualValue=function(n,i,r,u){var e=this,f=e._iconCriteria[u];if(f)switch(f.iconValueType){case 7:return e._calculateValue(n,i,r,f.iconValue);case 1:return e._calculateValue(n,i,r,f.iconValue);case 4:return e._calculatePercent(n,i,r,f.iconValue);case 5:return e._calculatePercentile(n,i,r,f.iconValue)}return t},f.paintIconSet=function(n,t,i,r,u,e,o,s){var c=i+1,l=r+2,a=16,v=16,h;t.showIconOnly&&(o.hAlign==1?c=i+u/2-a/2:o.hAlign==2&&(c=i+u-a-2));o.vAlign==1?l=r+e/2-v/2:o.vAlign==2&&(l=r+e-v-2);h=f.getIcon(t.iconSetType,t.iconIndex);try{h&&s&&($.type(h)==="string"?s.getState(h)?n.drawImage(s.getImage(h),c,l,a,v):s.addImage(h):s.getState(h.image)?n.drawImage(s.getImage(h.image),h.x,h.y,h.w,h.h,c,l,a,v):s.addImage(h.image))}catch(y){}},f.prototype.evaluate=function(n,u,f,e){var s=this,y=e,l,k,a,w,d,c,v;if(y===t||y===i)return t;l=NaN;try{r.num(y)&&(l=r.D(y))}catch(g){return t}if(isNaN(l))return t;var p=0,o=s._iconSetType,b=s._iconCriteria;if(o>=0&&o<=9?p=3:o>=10&&o<=14?p=4:o>=15&&o<=19&&(p=5),!b)return 0;for(k=Number.MAX_VALUE,a=s._showIconOnly,c=p-1;c>0;c--)if(c<b.length+1)if(w=b[c-1],d=w&&w.iconValue,d!==t&&typeof d!==h)if(v=s._getActualValue(n,u,f,c-1),v!==t&&typeof v!==h){if(w.isGreaterThanOrEqualTo){if(l<k&&l>=v)return{iconSetType:o,iconIndex:s._modifyIconIndex(c),showIconOnly:a}}else if(l<k&&l>v)return{iconSetType:o,iconIndex:s._modifyIconIndex(c),showIconOnly:a}}else return{iconSetType:o,iconIndex:s._modifyIconIndex(0),showIconOnly:a};else return{iconSetType:o,iconIndex:s._modifyIconIndex(0),showIconOnly:a};else return{iconSetType:o,iconIndex:s._modifyIconIndex(0),showIconOnly:a};return{iconSetType:o,iconIndex:s._modifyIconIndex(0),showIconOnly:a}},f.prototype.reset=function(){var n=this;n.ranges=t;n.condition=t;n.style=t;n._showIconOnly=!1;n._reverseIconOrder=!1;n._iconSetType=0;n._iconCriteria=t;n._stopIfTrue=!1;n._priority=1;n.scales=[];n.expected=[]},f.prototype.iconSetType=function(n){return arguments.length===0?this._iconSetType:(this._initIconSetType(n),this)},f.prototype.reverseIconOrder=function(n){return arguments.length===0?this._reverseIconOrder:(this._reverseIconOrder=n,this)},f.prototype.showIconOnly=function(n){return arguments.length===0?this._showIconOnly:(this._showIconOnly=n,this)},f.prototype.iconCriteria=function(){return this._iconCriteria},f.prototype._isDefaultValue=function(n,t){switch(n){case"showIconOnly":return t===!1;case"reverseIconOrder":return t===!1;case"priority":return t===1;case"stopIfTrue":return t===!1;default:return!1}},f.prototype.toJSON=function(){var n=this,r={ruleType:13,ranges:n.ranges,iconSetType:n.iconSetType(),iconCriteria:n.iconCriteria(),showIconOnly:n.showIconOnly(),reverseIconOrder:n.reverseIconOrder(),priority:n._priority},u={},t,i;for(t in r)i=r[t],n._isDefaultValue(t,i)||(u[t]=i);return u},f.prototype.fromJSON=function(r,u){var f,o,c,e,h;if(r){if(f=this,r.ranges)for(f.ranges=[],e=0;e<r.ranges.length;e++)o=r.ranges[e],f.ranges.push(new n.Range(o.row,o.col,o.rowCount,o.colCount));if(r.iconSetType!==t&&r.iconSetType!==i&&f._initIconSetType(r.iconSetType),r.iconCriteria!==t&&r.iconCriteria!==i)for(c=r.iconCriteria.length,e=0;e<c;e++)h=r.iconCriteria[e],f._iconCriteria[e]=new s(h.isGreaterThanOrEqualTo,h.iconValueType,h.iconValue);r.showIconOnly!==t&&r.showIconOnly!==i&&f.showIconOnly(r.showIconOnly);r.reverseIconOrder!==t&&r.reverseIconOrder!==i&&f.reverseIconOrder(r.reverseIconOrder);r.priority!==t&&r.priority!==i&&(f._priority=r.priority);f._stopIfTrue=!1}},f._getImageSrc=function(){return"data:image/png;base64,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"},f.getIcon=function(n,i){var e=[["0,160,16,16","0,180,16,16","0,80,16,16",t,t],["0,100,16,16","0,120,16,16","0,140,16,16",t,t],["0,900,16,16","0,920,16,16","0,880,16,16",t,t],["0,820,16,16","0,840,16,16","0,860,16,16",t,t],["0,780,16,16","0,1000,16,16","0,420,16,16",t,t],["0,680,16,16","0,940,16,16","0,400,16,16",t,t],["0,800,16,16","0,1020,16,16","0,440,16,16",t,t],["0,740,16,16","0,1040,16,16","0,400,16,16",t,t],["0,720,16,16","0,980,16,16","0,380,16,16",t,t],["0,700,16,16","0,960,16,16","0,360,16,16",t,t],["0,160,16,16","0,40,16,16","0,60,16,16","0,80,16,16",t],["0,100,16,16","0,0,16,16","0,20,16,16","0,140,16,16",t],["0,220,16,16","0,340,16,16","0,460,16,16","0,760,16,16",t],["0,600,16,16","0,620,16,16","0,640,16,16","0,660,16,16",t],["0,200,16,16","0,680,16,16","0,940,16,16","0,400,16,16",t],["0,160,16,16","0,40,16,16","0,180,16,16","0,60,16,16","0,80,16,16"],["0,100,16,16","0,0,16,16","0,120,16,16","0,20,16,16","0,140,16,16"],["0,580,16,16","0,600,16,16","0,620,16,16","0,640,16,16","0,660,16,16"],["0,480,16,16","0,500,16,16","0,520,16,16","0,540,16,16","0,560,16,16"],["0,240,16,16","0,260,16,16","0,280,16,16","0,300,16,16","0,320,16,16"]],o=f._getImageSrc(),u=e[n][i],r;return u?(r=u.split(","),{image:o,x:r[0],y:r[1],w:r[2],h:r[3]}):t},f}(l);n.IconSetRule=vt;bt=function(){function u(n,t){this.ignoreBlank=!1;this.expected=typeof n=="string"?n:"";this.formula=typeof t=="string"?y($.trim(t),"="):t}return u.prototype._concatArray=function(n,t){var i,r;if(t.length===1)if(i=t[0],i instanceof Array)for(r=0;r<i.length;r++)n.push(i[r]);else n.push(i);else for(r=0;r<t.length;r++)i=t[r],i instanceof Array?i.length>0&&n.push(i[0]):n.push(i)},u.prototype.getValidList=function(n,t,i){for(var u=[],f=this.getValidListImp(n,t,i),r=0,e=f.length;r<e;r++)u.push(f[r].value);return u},u.prototype.getValidListImp=function(n,r,u){var f=this,s=[],h,a,c,l,o,e;if(f.formula&&f.formula.length>0)h=f.getExpected(n,r,u),h instanceof Array?f._concatArray(s,h):s.push(h);else if(f.expected&&f.expected.length>0&&(a=f.expected,c=a.split(","),c))for(l=0;l<c.length;l++)(o=c[l],o!==i&&o!==t&&o!=="")&&(e=$.trim(o),e!==i&&e!==t&&e!==""&&s.push({text:e,value:e}));return s},u.prototype._equals=function(n,t){return n instanceof Date&&t instanceof Date?n.valueOf()===t.valueOf():n===t},u.prototype.evaluate=function(r,u,f,e){var s,h,o,c,l;if(e===i||e===t||e==="")return this.ignoreBlank===!0;if(s=this.getValidList(r,u,f),s)for(h=0;h<s.length;h++)if(o=s[h],(o===i||o===t)&&(e===i||e===t))return!0;else if(o!==i&&o!==t)if(this.formula){if(this._equals(o,e))return!0}else if(c=r.getActualStyle(u,f),l=n.util.parseText2Value(c,o,!0),this._equals(l,e))return!0;return!1},u.prototype.getExpected=function(n,i,u){var c=this,s=[],l,a,e,o,h,y,v,p,f;if(c.formula){if(v=n.getCalcService(),!v)return s;if(p=v.parse(t,c.formula,i,u),f=v.evaluateParsedFormula(n._getSheetSource(),p,i,u,!0),r.ref(f)){l=f.getRowCount(0);a=f.getColumnCount(0);var b=f.getRow(0),k=f.getColumn(0),w=f._source&&f._source._sheet&&f._source._sheet._sheet;for(e=0;e<l;e++)for(s[e]=[],o=0;o<a;o++)h=f.getValue(0,e,o),y=w?w.getText(b+e,k+o):h,s[e][o]={value:h,text:y}}else if(r.arr(f))for(l=f.getRowCount(),a=f.getColumnCount(),e=0;e<l;e++)for(s[e]=[],o=0;o<a;o++)h=f.getValue(e,o),s[e][o]={value:h,text:h}}else s.push({value:c.expected,text:c.expected});return s},u.prototype._isDefaultValue=function(n,t){switch(n){case"ignoreBlank":return t===!1;default:return!1}},u.prototype.toJSON=function(){var n=this,r={expected:n.expected,formula:n.formula,conType:12,ignoreBlank:n.ignoreBlank},u={},t,i;for(t in r)i=r[t],n._isDefaultValue(t,i)||(u[t]=i);return u},u.prototype.fromJSON=function(n,r){n&&(n.expected!==t&&n.expected!==i&&(this.expected=n.expected),n.formula!==t&&n.formula!==i&&(this.formula=n.formula),n.ignoreBlank!==t&&n.ignoreBlank!==i&&(this.ignoreBlank=n.ignoreBlank))},u.fromSource=function(n){return new u(n,t)},u.fromFormula=function(n){return new u("",n)},u.prototype.getFormulas=function(){return this.formula?[this.formula]:[]},u.prototype.setFormulas=function(n){this.formula=n[0]},u}();n.AreaCondition=bt;kt=function(){function r(n){this.rules=[];this._ruleTypes=t;this._cellRuleCache={};this.worksheet=n}return r.prototype.getRule=function(n){return this.rules[n]},r.prototype.count=function(){return this.rules.length},r.prototype._cloneRanges=function(n){for(var r,i=[],u=n.length,t=0;t<u;t++)r=this.worksheet._getActualRange(n[t]),i.push(r);return i},r.prototype._resetCache=function(){var t,n;if(this._cellRuleCache={},t=this._cellRuleCache,this.rules)for(n=0;n<this.rules.length;n++)this._addCache(this.rules[n])},r.prototype.clearCellRuleCache=function(){this._cellRuleCache=i},r.prototype._addCache=function(n){for(var u,f,v=this,y=v._cellRuleCache,t,i,e,o,p=n.ranges,w=v.worksheet,b=w.getRowCount(),k=w.getColumnCount(),s=0;s<p.length;s++){var r=p[s],h=r.row,c=r.col,l=r.rowCount,a=r.colCount;for(h+l-1>=b&&(l=b-h),c+a-1>=k&&(a=k-c),u=0;u<l;u++)for(e=u+h,t=y[e],t||(y[e]=t={}),f=0;f<a;f++)o=f+c,i=t[o],i||(t[o]=i=[]),i.push(n)}},r.prototype._removeCache=function(n){for(var r,o,s,u,f,v=this._cellRuleCache,e,t,l,h,a=n.ranges,c=0;c<a.length;c++)for(r=a[c],o=0;o<r.rowCount;o++)if(l=o+r.row,e=v[l],e)for(s=0;s<r.colCount;s++)if(h=s+r.col,t=e[h],t){for(u=[],f=0;f<t.length;f++)t[f]!==n&&u.push(t[f]);u.length===0&&(u=i);e[h]=u}},r.prototype._removeCacheByRange=function(n,t,r,u){for(var f,s,h,c=this._cellRuleCache,e,l,o=0;o<r;o++)if(s=o+n,e=c[s],e)for(f=0;f<u;f++)h=f+t,e[h]=i},r.prototype.addSpecificTextRule=function(n,t,i,r){var u=new g(n,t,i);return u.ranges=r,this.addRule(u)},r.prototype.addCellValueRule=function(n,t,i,r,u){var f=new d(n,t,i,r);return f.ranges=u,this.addRule(f)},r.prototype.addDateOccurringRule=function(n,t,i){var r=new rt(n,t);return r.ranges=i,this.addRule(r)},r.prototype.addFormulaRule=function(n,t,i){var r=new tt(n,t);return r.ranges=i,this.addRule(r)},r.prototype.addTop10Rule=function(n,t,i,r){var u=new ft(n,t,i);return u.ranges=r,this.addRule(u)},r.prototype.addUniqueRule=function(n,t){var i=new et(n);return i.ranges=t,this.addRule(i)},r.prototype.addDuplicateRule=function(n,t){var i=new ot(n);return i.ranges=t,this.addRule(i)},r.prototype.addAverageRule=function(n,t,i){var r=new st(n,t);return r.ranges=i,this.addRule(r)},r.prototype.add3ScaleRule=function(n,t,i,r,u,f,e,o,s,h){var c=new lt(n,t,i,r,u,f,e,o,s);return c.ranges=h,this.addRule(c)},r.prototype.add2ScaleRule=function(n,t,i,r,u,f,e){var o=new ct(n,t,i,r,u,f);return o.ranges=e,this.addRule(o)},r.prototype.addDataBarRule=function(n,t,i,r,u,f){var e=new at(n,t,i,r,u);return e.ranges=f,this.addRule(e)},r.prototype.addIconSetRule=function(n,t){var i=new vt(n);return i.ranges=t,this.addRule(i)},r.prototype.addRule=function(t){if(this.worksheet){var i=this;return this.worksheet._bindToAutoRefresh(function(t){if(!t)throw new Error(n.SR.Exp_RuleIsNull);for(var r=0;r<i.rules.length;r++)i.rules[r]._priority++;return t._priority=1,t.ranges=i._cloneRanges(t.ranges),i.rules.push(t),i._addCache(t),t})(t)}},r.prototype.removeRule=function(t){if(this.worksheet){var i=this;this.worksheet._bindToAutoRefresh(function(t){t&&(i._removeCache(t),n.ArrayHelper.remove(i.rules,t))})(t)}},r.prototype._removeRange=function(i,r,u,o,s){var k,d,g,nt,tt,it,rt,ut;if(!i.intersect(r,u,o,s))return[i];var h=i.row,p=i.row+i.rowCount-1,c=i.col,w=i.col+i.colCount-1,l=r,a=r+o-1,v=u,y=u+s-1,b=[];return(h!==-1&&c!==-1&&l!==-1&&v!==-1&&(v-c>0&&l-h>0&&(k=new n.Range(h,c,l-h,v-c),b.push(k)),f(y,w)-e(v,c)>=0&&l-h>0&&(d=new n.Range(h,e(v,c),l-h,f(y,w)-e(v,c)+1),b.push(d)),w-y>0&&l-h>0&&(g=new n.Range(h,y+1,l-h,w-y),b.push(g)),v-c>0&&f(a,p)-e(l,h)>=0&&(nt=new n.Range(e(l,h),c,f(a,p)-e(l,h)+1,v-c),b.push(nt)),w-y>0&&f(a,p)-e(l,h)>=0&&(tt=new n.Range(e(l,h),y+1,f(a,p)-e(l,h)+1,w-y),b.push(tt)),v-c>0&&p-a>0&&(it=new n.Range(a+1,c,p-a,v-c),b.push(it)),f(y,w)-e(v,c)>=0&&p-a>0&&(rt=new n.Range(a+1,e(v,c),p-a,f(y,w)-e(v,c)+1),b.push(rt)),w-y>0&&p-a>0&&(ut=new n.Range(a+1,y+1,p-a,w-y),b.push(ut))),b.length>0)?b:t},r.prototype.removeRuleByRange=function(t,i,r,u){if(this.worksheet){var f=this;this.worksheet._bindToAutoRefresh(function(t,i,r,u){var l=[],s,v,e,o,h,y,p,a,c,w;if(f.rules)for(f._removeCacheByRange(t,i,r,u),s=0,v=f.rules.length;s<v;s++)if(e=f.rules[s],e&&e.ranges&&e.intersects(t,i,r,u)){for(o=[],h=0,y=e.ranges.length;h<y;h++)p=e.ranges[h],a=f._removeRange(p,t,i,r,u),a&&(o=o.concat(a));o.length>0?e.ranges=o:l.push(e)}for(c=0,w=l.length;c<w;c++)n.ArrayHelper.remove(f.rules,l[c])})(t,i,r,u)}},r.prototype.clearRule=function(){if(this.worksheet){var n=this;this.worksheet._bindToAutoRefresh(function(){n.rules.length=0;n._resetCache()})()}},r.prototype.getRules=function(n,t){var o=this.rules,f,e,u,s,r,i;if(arguments.length===0||o.length===0)return o;if(n=n===undefined?-1:n,t=t===undefined?-1:t,f=this._cellRuleCache,e=[],n!==-1&&t!==-1){if(u=f[n],u&&(r=u[t],r))for(i=0;i<r.length;i++)e.push(r[i])}else if(n===-1){for(u in f)if(r=f[u][t],r)for(i=0;i<r.length;i++)e.push(r[i])}else if(u=f[n],u)for(s in u)for(r=u[s],i=0;i<r.length;i++)e.push(r[i]);return e},r.prototype.containsRule=function(t,i,r){return t&&n.ArrayHelper.contains(this.rules,t)?t.contains(i,r):!1},r.prototype._clearNullRefRules=function(){var n=this,t,i;if(n.rules)for(t=n.count()-1;t>-1;t--)i=n.rules[t],i.hasNoReference()&&n.removeRule(i)},r.prototype._addRows=function(n,t){var i=this,f,r,u;if(i.rules&&i.worksheet)for(f=i.rules.length,r=0;r<f;r++)u=i.rules[r],u&&u._addRows(n,t);this._resetCache()},r.prototype._addColumns=function(n,t){var i=this,f,r,u;if(i.rules&&i.worksheet)for(f=i.rules.length,r=0;r<f;r++)u=i.rules[r],u&&u._addColumns(n,t);this._resetCache()},r.prototype._removeRows=function(n,t){var i=this,f,r,u;if(i.rules&&i.worksheet)for(f=i.rules.length,r=0;r<f;r++)u=i.rules[r],u&&u._removeRows(n,t);this._resetCache()},r.prototype._removeColumns=function(n,t){var i=this,f,r,u;if(i.rules&&i.worksheet)for(f=i.rules.length,r=0;r<f;r++)u=i.rules[r],u&&u._removeColumns(n,t);this._resetCache()},r.prototype._clearCache=function(){var n=this.rules,r,i,u;if(n!=t&&n.length>0)for(i=0,u=n.length;i<u;i++)r=n[i],r instanceof l&&r._clearCache()},r.prototype.toJSON=function(){for(var u,n=[],r=0;r<this.rules.length;r++)u=this.rules[r],n.push(u?u.toJSON():t);return n.length===0?i:{rules:n}},r.prototype.fromJSON=function(n,i){var u,f,r,o,e;if(n&&n.rules){for(this.rules=[],u=0;u<n.rules.length;u++)f=n.rules[u],r=t,f&&(o=this._getRuleTypes(),e=o[f.ruleType],e&&(r=new e,r.fromJSON(f,i))),r&&this.rules.push(r);this._resetCache()}},r.prototype._getRuleTypes=function(){if(!this._ruleTypes){var n={};n[0]=o;n[1]=d;n[2]=g;n[3]=tt;n[4]=rt;n[5]=ft;n[6]=et;n[7]=ot;n[8]=st;n[9]=l;n[10]=ct;n[11]=lt;n[12]=at;n[13]=vt;this._ruleTypes=n}return this._ruleTypes},r}();n.ConditionalFormats=kt})(n.Sheets||(n.Sheets={}));var t=n.Sheets})(GcSpread||(GcSpread={}))
