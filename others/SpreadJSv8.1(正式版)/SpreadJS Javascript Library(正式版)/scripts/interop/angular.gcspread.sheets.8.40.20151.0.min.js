/*
 *
 * SpreadJS Library 8.40.20151.0
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License. 
 * spread.sales@grapecity.com
 * http://spread.grapecity.com/Pages/Spread-JS-License/
 *
 *
 **/
(function(){function s(n){this.headerText="";this.dataField=""}function u(n){var t,i;return n?(n=n.trim(),t=n.indexOf(",")>=0?n.split(","):n.split(" "),i=new GcSpread.Sheets.LineBorder,i.color=t[0].trim(),t.length>1&&(i.style=GcSpread.Sheets.LineStyle[t[1].trim()]),i):undefined}function r(n,t,i){if(n&&t){t=t.toLowerCase();var r;t==="numbervalidator"?r=GcSpread.Sheets.DefaultDataValidator.createNumberValidator(i.comparisonOperator,i.value1,i.value2,i.isIntegervalue):t==="datevalidator"?r=GcSpread.Sheets.DefaultDataValidator.createDateValidator(i.comparisonOperator,i.value1,i.value2):t==="textlengthvalidator"?r=GcSpread.Sheets.DefaultDataValidator.createTextLengthValidator(i.comparisonOperator,i.value1,i.value2):t==="formulavalidator"?r=GcSpread.Sheets.DefaultDataValidator.createFormulaValidator(i.formula):t==="formulalistvalidator"?r=GcSpread.Sheets.DefaultDataValidator.createFormulaListValidator(i.formulaList):t==="listvalidator"&&(r=GcSpread.Sheets.DefaultDataValidator.createListValidator(i.list));r&&(i.ignoreBlank!==undefined&&(r.ignoreBlank=i.ignoreBlank),i.inCellDropdown!==undefined&&(r.inCellDropdown=i.inCellDropdown),i.showInputMessage!==undefined&&(r.showInputMessage=i.showInputMessage),i.showErrorMessage!==undefined&&(r.showErrorMessage=i.showErrorMessage),i.errorStyle!==undefined&&(r.errorStyle=i.errorStyle),i.inputMessage!==undefined&&(r.inputMessage=i.inputMessage),i.inputTitle!==undefined&&(r.inputTitle=i.inputTitle),i.errorMessage!==undefined&&(r.errorMessage=i.errorMessage),i.errorTitle!==undefined&&(r.errorTitle=i.errorTitle),n.validator=r)}}function v(n,t,i){n._angularDataValidationResult=i}function y(n,t,i){if(i.text!==undefined||i.value!==undefined){i.text===undefined?i.text=i.value:i.value===undefined&&(i.value=i.text);var r;n.items()?r=n.items():(r=[],n.items(r));r.push(i)}}function h(n,t,i){t&&i.groups&&(t=t.toLowerCase().trim(),angular.forEach(i.groups,function(i){t==="rowrangegroup"?n.rowRangeGroup.group(i.index,i.count):n.colRangeGroup.group(i.index,i.count)}))}function p(n,t,i){n.groups||(n.groups=[]);n.groups.push(i)}function ot(n,t,i){rangeGroup.groups||(rangeGroup.groups=[]);rangeGroup.groups.push(i)}function w(n,t){return n[t].call(n).name()}function b(n,t,i){n._columnDefs=i}function k(n,t,i){n._sheetDefs=i;i.spread=n}function d(n,t,i){n.push(i)}function g(n,t,i){n.push(i);n.spread.addSheet(n.length-1,i)}function nt(n,t,i){n._angularDataSource=i}function tt(n,t,i){n.borderLeft||(n.borderLeft=i);n.borderTop||(n.borderTop=i);n.borderRight||(n.borderRight=i);n.borderBottom||(n.borderBottom=i)}var l=angular.module("gcspreadsheets",[]),a=angular.module("wijspread",[]),t,o,f,n,e;for(s.prototype={width:function(n){return arguments.length===0?this.column?this.column.width():undefined:(this._width=n,this.column&&this.column.width(n),this)},visible:function(n){return arguments.length===0?this.column?this.column.visible():undefined:(this._visible=n,this.column&&this.column.visible(n),this)},resizable:function(n){return arguments.length===0?this.column?this.column.resizable():undefined:(this._resizable=n,this.column&&this.column.resizable(n),this)},defaultStyle:function(n){return arguments.length===0?this.sheet?this.sheet.getStyle(-1,this.index,GcSpread.Sheets.SheetArea.viewport):null:(this._defaultStyle=n,this.sheet&&this.sheet.setStyle(-1,this.index,n,GcSpread.Sheets.SheetArea.viewport),this)},attach:function(n,t,i){this.sheet=n;this.column=t;this.index=i;this.updata()},updata:function(){this.sheet.suspendEvent();this._width!==undefined&&this.column.width(this._width);this._visible!==undefined&&this.column.visible(this._visible);this._resizable!==undefined&&this.column.resizable(this._resizable);this._defaultStyle&&this.sheet.setStyle(-1,this.index,this._defaultStyle,GcSpread.Sheets.SheetArea.viewport);this.autoFit&&this.sheet.autoFitColumn(this.index);this.sheet.resumeEvent()}},GcSpread.Sheets.ColumnWrapper=s,t={backcolor:{type:"string",name:"backColor"},forecolor:{type:"string",name:"foreColor"},halign:{type:"enum, HorizontalAlign",name:"hAlign"},valign:{type:"enum, VerticalAlign",name:"vAlign"},font:{type:"string",name:"font"},themefont:{type:"string",name:"themeFont"},formatter:{type:"string",name:"formatter"},border:{type:"LineBordeer",name:"border",getProperties:["borderLeft","borderTop","borderRight","borderBottom"],setFunction:tt,converter:u},borderleft:{type:"LineBorder",name:"borderLeft",converter:u},bordertop:{type:"LineBorder",name:"borderTop",converter:u},borderright:{type:"LineBorder",name:"borderRight",converter:u},borderbottom:{type:"LineBorder",name:"borderBottom",converter:u},locked:{type:"boolean",name:"locked"},wordwrap:{type:"boolean",name:"wordWrap"},textindent:{type:"number",name:"textIndent"},shrinktofit:{type:"boolean",name:"shrinkToFit"},backgroundimage:{type:"string",name:"backgroundImage"},backgroundimagelayout:{type:"enum, ImageLayout",name:"backgroundImageLayout"},numbervalidator:{type:"object",name:"numberValidator",setFunction:r,properties:{comparisonoperator:{type:"enum,ComparisonOperator",name:"comparisonOperator"},value1:{type:"string",name:"value1"},value2:{type:"string",name:"value2"},isintegervalue:{type:"boolean",name:"isIntegerValue"}}},datevalidator:{type:"object",name:"dateValidator",setFunction:r,properties:{comparisonoperator:{type:"enum,ComparisonOperator",name:"comparisonOperator"},value1:{type:"string",name:"value1"},value2:{type:"string",name:"value2"}}},textlengthvalidator:{type:"object",name:"textLengthValidator",setFunction:r,properties:{comparisonoperator:{type:"enum,ComparisonOperator",name:"comparisonOperator"},value1:{type:"string",name:"value1"},value2:{type:"string",name:"value2"}}},formulavalidator:{type:"object",name:"formulaValidator",setFunction:r,properties:{formula:{type:"string",name:"formula"}}},formulalistvalidator:{type:"object",name:"formulaListValidator",setFunction:r,properties:{formulalist:{type:"string",name:"formulaList"}}},listvalidator:{type:"object",name:"listValidator",setFunction:r,properties:{list:{type:"string",name:"list"}}},textcelltype:{type:"TextCellType",name:"cellType",properties:{}},buttoncelltype:{type:"ButtonCellType",name:"cellType",properties:{buttonbackcolor:{type:"string",name:"buttonBackColor",setFunction:"buttonBackColor"},marginleft:{type:"number",name:"marginLeft",setFunction:"marginLeft"},margintop:{type:"number",name:"marginTop",setFunction:"marginTop"},marginright:{type:"number",name:"marginRight",setFunction:"marginRight"},marginbottom:{type:"number",name:"marginBottom",setFunction:"marginBottom"},text:{type:"string",name:"text",setFunction:"text"}}},checkboxcelltype:{type:"CheckBoxCellType",name:"cellType",properties:{caption:{type:"string",name:"caption",setFunction:"caption"},isthreestate:{type:"boolean",name:"isThreeState",setFunction:"isThreeState"},textalign:{type:"enum,CheckBoxTextAlign",name:"textAlign",setFunction:"textAlign"},textfalse:{type:"string",name:"textFalse",setFunction:"textFalse"},textindeterminate:{type:"string",name:"textIndeterminate",setFunction:"textIndeterminate"},texttrue:{type:"string",name:"textTrue",setFunction:"textTrue"}}},comboboxcelltype:{type:"ComboBoxCellType",name:"cellType",properties:{editorvaluetype:{type:"enum,EditorValueType",name:"editorValueType",setFunction:"editorValueType"},item:{type:"object",name:"items",setFunction:y,properties:{value:{type:"string",name:"value"},text:{type:"string",name:"text"}}}}},hyperlinkcelltype:{type:"HyperLinkCellType",name:"cellType",properties:{linkcolor:{type:"string",name:"linkColor",setFunction:"linkColor"},linktooltip:{type:"string",name:"linkToolTip",setFunction:"linkToolTip"},text:{type:"string",name:"text",setFunction:"text"},visitedlinkcolor:{type:"string",name:"visitedLinkColor",setFunction:"visitedLinkColor"}}}},o=["numbervalidator","datevalidator","textlengthvalidator","formulavalidator","formulalistvalidator","listvalidator"],f=0;f<o.length;f++)n=t[o[f]].properties,n.ignoreblank={type:"boolean",name:"ignoreBlank"},n.incelldropdown={type:"boolean",name:"inCellDropdown"},n.showinputmessage={type:"boolean",name:"showInputMessage"},n.showerrormessage={type:"boolean",name:"showErrorMessage"},n.errorstyle={type:"enum, ErrorStyle",name:"errorStyle"},n.inputmessage={type:"string",name:"inputMessage"},n.inputtitle={type:"string",name:"inputTitle"},n.errormessage={type:"string",name:"errorMessage"},n.errortitle={type:"string",name:"errorTitle"};var c={group:{type:"object",name:"group",setFunction:p,properties:{index:{type:"number",name:"index"},count:{type:"number",name:"count"}}}},it={datafield:{type:"string",name:"dataField"},headertext:{type:"string",name:"headerText"},width:{type:"number",name:"width",setFunction:"width",getFunction:"width"},visible:{type:"boolean",name:"visible",setFunction:"visible",getFunction:"visible"},resizable:{type:"boolean",name:"resizable",setFunction:"resizable",getFunction:"resizable"},defaultstyle:{type:"Style",name:"defaultStyle",setFunction:"defaultStyle",getFunction:"defaultStyle",properties:t},autofit:{type:"boolean",name:"autoFit"}},rt={column:{type:"ColumnWrapper",name:"column",setFunction:d,properties:it}},ut={name:{type:"string",name:"name",setFunction:"setName",getFunction:"getName"},referencestyle:{type:"enum, ReferenceStyle",name:"referenceStyle",setFunction:"referenceStyle",getFunction:"referenceStyle"},frozentrailingcolumncount:{type:"number",name:"frozenTrailingColumnCount",setFunction:"setFrozenTrailingColumnCount",getFunction:"getFrozenTrailingColumnCount"},frozentrailingrowcount:{type:"number",name:"frozenTrailingRowCount",setFunction:"setFrozenTrailingRowCount",getFunction:"getFrozenTrailingRowCount"},frozencolumncount:{type:"number",name:"frozenColumnCount",setFunction:"setFrozenColumnCount",getFunction:"getFrozenColumnCount"},frozenrowcount:{type:"number",name:"frozenRowCount",setFunction:"setFrozenRowCount",getFunction:"getFrozenRowCount"},defaultstyle:{type:"Style",name:"defaultStyle",setFunction:{name:"setDefaultStyle",args:["$value-replace$",GcSpread.Sheets.SheetArea.viewport]},properties:t},rowheaderdefaultstyle:{type:"Style",name:"rowHeaderDefaultStyle",setFunction:{name:"setDefaultStyle",args:["$value-replace$",GcSpread.Sheets.SheetArea.rowHeader]},properties:t},columnheaderdefaultstyle:{type:"Style",name:"columnHeaderDefaultStyle",setFunction:{name:"setDefaultStyle",args:["$value-replace$",GcSpread.Sheets.SheetArea.colHeader]},properties:t},cornerheaderdefaultstyle:{type:"Style",name:"cornerHeaderDefaultStyle",setFunction:{name:"setDefaultStyle",args:["$value-replace$",GcSpread.Sheets.SheetArea.corner]},properties:t},allowcelloverflow:{type:"boolean",name:"allowCellOverflow",setFunction:"allowCellOverflow",getFunction:"allowCellOverflow"},frozenlinecolor:{type:"string",name:"frozenlineColor",setFunction:"frozenlineColor",getFunction:"frozenlineColor"},sheettabcolor:{type:"string",name:"sheetTabColor",setFunction:"sheetTabColor",getFunction:"sheetTabColor"},rowcount:{type:"number",name:"rowCount",setFunction:"setRowCount",getFunction:"getRowCount"},selectionpolicy:{type:"enum, SelectionPolicy",name:"selectionPolicy",setFunction:"selectionPolicy",getFunction:"selectionPolicy"},selectionunit:{type:"enum,SelectionUnit",name:"selectionUnit",setFunction:"selectionUnit",getFunction:"selectionUnit"},zoom:{type:"number",name:"zoom",setFunction:"zoom",getFunction:"zoom"},currenttheme:{type:"string",name:"currentTheme",setFunction:"currentTheme",getFunction:w},clipboardoptions:{type:"enum,ClipboardPasteOptions",name:"clipBoardOptions",setFunction:"clipBoardOptions",getFunction:"clipBoardOptions"},canuserdragfill:{type:"boolean",name:"canUserDragFill",setFunction:"canUserDragFill",getFunction:"canUserDragFill"},canuserdragdrop:{type:"boolean",name:"canUserDragDrop",setFunction:"canUserDragDrop",getFunction:"canUserDragDrop"},rowheadervisible:{type:"boolean",name:"rowHeaderVisible",setFunction:"setRowHeaderVisible",getFunction:"getRowHeaderVisible"},columnheadervisible:{type:"boolean",name:"columnHeaderVisible",setFunction:"setColumnHeaderVisible",getFunction:"getColumnHeaderVisible"},rowheaderautotext:{type:"enum, HeaderAutoText",name:"rowHeaderAutoText",setFunction:"setRowHeaderAutoText",getFunction:"getRowHeaderAutoText"},columnheaderautotext:{type:"enum, HeaderAutoText",name:"columnHeaderAutoText",setFunction:"setColumnHeaderAutoText",getFunction:"getColumnHeaderAutoText"},rowheaderautotextindex:{type:"number",name:"rowHeaderAutoTextIndex",setFunction:"setRowHeaderAutoTextIndex",getFunction:"getRowHeaderAutoTextIndex"},columnheaderautotextindex:{type:"number",name:"columnHeaderAutoTextIndex",setFunction:"setColumnHeaderAutoTextIndex",getFunction:"getColumnHeaderAutoTextIndex"},isprotected:{type:"boolean",name:"isProtected",setFunction:"setIsProtected",getFunction:"getIsProtected"},showrowrangegroup:{type:"boolean",name:"showRowRangeGroup",setFunction:"showRowRangeGroup",getFunction:"showRowRangeGroup"},showcolumnrangegroup:{type:"boolean",name:"showColumnRangeGroup",setFunction:"showColumnRangeGroup",getFunction:"showColumnRangeGroup"},rowrangegroup:{type:"object",name:"rowRangeGroup",setFunction:h,properties:c},colrangegroup:{type:"object",name:"colRangeGroup",setFunction:h,properties:c},selectionbackcolor:{type:"string",name:"selectionBackColor",setFunction:"selectionBackColor",getFunction:"selectionBackColor"},selectionbordercolor:{type:"string",name:"selectionBorderColor",setFunction:"selectionBorderColor",getFunction:"selectionBorderColor"},columns:{type:"[]",name:"columns",setFunction:b,properties:rt},datasource:{type:"[]",name:"dataSource",setFunction:nt},datasourcedeepwatch:{type:"boolean",name:"dataSourceDeepWatch"}},ft={sheet:{type:"Sheet",name:"sheet",setFunction:g,properties:ut}},et={name:{type:"string",name:"name"},allowuserzoom:{type:"boolean",name:"allowUserZoom",setFunction:"allowUserZoom",getFunction:"allowUserZoom"},allowuserresize:{type:"boolean",name:"allowUserResize",setFunction:"allowUserResize",getFunction:"allowUserResize"},tabstripvisible:{type:"boolean",name:"tabStripVisible",setFunction:"tabStripVisible",getFunction:"tabStripVisible"},tabeditable:{type:"boolean",name:"tabEditable",setFunction:"tabEditable",getFunction:"tabEditable"},newtabvisible:{type:"boolean",name:"newTabVisible",setFunction:"newTabVisible",getFunction:"newTabVisible"},canusereditformula:{type:"boolean",name:"canUserEditFormula",setFunction:"canUserEditFormula",getFunction:"canUserEditFormula"},autofittype:{type:"enum, AutoFitType",name:"autoFitType",setFunction:"autoFitType",getFunction:"autoFitType"},canuserdragfill:{type:"boolean",name:"canUserDragFill",setFunction:"canUserDragFill",getFunction:"canUserDragFill"},canuserdragdrop:{type:"boolean",name:"canUserDragDrop",setFunction:"canUserDragDrop",getFunction:"canUserDragDrop"},highlightinvaliddata:{type:"boolean",name:"highlightInvalidData",setFunction:"highlightInvalidData",getFunction:"highlightInvalidData"},referencestyle:{type:"enum, ReferenceStyle",name:"referenceStyle",setFunction:"referenceStyle",getFunction:"referenceStyle"},backcolor:{type:"string",name:"backColor",setFunction:"backColor",getFunction:"backColor"},grayareabackcolor:{type:"string",name:"grayAreaBackColor",setFunction:"grayAreaBackColor",getFunction:"grayAreaBackColor"},backgroundimage:{type:"string",name:"backgroundImage",setFunction:"backgroundImage",getFunction:"backgroundImage"},backgroundimagelayout:{type:"enum, ImageLayout",name:"backgroundImageLayout",setFunction:"backgroundImageLayout",getFunction:"backgroundImageLayout"},showverticalscrollbar:{type:"boolean",name:"showVerticalScrollbar",setFunction:"showVerticalScrollbar",getFunction:"showVerticalScrollbar"},showhorizontalscrollbar:{type:"boolean",name:"showHorizontalScrollbar",setFunction:"showHorizontalScrollbar",getFunction:"showHorizontalScrollbar"},showscrolltip:{type:"enum, ShowScrollTip",name:"showScrollTip",setFunction:"showScrollTip",getFunction:"showScrollTip"},showresizetip:{type:"enum, ShowResizeTip",name:"showResizeTip",setFunction:"showResizeTip",getFunction:"showResizeTip"},showdragdroptip:{type:"boolean",name:"showDragDropTip",setFunction:"showDragDropTip",getFunction:"showDragDropTip"},showdragfilltip:{type:"boolean",name:"showDragFillTip",setFunction:"showDragFillTip",getFunction:"showDragFillTip"},datavalidationresult:{type:"enum, DataValidationResult",name:"DataValidationResult",setFunction:v},sheets:{type:"[]",name:"sheets",setFunction:k,properties:ft}},i;(function(n){n._map=[];n.ELEMENT_NODE=1;n.ATTRIBUTE_NODE=2;n.TEXT_NODE=3;n.CDATA_SECTION_NODE=4;n.ENTITY_REFERENCE_NODE=5;n.ENTITY_NODE=6;n.PROCESSING_INSTRUCTION_NODE=7;n.COMMENT_NODE=8;n.DOCUMENT_NODE=9;n.DOCUMENT_TYPE_NODE=10;n.DOCUMENT_FRAGMENT_NODE=11;n.NOTATION_NODE=12})(i||(i={})),function(n){var t=n;n.setValues=function(n){t.valueCatch&&angular.forEach(t.valueCatch,function(n){var i=n.target;angular.forEach(n.setting,function(n){var r=n.nodeDef,u=n.value;t.setPropertyValue(i,r,u)})})};n.setBindings=function(i){var r=i.$parent;t.bindings&&angular.forEach(t.bindings,function(i){var u,f;i.dynamicText&&(u=i.dynamicText.substring(2,i.dynamicText.length-2),i.target._angularBindingPath||(i.target._angularBindingPath={}),i.target._angularBindingPath[i.name]=u,f=u,r[f]===undefined?r[f]=n.getPropertyValue(i.target,i.metadata):t.setPropertyValue(i.target,i.metadata,r[f]),r.$watch(u,function(n){t.setPropertyValue(i.target,i.metadata,n)}))})};n.initSpread=function(n,i,r){var u=i[0];t._readNodeWithChildren(n,u,et,"sheets",!1)};n._readNodeWithChildren=function(n,i,r,u,f){if(!f){t.valueCatch||(t.valueCatch=[]);var e;angular.forEach(t.valueCatch,function(t){t.target===n&&(e=t)});e||(e={target:n,setting:[]},t.valueCatch.push(e))}angular.forEach(i.attributes,function(i){t._readNode(n,i,r,e,f)});i.childNodes.length>0&&angular.forEach(i.childNodes,function(i){var s=i.nodeName.toLowerCase(),u,o,h;if(s=t.normalizeName(s),u=r[s],u&&u.type){if(u.type==="object")o={};else if(u.type==="[]")o=[];else{if(h=GcSpread.Sheets[u.type],!h)return;o=new h}u.name==="sheets"||u.name==="sheet"||u.name==="columns"||u.name==="column"?t._readNodeWithChildren(o,i,u.properties,undefined,!1):t._readNodeWithChildren(o,i,u.properties,undefined,!0);f?t.setPropertyValue(n,u,o):e.setting.push({nodeDef:u,value:o})}})};n.convertValue=function(n,i,r){var h,o,u,e,s,f;if(r)return r.call(null,n);if(n===undefined||i===undefined)return n;if(typeof n=="string"&&(n=n.trim()),i.length>2&&i[0]==="["&&(h=i.substring(1,i.length-2),n.length>2)){for(n[0]==="["&&n[n.length-1]==="]"&&(n=n.substring(1,n.length-2)),o=n.split(","),u=[],f=0;f<o.length;f++)u.push(t.convertValue(o[f],h,r));return u}switch(i){case"string":return n;case"boolean":if(typeof n=="boolean")return n;if(n.toLowerCase()==="true")return!0;else if(n.toLowerCase()==="false")return!1;return Boolean(n);case"number":return Number(n);case"color":return n;case"[]":return n}if(i.length>5&&i.substring(0,5)==="enum,"){if(typeof n!="number"&&(typeof n!="string"||parseInt(n)===undefined||isNaN(parseInt(n)))){if(i=i.substring(5).trim(),e=GcSpread.Sheets,i.indexOf(".")>0)for(s=name.split("."),f=0;f<s.length;f++)e=u[s[f]];else e=e[i];u=e[n];u===undefined&&(n=n[0].toUpperCase()+n.substring(1),u=e[n])}else u=parseInt(n);return u}return n};n.normalizeName=function(n){if(n.match(/-/)){var t=n.split("-");n=t.shift();angular.forEach(t,function(t){n+=t})}return n};n._readNode=function(n,r,u,f,e){var c=$(r),o,s,l,h;switch(r.nodeType){case i.ATTRIBUTE_NODE:o=c.val();break;case i.ELEMENT_NODE:o=c.text();break;default:return}if(s=r.nodeName||r.name,s=s.toLowerCase(),s=t.normalizeName(s),h=u[s],h)s=h.name;else return;if(!t.hasChildElements(r)&&o&&o.length>4&&o.substring(0,2)==="{{"&&o.substring(o.length-2)==="}}"){t.bindings||(t.bindings=[]);t.bindings.push({target:n,metadata:h,path:s,name:s,dynamicText:o});return}o.match(/^[^\d]/)&&r.nodeType===i.ATTRIBUTE_NODE&&(h.changeEvent||h.twoWayBinding)?(t.bindings||(t.bindings=[]),_ngMgr.bindings.push({target:n,path:(path&&path+".")+s,name:s,expression:o})):r.nodeType===i.ATTRIBUTE_NODE&&(e?t.setPropertyValue(n,h,o):f.setting.push({nodeDef:h,value:o}))};n.setPropertyValue=function(n,i,r){if(r!==undefined){n.$scopeObject&&(n=n.$scopeObject);try{r=t.convertValue(r,i.type,i.converter);i.setFunction?typeof i.setFunction=="function"?i.setFunction.call(t,n,i.name,r):t.setPropertyValueCore(n,r,undefined,i.setFunction):(t.setPropertyValueCore(n,r,i.name),n[i.name]=r)}catch(u){}}};n.setPropertyValueCore=function(n,t,i,r){var f,u,e;if(i)n[i]=t;else if(r)if(typeof r=="string")n[r].call(n,t);else{for(f=r.name,u=[],e=0;e<r.args.length;e++)u[e]=r.args[e]==="$value-replace$"?t:r.args[e];switch(u.length){case 1:n[f].call(n,u[0]);break;case 2:n[f].call(n,u[0],u[1]);break;case 3:n[f].call(n,u[0],u[1],u[2]);break;case 4:n[f].call(n,u[0],u[1],u[2],u[3]);break;case 5:n[f].call(n,u[0],u[1],u[2],u[3],u[4]);break}}};n.getPropertyValue=function(n,i){n.$scopeObject&&(n=n.$scopeObject);var r="";try{if(i.getProperties)angular.forEach(i.getProperties,function(i){r=r===""?t.setPropertyValueCore(n,r,i):r+","+t.setPropertyValueCore(n,r,i)});else if(i.getFunction)if(typeof i.getFunction=="function")return i.getFunction.call(t,n,i.name);else r=t.getPropertyValueCore(n,undefined,i.getFunction);else r=t.getPropertyValueCore(n,name)}catch(u){}return r};n.getPropertyValueCore=function(n,t,i){if(t)return n[t];else if(i&&typeof i=="string")return n[i].call(n);return""};n.hasChildElements=function(n){var r,t,u;if(!n||!n.childNodes)return!1;for(r=n.childNodes.length,t=0;t<r;t++)if(u=n.childNodes[t],u.nodeType==i.ELEMENT_NODE)return!0;return!1};n.angularDerictive=function(){return{restrict:"E",replace:!0,transclude:!0,template:"<div ng-transclude/>",scope:{},controller:["$scope",function(n){}],link:function(t,i,r){function v(i){var f=i._columnDefs&&i._columnDefs.length>0,r;if(f)for(i.setColumnCount(i._columnDefs.length),r=0;r<i._columnDefs.length;r++)i._columnDefs[r].attach(i,i.getColumn(r),r);i.bind(e.Events.ValidationError,function(n,t){t.validationResult=u._angularDataValidationResult!==undefined?u._angularDataValidationResult:e.DataValidationResult.Discard});i.bind(e.Events.ColumnWidthChanged,function(n,t){for(var u,f,e=t.sheet,r=t.colList,i=0;i<r.length;i++)u=e._columnDefs[r[i]],f=u._angularBindingPath&&u._angularBindingPath.width,f&&(o[f]=e.getColumnWidth(r[i]));o.$apply()});i.bind(e.Events.SheetNameChanged,function(n,t){var r=i._angularBindingPath&&i._angularBindingPath.name;r&&(o[r]=t.newValue,o.$apply())});i.bind(e.Events.UserZooming,function(n,t){var r=i._angularBindingPath&&i._angularBindingPath.zoom;r&&(o[r]=t.newValue,o.$apply())});n.setBindings(t)}function y(n,t,i){var f,o,r,u;if(i)if(i!==n.getDataSource()){if(n.isPaintSuspended(!0),f=n._columnDefs&&n._columnDefs.length>0,f)for(n.autoGenerateColumns=!1,n.setDataSource(i,!1),n.setColumnCount(n._columnDefs.length),r=0;r<n._columnDefs.length;r++)p(n,r);else{for(o=b(n),n.autoGenerateColumns=!0,n.setDataSource(i,!1),r=0;r<n.getColumnCount();r++)u=n.getValue(0,r,e.SheetArea.colHeader),u=w(u),n.setValue(0,r,u,e.SheetArea.colHeader),u.indexOf("$$")==0&&(n.deleteColumns(r,1),r--);k(n,o)}n.parent.isPaintSuspended()?n.parent.isPaintSuspended(!1):n.isPaintSuspended(!1)}else i&&t&&i.length!=t.length?(n.setRowCount(i.length),n.invalidateLayout(),n.repaint()):(n.invalidateLayout(),n.repaint());else t&&n.setDataSource(null,!0)}function p(n,t){var r=n.getColumn(t),i=n._columnDefs[t];(i.dataField||i.headerText)&&n.bindColumn(t,{name:i.dataField,displayName:i.headerText});i.updata()}function w(n){for(n=n.charAt(0).toUpperCase()+n.slice(1);n.indexOf("_")>-1;)n=n.replace("_"," ");return n}function b(n){for(var i=[],t=0;t<n.getColumnCount();t++)i.push(n.getColumn(t).width());return i}function k(n,t){if(n.getColumnCount()==t.length)for(var i=0;i<n.getColumnCount();i++)n.getColumn(i).width(t[i])}var s,c,h,f,l,a;n.initSpread(t,i,r);var u=new GcSpread.Sheets.Spread(i[0],0),e=GcSpread.Sheets,o=t.$parent;if(t.$scopeObject=u,u.suspendCalcService(!0),u.isPaintSuspended(!0),n.setValues(t),s=u._sheetDefs,c=!1,s&&s.length>0)for(h=0;h<s.length;h++)f=s[h],f.suspendEvent(),v(f),f._angularDataSource&&(c=!0,l=!0,f.dataSourceDeepWatch!==undefined&&(l=f.dataSourceDeepWatch),a=function(n,t){o.$watch(n._angularDataSource,function(t,i){y(n,i,t)},t)},a(f,l)),f.resumeEvent();c||u.isPaintSuspended(!1);u.resumeCalcService(!1)}}}}(e||(e={}));l.directive("gcspreadSheets",function(){return e.angularDerictive()});a.directive("wijSpread",function(){return e.angularDerictive()})})()
