/*
 *
 * SpreadJS Library 8.40.20151.0
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License. 
 * spread.sales@grapecity.com
 * http://spread.grapecity.com/Pages/Spread-JS-License/
 *
 *
 **/
var __extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},GcSpread;(function(n){(function(n){function u(n,t,i,r,u){if(n)return u?u.call(t,t[i]):t[i];var f=t[i];return t[i]=r,u&&u.call(t,f!==r),t}function d(t,i){if(i&&t){var r=n._ThemeContext.getColor(i,t);if(r)return r}return t}function rt(n,t){return t===1?n.colCount:n.rowCount}function ut(n,t,i,r){return r===1?n.getValue(i.row,i.col+t):n.getValue(i.row+t,i.col)}function ft(n,t,i,r){return r===1?n.getColumnWidth(i.col+t)<=0||n.getRowHeight(i.row)<=0:n.getRowHeight(i.row+t)<=0||n.getColumnWidth(i.col)<=0}var g,nt,a,tt,it,s,h,v,c,p,w;n.feature("sparkline",["core.common","core.theme","core.sheet_model"]);var t=null,r=undefined,b=Math.min,o=Math.floor,l=Math.max,y=Math.abs,k=Math.PI,i="undefined",f={Black:"black",Blue:"Blue",Brown:"Brown"},e={FromArgb:function(t,i,r,u){return new n._Color(t,i,r,u).toString()}};n.__invalidValuePlaceHolder={},function(n){n[n.Gaps=0]="Gaps";n[n.Zero=1]="Zero";n[n.Connect=2]="Connect"}(n.EmptyValueStyle||(n.EmptyValueStyle={}));g=n.EmptyValueStyle,function(n){n[n.individual=0]="individual";n[n.group=1]="group";n[n.custom=2]="custom"}(n.SparklineAxisMinMax||(n.SparklineAxisMinMax={}));nt=n.SparklineAxisMinMax;a=function(){function n(n){var i=this,r;if(n)for(r in n)r&&(i[r]=n[r]);else i._axisColor=f.Black,i._firstMarkerColor=e.FromArgb(255,149,179,215),i._highMarkerColor=f.Blue,i._lastMarkerColor=e.FromArgb(255,149,179,215),i._lowMarkerColor=f.Blue,i._markersColor=e.FromArgb(255,36,64,98),i._negativeColor=f.Brown,i._seriesColor=e.FromArgb(255,36,64,98),i.displayEmptyCellsAs=0,i.rightToLeft=!1,i.displayHidden=!1,i.displayXAxis=!1,i._showFirst=!1,i._showHigh=!1,i._showLast=!1,i._showLow=!1,i._showNegative=!1,i._showMarkers=!1,i.manualMax=0,i.manualMin=0,i.maxAxisType=0,i.minAxisType=0,i.groupMaxValue=0,i.groupMinValue=0,i.lineWeight=1;i._worksheet=t}return n.prototype.axisColor=function(n){return u(arguments.length===0,this,"_axisColor",n)},n.prototype.firstMarkerColor=function(n){return u(arguments.length===0,this,"_firstMarkerColor",n)},n.prototype.highMarkerColor=function(n){return u(arguments.length===0,this,"_highMarkerColor",n)},n.prototype.lastMarkerColor=function(n){return u(arguments.length===0,this,"_lastMarkerColor",n)},n.prototype.lowMarkerColor=function(n){return u(arguments.length===0,this,"_lowMarkerColor",n)},n.prototype.markersColor=function(n){return u(arguments.length===0,this,"_markersColor",n)},n.prototype.negativeColor=function(n){return u(arguments.length===0,this,"_negativeColor",n)},n.prototype.seriesColor=function(n){return u(arguments.length===0,this,"_seriesColor",n)},n.prototype.showFirst=function(n){return u(arguments.length===0,this,"_showFirst",n)},n.prototype.showHigh=function(n){return u(arguments.length===0,this,"_showHigh",n)},n.prototype.showLast=function(n){return u(arguments.length===0,this,"_showLast",n)},n.prototype.showLow=function(n){return u(arguments.length===0,this,"_showLow",n)},n.prototype.showNegative=function(n){return u(arguments.length===0,this,"_showNegative",n)},n.prototype.showMarkers=function(n){return u(arguments.length===0,this,"_showMarkers",n)},n.prototype.clone=function(){var i=this,t=new n;return t._axisColor=i._axisColor,t._firstMarkerColor=i._firstMarkerColor,t._highMarkerColor=i._highMarkerColor,t._lastMarkerColor=i._lastMarkerColor,t._lowMarkerColor=i._lowMarkerColor,t._markersColor=i._markersColor,t._negativeColor=i._negativeColor,t._seriesColor=i._seriesColor,t.displayEmptyCellsAs=i.displayEmptyCellsAs,t.rightToLeft=i.rightToLeft,t.displayHidden=i.displayHidden,t.displayXAxis=i.displayXAxis,t._showFirst=i._showFirst,t._showHigh=i._showHigh,t._showLast=i._showLast,t._showLow=i._showLow,t._showNegative=i._showNegative,t._showMarkers=i._showMarkers,t.manualMax=i.manualMax,t.manualMin=i.manualMin,t.maxAxisType=i.maxAxisType,t.minAxisType=i.minAxisType,t.groupMaxValue=i.groupMaxValue,t.groupMinValue=i.groupMinValue,t.lineWeight=i.lineWeight,t},n.prototype._setThemeContext=function(n){this._worksheet=n},n.prototype._getActualColor=function(n){var i=this._worksheet;return i?d(this[n](),i):t},n.prototype._isDefaultValue=function(n,t){switch(n){case"axisColor":return t===f.Black;case"firstMarkerColor":return t===e.FromArgb(255,149,179,215);case"highMarkerColor":return t===f.Blue;case"lastMarkerColor":return t===e.FromArgb(255,149,179,215);case"lowMarkerColor":return t===f.Blue;case"markersColor":return t===e.FromArgb(255,36,64,98);case"negativeColor":return t===f.Brown;case"seriesColor":return t===e.FromArgb(255,36,64,98);case"displayEmptyCellsAs":return t===0;case"rightToLeft":return t===!1;case"displayHidden":return t===!1;case"displayXAxis":return t===!1;case"showFirst":return t===!1;case"showHigh":return t===!1;case"showLast":return t===!1;case"showLow":return t===!1;case"showNegative":return t===!1;case"showMarkers":return t===!1;case"manualMax":return t===0;case"manualMin":return t===0;case"maxAxisType":return t===0;case"minAxisType":return t===0;case"lineWeight":return t===1;default:return!1}},n.prototype.toJSON=function(){var n=this,f={axisColor:n._axisColor,firstMarkerColor:n._firstMarkerColor,highMarkerColor:n._highMarkerColor,lastMarkerColor:n._lastMarkerColor,lowMarkerColor:n._lowMarkerColor,markersColor:n._markersColor,negativeColor:n._negativeColor,seriesColor:n._seriesColor,displayEmptyCellsAs:n.displayEmptyCellsAs,rightToLeft:n.rightToLeft,displayHidden:n.displayHidden,displayXAxis:n.displayXAxis,showFirst:n._showFirst,showHigh:n._showHigh,showLast:n._showLast,showLow:n._showLow,showNegative:n._showNegative,showMarkers:n._showMarkers,manualMax:n.manualMax,manualMin:n.manualMin,maxAxisType:n.maxAxisType,minAxisType:n.minAxisType,lineWeight:n.lineWeight},i={},t,u;for(t in f)u=f[t],n._isDefaultValue(t,u)||(i[t]=u);return $.isEmptyObject(i)?r:i},n}();n.SparklineSetting=a,function(n){n[n.line=0]="line";n[n.column=1]="column";n[n.winloss=2]="winloss"}(n.SparklineType||(n.SparklineType={}));tt=n.SparklineType,function(n){n[n.Vertical=0]="Vertical";n[n.Horizontal=1]="Horizontal"}(n.DataOrientation||(n.DataOrientation={}));it=n.DataOrientation;s=function(){function i(n,i){var r=this;r.displayDateAxis=!1;r._sparklineGroupManager=t;r._innerList=[];r._axisReference=t;r._axisOrientation=1;r.setting=i;r.sparklineType=n}return i.prototype.add=function(n){var t=this;n&&(t._innerList.push(n),n.group(t),t._adjustGroupMaxMinValue(),t.onGroupChanged())},i.prototype.clear=function(){var n=this;n._innerList&&n._innerList.length!==0&&(n._innerList=[])},i.prototype.remove=function(t){var i=this;return n.ArrayHelper.remove(i._innerList,t),t.onSparklineChanged(),t._group=i.clone(),i._adjustGroupMaxMinValue(),i.onGroupChanged(),i._innerList},i.prototype.contains=function(t){return n.ArrayHelper.contains(this._innerList,t)},i.prototype.onGroupChanged=function(){var n,t;if(this._innerList)for(n=0;n<this._innerList.length;n++)t=this._innerList[n],t&&t.onSparklineChanged()},i.prototype.clone=function(){var n=this,u=n.setting?n.setting.clone():t,r=new i(n.sparklineType,u);return r.displayDateAxis=n.displayDateAxis,r._axisReference=n._axisReference,r._axisOrientation=n._axisOrientation,r},i.prototype.dateAxisData=function(n){return arguments.length===0?u(!0,this,"_axisReference",n):u(!1,this,"_axisReference",n,function(n){n&&this.onGroupChanged()})},i.prototype.dateAxisOrientation=function(n){return arguments.length===0?u(!0,this,"_axisOrientation",n):u(!1,this,"_axisOrientation",n,function(n){n&&this.onGroupChanged()})},i.prototype.count=function(){return this._innerList.length},i.prototype._adjustGroupMaxMinValue=function(){var n=this,t;if(n.setting){n.setting.groupMaxValue=-Number.MAX_VALUE;n.setting.groupMinValue=Number.MAX_VALUE;var r=n.setting.maxAxisType===1,u=n.setting.minAxisType===1,i=!1;if(r||u)for(t=0;t<n._innerList.length;t++){var s=n._innerList[t],f=n._getMaxMinValues(s),e=f.min,o=f.max;r&&n.setting.groupMaxValue<o&&(n.setting.groupMaxValue=o,i=!0);u&&n.setting.groupMinValue>e&&(n.setting.groupMinValue=e,i=!0)}return i}},i.prototype._getMaxMinValues=function(t){var u=-Number.MAX_VALUE,f=Number.MAX_VALUE,s=t.data(),o,e,i,r;if(s)for(o=t._provideValues(s,t.dataOrientation(),!1),e=0;e<o.length;e++)i=o[e],i===n.__invalidValuePlaceHolder&&(i=0),typeof i=="number"&&(r=i,u=u<r?r:u,f=f>r?r:f);return{min:f,max:u}},i.prototype._isDefaultValue=function(n,i){switch(n){case"setting":return i===t;case"displayDateAxis":return i===!1;case"axisReference":return i===t;case"axisOrientation":return i===1;case"sparklines":return i.length===0;default:return!1}},i.prototype.toJSON=function(){var n=this,e={setting:n.setting?n.setting.toJSON():t,displayDateAxis:n.displayDateAxis,sparklineType:n.sparklineType,axisReference:n._axisReference,axisOrientation:n._axisOrientation,sparklines:n._innerList},u={},i,f;for(i in e)f=e[i],n._isDefaultValue(i,f)||(u[i]=f);return $.isEmptyObject(u)?r:u},i.prototype.fromJSON=function(n,i){var u,e,f,s,h,v,o,l;if(n){if(u=this,n.setting){u.setting=new a;e=n.setting;for(f in u.setting)u.setting.hasOwnProperty(f)&&(e.hasOwnProperty(f)?u.setting[f]=e[f]:f.substr(0,1)==="_"&&(s=f.substr(1),e.hasOwnProperty(s)&&(u.setting[f]=e[s])))}if(n.displayDateAxis!==r&&n.displayDateAxis!==t&&(u.displayDateAxis=n.displayDateAxis),n.sparklineType!==r&&n.sparklineType!==t&&(u.sparklineType=n.sparklineType),n.axisReference!==r&&n.axisReference!==t&&(u._axisReference=n.axisReference),n.axisOrientation!==r&&n.axisOrientation!==t&&(u._axisOrientation=n.axisOrientation),n.sparklines)for(u._innerList=[],h=n.sparklines,v=h.length,o=0;o<v;o++)l=new c,l.fromJSON(h[o],i),u.add(l)}},i}();n.SparklineGroup=s;h=function(){function n(n,t,i,r){var u=this;u.X=n;u.Y=t;u.Width=i;u.Height=r;u.Left=u.X;u.Right=u.Left+u.Width;u.Top=u.Y;u.Bottom=u.Y+u.Height}return n}();n._PositionRect=h;v=function(){function f(n){this._minItemHeight=2;this.info=n;this._clearCache()}return f.prototype.sparklineInfo=function(n){return u(arguments.length===0,this,"info")},f.prototype.paint=function(n,t,i,r,u){var f=this;f._clearCache();var e=f._getWorksheet(),o=f.info,s=f._getCachedValues(),h=o.dateAxisData()?f._getCachedDatetimes():[],c=e._zoomFactor;o.setting()._setThemeContext(e);f._paintCore(n,t,i,r,u,s,h,c)},f.prototype._paintCore=function(n,t,i,r,u,f,e,o){n.save();n.rect(t,i,r,u);n.clip();n.beginPath();var s=this;s.info.sparklineType()===0&&s._paintLines(n,t,i,r,u,f,e,o);s._paintDataPoints(n,t,i,r,u,f,e,o);s._paintAxis(n,t,i,r,u,f,e,o);n.restore()},f.prototype._clearCache=function(){var n=this;n._cachedMinDatetime=Number.MAX_VALUE;n._cachedMaxDatetime=-Number.MAX_VALUE;n._cachedMinValue=Number.MAX_VALUE;n._cachedMaxValue=-Number.MAX_VALUE;n._cachedIndexMapping=t;n._cachedValues=t;n._cachedDatetimes=t},f.prototype._getWorksheet=function(){var n=this.info,t=n&&n.group(),i=t&&t._sparklineGroupManager;if(i)return i._sheet},f.prototype._getSpace=function(n,t){return this.info.sparklineType()===0?3+this._getLineWeight(t)+1:3},f.prototype._leftSpace=function(n){return this._getSpace("left",n)},f.prototype._rightSpace=function(n){return this._getSpace("right",n)},f.prototype._topSpace=function(n){return this._getSpace("top",n)},f.prototype._bottomSpace=function(n){return this._getSpace("bottom",n)},f.prototype._getCachedValues=function(){var n=this._cachedValues;if(!n){var t=this.info,i=t.data(),r=t.dataOrientation();n=this._cachedValues=t._provideValues(i,r)}return n},f.prototype._getCachedDatetimes=function(){var n=this._cachedDatetimes;if(!n){var t=this.info,i=t.group(),r=i.dateAxisData(),u=i.dateAxisOrientation();n=this._cachedDatetimes=t._provideValues(r,u,!0)}return n},f.prototype._getCachedIndexMaping=function(u,f){var s=this._cachedIndexMapping,l,v,o,e,p,h,c;if(s)return s;if(s=this._cachedIndexMapping=[],l=n.__invalidValuePlaceHolder,v=u.length,this.sparklineInfo().displayDateAxis()){var w=f.length,y=b(v,w),a=[];for(y>0&&(a=f.slice(0,y)),a.sort(function(n,t){return n===t?0:(n===l&&(n=0),t===l&&(t=0),n-t)}),p=a.length,o=0;o<p;o++)if(h=a[o],typeof h!==i&&h!==t){for(c=n.ArrayHelper.indexOf(f,h);n.ArrayHelper.contains(s,c);)c=n.ArrayHelper.indexOf(f,h,c+1);isNaN(h)||(e=u[c],e!==r&&e!==t&&isNaN(e)&&e!==l||s.push(c))}}else for(o=0;o<v;o++)e=u[o],typeof e!==i&&e!==t&&isNaN(e)&&e!==l||s.push(o);return s},f.prototype._getValue=function(r,u){var f=u[r];return typeof f===i||f===t?this.sparklineInfo().setting().displayEmptyCellsAs===1&&(f=0):f===n.__invalidValuePlaceHolder&&(f=0),f},f.prototype._paintLines=function(n,r,u,f,e,o,s,h){var l=this,y=l._getCachedIndexMaping(o,s),c,p,w,k=y.length-1,d,it,a,v,g,rt,ut,nt,b,ft,tt;for(k<0&&(k=0),d=l.linePos=[],ut=l.sparklineInfo().setting().displayEmptyCellsAs,c=0;c<k;c++)if(it=l._getValue(y[c],o),typeof it!==i&&it!==t){if(v=c+1,a=l._getValue(y[v],o),typeof a===i||a===t)if(ut===1)a=0;else if(ut===2)for(v=c+2;v<=k;v++)if(nt=o[y[v]],typeof nt!==i&&nt!==t){a=nt;break}typeof a!==i&&a!==t?(g=l._getDataPointPosition(y[c],{Width:f,Height:e},o,s,h),rt=l._getDataPointPosition(y[v],{Width:f,Height:e},o,s,h),b=g.Width/2,p={X:g.X+b,Y:g.Y+b},w={X:rt.X+b,Y:rt.Y+b},d[c]={P1:p,P2:w}):c++}if(ft=d.length,ft>0)for(n.strokeStyle=l.info.setting()._getActualColor("seriesColor"),n.lineCap="round",n.lineWidth=l._getLineWeight(h),c=0;c<ft;c++)(tt=d[c],tt)&&(n.beginPath(),p=tt.P1,w=tt.P2,n.moveTo(r+p.X,u+p.Y),n.lineTo(r+w.X,u+w.Y),n.stroke(),n.closePath())},f.prototype._getDataPointColor=function(u,f,e){var h=this,o=t,tt=Number.MAX_VALUE,it=-Number.MAX_VALUE,c=h._getValue(u,f),s=h.info.setting(),v=h._cachedMinValue,y=h._cachedMaxValue,a=h._getCachedIndexMaping(f,e),p=a.length,w=h.info,b=w.group(),k,d,g,nt,l;return typeof c!==i&&c!==t&&((v===Number.MAX_VALUE||y===-Number.MAX_VALUE)&&h._getMaxMinValue(f),k=v,c===k&&s.showLow()&&(o=s._getActualColor("lowMarkerColor")),(typeof o===i||o===t)&&(d=y,c===d&&s.showHigh()&&(o=s._getActualColor("highMarkerColor"))),(typeof o===i||o===t)&&(b.displayDateAxis?(g=n.ArrayHelper.indexOf(a,u),g===0&&s.showFirst()&&(o=s._getActualColor("firstMarkerColor"))):u===0&&s.showFirst()&&(o=s._getActualColor("firstMarkerColor"))),(typeof o===i||o===t)&&(b.displayDateAxis?(nt=n.ArrayHelper.indexOf(a,u),nt===p-1&&s.showLast()&&(o=s._getActualColor("lastMarkerColor"))):u===p-1&&s.showLast()&&(o=s._getActualColor("lastMarkerColor"))),(typeof o===i||o===t)&&c<0&&s.showNegative()&&(o=s._getActualColor("negativeColor")),(typeof o===i||o===t)&&(l=w.sparklineType(),l===0?s.showMarkers()&&(o=s._getActualColor("markersColor")):l===1?o=s._getActualColor("seriesColor"):l===2&&(o=s._getActualColor("seriesColor")))),o===r||o===t?"Transparent":o},f.prototype._paintDataPoints=function(n,t,i,r,u,f,e,s){for(var c=this,tt={Width:r,Height:u},p=c._getCachedIndexMaping(f,e),it=p.length,rt=c.info.sparklineType(),a,v,h,w,b,l,d,g,nt,y=0;y<it;y++)a=p[y],v=c._getDataPointColor(a,f,e),h=c._getDataPointPosition(a,tt,f,e,s),n.fillStyle!==v&&(n.fillStyle=v),rt===0?(n.save(),w=t+h.X+h.Width/2,b=i+h.Y+h.Height/2,n.translate(w,b),n.rotate(k/4),n.fillRect(0-h.Width/2,0-h.Height/2,h.Width,h.Height),n.restore()):(l=t+h.X+h.Width/4,l=o(l),d=i+h.Y,g=h.Width/2,nt=h.Height,n.fillRect(l,d,g,nt))},f.prototype._paintAxis=function(n,t,i,r,u,f,e,s){var h=this,l=h.info.setting();if(l.displayXAxis&&h._hasAxis(f,e)){var a={Width:r,Height:u},p=h._leftSpace(s),w=a.Width-h._rightSpace(s),v=o(h._getAxisY(a,f,s))+.5,b=v,y=l._getActualColor("axisColor"),c=s;c<1&&(c=1);n.strokeStyle!==y&&(n.strokeStyle=y);n.lineWidth!==c&&(n.lineWidth=c);n.beginPath();n.moveTo(t+p,i+v);n.lineTo(t+w,i+b);n.stroke()}},f.prototype._hasAxisNormal=function(n){var i=this._getActualMaxValue(n),t;return i!==-Number.MAX_VALUE&&(t=this._getActualMinValue(n),t!==Number.MAX_VALUE)?i===t||i*t<=0:!0},f.prototype._hasAxis=function(n,r){var f=this._hasAxisNormal(n),e,o,h,s,u;if(this.info.sparklineType()!==2)return f;if(e=this._getCachedIndexMaping(n,r),o=e.length,!f&&o>0)for(u=0;u<o;u++)if(h=e[u],s=n[h],typeof s!==i&&s!==t)return!0;return f},f.prototype._getMinDatetime=function(n,t){var i=this._cachedMinDatetime;return(isNaN(i)||i===Number.MAX_VALUE)&&this._getMaxMindatetimes(n,t),this._cachedMinDatetime},f.prototype._getMaxDatetime=function(n,t){var i=this._cachedMaxDatetime;return(isNaN(i)||i===-Number.MAX_VALUE)&&this._getMaxMindatetimes(n,t),this._cachedMaxDatetime},f.prototype._getMaxMindatetimes=function(n,r){for(var f=this,o=new Date(0,0,0),s=Number.MAX_VALUE,l=f._getCachedIndexMaping(n,r),a=l.length,h,u,e,c=0;c<a;c++)(h=l[c],u=r[h],isNaN(u))||(e=f._getValue(h,n),e!==t&&typeof e===i||isNaN(e))||typeof u!==i&&u!==t&&(u>o&&(o=u),u<s&&(s=u));f._cachedMaxDatetime=o;f._cachedMinDatetime=s},f.prototype._calcItemWidth=function(n,r,u,f){for(var s=this,b=s._getMinDatetime(r,u),k=s._getMaxDatetime(r,u),h=[],e,y,p=s._getCachedIndexMaping(r,u),d=p.length,a,c,v,w,l,o=0;o<d;o++)(y=p[o],e=u[y],typeof e===i||e===t||isNaN(e))||e&&h.push(e);if(h.sort(function(n,t){return n-t}),a=h.length,a>1&&b!==k){for(c=Number.MAX_VALUE,v=0,o=1;o<a;o++)w=h[o],e=w-h[o-1],e<c&&e>0&&(c=e),v+=e;return l=(n.Width-s._leftSpace(f)-s._rightSpace(f))*c/v/2,l<2&&(l=2),l}else return(n.Width-s._leftSpace(f)-s._rightSpace(f))/2},f.prototype._getItemWidth=function(n,t,i,r){var u=this,f;return u.info.displayDateAxis()?u._calcItemWidth(n,t,i,r):(f=u._getCachedIndexMaping(t,i).length,(n.Width-u._leftSpace(r)-u._rightSpace(r))/f)},f.prototype._getItemX=function(t,i,r,u,f){var e=this,s,h=e._leftSpace(f),l,c,a,v,y,p,w;return e.sparklineInfo().displayDateAxis()?(s=e._getItemWidth(t,r,u,f),l=e._getMaxDatetime(r,u),c=e._getMinDatetime(r,u),l===c)?h+s/2:(a=u[i],!a)?0:(v=t.Width-h-e._rightSpace(f),v-=s,y=l-c,h+o((a-c)/y*v)):(s=e._getItemWidth(t,r,u,f),p=n.ArrayHelper.indexOf(e._getCachedIndexMaping(r,u),i),w=h+s*p,o(w))},f.prototype._getCanvasSize=function(n,t){var i=this,u=n.Width-i._leftSpace(t)-i._rightSpace(t),r;return u=l(u,0),r=n.Height-i._topSpace(t)-i._bottomSpace(t),r=l(r,0),{Width:u,Height:r}},f.prototype._getMaxMinValue=function(n){for(var u=this,e=n.length,r,f=0;f<e;f++)r=n[f],typeof r!==i&&r!==t&&(typeof r!="number"&&(r=0),r<u._cachedMinValue&&(u._cachedMinValue=r),r>u._cachedMaxValue&&(u._cachedMaxValue=r))},f.prototype._getActualMaxValue=function(n){var t=this,i,r;if(t._cachedMaxValue!==-Number.MAX_VALUE&&t._cachedMaxValue||t._getMaxMinValue(n),i=t.info.setting(),r=i.maxAxisType,r===0)return t._cachedMaxValue;else if(r===1)return i.groupMaxValue;else if(r===2)return i.manualMax;return t._cachedMaxValue},f.prototype._getActualMinValue=function(n){var t=this,i,r;if(t._cachedMinValue!==Number.MAX_VALUE&&t._cachedMinValue||t._getMaxMinValue(n),i=t.info.setting(),r=i.minAxisType,r===0)return t._cachedMinValue;else if(r===1)return i.groupMinValue;else if(r===2)return i.manualMin},f.prototype._getItemHeightNormal=function(n,t,i,r){var h=this._getCanvasSize(n,r),u=this._getActualMaxValue(i),e=this._getActualMinValue(i),o=u-e,f,s;if(u===e){if(u===0)return 0;o=y(u)}return f=i[t],f||(f=0),s=h.Height/o,f*s},f.prototype._getItemHeight=function(n,r,u,f){var o=this,l=o.info,h=l.sparklineType(),e,s,c;if(h===0)return o._getItemHeightNormal(n,r,u,f);else if(h===1){if(e=u[r],(typeof e===i||e===t)&&l.setting().displayEmptyCellsAs===1)return 0;if(s=o._getItemHeightNormal(n,r,u,f),s>-o._minItemHeight&&s<o._minItemHeight)if(e>0)return s+o._minItemHeight;else if(e<0)return s-o._minItemHeight;return s}else if(h===2)return(e=u[r],typeof e===i||e===t||e===0||isNaN(e))?0:(c=o._getCanvasSize(n,f),e>=0?c.Height/2:-c.Height/2)},f.prototype._getAxisYNormal=function(n,t,i){var u=this,s=u._getCanvasSize(n,i),r=u._getActualMaxValue(t),f=u._getActualMinValue(t),e,o;if(r===-Number.MAX_VALUE||f===Number.MAX_VALUE)return n.Height/2;if(e=r-f,r===f){if(r===0)return n.Height/2;e=r;r<0&&(r=0)}return o=s.Height/e,u._topSpace(i)+r*o},f.prototype._getAxisY=function(n,t,i){return this.info.sparklineType()===2?n.Height/2:this._getAxisYNormal(n,t,i)},f.prototype._getItemVisibleHeightNormal=function(n,r,u,f){var h=this,a=h._getCanvasSize(n,f),o=h._getActualMaxValue(u),s=h._getActualMinValue(u),l=o-s,c,e,v;if(o===s){if(o===0)return 0;l=o}return c=a.Height/l,e=h._getValue(r,u),(typeof e===i||e===t)&&(e=0),o!==s&&o*s>0?(v=0,e>=0?(e-s)*c:(e-o)*c):e*c},f.prototype._getItemVisibleHeight=function(n,r,u,f){var e=this,c=e.info.sparklineType(),o,h,s;if(c===0)return e._getItemVisibleHeightNormal(n,r,u,f);else if(c===1)return(o=e._getItemVisibleHeightNormal(n,r,u,f),h=e._minItemHeight,o>-h&&o<h&&(s=e._getValue(r,u),(typeof s===i||s===t)&&(s=0),s!==0))?s>0?o+h:o-h:o;else if(c===2)return e._getItemHeight(n,r,u,f)},f.prototype._getDataPointPositionNormal=function(n,t,i,r,u){var f=this,s=f._getItemWidth(t,i,r,u),k=f._getItemX(t,n,i,r,u),a,e,b,v;s<0&&(s=0);s=o(s);s%2==1&&(s+=1);var p=f._getItemHeight(t,n,i,u),w=f._getAxisY(t,i,u),d=f._getActualMaxValue(i),g=f._getActualMinValue(i),c=0;return d<0&&g<0?c=l(f._topSpace(u),w):(c=w,p>=0&&(c=w-p)),a=f._getItemVisibleHeight(t,n,i,u),e=new h(k,c,s,y(a)),p!==0&&(b=f._topSpace(u),e.Y<b&&e.Bottom<b+1?e.Height=o(e.Height+1):(v=t.Height-f._bottomSpace(u),e.Bottom>v&&e.Y>v-1&&(e.Y=v-a,e.Height=a))),e},f.prototype._getLineWeight=function(n){var t=this.info.setting().lineWeight*n;return t<1&&(t=1),t},f.prototype._getDataPointPosition=function(n,r,u,f,e){var c=this,s=c._getLineWeight(e),o,l;if(s++,s<2&&(s=2),o=c._getDataPointPositionNormal(n,r,u,f,e),c.info.sparklineType()===0&&(o.X=o.X+(o.Width-s)/2,l=c._getValue(n,u),typeof l!==i&&l!==t?(l>=0?o.Y-=s/2:o.Y=o.Bottom-s/2,o.Width=s,o.Height=s):(o.Width=0,o.Height=0)),c.info.group().setting.rightToLeft){var a=o.X,v=r.Width-a,y=v-o.Width;o=new h(y,o.Y,o.Width,o.Height)}return o},f}();n.SparklineRender=v;c=function(){function i(n,t,i,r,u,f){var e=this;e.row=n;e.column=t;e._dataOrientation=r;e._data=i;e._group=new s(u,f);e._group.add(e);e._renderer=new v(e)}return i.prototype.group=function(n){var t=this,i;return arguments.length===0?(i=t._group,i||(i=new s,i.add(t),t._group=i),i):(n!==t._group&&(t._group&&t._group.remove(t),t._group=n,t._group&&(t._group.contains(t)||t._group.add(t)),t.onSparklineChanged()),t)},i.prototype.sparklineType=function(n){var t=this;return arguments.length===0?t.group().sparklineType:(t.group().sparklineType!==n&&(t.group().sparklineType=n,t.onSparklineChanged()),t)},i.prototype.onSparklineChanged=function(){var n=this._getWorksheet(),t;n&&(t=this,n.triggerSparklineChanged({sheet:n,sheetName:n._name,sparkline:t}))},i.prototype.setting=function(n){return arguments.length===0?this.group().setting:(this.group().setting=n,this)},i.prototype.data=function(n){var t=this;return arguments.length===0?t._data:(t._data!==n&&(t._data=n,t.onSparklineChanged()),t)},i.prototype.dataOrientation=function(n){var t=this;return arguments.length===0?t._dataOrientation:(t._dataOrientation!==n&&(t._dataOrientation=n,t.onSparklineChanged()),t)},i.prototype.dateAxisData=function(n){return arguments.length===0?this.group().dateAxisData():(this.group().dateAxisData(n),this)},i.prototype.dateAxisOrientation=function(n){return arguments.length===0?this.group().dateAxisOrientation():(this.group().dateAxisOrientation(n),this)},i.prototype.displayDateAxis=function(n){return arguments.length===0?this.group().displayDateAxis:(this.group().displayDateAxis=n,this)},i.prototype.clone=function(){var t=this,n=new i;return n.row=t.row,n.column=t.column,n.data(t.data()),n.dataOrientation(t.dataOrientation()),n.group(t.group().clone()),n},i.prototype.paintSparkline=function(n,t,i,r,u){this._renderer.paint(n,t,i,r,u)},i.prototype._provideValues=function(i,u,f){var s=this._getWorksheet(),h=[],c,o,e;if(!s)return h;for(c=rt(i,u),o=0;o<c;o++)e=ut(s,o,i,u),!this.setting().displayHidden&&ft(s,o,i,u)?e=NaN:e!==t&&e!==r&&(f?e=typeof e=="number"?n._DateTimeHelper.fromOADate(e):Date.parse(e):typeof e!="number"&&(e=n.__invalidValuePlaceHolder)),h.push(e);return h},i.prototype._getWorksheet=function(){return this.group()&&this.group()._sparklineGroupManager?this.group()._sparklineGroupManager._sheet:t},i.prototype._isDefaultValue=function(n,i){switch(n){case"axisReference":return i===t;case"axisOrientation":return i===1;default:return!1}},i.prototype.toJSON=function(){var n=this,r={row:n.row,col:n.column,orientation:n._dataOrientation,data:n._data,type:n._group.sparklineType,setting:n._group.setting,axisReference:n._group._axisReference,axisOrientation:n._group._axisOrientation},u={},t,i;for(t in r)i=r[t],n._isDefaultValue(t,i)||(u[t]=i);return u},i.prototype.fromJSON=function(i,u){var f,e;i&&(f=this,i.row!==r&&i.row!==t&&(f.row=i.row),i.col!==r&&i.col!==t&&(f.column=i.col),i.orientation!==r&&i.orientation!==t&&(f._dataOrientation=i.orientation),i.data&&(e=i.data,f._data=new n.Range(e.row,e.col,e.rowCount,e.colCount)))},i}();n.Sparkline=c;p=function(){function i(n,t){this._groups=[];this._sheet=n;this.evaluator=t}return i.prototype.groups=function(n){return u(arguments.length===0,this,"_groups")},i.prototype.add=function(n){this.groups().push(n);n._sparklineGroupManager=this;n._adjustGroupMaxMinValue()},i.prototype.remove=function(t){n.ArrayHelper.remove(this.groups(),t)},i.prototype.contains=function(t){return n.ArrayHelper.contains(this.groups(),t)},i.prototype.count=function(){return this.groups().length},i.prototype._addRows=function(n,t){for(var i,o,f,r,s,u=this,e=0;e<u._groups.length;e++)for(i=u._groups[e],i.displayDateAxis&&(o=u._addRowRange(n,t,i.dateAxisData()),i.dateAxisData(o)),f=0;f<i._innerList.length;f++)r=i._innerList[f],n<=r.row&&(r.row+=t),s=u._addRowRange(n,t,r.data()),r.data(s)},i.prototype._addColumns=function(n,t){for(var i,o,f,r,s,u=this,e=0;e<u._groups.length;e++)for(i=u._groups[e],i.displayDateAxis&&(o=u._addColumnRange(n,t,i.dateAxisData()),i.dateAxisData(o)),f=0;f<i._innerList.length;f++)r=i._innerList[f],n<=r.column&&(r.column+=t),s=u._addColumnRange(n,t,r.data()),r.data(s)},i.prototype._removeRows=function(n,i){for(var u,s,o,h,f,c,e=this,l=0;l<e._groups.length;l++){if(u=e._groups[l],u.displayDateAxis)if(s=e._removeRowRange(n,i,u.dateAxisData()),s!==t&&s!==r)u.dateAxisData(s);else{u.clear();e.remove(u);continue}for(o=[],o=o.concat(u._innerList),h=0;h<o.length;h++)f=o[h],f.row>=n&&f.row<n+i?u.remove(f):(n<=f.row&&(f.row-=i),c=e._removeRowRange(n,i,f.data()),c!==t&&c!==r?f.data(c):u.remove(f));u.count()<=0&&e.remove(u)}},i.prototype._removeColumns=function(n,i){for(var u,s,o,h,f,c,e=this,l=0;l<e._groups.length;l++){if(u=e._groups[l],u.displayDateAxis)if(s=e._removeColumnRange(n,i,u.dateAxisData()),s!==t&&s!==r)u.dateAxisData(s);else{u.clear();e.remove(u);continue}for(o=[],o=o.concat(u._innerList),h=0;h<o.length;h++)f=o[h],f.column>=n&&f.column<n+i?u.remove(f):(n<=f.column&&(f.column-=i),c=e._removeColumnRange(n,i,f.data()),c!==t&&c!==r?f.data(c):u.remove(f));u.count()<=0&&e.remove(u)}},i.prototype.clear=function(n,i,r,u){var f=this,e,l,o,s,h,c;if(arguments.length===0){for(e=0;e<f._groups.length;e++)l=f._groups[e],l&&(l.SparklineGroupManager=t);f._groups=[];return}for(o=n;o<n+r;o++)for(s=i;s<i+u;s++)h=f._find(o,s),h&&(c=h.group(),c.remove(h),c.count()===0&&f.remove(c))},i.prototype._find=function(n,i){for(var e,f,r,u=0;u<this._groups.length;u++)for(e=this._groups[u],f=0;f<e.count();f++)if(r=e[f],r&&r.row===n&&r.column===i)return r;return t},i.prototype._copy=function(i,u,f,e,o,s,h){var w=this,v=w._sheet,d,a,y,p;if(v){for(var g=new n._GcSheetModel(o,s,t),b=f-i,k=e-u,nt=v._getModel(),l,tt=v.getRowCount(),it=v.getColumnCount(),c=0;c<o;c++)if(!h||!v.isRowFilterOut(f+c))for(l=0;l<s;l++)d=nt.getSparkline(i+c,u+l),d&&(a=d.clone(),a.row=f+c,a.column=e+l,y=a.dateAxisData(),y!==t&&y!==r&&w._canOffset(y,b,k,tt,it)&&a.dateAxisData(y.offset(k,b)),p=a.data(),p!==r&&p!==t&&w._canOffset(p,b,k,tt,it)&&a.data(p.offset(k,b)),w.add(a.group()),g.setValue(c,l,a));for(c=0;c<o;c++)if(!h||!v.isRowFilterOut(f+c))for(l=0;l<s;l++)nt.setSparkline(f+c,e+l,g.getValue(c,l))}},i.prototype._canOffset=function(n,t,i,r,u){var f=this._getExpressionRange(n);if(f){var e=f.row<0?0:f.row,o=f.col<0?0:f.col,s=f.row<0?r:f.rowCount,h=f.col<0?u:f.colCount;return!(e+t<0||o+i<0||e+s+t>r||o+h+i>u)}return!1},i.prototype._move=function(i,r,u,f,e,o){var v=this._sheet,l,a,s,h,c;if(v){for(this._moveDataRange(i,r,u,f,e,o),l=v._getModel(),a=new n._GcSheetModel(e,o,t),s=0;s<e;s++)for(h=0;h<o;h++)c=l.getSparkline(i+s,r+h),c&&(c.row=u+s,c.column=f+h,a.setValue(s,h,c)),l.setSparkline(i+s,r+h,t);for(s=0;s<e;s++)for(h=0;h<o;h++)l.setSparkline(u+s,f+h,a.getValue(s,h))}},i.prototype._moveDataRange=function(t,i,r,u,f,e){var s=this,h=new n.Range(t,i,f,e),k=r-t,a,c,v,l,o,y,p,w,b;for(t,a=u-i,c=0;c<s._groups.length;c++)for(v=s._groups[c],l=0;l<v._innerList.length;l++)(o=v._innerList[l],o)&&(y=o.dateAxisData(),p=s._getExpressionRange(y),p&&h.containsRange(p)&&h.contains(o.row,o.column)&&o.dateAxisData(y.offset(a,k)),w=o.data(),b=s._getExpressionRange(w),b&&h.containsRange(b)&&h.contains(o.row,o.column)&&o.data(w.offset(a,k)))},i.prototype._getExpressionRange=function(n){return n},i.prototype._swap=function(n,t,i,r,u,f){},i.prototype._exCopy=function(n,i,u,f,e,o,s,h){var y=this,v=y._sheet,l,a,d,c,p,w;if(v){if(n===v){y._copy(i,u,f,e,o,s);return}var b=f-i,k=e-u,it=n._getModel(),g=v._getModel(),nt=v.getRowCount(),tt=v.getColumnCount();for(l=0;l<o;l++)if(!h||!v.isRowFilterOut(f+l))for(a=0;a<s;a++)d=it.getSparkline(i+l,u+a),d?(c=d.clone(),c.row=f+l,c.column=e+a,p=c.dateAxisData(),p!==r&&p!==t&&y._canOffset(p,b,k,nt,tt)&&c.dateAxisData(p.offset(k,b)),w=c.data(),w!==r&&w!==t&&y._canOffset(w,b,k,nt,tt)&&c.data(w.offset(k,b)),y.add(c.group()),g.setSparkline(f+l,e+a,c)):g.setSparkline(f+l,e+a,t)}},i.prototype._exMove=function(n,i,r,u,f,e,o){var a=this,v=a._sheet,y,p,s,h,c,l,w;if(v){if(n===v){a._move(i,r,u,f,e,o);return}for(y=n._getModel(),p=v._getModel(),a._exMoveDataRange(n,i,r,u,f,e,o),s=0;s<e;s++)for(h=0;h<o;h++)c=y.getSparkline(i+s,r+h),c?(c.row=u+s,c.column=f+h,l=c.group(),w=l.clone(),l.remove(c),l.count()<=0&&n._sparklineGroupManager.remove(l),w.add(c),a.add(w),p.setSparkline(u+s,f+h,c)):p.setSparkline(u+s,f+h,t),y.setSparkline(i+s,r+h,t)}},i.prototype._exMoveDataRange=function(t,i,r,u,f,e,o){var h=this,k=h._sheet,l,p,a,s,v,w,y,b;if(t&&k){if(t===k){h._moveDataRange(i,r,u,f,e,o);return}var c=new n.Range(i,r,e,o),d=u-i,g=f-r;for(l=0;l<t._sparklineGroupManager._groups.length;l++)for(p=t._sparklineGroupManager._groups[l],a=0;a<p._innerList.length;a++)(s=p._innerList[a],s)&&(v=s.dateAxisData(),w=h._getExpressionRange(v),w&&h._sameSource(t,v)&&c.containsRange(w)&&c.contains(s.row,s.column)&&s.dateAxisData(v.offset(g,d)),y=s.data(),b=h._getExpressionRange(y),b&&h._sameSource(t,y)&&c.containsRange(b)&&c.contains(s.row,s.column)&&s.data(y.offset(g,d)))}},i.prototype._sameSource=function(n,t){return!0},i.prototype._addRowRange=function(i,r,u){return u?i>u.row+u.rowCount-1?u:i>u.row?new n.Range(u.row,u.col,u.rowCount+r,u.colCount):new n.Range(u.row+r,u.col,u.rowCount,u.colCount):t},i.prototype._addColumnRange=function(i,r,u){return u?i>u.col+u.colCount-1?u:i>u.col?new n.Range(u.row,u.col,u.rowCount,u.colCount+r):new n.Range(u.row,u.col+r,u.rowCount,u.colCount):t},i.prototype._removeColumnRange=function(i,r,u){var f=this._rangeSubCat(u.col,u.col+u.colCount-1,i,i+r-1);return f?new n.Range(u.row,f.start,u.rowCount,f.end-f.start+1):t},i.prototype._removeRowRange=function(i,r,u){var f=this._rangeSubCat(u.row,u.row+u.rowCount-1,i,i+r-1);return f?new n.Range(f.start,u.col,f.end-f.start+1,u.colCount):t},i.prototype._rangeSubCat=function(n,i,r,u){var f=-1,o,e,h,l,c,s;if(u<n)return h=u-r+1,f=n-h,o=i-h,{start:f,end:o};if(r>i)return f=n,o=i,{start:f,end:o};if(r<=n){for(l=i-n+1,c=0,e=n;e<=u;e++)if(e<=i)c++;else break;return f=r,o=f+l-c-1,{start:f,end:o}}for(s=0,e=n;e<=i;e++)f===-1&&(e<r||e>u)&&(f=e),(e<r||e>u)&&s++;return f!==-1&&s>0?(o=f+s-1,{start:f,end:o}):t},i.prototype.toJSON=function(){var n=this._groups,t,i;if(!n||n.length===0)return r;for(t=[],i=0;i<n.length;i++)t.push(n[i].toJSON());return t.length===0?r:t},i.prototype.fromJSON=function(n,t){var i,u,r;if(n&&n.length!==0)for(i=0;i<n.length;i++)u=n[i],r=new s,r.fromJSON(u,t),this.add(r)},i}();n.WorksheetSparklineGroupManager=p;w=function(n){function t(){n.apply(this,arguments)}return __extends(t,n),t}(c);n.SparklineValue=w})(n.Sheets||(n.Sheets={}));var t=n.Sheets})(GcSpread||(GcSpread={}))
