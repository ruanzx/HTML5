/*
 *
 * SpreadJS Library 8.40.20151.0
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License. 
 * spread.sales@grapecity.com
 * http://spread.grapecity.com/Pages/Spread-JS-License/
 *
 *
 **/
var __extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype;n.prototype=new r},GcSpread;(function(n){(function(n){var l,yt,pt,it,t,u,p,w,b,rt,k,d;n.feature("formatter",["core.common","core.globalize","core.migrate"]);var i=null,f=undefined,o=Math.abs,h=Math.ceil,nt=Math.pow,a=Math.floor,lt=Math.max,at=Math.min,vt=Math.round,r={Empty:"",Format:function(){for(var r,n,f,u=[],t=0;t<arguments.length-0;t++)u[t]=arguments[t+0];if(arguments.length===0)return i;for(r=u[0],n=1;n<arguments.length;n++)f=new RegExp("\\{"+(n-1)+"\\}","gm"),r=r.replace(f,arguments[n]);return r},IsNullOrEmpty:function(n){return!n||n===r.Empty}},tt;(function(n){n[n.None=0]="None";n[n.AllowLeadingWhite=1]="AllowLeadingWhite";n[n.AllowTrailingWhite=2]="AllowTrailingWhite";n[n.AllowInnerWhite=4]="AllowInnerWhite";n[n.AllowWhiteSpaces=7]="AllowWhiteSpaces";n[n.NoCurrentDateDefault=8]="NoCurrentDateDefault";n[n.AdjustToUniversal=16]="AdjustToUniversal";n[n.AssumeLocal=32]="AssumeLocal";n[n.AssumeUniversal=64]="AssumeUniversal";n[n.RoundtripKind=128]="RoundtripKind"})(tt||(tt={}));l={IsDigit:function(n){var t=n.charCodeAt(0);return t>=48&&t<=57},IsWhiteSpace:function(n){var t=n.charCodeAt(0);return t>=9&&t<=13||t===32||t===133||t===160}},function(n){n[n.CustomMode=0]="CustomMode";n[n.StandardDateTimeMode=1]="StandardDateTimeMode";n[n.StandardNumericMode=2]="StandardNumericMode"}(n.FormatMode||(n.FormatMode={}));yt=n.FormatMode,function(n){n[n.General=0]="General";n[n.Number=1]="Number";n[n.DateTime=2]="DateTime";n[n.Text=3]="Text"}(n.NumberFormatType||(n.NumberFormatType={}));pt=n.NumberFormatType,function(n){n[n.Hour=0]="Hour";n[n.Minute=1]="Minute";n[n.Second=2]="Second"}(it||(it={}));t=function(){function t(){}return t.DateTimeFormatInfo=function(){return n._CultureInfo._currentCulture.DateTimeFormat()},t.NumberFormatInfo=function(){return n._CultureInfo._currentCulture.NumberFormat()},t.Filter=function(n,t,r){var s,u,e,o;if(n===f||n===i||n==="")return n;for(s="",u=0,e=0;e<n.length;e++)o=n[e],o===t?u++:o===r?(u--,u<0&&(u=0)):u===0&&(s+=o);return s.toString()},t.TrimSquareBracket=function(i){return!i||i===r.Empty?i:(i[0]===t.LeftSquareBracket&&(i=n.StringHelper.TrimStart(i,t.LeftSquareBracket)),i[i.length-1]===t.RightSquareBracket&&(i=n.StringHelper.TrimEnd(i,t.RightSquareBracket)),i)},t.IsOperator=function(n){return n===t.LessThanSign||n===t.GreaterThanSign||n===t.EqualsThanSign},t.TrimEscape=function(n){for(var r,e=n.length,i=!1,u="",f=0;f<e;f++)r=n.charAt(f),r===t.ReverseSolidusSign?(i=!i,i||(u+=r)):(i=!1,u+=r);return u},t.AddSquareBracket=function(i){if(!i)throw new Error(n.SR.Exp_TokenIsNull);return(i.length===0||i[0]!==t.LeftSquareBracket)&&(i=n.StringHelper.Insert(i,0,t.LeftSquareBracket.toString())),(i.length===0||i[i.length-1]!==t.RightSquareBracket)&&(i=n.StringHelper.Insert(i,i.length,t.RightSquareBracket.toString())),i},t.IsEquals=function(n,t,i){return n||t?n&&t?i?n.toLowerCase()===t.toLowerCase():n===t:!1:!0},t.ReplaceKeyword=function(t,i,u){var f,o,e;if(!t||t===r.Empty||this.IsEquals(i,u,!0))return t;for(f=t,o=0;;)if(e=n.StringHelper.IndexOf(f,i,1),e>-1)f=n.StringHelper.Remove(f,e,i.length),f=n.StringHelper.Insert(f,e,u),o=e+u.length;else break;return f},t.IsDecimal=function(n,i){var r=t.DecimalSeparator;return n.indexOf(r)>-1},t.DoubleQuote='"',t.SingleQuote="'",t.Tab="\t",t.LeftSquareBracket="[",t.RightSquareBracket="]",t.LessThanSign="<",t.GreaterThanSign=">",t.EqualsThanSign="=",t.PlusSign="+",t.HyphenMinus="-",t.UnderLine="_",t.LeftParenthesis="(",t.RightParenthesis=")",t.Dollar="$",t.Comma=";",t.Space=" ",t.SolidusSign="/",t.ReverseSolidusSign="\\",t.Zero="0",t.QuestionMark="?",t.Colon=":",t.Semicolon=";",t.Sharp="#",t.CommercialAt="@",t.NumberSign="#",t.Asterisk="*",t.Exponential1="E+",t.Exponential2="E-",t.DecimalSeparator=".",t.numberGroupSeparator=",",t.percentSymbol="%",t.nanSymbol="NaN",t.FormatSeparator=";",t.negativeSign="-",t.ReplacePlaceholder="@",t.ExponentialSymbol="E",t}();n.DefaultTokens=t;u=function(){function u(t,r,u){this._classNames=["NumberFormatBase","IFormatter","IFormatProviderSupport"];this.numberFormatInfo=i;this.dateTimeFormatInfo=i;this.cultureName="";var f=this;f._initFileds();f.partLocaleID=t;f.partDbNumberFormat=r;f.cultureName=u?u:n._CultureInfo._currentCulture.Name()}return u.prototype._initFileds=function(){var n=this;n.numberStringConverter=i;n.numberFormatInfo=i;n.dateTimeFormatInfo=i;n.partLocaleID=i;n.partDbNumberFormat=i},u.prototype.NumberStringConverter=function(n){return arguments.length===0?this.numberStringConverter?this.numberStringConverter:i:(this.numberStringConverter=n,n)},u.prototype.PartLocaleID=function(){return n.util.asCustomType(this.partLocaleID,"LocaleIDFormatPart")},u.prototype.PartDBNumberFormat=function(){return n.util.asCustomType(this.partDbNumberFormat,"DBNumberFormatPart")},u.prototype.DateTimeFormatInfo=function(n){return arguments.length===0?this.dateTimeFormatInfo:(this.dateTimeFormatInfo=n,n)},u.prototype.NumberFormatInfo=function(n){return arguments.length===0?this.numberFormatInfo:(this.numberFormatInfo=n,n)},u.prototype.CultureName=function(n){var t=this;return arguments.length===0?t.partLocaleID?t.partLocaleID.CultureInfo().Name():t.cultureName:(t.cultureName=n,n)},u.prototype.numberGroupSeparator=function(){return this.NumberFormatInfo()?this.NumberFormatInfo().numberGroupSeparator:t.numberGroupSeparator},u.prototype.PercentSymbol=function(){return this.NumberFormatInfo()?this.NumberFormatInfo().percentSymbol:t.percentSymbol},u.prototype.PositiveSign=function(){return this.NumberFormatInfo()?this.NumberFormatInfo().positiveSign:t.NumberFormatInfo().positiveSign},u.prototype.NegativeSign=function(){return this.NumberFormatInfo()?this.NumberFormatInfo().negativeSign:t.negativeSign},u.prototype.DecimalSeparator=function(){return t.DecimalSeparator},u.prototype.NaNSymbol=function(){return this.NumberFormatInfo()?this.NumberFormatInfo().nanSymbol:t.nanSymbol},u.TrimNotSupportSymbol=function(n,t){var e,o,i,r,f;for(arguments.length===1&&(t=!0),e=!1,o="",i=0;i<n.length;i++)r=n[i],f=!0,r==='"'?e=!e:e||(t||(r==="?"&&(u.IsTransform(n,i)||(f=!1)),r==="/"&&(u.IsTransform(n,i)||(f=!1))),r==="_"?u.IsTransform(n,i)||(f=!1,i++):r==="*"&&(u.IsTransform(n,i)||(f=!1))),f&&(o+=r);return o},u.IsTransform=function(t,i){if(t[i]==="\\")throw new Error(n.SR.Exp_InvalidBackslash);if(i-1>0&&i-1<t.length&&t[i-1]==="\\")if(i-2<0)return!0;else if(i-2>0&&i-2<t.length)return t[i-2]!=="\\";return!1},u.ContainsKeywords=function(n,u,f){var s,e,l,h;if(!n||n===r.Empty)return!1;if(f[n])return!0;var a="",c=!1,v=i,o;for(s=0;s<n.length;s++)e=n[s],e==='"'?c=!c:c||e!==t.UnderLine&&v!==t.UnderLine&&(e!=="E"&&(o=e.charCodeAt(0),o>=65&&o<=90&&(o|=32,e=String.fromCharCode(o))),a+=e),v=e;if(l=a,f[l])return!0;for(h=0;h<u.length;h++)if(l.indexOf(u[h])>=0)return!0;return!1},u.prototype.Format=function(n){return""},u.prototype.Parse=function(n){return i},u.prototype.FormatString=function(){return""},u.prototype.ExcelCompatibleFormatString=function(){return""},u.General="General",u.General_Lower="general",u._keywords=[u.General_Lower],u._keywordsSet={general:!0},u}();p=function(){function t(n){var t=this;t.shortDatePattern="d";t.longDatePattern="D";t.FullDatePatternShortTime="f";t.FullDatePatternLongTime="F";t.GeneralDatePatternLongTimeShortTime="g";t.GeneralDatePatternLongTimeLongTime="G";t.MonthDayPattern1="m";t.MonthDayPattern2="M";t.RoundTripDatePattern1="o";t.RoundTripDatePattern2="O";t.RFC1123Pattern1="r";t.RFC1123Pattern2="R";t.SortableDatePattern="s";t.shortTimePattern="t";t.longTimePattern="T";t.UniversalSortableDatePattern="u";t.UniversalFullDatePattern="U";t.YearMonthPattern1="y";t.YearMonthPattern2="Y";t._classNames=["StandardDateTimeFormatter","IFormatter"];t._formatString=n}return t.prototype.EvaluateFormat=function(n){var t=this;return n===t.shortDatePattern||n===t.longDatePattern||n===t.FullDatePatternShortTime||n===t.FullDatePatternLongTime||n===t.GeneralDatePatternLongTimeShortTime||n===t.GeneralDatePatternLongTimeLongTime||n===t.MonthDayPattern1||n===t.MonthDayPattern2||n===t.RoundTripDatePattern1||n===t.RoundTripDatePattern2||n===t.RFC1123Pattern1||n===t.RFC1123Pattern2||n===t.SortableDatePattern||n===t.shortTimePattern||n===t.longTimePattern||n===t.UniversalSortableDatePattern||n===t.UniversalFullDatePattern||n===t.YearMonthPattern1||n===t.YearMonthPattern2?!0:!1},t.prototype.Format=function(t){try{return t===f||t===i||t===""?"":new n._DateTimeHelper(t).localeFormat(this._formatString)}catch(r){return t.toString()}},t.prototype.Parse=function(t){try{return!t||t===""?i:n._DateTimeHelper.parseLocale(t,this._formatString)}catch(r){return new Date(t)}},t.prototype.FormatString=function(){return this._formatString},t}();n._StandardDateTimeFormatter=p;w=function(){function t(n){var t=this;t.CurrencyPattern1="c";t.CurrencyPattern2="C";t.DecimalPattern1="d";t.DecimalPattern2="D";t.ScientificPattern1="e";t.ScientificPattern2="E";t.FixedPointPattern1="f";t.FixedPointPattern2="F";t.GeneralPattern1="g";t.GeneralPattern2="G";t.NumberPattern1="n";t.NumberPattern2="N";t.PercentPattern1="p";t.PercentPattern2="P";t.RoundTripPattern1="r";t.RoundTripPattern2="R";t.HexadecimalPattern1="x";t.HexadecimalPattern2="X";t._classNames=["StandardNumberFormatter","IFormatter"];t._formatString=n}return t.prototype.EvaluateFormat=function(n){var i=this,t;return n&&n!==r.Empty&&n.length>0&&(t=n.substr(0,1),t===i.CurrencyPattern1||t===i.CurrencyPattern2||t===i.DecimalPattern1||t===i.DecimalPattern2||t===i.ScientificPattern1||t===i.ScientificPattern2||t===i.FixedPointPattern1||t===i.FixedPointPattern2||t===i.GeneralPattern1||t===i.GeneralPattern2||t===i.NumberPattern1||t===i.NumberPattern2||t===i.PercentPattern1||t===i.PercentPattern2||t===i.RoundTripPattern1||t===i.RoundTripPattern2||t===i.HexadecimalPattern1||t===i.HexadecimalPattern2)?!0:!1},t.prototype.Format=function(t){try{return t===i||t===f||t===""?"":new n._NumberHelper(t).localeFormat(this._formatString)}catch(r){return t.toString()}},t.prototype.Parse=function(t){try{return t===i||t===f||t===""?i:n._NumberHelper.parseLocale(t)}catch(u){var r=parseFloat(t);return isNaN(r)||!isFinite(r)?i:r}},t.prototype.FormatString=function(){return this._formatString},t}();n._StandardNumberFormatter=w;b=function(r){function e(n,i,f,e){var s=this,o;r.call(this,i,f,e);s._classNames=["NumberFormatText","IFormatter"];o=u.TrimNotSupportSymbol(n,!1);i&&(o=t.ReplaceKeyword(o,s.PartLocaleID().OriginalToken(),s.PartLocaleID().CurrencySymbol()));o=t.Filter(o,t.LeftSquareBracket,t.RightSquareBracket);o=t.TrimEscape(o);s._formatString=o}return __extends(e,r),e.prototype.Format=function(t){try{var r=n.Calc.Convert.S(t),u=n.StringHelper.Replace(this._formatString,'"',"");return u!==i&&u!==f&&(r=n.StringHelper.Replace(u,"@",r)),r}catch(e){return""}},e.prototype.Parse=function(n){return n?n:""},e.prototype.FormatString=function(){return this._formatString},e.EvaluateFormat=function(n){return!0},e.prototype.DefaultDateTimeNumberStringConverter=function(){},e}(u);rt=function(){function n(n){this._innerFormatter=n}return n.prototype.FormatString=function(){return this._innerFormatter?this._innerFormatter.FormatString():""},n.prototype.innerFormatter=function(n){return arguments.length===0?this._innerFormatter:(this._innerFormatter=n,this)},n.prototype.Parse=function(n){return this._innerFormatter?this._innerFormatter.Parse(n):n},n.prototype.Format=function(n){return this._innerFormatter?this._innerFormatter.Format(n):n===f||n===i?"":n.toString()},n.prototype.toJSON=function(){return f},n}();n.AutoFormatter=rt;k=function(){function o(t,r){var f=this;f.conditionFormatPart=i;f.colorFormatPart=i;f.localeIDFormatPart=i;f.dbNumberFormatPart=i;f.numberFormat=i;f.dateTimeFormatInfo=i;f.numberFormatInfo=i;f.formatCached=i;f._classNames=["CustomNumberFormat","IFormatter","IFormatProviderSupport"];r||(r=n._CultureInfo._currentCulture.Name());arguments.length===0?(f.formatCached=u.General,f.numberFormat=new e):f.Init(t,r)}return o.prototype.Init=function(u,o){var h,d,p,nt,w,v,tt;if(u===i||u===f)throw new Error(n.SR.Exp_FormatIllegal);h=this;h.formatCached=u;var a="",l="",k=!1,g=[];for(d=0;d<u.length;d++)if(p=u[d],p===t.LeftSquareBracket){if(k)throw new Error(n.SR.Exp_FormatIllegal);else l&&(a||(a=""),a+=l,l=""),l=p.toString();k=!0}else if(p===t.RightSquareBracket){if(k)if(l){if(l+=p,nt=l.toString(),w=n.util.asCustomType(s.Create(nt),"FormatPartBase"),w&&!n.util.isCustomType(w,"ABSTimeFormatPart"))h.AddPart(w);else if(n.util.isCustomType(w,"ABSTimeFormatPart"))g.push(n.util.asCustomType(w,"ABSTimeFormatPart")),a+=l;else throw new Error(n.SR.Exp_FormatIllegal);l=""}else throw new Error(n.SR.Exp_FormatIllegal);else throw new Error(n.SR.Exp_FormatIllegal);k=!1}else l+=p;if(l)if(k)throw new Error(n.SR.Exp_FormatIllegal);else a+=l;if(h.localeIDFormatPart!==i&&(o=h.localeIDFormatPart.CultureInfo().Name()),v=a?a.toString():r.Empty,e.EvaluateFormat(v))h.numberFormat=new e(v,h.LocaleIDFormatPart(),h.dbNumberFormatPart,o);else if(c.EvaluateFormat(v))tt=g.length>0?g:i,h.numberFormat=new c(v,tt,h.LocaleIDFormatPart(),h.dbNumberFormatPart,o);else if(y.EvaluateFormat(v))h.numberFormat=new y(u,h.LocaleIDFormatPart(),h.dbNumberFormatPart,o);else if(b.EvaluateFormat(v))h.numberFormat=new b(u,h.LocaleIDFormatPart(),h.dbNumberFormatPart,o);else throw new Error(n.SR.Exp_FormatIllegal);},o.prototype.FormatString=function(){var n=this,t="";return n.numberFormat&&n.numberFormat.FormatString()&&(n.ColorFormatPart()&&(t+=n.ColorFormatPart().toString()),n.ConditionFormatPart()&&(t+=n.ConditionFormatPart().toString()),n.DBNumberFormatPart()&&(t+=n.DBNumberFormatPart().toString()),n.LocaleIDFormatPart()&&(t+=n.LocaleIDFormatPart().toString()),t+=n.numberFormat.FormatString()),t.toString()},o.prototype.ConditionFormatPart=function(){return this.conditionFormatPart},o.prototype.ColorFormatPart=function(){return this.colorFormatPart},o.prototype.LocaleIDFormatPart=function(){return this.localeIDFormatPart},o.prototype.DBNumberFormatPart=function(){return this.dbNumberFormatPart},o.prototype.NumberStringConverter=function(n){var t=this;if(arguments.length===0)return t.numberFormat?t.numberFormat.NumberStringConverter():i;else t.numberFormat&&t.numberFormat.NumberStringConverter(n)},o.prototype.ExcelCompatibleFormatString=function(){var t=this,i="";return t.numberFormat&&t.numberFormat.ExcelCompatibleFormatString()&&(n.util.isCustomType(t.numberFormat,"NumberFormatDigital")||(t.DBNumberFormatPart()&&(i+=t.DBNumberFormatPart().toString()),t.LocaleIDFormatPart()&&(i+=t.LocaleIDFormatPart().toString()),t.ConditionFormatPart()&&(i+=t.ConditionFormatPart().toString()),t.ColorFormatPart()&&(i+=t.ColorFormatPart().toString())),i+=t.numberFormat.ExcelCompatibleFormatString()),i.toString()},o.prototype.Formatter=function(){return this.numberFormat},o.prototype.DateTimeFormatInfo=function(n){return arguments.length===0?this.Formatter().DateTimeFormatInfo():(this.Formatter().DateTimeFormatInfo(n),this.dateTimeFormatInfo=n,n)},o.prototype.NumberFormatInfo=function(n){return arguments.length===0?this.Formatter().NumberFormatInfo():(this.Formatter().NumberFormatInfo(n),this.numberFormatInfo=n,n)},o.prototype.AddPart=function(t){if(!t)throw new Error(n.SR.Exp_PartIsNull);var i=this;if(n.util.isCustomType(t,"ConditionFormatPart"))if(i.conditionFormatPart)throw new Error(n.SR.Exp_DuplicatedDescriptor);else i.conditionFormatPart=n.util.asCustomType(t,"ConditionFormatPart");else if(n.util.isCustomType(t,"ColorFormatPart"))if(i.colorFormatPart)throw new Error(n.SR.Exp_DuplicatedDescriptor);else i.colorFormatPart=n.util.asCustomType(t,"ColorFormatPart");else if(n.util.isCustomType(t,"LocaleIDFormatPart"))if(i.localeIDFormatPart)throw new Error(n.SR.Exp_DuplicatedDescriptor);else i.localeIDFormatPart=n.util.asCustomType(t,"LocaleIDFormatPart");else if(n.util.isCustomType(t,"DBNumberFormatPart"))if(i.dbNumberFormatPart)throw new Error(n.SR.Exp_DuplicatedDescriptor);else i.dbNumberFormatPart=n.util.asCustomType(t,"DBNumberFormatPart")},o.prototype.Format=function(n){return this.numberFormat.Format(n)},o.prototype.Parse=function(n){return this.numberFormat.Parse(n)},o}();d=function(){function s(t,f,e){var o=this;o.formatters=i;o.formatModeType=0;o.dateTimeFormatInfo=i;o.numberFormatInfo=i;o.isSingleFormatterInfo=!0;o.isDefault=!0;o.isConstructed=!1;o.customerCultureName=i;o.PropertyChanged=[];o._classNames=["GeneralFormatter","IFormatter","INotifyPropertyChanged","IColorFormatter"];r.IsNullOrEmpty(t)&&(t=u.General);f||(f=0);o.formatCached=t;o.formatModeType=f;o.isDefault=o.formatCached.toLowerCase()===u.General_Lower;o.isConstructed=!1;o.customerCultureName=e?n._CultureInfo.getCulture(e).Name():n._CultureInfo._currentCulture.Name()}return s._needChangeDefaultFormat=function(t){if(t){var i=n._CultureInfo._currentCulture.Name().toLowerCase(),r=t.customerCultureName.toLowerCase();return r===i?!1:!0}else return!0},s.DefaultNumberFormatter=function(){return s._needChangeDefaultFormat(this.defaultNumberFormatter)&&(this.defaultNumberFormatter=new s("###################0.################",0,n._CultureInfo._currentCulture.Name())),this.defaultNumberFormatter},s.DefaultGeneralFormatter=function(){return s._needChangeDefaultFormat(this.defaultGeneralFormatter)&&(this.defaultGeneralFormatter=new s),this.defaultGeneralFormatter},s.DefaultShortDatePatternFormatter=function(){return s._needChangeDefaultFormat(this.defaultShortDatePatternFormatter)&&(this.defaultShortDatePatternFormatter=new s(t.DateTimeFormatInfo().shortDatePattern)),this.defaultShortDatePatternFormatter},s.DefaultSXDatetimePatternFormatter=function(){var n=t.DateTimeFormatInfo().shortDatePattern+" h:mm:ss";return s._needChangeDefaultFormat(this.defaultSXDatetimePatternFormatter)&&(this.defaultSXDatetimePatternFormatter=new s(n)),this.defaultSXDatetimePatternFormatter},s.DefaultLongTimePatternFormatter=function(){var n=t.DateTimeFormatInfo().longTimePattern;return s._needChangeDefaultFormat(this.defaultLongTimePatternFormatter)&&(this.defaultLongTimePatternFormatter=new s(n)),this.defaultLongTimePatternFormatter},s.DefaultDMMMFormatter=function(){return s._needChangeDefaultFormat(this.defaultDMMMFormatter)&&(this.defaultDMMMFormatter=new s("d-mmm",0,n._CultureInfo._currentCulture.Name())),this.defaultDMMMFormatter},s.DefaultMMMYYFormatter=function(){return s._needChangeDefaultFormat(this.defaultMMMYYFormatter)&&(this.defaultMMMYYFormatter=new s("mmm-yy",0,n._CultureInfo._currentCulture.Name())),this.defaultMMMYYFormatter},s.DefaultHMMFormatter=function(){return s._needChangeDefaultFormat(this.defaultHMMFormatter)&&(this.defaultHMMFormatter=new s("h:mm",0,n._CultureInfo._currentCulture.Name())),this.defaultHMMFormatter},s.DefaultHMMSSFormatter=function(){return s._needChangeDefaultFormat(this.defaultHMMSSFormatter)&&(this.defaultHMMSSFormatter=new s("h:mm:ss",0,n._CultureInfo._currentCulture.Name())),this.defaultHMMSSFormatter},s.DefaultHMMSS0Formatter=function(){return s._needChangeDefaultFormat(this.defaultHMMSS0Formatter)&&(this.defaultHMMSS0Formatter=new s("h:mm:ss.0",0,n._CultureInfo._currentCulture.Name())),this.defaultHMMSS0Formatter},s.DefaultComboNumberFormatter1=function(){return s._needChangeDefaultFormat(this.defaultComboNumberFormatter1)&&(this.defaultComboNumberFormatter1=new s(r.Format("{0}#,##0.00;[Red]({0}#,##0.00)",t.NumberFormatInfo().currencySymbol))),this.defaultComboNumberFormatter1},s.DefaultComboNumberFormatter2=function(){return s._needChangeDefaultFormat(this.defaultComboNumberFormatter2)&&(this.defaultComboNumberFormatter2=new s(r.Format("{0}#,##0;[Red]({0}#,##0)",t.NumberFormatInfo().currencySymbol))),this.defaultComboNumberFormatter2},s.DefaultStandardNumberFormatter=function(){return s._needChangeDefaultFormat(this.defaultStandardNumberFormatter)&&(this.defaultStandardNumberFormatter=new s("0.00E+00",0,n._CultureInfo._currentCulture.Name())),this.defaultStandardNumberFormatter},s.DefaultStandardPercentFormatter1=function(){return s._needChangeDefaultFormat(this.defaultStandardPercentFormatter1)&&(this.defaultStandardPercentFormatter1=new s("0.00%",0,n._CultureInfo._currentCulture.Name())),this.defaultStandardPercentFormatter1},s.DefaultStandardPercentFormatter2=function(){return s._needChangeDefaultFormat(this.defaultStandardPercentFormatter2)&&(this.defaultStandardPercentFormatter2=new s("0%",0,n._CultureInfo._currentCulture.Name())),this.defaultStandardPercentFormatter2},s.DefaultStandardGroupNumberFormatter1=function(){return s._needChangeDefaultFormat(this.defaultStandardGroupNumberFormatter1)&&(this.defaultStandardGroupNumberFormatter1=new s("#,##0.00",0,n._CultureInfo._currentCulture.Name())),this.defaultStandardGroupNumberFormatter1},s.DefaultStandardGroupNumberFormatter2=function(){return s._needChangeDefaultFormat(this.defaultStandardGroupNumberFormatter2)&&(this.defaultStandardGroupNumberFormatter2=new s("#,##0",0,n._CultureInfo._currentCulture.Name())),this.defaultStandardGroupNumberFormatter2},s.prototype.findDateTimeGeneralFormatter=function(t,r,u,f){var e,s,o;if(u&&u.length>0)for(e in u)if(u.hasOwnProperty(e)&&(s=u[e],o=n._DateTimeHelper.parseLocale(t,s),o&&o-r==0))return f();return i},s.prototype.toJSON=function(){var n=this,r={formatModeType:n.formatModeType,customerCultureName:n.customerCultureName,formatCached:n.formatCached},u={},t,i;for(t in r)i=r[t],n._isDefaultValue(t,i)||(u[t]=i);return u},s.prototype._isDefaultValue=function(n,t){switch(n){case"formatModeType":return t===0;case"formatCached":return t==="General";default:return!1}},s.prototype.HasFormatedColor=function(){var n=this;return n.isDefault?!1:n.PositiveExpression()&&n.PositiveExpression().ColorFormatPart()?!0:n.NegativeExpression()&&n.NegativeExpression().ColorFormatPart()?!0:n.ZeroExpression()&&n.ZeroExpression().ColorFormatPart()?!0:n.TextExpression()&&n.TextExpression().ColorFormatPart()?!0:!1},s.prototype.IsDefaultFormat=function(){return this.isDefault},s.prototype.FormatString=function(f){var e=this,o,s,h,c;if(arguments.length===0){e.Init();o=i;switch(e.FormatMode()){case 0:if(e.formatters)for(s=0;s<e.formatters.length;s++)h=e.formatters[s],n.util.isCustomType(h,"CustomNumberFormat")&&(o==i?o="":o+=t.FormatSeparator,c=h.FormatString(),o+=c);break;case 1:if(n.util.isCustomType(e.formatters[0],"StandardDateTimeFormatter"))return e.formatters[0].FormatString();break;case 2:if(n.util.isCustomType(e.formatters[0],"StandardNumberFormatter"))return e.formatters[0].FormatString();break}return o?o:r.Empty}else{if(!f)throw new Error(n.SR.Exp_ValueIsNull);e.formatters=i;e.formatCached=f;e.isDefault=e.formatCached.toLowerCase()===u.General_Lower;e.isConstructed=!1;e.Init();e.RaisePropertyChanged("FormatString")}},s.prototype.DateTimeFormatInfo=function(i){var r=this,u,f,e;if(arguments.length===0)return(r.Init(),r.dateTimeFormatInfo)?r.dateTimeFormatInfo:t.DateTimeFormatInfo();else{if(r.Init(),r.dateTimeFormatInfo=i,r.formatters)for(u=0;u<r.formatters.length;u++)f=r.formatters[u],n.util.isCustomType(f,"IFormatProviderSupport")&&(e=f,e.DateTimeFormatInfo(i));return r.RaisePropertyChanged("DateTimeFormatInfo"),i}},s.prototype.NumberFormatInfo=function(i){var r=this,u,f,e;if(arguments.length===0)return(r.Init(),r.numberFormatInfo)?r.numberFormatInfo:t.NumberFormatInfo();else{if(r.Init(),r.numberFormatInfo=i,r.formatters)for(u=0;u<r.formatters.length;u++)f=r.formatters[u],n.util.isCustomType(f,"IFormatProviderSupport")&&(e=f,e.NumberFormatInfo(i));return r.RaisePropertyChanged("NumberFormatInfo"),i}},s.prototype.FormatMode=function(n){return arguments.length===0?this.formatModeType:(this.formatModeType=n,this.RaisePropertyChanged("FormatMode"),n)},s.prototype.ExcelCompatibleFormatString=function(){var u=this,f,e,o,s;u.Init();f=i;switch(u.FormatMode()){case 0:if(u.formatters)for(e=0;e<u.formatters.length;e++)o=u.formatters[e],n.util.isCustomType(o,"CustomNumberFormat")&&(f==i?f="":f+=t.FormatSeparator,s=o.ExcelCompatibleFormatString(),f+=s);break;case 1:if(n.util.isCustomType(u.formatters[0],"StandardDateTimeFormatter"))return u.formatters[0].ExcelCompatibleFormatString();break;case 2:if(n.util.isCustomType(u.formatters[0],"StandardNumberFormatter"))return u.formatters[0].ExcelCompatibleFormatString();break}return f?f.toString():r.Empty},s.prototype.PositiveExpression=function(){var t=this;return(t.Init(),t.formatters&&t.formatters.length>0)?n.util.asCustomType(t.formatters[0],"CustomNumberFormat"):i},s.prototype.NegativeExpression=function(){var t=this;return(t.Init(),t.formatters&&t.formatters.length>1)?n.util.asCustomType(t.formatters[1],"CustomNumberFormat"):i},s.prototype.ZeroExpression=function(){var t=this;return(t.Init(),t.formatters&&t.formatters.length>2)?n.util.asCustomType(t.formatters[2],"CustomNumberFormat"):i},s.prototype.TextExpression=function(){var t=this;return(t.Init(),t.formatters&&t.formatters.length>3)?n.util.asCustomType(t.formatters[3],"CustomNumberFormat"):i},s.prototype.GetFormatType=function(t){var i,r;if(this.Init(),i=this.GetFormatInfo(t),n.util.isCustomType(i,"CustomNumberFormat")){if(r=i.Formatter(),n.util.isCustomType(r,"NumberFormatDigital"))return 1;else if(n.util.isCustomType(r,"NumberFormatDateTime"))return 2;else if(n.util.isCustomType(r,"NumberFormatText"))return 3}else if(n.util.isCustomType(i,"NumberFormatDigital")||n.util.isCustomType(i,"StandardNumberFormatter"))return 1;else if(n.util.isCustomType(i,"NumberFormatDateTime")||n.util.isCustomType(i,"StandardDateTimeFormatter"))return 2;else if(n.util.isCustomType(i,"NumberFormatText"))return 3;return 0},s.prototype.GetPreferredEditingFormatter=function(t){var i,r;return this.Init(),n.util.isType(t,"DateTime")?(i=new n._DateTimeHelper(t),i.Hour()===0&&i.Minute()===0&&i.Second()===0&&i.Millisecond()===0?s.DefaultShortDatePatternFormatter():s.DefaultSXDatetimePatternFormatter()):n.util.isType(t,"TimeSpan")?s.DefaultLongTimePatternFormatter():n.FormatConverter.IsNumber(t)?(r=n.FormatConverter.ToDouble(t),r>1e20?new s("0.##E+00"):s.DefaultNumberFormatter()):n.util.isType(t,"string")?s.DefaultGeneralFormatter():s.DefaultGeneralFormatter()},s.prototype.GetPreferredDisplayFormatter=function(u,f){var o=this,c,h,l;if(f||(f={value:i}),f.value=i,o.Init(),r.IsNullOrEmpty(u))return new s;if(c=u,h=f.value=o.Parse(c),n.util.isType(h,"DateTime")||n.util.isType(h,"TimeSpan")){if((l=o.findDateTimeGeneralFormatter(u,h,e.GeneralMonthDay(),function(){return s.DefaultDMMMFormatter()}))||(l=o.findDateTimeGeneralFormatter(u,h,e.GeneralYearMonth(),function(){return s.DefaultMMMYYFormatter()}))||(l=o.findDateTimeGeneralFormatter(u,h,e.GeneralYearMonthDay(),function(){return s.DefaultShortDatePatternFormatter()}))||(l=o.findDateTimeGeneralFormatter(u,h,e.GeneralHourMinute(),function(){return s.DefaultHMMFormatter()}))||(l=o.findDateTimeGeneralFormatter(u,h,e.GeneralHourMinuteSecond(),function(){return s.DefaultHMMSSFormatter()}))||(l=o.findDateTimeGeneralFormatter(u,h,e.GeneralHourMinuteSecondSubSecond(),function(){return s.DefaultHMMSS0Formatter()}))||(l=o.findDateTimeGeneralFormatter(u,h,e.GeneralHourMinuteWithDate(),function(){return s._needChangeDefaultFormat(s.defaultShortDatePatternHMMFormatter)&&(s.defaultShortDatePatternHMMFormatter=new s(o.DateTimeFormatInfo().shortDatePattern+" h:mm")),s.defaultShortDatePatternHMMFormatter}))||(l=o.findDateTimeGeneralFormatter(u,h,e.GeneralHourMinuteSecondWithDate(),function(){return s._needChangeDefaultFormat(s.defaultShortDatePatternHMMSSFormatter)&&(s.defaultShortDatePatternHMMSSFormatter=new s(o.DateTimeFormatInfo().shortDatePattern+" h:mm:ss")),s.defaultShortDatePatternHMMSSFormatter}))||(l=o.findDateTimeGeneralFormatter(u,h,e.GeneralHourMinuteSecondSubSecondWithDate(),function(){return s._needChangeDefaultFormat(s.defaultShortDatePatternHMMSS0Formatter)&&(s.defaultShortDatePatternHMMSS0Formatter=new s(o.DateTimeFormatInfo().shortDatePattern+" h:mm:ss.0")),s.defaultShortDatePatternHMMSS0Formatter})))return l}else if(n.FormatConverter.IsNumber(h))if(c[0]===t.NumberFormatInfo().currencySymbol[0])return n.StringHelper.Contains(c,t.DecimalSeparator)?s.DefaultComboNumberFormatter1():s.DefaultComboNumberFormatter2();else if(n.StringHelper.IndexOf(c,"e",1)>-1)return s.DefaultStandardNumberFormatter();else if(c[0].toString()===t.percentSymbol||c[c.length-1].toString()===t.percentSymbol)return n.StringHelper.Contains(c,t.DecimalSeparator)?s.DefaultStandardPercentFormatter1():s.DefaultStandardPercentFormatter2();else if(n.StringHelper.Contains(c,t.numberGroupSeparator))return n.StringHelper.Contains(c,t.DecimalSeparator)?s.DefaultStandardGroupNumberFormatter1():s.DefaultStandardGroupNumberFormatter2();return s.DefaultGeneralFormatter()},s.prototype.Format=function(u,e){var s,v,c,l,h,a;if(n.util.isType(u,"boolean"))return u.toString().toUpperCase();if(e&&(e.value=i),this.Init(),s=this.GetFormatInfo(u),n.util.isCustomType(s,"CustomNumberFormat")&&(v=s.ColorFormatPart(),e&&v&&(e.value=v.ForeColor())),c=0,l=n.FormatConverter.IsNumber(u),l&&(c=n.FormatConverter.ToDouble(u)),s){if(h=i,l&&s===this.NegativeExpression())h=s.Format(o(c)),n.util.isCustomType(s,"CustomNumberFormat")&&(a=n.util.asCustomType(s,"CustomNumberFormat"),a&&a.ConditionFormatPart()&&a.ConditionFormatPart().Value()>0&&c<0&&(h=t.negativeSign+h));else try{h=s.Format(u)}catch(y){n.util.isType(u,"string")&&(h=u.toString())}return h?h:r.Empty}else return l&&c<0?t.HyphenMinus.toString():n.util.isType(u,"string")?u.toString():u===f||u===i?r.Empty:u.toString()},s.prototype.Parse=function(n){var t=this;return(t.Init(),t.formatters&&t.formatters.length>0)?t.formatters[0].Parse(n):i},s.prototype.Init=function(){var n=this;if(!n.isConstructed){n.isConstructed=!0;switch(n.formatModeType){case 0:n.InitExcelCompatibleMode(n.formatCached);break;case 1:n.InitStandardDateTimeMode(n.formatCached);break;case 2:n.InitStandardNumericMode(n.formatCached);break}}},s.prototype.InitStandardDateTimeMode=function(t){var i=new p(t);if(i.EvaluateFormat(t))this.formatters=[],this.formatters.push(i);else throw new Error(n.SR.Exp_FormatIllegal);},s.prototype.InitStandardNumericMode=function(t){var i=new w(t);if(i.EvaluateFormat(t))this.formatters=[],this.formatters.push(i);else throw new Error(n.SR.Exp_FormatIllegal);},s.prototype.InitExcelCompatibleMode=function(i){var u,f,o,e,s;if(r.IsNullOrEmpty(i))throw new Error(n.SR.Exp_FormatIllegal);if(u=this,u.formatters=[],u.isDefault)u.formatters.push(new k);else{if(u.isSingleFormatterInfo=!n.StringHelper.Contains(i,t.FormatSeparator.toString()),f=i.split(t.FormatSeparator),!f)throw new Error(n.SR.Exp_FormatIllegal);if(f.length<1||f.length>5)throw new Error(n.SR.Exp_FormatIllegal);for(o=0,e=0;e<f.length;e++){if(o++,o>4)break;s=new k(f[e],u.customerCultureName);s&&u.formatters.push(s)}if(!u.PositiveExpression())throw new Error(n.SR.Exp_FormatIllegal);}},s.prototype.GetFormatInfo=function(t){var r=this;if(r.FormatMode()===0){if(typeof t=="string"&&isNaN(t))return r.TextExpression()?r.TextExpression():r.PositiveExpression();else if(n.FormatConverter.IsNumber(t)||n.util.isType(t,"boolean")){var f=r.PositiveExpression(),o=r.NegativeExpression(),e=n.FormatConverter.ToDouble(t),s=f&&f.ConditionFormatPart(),h=o&&o.ConditionFormatPart(),u=r.isSingleFormatterInfo?f:i;return f&&(s?f.ConditionFormatPart().IsMeetCondition(e)&&(u=f):(e>0||e===0&&!r.ZeroExpression())&&(u=f)),!u&&r.NegativeExpression()&&(h?o.ConditionFormatPart().IsMeetCondition(e)&&(u=o):e<0&&(u=o)),!u&&r.ZeroExpression()&&e===0&&(u=r.ZeroExpression()),!u&&r.ZeroExpression()&&(u=r.ZeroExpression()),!u&&r.NegativeExpression()&&(u=r.NegativeExpression()),u}}else if((r.FormatMode()===1||r.FormatMode()===2)&&r.formatters&&r.formatters.length===1)return r.formatters[0];return i},s.prototype.RaisePropertyChanged=function(n){var t=this,i,r;if(t.PropertyChanged)for(i=0;i<t.PropertyChanged.length;i++)r=t.PropertyChanged[i],typeof r=="function"&&r(t,n)},s.defaultNumberFormatter=i,s.defaultGeneralFormatter=i,s.defaultShortDatePatternFormatter=i,s.defaultLongTimePatternFormatter=i,s.defaultSXDatetimePatternFormatter=i,s.defaultDMMMFormatter=i,s.defaultMMMYYFormatter=i,s.defaultHMMFormatter=i,s.defaultHMMSSFormatter=i,s.defaultHMMSS0Formatter=i,s.defaultShortDatePatternHMMFormatter=i,s.defaultShortDatePatternHMMSSFormatter=i,s.defaultShortDatePatternHMMSS0Formatter=i,s.defaultComboNumberFormatter1=i,s.defaultComboNumberFormatter2=i,s.defaultStandardNumberFormatter=i,s.defaultStandardPercentFormatter1=i,s.defaultStandardPercentFormatter2=i,s.defaultStandardGroupNumberFormatter1=i,s.defaultStandardGroupNumberFormatter2=i,s}();n.GeneralFormatter=d;var s=function(){function n(n){this._classNames=["FormatPartBase"];this.originalToken=n}return n.prototype.OriginalToken=function(){return this.originalToken},n.prototype.SupportedPartFormat=function(){return n._supportedPartFormat||(n._supportedPartFormat=["ConditionFormatPart","ColorFormatPart","LocaleIDFormatPart"]),n._supportedPartFormat},n.Create=function(n){return ut.EvaluateFormat(n)?new ut(n):ot.EvaluateFormat(n)?new ot(n):ht.EvaluateFormat(n)?new ht(n):et.EvaluateFormat(n)?new et(n):ft.EvaluateFormat(n)?new ft(n):i},n}(),ut=function(u){function f(f){var e,h,v,y,a;if(u.call(this,f),e=this,s.call(e,f),e._classNames.push("ConditionFormatPart"),e._initFileds(),h=t.TrimSquareBracket(f),r.IsNullOrEmpty(h))throw new Error(n.SR.Exp_TokenIllegal);for(var o="",c=0,l=i;c<h.length;c++)if(l=h[c],t.IsOperator(l))o+=l;else break;if(!o)throw new Error(n.SR.Exp_TokenIllegal);v=o;o="";switch(v){case"<":e.compareOperator=4;break;case"<=":e.compareOperator=5;break;case"=":e.compareOperator=0;break;case">=":e.compareOperator=3;break;case">":e.compareOperator=2;break;case"<>":e.compareOperator=1;break;default:throw new Error(n.SR.Exp_TokenIllegal);}for(;c<h.length;c++){if(l=h[c],t.IsOperator(l))throw new Error(n.SR.Exp_TokenIllegal);o+=l}if(!o)throw new Error(n.SR.Exp_TokenIllegal);if(y=o,a=parseFloat(y),isNaN(a))throw new Error(n.SR.Exp_TokenIllegal);else e.value=a}return __extends(f,u),f.prototype._initFileds=function(){this.value=0;this.compareOperator=i},f.prototype.CompareOperator=function(){return this.compareOperator},f.prototype.Value=function(){return this.value},f.prototype.toString=function(){var n="";switch(this.compareOperator){case 0:n+="=";break;case 2:n+=">";break;case 3:n+=">=";break;case 4:n+="<";break;case 5:n+="<=";break;case 1:n+="<>";break;default:throw new Error;}return n+=this.value.toString(),t.AddSquareBracket(n)},f.prototype.IsMeetCondition=function(n){var t=this;switch(t.compareOperator){case 0:return n===t.value;case 2:return n>t.value;case 3:return n>=t.value;case 4:return n<t.value;case 5:return n<=t.value;case 1:return n!==t.value}return!1},f.EvaluateFormat=function(n){if(!n||n===r.Empty)return!1;var i=t.TrimSquareBracket(n);return!i||i===r.Empty?!1:t.IsOperator(i[0])},f}(s),ft=function(u){function f(f){var o,e,h,c;if(u.call(this,f),this.foreColor="black",this.index=-1,this.colorName=i,o=this,s.call(o,f),o._classNames.push("ColorFormatPart"),e=t.TrimSquareBracket(f),!e||e===r.Empty)throw new Error(n.SR.Exp_TokenIllegal);try{o.foreColor=e;o.colorName=e;return}catch(l){}if(!(e.length>5)||(e=n.StringHelper.Remove(e,0,5),h=-1,c=parseInt(e,10),isNaN(c)||(h=c,!(h>=1)||!(h<=56))))throw new Error(n.SR.Exp_TokenIllegal);}return __extends(f,u),f.prototype.ForeColor=function(){return this.foreColor},f.prototype.toString=function(){var n=this;if(n.index>-1)return t.AddSquareBracket("Color"+n.index);else if(n.colorName)return t.AddSquareBracket(n.colorName);throw new Error;},f.EvaluateFormat=function(i){if(!i||i===r.Empty)return!1;var u=t.TrimSquareBracket(i);return!u||u===r.Empty?!1:u.length<3?!1:isNaN(i[i.length-1])?i[0]!==i[1]:n.StringHelper.StartsWith(i,"Color",1)},f}(s),et=function(u){function f(t){var i,r,e;if(u.call(this,t),i=this,s.call(i,t),i._classNames.push("ABSTimeFormatPart"),i._initFileds(),f.EvaluateFormat(t))if(i.token=t.toLowerCase(),i.token[1]===f.HoursABSContent)i.type=0;else if(i.token[1]===f.MinuteABSContent)i.type=1;else if(i.token[1]===f.SecondABSContent)i.type=2;else throw new Error(n.SR.Exp_TokenIllegal);else throw new Error(n.SR.Exp_TokenIllegal);for(r="",e=0;e<i.token.length-2;e++)r+="0";i.formatString=r}return __extends(f,u),f.prototype._initFileds=function(){this.token=i;this.type=i;this.formatString=i},f.prototype.FormatString=function(){return this.formatString},f.prototype.TimePartType=function(){return this.type},f.prototype.Token=function(){return this.token},f.EvaluateFormat=function(n){var u,e,o,s;if(!n||n===r.Empty||(u=t.TrimSquareBracket(n),!u||u===r.Empty))return!1;for(u=u.toLowerCase(),e=i,o=0;o<u.length;o++)if((e||(e=u[o]),s=f,e!==s.HoursABSContent&&e!==s.MinuteABSContent&&e!==s.SecondABSContent)||e!==u[o])return!1;return!0},f.HoursABSContent="h",f.MinuteABSContent="m",f.SecondABSContent="s",f}(s),g=function(){function n(n,t){var f=this,o,e,u;if(f._classNames=["DBNumber"],o=i,e=i,n)for(f.units=[],u=0;u<n.length;u++)e=n[u],e===0?f.units.push(r.Empty):f.units.push(String.fromCharCode(e));if(t)for(f.numbers=[],u=0;u<t.length;u++)e=t[u],e===0?f.numbers.push(r.Empty):f.numbers.push(String.fromCharCode(e))}return n.JapaneseDBNum1=function(){return n.japaneseDBNum1||(n.japaneseDBNum1=new n(n.JapaneseNumberUnitLetter1,n.JapaneseNumberLetterValues1)),n.japaneseDBNum1},n.JapaneseDBNum2=function(){return n.japaneseDBNum2||(n.japaneseDBNum2=new n(n.JapaneseNumberUnitLetter2,n.JapaneseNumberLetterValues2)),n.japaneseDBNum2},n.JapaneseDBNum3=function(){return n.japaneseDBNum3||(n.japaneseDBNum3=new n(i,n.JapaneseNumberLetterValues3)),n.japaneseDBNum3},n.prototype.Units=function(){return this.units},n.prototype.Numbers=function(){return this.numbers},n.japaneseDBNum1=i,n.japaneseDBNum2=i,n.japaneseDBNum3=i,n.JapaneseNumberUnitLetter1=[21315,30334,21313,20806,21315,30334,21313,20740,21315,30334,21313,19975,21315,30334,21313,0],n.JapaneseNumberUnitLetter2=[38433,30334,25342,20806,38433,30334,25342,20740,38433,30334,25342,33836,38433,30334,25342,0],n.JapaneseNumberLetterValues1=[12295,19968,20108,19977,22235,20116,20845,19971,20843,20061],n.JapaneseNumberLetterValues2=[12295,22769,24336,21442,22235,20237,20845,19971,20843,20061],n.JapaneseNumberLetterValues3=[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],n}(),ot=function(u){function f(r){var e,o,s;if(u.call(this,r),this.token=i,this.type=0,e=this,e._classNames.push("DBNumberFormatPart"),f.EvaluateFormat(r)){if(e.token=r,o=t.TrimSquareBracket(r),s=n.StringHelper.Remove(o,0,5),e.type=parseInt(s,10),e.type<0||e.type>3)throw new Error(n.SR.Exp_TokenIllegal);}else throw new Error(n.SR.Exp_TokenIllegal);}return __extends(f,u),f.prototype.Token=function(){return this.token?this.token:r.Empty},f.prototype.Type=function(){return this.type},f.prototype.ReplaceNumberString=function(u,f,e){var l,p;if(!u||u===r.Empty)return u;var h=u,w=u,s=-1,o=-1,a=!1,c=i,v=i,y=i;for(l=u.length-1;l>=0;l--)p=w[l],isNaN(p)&&(!t.IsEquals(p,t.DecimalSeparator,!1)||a)?o>-1&&s>-1&&(c=w.substr(o,s-o+1),v=parseFloat(c),isNaN(v)||(y=this.NumberString(c,f,e),h=n.StringHelper.Remove(h,o,s-o+1),h=n.StringHelper.Insert(h,o,y)),s=-1,o=-1,a=!1):(t.IsEquals(p,t.DecimalSeparator,!1)&&(a=!0),s===-1&&(s=l),o=l);return o>-1&&s>-1&&(c=w.substr(o,s-o+1),v=parseFloat(c),isNaN(v)||(y=this.NumberString(c,f,e),h=n.StringHelper.Remove(h,o,s-o+1),h=n.StringHelper.Insert(h,o,y)),s=-1,o=-1,a=!1),h},f.prototype.NumberString=function(t,r,u){var e=t.split("."),o,s;if(e)if(e.length===1)return f.FormatNumberString(e[0],r.Numbers(),u?r.Units():i);else if(e.length===2)return o=f.FormatNumberString(e[0],r.Numbers(),u?r.Units():i),s=f.FormatNumberString(e[1],r.Numbers()),o+"."+s;throw new Error(n.SR.Exp_ValueIllegal);},f.prototype.toString=function(){if(this.type>-1)return t.AddSquareBracket("DBNum"+this.type);throw new Error;},f.EvaluateFormat=function(i){if(!i||i===r.Empty)return!1;var u=t.TrimSquareBracket(i);return!u||u===r.Empty?!1:n.StringHelper.StartsWith(u,"DBNum",1)?!0:!1},f.FormatNumberString=function(n,t,u){var w=n,v=0,a=i,y=0,k,g,nt,b,e,c,h,it,tt;if(arguments.length===2){for(k="",v=0;v<w.length;v++)a=w.substr(v,1),y=parseInt(a,10),k+=t[y];return k}else if(arguments.length===3){if(!u)return f.FormatNumberString(n,t);var o=0,d="",l=w.length,p=!1,s=[];for(v=0;v<l;v++)g=u.length-1-v,g>-1?s.push(u[g].toString()):s.push(r.Empty);for(nt=[],e=s.length-1;e>=0;e--)nt[s.length-e-1]=s[e];for(s=nt,b=!1,e=0;e<l;e++)a=w.substr(e,1),y=parseInt(a,10),c=r.Empty,h=r.Empty,l-e-16>0?(c=t[y],h="",b=!0):e!==l-1&&e!==l-5&&e!==l-9&&e!==l-13?a==="0"?(c="",h="",o=o+1):a!=="0"&&o!==0?(c=t[0]+t[y],h=s[e],o=0):(c=t[y],h=s[e],o=0):a!=="0"&&o!==0?(c=t[0]+t[y],h=s[e],o=0):a!=="0"&&o===0||b?(c=t[y],h=s[e],o=0,b=!1):a==="0"&&o>=3?(c="",h="",o=o+1):l>=11?(c="",o=o+1):(c="",h=s[e],o=o+1),it=c+h===r.Empty,it||(p=!1),e!==l-13||p||(h=s[e],p=!0),e!==l-9||p||(h=s[e],p=!0),e===l-1&&(h=s[e],p=!0),d=d+c+h;return(tt=parseInt(n,10),!isNaN(tt)&&tt===0)?t[0]:d}},f}(s),v=function(){function t(){}return t.ParseHexString=function(t){if(!t||t===r.Empty)throw new Error(n.SR.Exp_StringIllegal);return parseInt(t,16)},t.FixJapaneseChars=function(n){return n},t.GetFraction=function(n,t,i,r,u){var l=0,y=0,p=0,f=0,s,c,a,v,e;for(n>0?(f=n-h(n)+1,f==1?(f=0,l=n):l=h(n)-1):n<0&&(l=h(n),f=h(n)-n),s=2,c=9,s=nt(10,t-1),c=nt(10,t)-1,s<2&&(s=2),c<2&&(c=2),a=!1,v=0,e=s;e<=c;e++){var d=e*f,w=vt(d),b=w/e,k=o(b-f);if((a?k<o(v-f):!0)&&(a=!0,v=b,y=w,p=e,k<.0005))break}return i.value=l,r.value=y,u.value=p,a},t}(),st=function(){function t(){}return t.AllowScience=function(n){return n?!(n.indexOf("ja")===0)&&!(n.indexOf("zh")===0):!0},t.CreateCultureInfo=function(i){switch(i){case 1033:return n._CultureInfo.getCulture(t.EnglishUnitedStates);case 1041:return n._CultureInfo.getCulture(t.JapanneseJapan);default:return n._CultureInfo.currentCulture()}},t.JapanneseJapan="ja-JP",t.EnglishUnitedStates="en-US",t}(),ht=function(u){function f(f){var o,e,h;if(u.call(this,f),this.currencySymbol=i,this.locateID=-1,this.cultureInfo=i,this.content=i,o=this,s.call(o,f),o._classNames.push("LocaleIDFormatPart"),!f)throw new Error(n.SR.Exp_TokenIsNull);if(f===r.Empty)throw new Error(n.SR.Exp_TokenIllegal);if(o.content=t.TrimSquareBracket(f),e=o.content,!e||e===r.Empty)throw new Error(n.SR.Exp_TokenIllegal);if(t.IsEquals(e[0],t.Dollar,!1))e=n.StringHelper.Remove(e,0,1);else throw new Error(n.SR.Exp_TokenIllegal);if(h=e.indexOf(t.HyphenMinus),h>-1)o.currencySymbol=e.substr(0,h),e=n.StringHelper.Remove(e,0,h);else{o.currencySymbol=e;return}if(t.IsEquals(e[0],t.HyphenMinus,!1))e=n.StringHelper.Remove(e,0,1);else throw new Error(n.SR.Exp_TokenIllegal);if(e.length>0)o.locateID=v.ParseHexString(e);else throw new Error(n.SR.Exp_TokenIllegal);}return __extends(f,u),f.prototype.CultureInfo=function(){var n=this;return n.cultureInfo||(n.cultureInfo=st.CreateCultureInfo(n.locateID),n.currencySymbol&&n.currencySymbol!==r.Empty&&n.cultureInfo&&!n.cultureInfo.NumberFormat().isReadOnly&&(n.cultureInfo.NumberFormat().currencySymbol=n.currencySymbol)),n.cultureInfo},f.prototype.CurrencySymbol=function(){return this.currencySymbol?this.EncodeSymbol(this.currencySymbol):r.Empty},f.prototype.AllowScience=function(){if(this.cultureInfo)return st.AllowScience(this.cultureInfo.Name())},f.prototype.GetDBNumber=function(n){var t=this.locateID&255;switch(t){case 17:switch(n){case 1:return g.JapaneseDBNum1();case 2:return g.JapaneseDBNum2();case 3:return g.JapaneseDBNum3()}break;default:break}return i},f.prototype.toString=function(){return this.content?t.AddSquareBracket(this.content):r.Empty},f.prototype.EncodeSymbol=function(t){return n.StringHelper.Replace(t,"\\.","'.'")},f.EvaluateFormat=function(n){if(!n||n===r.Empty)return!1;var i=t.TrimSquareBracket(n);return!i||i===r.Empty?!1:t.IsEquals(i[0],t.Dollar,!1)},f}(s),ct=function(){function r(){}return r.prototype.ConvertTo=function(r,u,f,e,o){var s=r,h;return e!=i&&o!=i&&u instanceof Date&&(h=e.GetDBNumber(o.Type()),s=o.ReplaceNumberString(s,h,!0),s=s.replace(t.ReplacePlaceholder+c.YearFourDigit,new n._DateTimeHelper(u).localeFormat(c.YearFourDigit)),s=s.replace(t.ReplacePlaceholder+c.YearTwoDigit,new n._DateTimeHelper(u).localeFormat(c.YearTwoDigit)),s=o.ReplaceNumberString(s,h,!1)),s},r}(),c=function(e){function o(n,t,r,f,o){e.call(this,r,f,o);this.baseNumberStringConverter=u.prototype.NumberStringConverter;this.baseDateTimeFormatInfo=u.prototype.DateTimeFormatInfo;this.baseCultureName=u.prototype.CultureName;var s=this;s.validDateTimeFormatString=i;s.formatString=i;s.hasJD=!1;s.absoluteTime=i;s.absTimeParts=i;s.hasYearDelay=!1;s.exactlyMatch=!1;s._classNames.push("NumberFormatDateTime");s.exactlyMatch=!1;s.formatString=s.FixFormat(u.TrimNotSupportSymbol(n));s.absTimeParts=t;s._init(n,t,r,f)}return __extends(o,e),o.EvaluateFormat=function(n){return u.ContainsKeywords(n,o.keyWords,o.keyWordsSet())},o.prototype._init=function(i,r,u,f){var s=this,e={value:s.formatString},h=o,a,c,l;if(h.EvaluateFormat(e.value)){if(a=s.ProcessAMPM(e),s.hasJD=s.Replace(e.value,h.MonthJD,'"'+h.PlaceholderMonthJD+'"',!0,!1,e,!1,!1),s.Replace(e.value,h.MonthUnabbreviated,h.StandardMonthUnabbreviated,!0,!1,e,!1,!1),s.Replace(e.value,h.MonthAbbreviation,h.StandardMonthAbbreviation,!0,!1,e,!1,!1),s.Replace(e.value,h.MonthTwoDigit,h.StandardMonthTwoDigit,!0,!1,e,!1,!1),s.Replace(e.value,h.MonthSingleDigit,h.StandardMonthSingleDigit,!0,!1,e,!1,!1),s.Replace(e.value,h.DayWeekDayAbbreviation,h.StandardDayWeekDayAbbreviation,!0,!0,e,!1,!0),s.Replace(e.value,h.DayWeekDayUnabbreviated,h.StandardDayWeekDayUnabbreviated,!0,!0,e,!1,!0),s.Replace(e.value,h.MinuteSingleDigit,h.StandardMinuteSingleDigit,!1,!0,e,!1,!1),a||(s.Replace(e.value,h.HoursSingleDigit,h.StandardHourSingleDigit,!0,!0,e,!1,!1),s.Replace(e.value,h.HoursTwoDigit,h.StandardHourTwoDigit,!0,!0,e,!1,!1)),s.Replace(e.value,h.SecondSingleDigit,h.StandardSecondSingleDigit,!0,!0,e,!1,!0),s.PartDBNumberFormat()&&s.PartLocaleID()&&(s.hasYearDelay=s.hasYearDelay||s.Replace(e.value,h.YearFourDigit,'"'+t.ReplacePlaceholder+h.YearFourDigit+'"',!0,!1,e,!1,!0),s.hasYearDelay=s.hasYearDelay||s.Replace(e.value,h.YearTwoDigit,'"'+t.ReplacePlaceholder+h.YearTwoDigit+'"',!0,!1,e,!1,!0)),s.absTimeParts)for(c=0;c<s.absTimeParts.length;c++)l=s.absTimeParts[c],s.Replace(e.value,l.token,t.ReplacePlaceholder+l.token,!0,!0,e,!1,!0);s.validDateTimeFormatString=e.value}else throw new Error(n.SR.Exp_FormatIllegal);},o.prototype._isJanpaneseCulture=function(){var t=this.PartLocaleID();if(t!==i&&t.CultureInfo()!==i){if(t.CultureInfo()===n._CultureInfo.japanCulture())return!0}else if(this.CultureName()===n._CultureInfo.japanCulture().Name())return!0;return!1},o.prototype.NumberStringConverter=function(n){return arguments.length===0?this.baseNumberStringConverter()?this.baseNumberStringConverter():o.defaultDateTimeNumberStringConverter:(this.baseNumberStringConverter(n),n)},o.prototype.AbsoluteTime=function(){return this.absoluteTime?this.absoluteTime:o.defaultAbsoluteTime},o.prototype.FormatString=function(){return this.formatString},o.prototype.DateTimeFormatInfo=function(i){var r=this;return arguments.length===0?r.baseDateTimeFormatInfo()?r.baseDateTimeFormatInfo():r.PartLocaleID()&&r.PartLocaleID().CultureInfo()?r.PartLocaleID().CultureInfo().DateTimeFormat():r.baseCultureName()?n._CultureInfo.getCulture(r.baseCultureName()).DateTimeFormat():t.DateTimeFormatInfo():(r.baseDateTimeFormatInfo(i),i)},o.prototype.ExcelCompatibleFormatString=function(){var t=this,i=t.formatString,n=o,r={value:i};return t.Replace(i,n.StandardAMPMSingleDigit,t.CurrentAMPM(),!0,!0,r,!1,!0),t.Replace(i,n.StandardMonthUnabbreviated,n.MonthUnabbreviated,!0,!1,r,!1,!0),t.Replace(i,n.StandardMonthAbbreviation,n.MonthAbbreviation,!0,!1,r,!1,!0),t.Replace(i,n.StandardMonthTwoDigit,n.MonthTwoDigit,!0,!1,r,!1,!0),t.Replace(i,n.StandardMonthSingleDigit,n.MonthSingleDigit,!0,!1,r,!1,!0),t.Replace(i,n.StandardDayWeekDayAbbreviation,n.DayWeekDayAbbreviation,!0,!0,r,!1,!0),t.Replace(i,n.StandardDayWeekDayUnabbreviated,n.DayWeekDayUnabbreviated,!0,!0,r,!1,!0),t.Replace(i,n.StandardMinuteSingleDigit,n.MinuteSingleDigit,!1,!0,r,!1,!0),t.Replace(i,n.StandardHourSingleDigit,n.HoursSingleDigit,!0,!0,r,!1,!1),t.Replace(i,n.StandardHourTwoDigit,n.HoursTwoDigit,!0,!0,r,!1,!1),t.Replace(i,n.StandardSecondSingleDigit,n.SecondSingleDigit,!0,!0,r,!1,!0),t.Replace(i,n.StandardSubSecondThreeDigit,n.SubSecondThreeDigit,!0,!0,r,!1,!0),t.Replace(i,n.StandardSubSecondTwoDigit,n.SubSecondTwoDigit,!0,!0,r,!1,!0),t.Replace(i,n.StandardSubSecondSingleDigit,n.SubSecondSingleDigit,!0,!0,r,!1,!0),r.value},o.prototype.CurrentAMPM=function(){var n=i;return(n=this.DateTimeFormatInfo()?this.DateTimeFormatInfo():t.DateTimeFormatInfo(),n&&n.amDesignator&&n.amDesignator!==r.Empty&&n.pmDesignator&&n.pmDesignator!==r.Empty)?r.Format("{0}/{1}",n.amDesignator,n.pmDesignator):o.AMPMTwoDigit},o.prototype.Format=function(u){var l,c,b,y,p,w,v,k;if(n.util.isType(u,"boolean"))return u.toString().toUpperCase();var e=this,s=r.Empty,h=i;try{try{h=n.Calc.Convert.DT(u);h||(s=u.toString())}catch(d){s=u.toString()}if(h&&(l=e.validDateTimeFormatString,c=e.validDateTimeFormatString.replace(/%/g,""),c==="H"||c==="h"||c==="m"||c==="M"||c==="d"||c==="s"||c==="y"?(l="%"+c,e.validDateTimeFormatString=l):l=c,s=e.PartLocaleID()&&e.PartLocaleID().CultureInfo()?new n._DateTimeHelper(h).customCultureFormat(l,e.PartLocaleID().CultureInfo()):e.CultureName()?new n._DateTimeHelper(h).customCultureFormat(l,n._CultureInfo.getCulture(e.CultureName())):new n._DateTimeHelper(h).localeFormat(l),e.hasJD&&(b=e._getMonthName(h.getMonth()),s=n.StringHelper.Replace(s,o.PlaceholderMonthJD,b.substr(0,1))),e.absTimeParts))for(y=(n._DateTimeHelper.___toOADate(h)-n._DateTimeHelper.___toOADate(e.AbsoluteTime()))*864e5,p=0;p<e.absTimeParts.length;p++){w=e.absTimeParts[p];v=i;switch(w.TimePartType()){case 0:v=a(y/36e5);break;case 1:v=a(y/6e4);break;case 2:v=a(y/1e3);break}v!==i&&v!==f&&(k=w.token.replace("[","\\[").replace("]","\\]"),s=n.StringHelper.Replace(s,t.ReplacePlaceholder+k,v))}}catch(g){s=n.FormatConverter.toString(u)}return e.NumberStringConverter()&&(e.NumberStringConverter()instanceof ct?s=e.NumberStringConverter().ConvertTo(s,u,!1,e.PartLocaleID(),e.PartDBNumberFormat()):(e.hasYearDelay&&(s=n.StringHelper.Replace(s,t.ReplacePlaceholder+o.YearFourDigit,new n._DateTimeHelper(h).localeFormat(o.YearFourDigit)),s=n.StringHelper.Replace(s,t.ReplacePlaceholder+o.YearTwoDigit,new n._DateTimeHelper(h).localeFormat(o.YearTwoDigit))),s=e.NumberStringConverter().ConvertTo(s,u,!0,e.PartLocaleID(),e.PartDBNumberFormat()))),s},o.prototype._getMonthName=function(n){var t=["January","February","March","April","May","June","July","August","September","October","November","December"];return t[n]},o.prototype.Parse=function(t){var o,e;if(!t||t===r.Empty)return i;var f=this,u=v.FixJapaneseChars(t),s=u.toLowerCase();if(s==="true")return!0;else if(s==="false")return!1;if(f.validDateTimeFormatString&&(o=n._DateTimeHelper.parseExact(u,f.validDateTimeFormatString,n._CultureInfo.getCulture(f.CultureName())),o))return o;if(!f.exactlyMatch)try{return e=n.Calc.Convert.DT(u),e&&!isNaN(e)?e:u}catch(h){return u}return i},o.prototype.FixFormat=function(i){for(var r,u=i,s="",e=!1,h=n.StringHelper.IndexOf(u,o.HoursSingleDigit[0],1)>-1||n.StringHelper.IndexOf(u,o.SecondSingleDigit[0],1)>-1,c=n.StringHelper.IndexOf(u,o.YearTwoDigit[0],1)>-1||n.StringHelper.IndexOf(u,o.DaySingleDigit[0],1)>-1,f=0;f<u.length;f++)r=u[f],r==='"'?e=!e:e||(r==="Y"||r==="D"||r==="S"||r==="E"||r==="G"?r=r.toLowerCase():r==="M"&&(f>1?t.IsEquals("A",u[f-1],!0)||t.IsEquals("P",u[f-1],!0)||(r=r.toLowerCase()):r=r.toLowerCase())),s+=r;return s},o.prototype.ProcessAMPM=function(t){var u=!1,i,f,r;return n.StringHelper.Contains(t.value,o.AMPMTwoDigit)&&(t.value=n.StringHelper.Replace(t.value,o.AMPMTwoDigit,o.StandardAMPMSingleDigit),u=!0),i=this.DateTimeFormatInfo(),n.StringHelper.Contains(t.value,o.AMPMSingleDigit)&&(t.value=n.StringHelper.Replace(t.value,o.AMPMSingleDigit,o.StandardAMPMSingleDigit),i&&(i.amDesignator=o.AMPMSingleDigit.substr(0,1),i.pmDesignator=o.AMPMSingleDigit.substr(2,1)),u=!0),f=this.CurrentAMPM(),n.StringHelper.Contains(t.value,f)&&(t.value=n.StringHelper.Replace(t.value,f,o.StandardAMPMSingleDigit),r=f.split("/"),r&&r.length===2&&(i.amDesignator=r[0],i.pmDesignator=r[1]),u=!0),u},o.prototype.Replace=function(i,r,u,f,e,s,h,c){var a,w,y,b,tt,v,g;if(s.value=i,f||e){var k=[],p=!0,it=n.StringHelper.IndexOf(s.value,o.HoursSingleDigit[0],1)>-1||n.StringHelper.IndexOf(s.value,o.SecondSingleDigit[0],1)>-1,rt=n.StringHelper.IndexOf(s.value,o.YearTwoDigit[0],1)>-1||n.StringHelper.IndexOf(s.value,o.DaySingleDigit[0],1)>-1;!rt&&it&&(p=!1);for(var d=!1,nt=0,l=0;l<s.value.length;l++){if(a=s.value[l],t.IsEquals(a,o.HoursSingleDigit[0],!0)||t.IsEquals(a,o.SecondSingleDigit[0],!0)?p=!1:(t.IsEquals(a,o.YearTwoDigit[0],!0)||t.IsEquals(a,o.DaySingleDigit[0],!0))&&(p=!0),f&&t.IsEquals(a,r[nt],c)&&p||e&&t.IsEquals(a,r[nt],c)&&!p){for(w=!0,y=0;y<r.length;y++)if(y+l>=i.length||!t.IsEquals(r[y],s.value[y+l],c)){w=!1;break}if(b=l+r.length-1,w&&b+1<s.value.length){for(tt=s.value[b],v=-1,v=b+1;v<s.value.length;v++)if(!t.IsEquals(tt,s.value[v],c))break;v>b+1&&(l=v,w=!1)}w&&!d&&n.ArrayHelper.insert(k,0,l)}a==='"'&&(d=!d)}if(k.length>0){if(!h)for(l=0;l<k.length;l++)g=k[l],s.value=n.StringHelper.Remove(s.value,g,r.length),s.value=n.StringHelper.Insert(s.value,g,u);return!0}else return!1}return!1},o.keyWordsSet=function(){var n=o,i,t;if(!n._keyWordsSet){for(i={},t=0;t<n.keyWords.length;t++)i[n.keyWords[t]]=!0;n._keyWordsSet=i}return n._keyWordsSet},o.defaultDateTimeNumberStringConverter=new ct,o.YearTwoDigit="yy",o.YearSingleDigit="y",o.YearFourDigit="yyyy",o.MonthSingleDigit="m",o.MonthTwoDigit="mm",o.MonthAbbreviation="mmm",o.MonthUnabbreviated="mmmm",o.MonthJD="mmmmm",o.DaySingleDigit="d",o.DayTwoDigit="dd",o.DayWeekDayAbbreviation="aaa",o.DayWeekDayUnabbreviated="aaaa",o.HoursSingleDigit="h",o.HoursTwoDigit="hh",o.MinuteSingleDigit="m",o.MinuteTwoDigit="mm",o.SecondSingleDigit="s",o.SecondTwoDigit="ss",o.SubSecondSingleDigit=".0",o.SubSecondTwoDigit=".00",o.SubSecondThreeDigit=".000",o.EraYear="e",o.AMPMTwoDigit="AM/PM",o.AMPMSingleDigit="A/P",o.StandardYearSingleDigit="%y",o.StandardMonthSingleDigit="%M",o.StandardMonthTwoDigit="MM",o.StandardMonthAbbreviation="MMM",o.StandardMonthUnabbreviated="MMMM",o.StandardAMPMSingleDigit="tt",o.StandardMinuteSingleDigit="%m",o.StandardHourSingleDigit="H",o.StandardHourTwoDigit="HH",o.StandardSecondSingleDigit="%s",o.StandardSubSecondSingleDigit=".f",o.StandardSubSecondTwoDigit=".ff",o.StandardSubSecondThreeDigit=".fff",o.StandardDayWeekDayAbbreviation="ddd",o.StandardDayWeekDayUnabbreviated="dddd",o.PlaceholderMonthJD=t.ReplacePlaceholder+"mmmmm",o.defaultAbsoluteTime=new Date(1899,11,30,0,0,0,0),o.keyWords=[o.YearSingleDigit,o.YearTwoDigit,o.YearFourDigit,o.MonthSingleDigit,o.MonthTwoDigit,o.MonthAbbreviation,o.MonthUnabbreviated,o.MonthJD,o.DaySingleDigit,o.DayTwoDigit,o.DayWeekDayAbbreviation,o.DayWeekDayUnabbreviated,o.HoursSingleDigit,o.HoursTwoDigit,o.MinuteSingleDigit,o.MinuteTwoDigit,o.SecondSingleDigit,o.SecondTwoDigit,"ggg","gg","g","ee","e"],o}(u),wt=function(){function n(){}return n.prototype.ConvertTo=function(n,t,r,u,f){if(u!=i&&f!=i){var e=u.GetDBNumber(f.Type());if(e!=i)return f.ReplaceNumberString(n,e,r)}return n},n}(),y=function(f){function e(e,o,s,h){var c,l,p,w,v,a,y;f.call(this,o,s,h);this.baseNumberStringConverter=u.prototype.NumberStringConverter;this.baseNumberFormatInfo=u.prototype.NumberFormatInfo;this.baseCultureName=u.prototype.CultureName;c=this;c.numberFormatString=i;c.fullFormatString=i;c.isGeneralNumber=!1;c.fractionIntegerFormat=i;c.fractionNumeratorFormat=i;c.fractionDenominatorFormat=i;c.excelFormatString=r.Empty;c._classNames.push("NumberFormatDigital");l=u.TrimNotSupportSymbol(e);c.fullFormatString=t.Filter(e,t.LeftSquareBracket,t.RightSquareBracket);c.excelFormatString=l;o&&(p=l,l=t.ReplaceKeyword(p,c.PartLocaleID().OriginalToken(),c.PartLocaleID().CurrencySymbol()));c.PartDBNumberFormat()&&(c.excelFormatString=t.ReplaceKeyword(c.excelFormatString,c.PartDBNumberFormat().OriginalToken(),c.PartDBNumberFormat().toString()));l=t.Filter(l,t.LeftSquareBracket,t.RightSquareBracket);w=l.indexOf(t.SolidusSign);w>-1&&(l=n.StringHelper.Replace(l,"\\"+t.QuestionMark,t.Zero),v=l.split(t.SolidusSign),v&&v.length===2&&(c.fractionDenominatorFormat=v[1],a=v[0],a&&(y=a.lastIndexOf(t.Space),y>-1?(c.fractionIntegerFormat=a.substr(0,y),c.fractionNumeratorFormat=a.substr(y+1,a.length-y-1)):c.fractionNumeratorFormat=a)));c.numberFormatString=l}return __extends(e,f),e.prototype.NumberStringConverter=function(n){var t=this;return arguments.length===0?t.baseNumberStringConverter()?t.baseNumberStringConverter():e.defaultNumberStringConverter:(t.baseNumberStringConverter(n),n)},e.prototype.FormatString=function(){return this.fullFormatString},e.prototype.NumberFormatInfo=function(i){var r=this;return arguments.length===0?r.baseNumberFormatInfo()?r.baseNumberFormatInfo():r.PartLocaleID()&&r.PartLocaleID().CultureInfo()?r.PartLocaleID().CultureInfo().NumberFormat():r.baseCultureName()?n._CultureInfo.getCulture(r.baseCultureName()).NumberFormat():t.NumberFormatInfo():(r.baseNumberFormatInfo(i),i)},e.prototype.IsGeneralNumber=function(n){return arguments.length===0?this.isGeneralNumber:(this.isGeneralNumber=n,n)},e.prototype.ExcelCompatibleFormatString=function(){return this.excelFormatString},e.prototype.Format=function(u){var f,l,d,o,y,it,p,a,b,ut,v,w;if(n.util.isType(u,"boolean"))return u.toString().toUpperCase();if(f=this,l=n.FormatConverter.ToDouble(u),isNaN(l)||!isFinite(l)||isNaN(u))return typeof u=="string"?u:i;if(d=f.NaNSymbol(),o=i,y=f.CultureName()?n._CultureInfo.getCulture(f.CultureName()):n._CultureInfo._currentCulture,f.fractionNumeratorFormat&&f.fractionDenominatorFormat){var g={value:0},s={value:0},c={value:0},ft=f.fractionDenominatorFormat.length;if(e.GetFraction(l,ft,g,s,c))if(it=f.GetGCD(s.value,c.value),it>1&&(s.value/=it,c.value/=it),f.fractionIntegerFormat){if(o="",g.value!==0&&(o+=new n._NumberHelper(g.value).customCultureFormat(f.fractionIntegerFormat,y),o+=t.Space),g.value===0&&l<0&&(o+=t.negativeSign),l===0&&(o+="0"),p=f.fractionDenominatorFormat,a=parseFloat(p),isNaN(a)||a>0&&(s.value*=a/c.value,p=r.Empty,c.value=a,v=h(s.value),w=v-s.value,s.value=w<=.5&&w>=0?parseFloat(v.toString()):parseFloat((v-1).toString())),b=f.fractionNumeratorFormat,ut=parseFloat(b),!isNaN(ut)&&ut===0){var nt=b.length,rt=s.value.toString(),tt=rt.length;nt>tt?b=b.substr(0,nt-(nt-tt)):nt<tt&&(rt=rt.substr(0,tt-(tt-nt)),s.value=parseInt(rt,10))}return s.value!==0&&(o+=new n._NumberHelper(s.value).customCultureFormat(b,y).replace(/^0*/,""),o+=t.SolidusSign,o+=new n._NumberHelper(c.value).customCultureFormat(p,y).replace(/^0*/,"")),o}else{o="";var k=g.value*c.value+s.value,p=f.fractionDenominatorFormat,a=parseFloat(p);return a>0?(k*=a/c.value,p=r.Empty,c.value=a,v=h(k),w=v-k,k=w<=.5&&w>=0?parseFloat(v.toString()):parseFloat((v-1).toString()),o+=k+t.SolidusSign+c.value):(o+=new n._NumberHelper(k).customCultureFormat(f.fractionNumeratorFormat,y).replace(/^0*/,""),o+=t.SolidusSign,o+=new n._NumberHelper(c.value).customCultureFormat(f.fractionDenominatorFormat,y).replace(/^0*/,"")),o}else return l.toString()}else d=new n._NumberHelper(l).customCultureFormat(f.EncodeNumberFormat(f.numberFormatString),y),f.NumberStringConverter()&&(d=f.NumberStringConverter().ConvertTo(d,u,f.isGeneralNumber,f.PartLocaleID(),f.PartDBNumberFormat()));return d},e.prototype.Parse=function(u){var e=this,k,p,c,l,w,b,it,nt,rt,f,y,ut,tt;if(u=e.TrimSpecialSymbol(u),u=e.TrimCurrencySymbol(u),!u||u===r.Empty)return i;if(n.StringHelper.EndsWith(u,t.numberGroupSeparator))return u;if(k=v.FixJapaneseChars(u),u.toLowerCase()==="true")return!0;else if(u.toLowerCase()==="false")return!1;var s=t.IsDecimal(k,e.NumberFormatInfo()),g=n.StringHelper.IndexOf(k,t.ExponentialSymbol,1),h=g>-1;if(e.numberFormatString){if(p={value:0},u=e.TrimPercentSign(u,p),c=u,h&&(c=u.substr(0,g)),c[0]===t.NumberFormatInfo().positiveSign&&(c=c.substr(1),u=u.substr(1)),l=n.StringHelper.Replace(c,t.numberGroupSeparator,""),w=l.indexOf(t.DecimalSeparator),w===l.lastIndexOf(t.DecimalSeparator)){if(b="#,##0",w!==-1)for(b+=".",it=l.length-w-1,nt=0;nt<it;nt++)b+="0";rt=new d(b).Format(l);rt===c&&(u=h?l+u.substr(g):l)}if(f=parseFloat(u),y=i,f.toString()!==u&&(ut=e.NumberFormatInfo(),tt=t.DecimalSeparator,s||h?s&&!h?y=new RegExp("^((\\+|-)?\\d*)"+tt+"(\\d*)$","ig"):!s&&h?y=new RegExp("^((\\+|-)?\\d+)((E(\\+|-)?|e(\\+|-)?)\\d+)$","ig"):s&&h&&(y=new RegExp("^((\\+|-)?\\d*)"+tt+"(\\d*)((E(\\+|-)?|e(\\+|-)?)\\d+)$","ig")):y=new RegExp("^((\\+|-)?\\d+)$","ig")),!isNaN(f)&&isFinite(f)&&(!y||y.test(u)))return p.value>0&&(f=f/parseFloat((100*p.value).toString())),f!==0&&o(f-a(f))!==0&&(s=!0),h&&(s=!0),e.ToObject(f,s)}return i},e.prototype.EncodeNumberFormat=function(n){var i,r,t;if(n){for(i=n.split(""),r="",t=0;t<i.length-1;)i[t]==="\\"?(r+=i[t+1],t+=2):(r+=i[t],t++);t===i.length-1&&i[t]!=="\\"&&(r+=i[t]);n=r}return n},e.prototype.ToObject=function(n,t){return t?n:n<=1e22?n:n},e.prototype.TrimPercentSign=function(i,u){if(u.value=0,!i||i===r.Empty)return i;var f=i,e=t.percentSymbol,o=i.indexOf(e);return o===i.length-1&&o===i.lastIndexOf(e)&&(f=n.StringHelper.Replace(f,e,""),u.value+=(i.length-f.length)/e.length),f},e.prototype.TrimSpecialSymbol=function(i){var u,h,e,c,o,f,s;if(!i||i===r.Empty)return i;for(u=i,h=-1,e=0;e<u.length;e++)if(l.IsDigit(u[e])){h=e;break}for(c=-1,o=u.length-1;o>-1;o--)if(l.IsDigit(u[o])){c=o;break}for(f=u.length-1;f>-1;f--)if(s=u[f],this.IsSpecialSymbol(s))l.IsWhiteSpace(s)?(f<h||c<f)&&(u=n.StringHelper.Remove(u,f,1)):u=n.StringHelper.Remove(u,f,1);else if((s==="-"||s==="+")&&f>0&&u[f-1]!=="e"&&u[f-1]!=="E"&&u[f-1]!=="("&&u[f-1].toString()!==t.NumberFormatInfo().currencySymbol)break;return u},e.prototype.IsStandardNumberSymbol=function(n){var i=this.NumberFormatInfo()?this.NumberFormatInfo():t.NumberFormatInfo(),r;return i&&(r=n.toString(),r===i.currencyDecimalSeparator||r===i.currencyGroupSeparator||r===i.currencySymbol||r===i.nanSymbol||r===i.negativeInfinitySymbol||r===i.negativeSign||r===i.numberDecimalSeparator||r===i.numberGroupSeparator||r===i.percentDecimalSeparator||r===i.percentGroupSeparator||r===i.percentSymbol||r===i.perMilleSymbol||r===i.positiveInfinitySymbol||r===i.positiveSign)?!0:!1},e.prototype.IsSpecialSymbol=function(n){return this.IsStandardNumberSymbol(n)?!1:l.IsWhiteSpace(n)?!0:!1},e.prototype.TrimCurrencySymbol=function(n){var i,r,u;return n?(i=this.NumberFormatInfo()?this.NumberFormatInfo():t.NumberFormatInfo(),i&&(r=i.currencySymbol,u=n.toString().indexOf(r),u===0&&u===n.lastIndexOf(r)&&(n=n.substr(1))),n):n},e.keyWordsSet=function(){var n=e,i,t;if(!n._keyWordsSet){for(i={},t=0;t<n.keywords.length;t++)i[n.keywords[t]]=!0;n._keyWordsSet=i}return n._keyWordsSet},e.EvaluateFormat=function(n){return u.ContainsKeywords(n,e.keywords,e.keyWordsSet())},e.GetFraction=function(n,t,i,r,u){return v.GetFraction(n,t,i,r,u)},e.prototype.GetGCD=function(n,t){if(n==0)return o(t);if(t==0)return o(n);for(var r=lt(n,t),i=at(n,t),u=r%i;u!=0;)r=i,i=u,u=r%i;return o(i)},e.defaultNumberStringConverter=new wt,e.keywords=[t.Exponential1,t.Exponential2,t.NumberSign,t.DecimalSeparator,t.numberGroupSeparator,t.percentSymbol,t.Zero,t.SolidusSign],e}(u),e=function(e){function s(r,f,o,h){if(e.call(this,f,o,h),this.digitalFormat=i,this.exponentialDigitalFormat=i,this.fullFormatString=i,this._classNames.push("NumberFormatGeneral"),arguments.length>0)if(s.EvaluateFormat(r)){if(r.indexOf(t.Zero)>=0||r.indexOf(t.NumberSign)>=0||r.indexOf(t.DecimalSeparator)>=0||r.indexOf(t.CommercialAt)>=0)throw n.SR.Exp_FormatIllegal;this.fullFormatString=r}else throw n.SR.Exp_FormatIllegal;else this.fullFormatString=u.General}return __extends(s,e),s.prototype.DigitalFormat=function(){var n=this,i;return n.digitalFormat||(i=n.fullFormatString,i=t.ReplaceKeyword(i,u.General,s.GeneralNumber),n.digitalFormat=new y(i,n.PartLocaleID(),n.PartDBNumberFormat(),n.CultureName()),n.digitalFormat.IsGeneralNumber(!0)),n.digitalFormat},s.prototype.ExponentialDigitalFormat=function(){var n=this;return n.exponentialDigitalFormat||(n.exponentialDigitalFormat=new y("0.#####E+00",n.PartLocaleID(),n.PartDBNumberFormat(),n.CultureName()),n.exponentialDigitalFormat.IsGeneralNumber(!0)),n.exponentialDigitalFormat},s.prototype.FormatString=function(){return n.StringHelper.Replace(this.fullFormatString,s.GeneralPlaceholder,u.General)},s.prototype.Format=function(r){var e=this,h,u,s;if(n.FormatConverter.IsNumber(r)){if(h=e.PartLocaleID()?e.PartLocaleID().AllowScience():!0,u=n.FormatConverter.ToDouble(r),u!==f&&u!==i)return o(u)>99999999999&&h||o(u)<1e-11&&u!==0?e.ExponentialDigitalFormat().Format(r):e.DigitalFormat().Format(r)}else if(n.util.isType(r,"string"))return(s=n.StringHelper.Replace(e.FormatString(),'"',""),s=t.TrimEscape(s),s)?n.StringHelper.Replace(s,"General",r):r;else if(n.util.isType(r,"boolean"))return r.toString().toUpperCase();return""},s.prototype.Parse=function(u){var c,l,a,v;if(r.IsNullOrEmpty(u))return i;if(c=!1,l=n.StringHelper.IndexOf(u,"-"),l>0&&(t.IsEquals(u.charAt(l-1),t.ExponentialSymbol,!0)||(c=!0)),(n.StringHelper.Contains(u,"/")||c||n.StringHelper.Contains(u,":")||n.StringHelper.Contains(u,"-"))&&(a=n._DateTimeHelper.parseLocale(u),a))return a;var s=u,e=i,h=i;if(s.charAt(0)===t.negativeSign?h=!0:s.charAt(0)===t.NumberFormatInfo().positiveSign&&(h=!1),v=!1,h&&s.length>3&&s.charAt(1)===t.LeftParenthesis&&s.charAt(s.length-1)===t.RightParenthesis&&(v=!0),h&&v){if(e=this.DigitalFormat().Parse(n.StringHelper.Remove(u,0,1)),e)return n.util.isType(e,"number")?o(e)*(h?-1:1):e}else if(e=this.DigitalFormat().Parse(u),e!==f&&e!==i)return e;return u},s.GeneralMonthDay=function(){return["M/d","MMM/d","MMMM/d","d/M","d/MMM","d/MMMM","M-d","MMM-d","MMMM-d","d-M","d-MMM","d-MMMM"]},s.GeneralYearMonth=function(){return["M/y","MMM/y","M/yyyy","MMM/yyyy","M-y","MMM-y","M-yyyy","MMM-yyyy"]},s.GeneralYearMonthDay=function(){return["M/d/y","MMM/d/y","MMMM/d/y","M/d/yyyy","MMM/d/yyyy","MMMM/d/yyyy","d/M/y","d/MMM/y","d/MMMM/y","d/M/yyyy","d/MMM/yyyy","d/MMMM/yyyy","yyyy/M/d","M-d-y","MMM-d-y","MMMM-d-y","M-d-yyyy","MMM-d-yyyy","MMMM-d-yyyy","d-M-y","d-MMM-y","d-MMMM-y","d-M-yyyy","d-MMM-yyyy","d-MMMM-yyyy","yyyy-M-d"]},s.GeneralHourMinute=function(){return["H:m","h:m tt"]},s.GeneralHourMinuteWithDate=function(){return["M/d H:m","MMM/d H:m","MMMM/d H:m","d/M H:m","d/MMM H:m","d/MMMM H:m","M/y H:m","MMM/y H:m","M/yyyy H:m","MMM/yyyy H:m","M/d/y H:m","MMM/d/y H:m","MMMM/d/y H:m","M/d/yyyy H:m","MMM/d/yyyy H:m","MMMM/d/yyyy H:m","M-d H:m","MMM-d H:m","MMMM-d H:m","d-M H:m","d-MMM H:m","d-MMMM H:m","M-y H:m","MMM-y H:m","M-yyyy H:m","MMM-yyyy H:m","M-d-y H:m","MMM-d-y H:m","MMMM-d-y H:m","M-d-yyyy H:m","MMM-d-yyyy H:m","MMMM-d-yyyy H:m","M/d h:m tt","MMM/d h:m tt","MMMM/d h:m tt","d/M h:m tt","d/MMM h:m tt","d/MMMM h:m tt","M/y h:m tt","MMM/y h:m tt","M/yyyy h:m tt","MMM/yyyy h:m tt","M/d/y h:m tt","MMM/d/y h:m tt","MMMM/d/y h:m tt","M/d/yyyy h:m tt","MMM/d/yyyy h:m tt","MMMM/d/yyyy h:m tt","M-d h:m tt","MMM-d h:m tt","MMMM-d h:m tt","d-M h:m tt","d-MMM h:m tt","d-MMMM h:m tt","M-y h:m tt","MMM-y h:m tt","M-yyyy h:m tt","MMM-yyyy h:m tt","M-d-y h:m tt","MMM-d-y h:m tt","MMMM-d-y h:m tt","M-d-yyyy h:m tt","MMM-d-yyyy h:m tt","MMMM-d-yyyy h:m tt"]},s.GeneralHourMinuteSecond=function(){return["H:m:s","h:m:s tt","H:m:s","h:mm:ss tt"]},s.GeneralHourMinuteSecondSubSecond=function(){return["H:m:s.FFF","h:m:s.FFF tt"]},s.GeneralHourMinuteSecondWithDate=function(){return["M/d H:m:s","MMM/d H:m:s","MMMM/d H:m:s","d/M H:m:s","d/MMM H:m:s","d/MMMM H:m:s","M/y H:m:s","MMM/y H:m:s","M/yyyy H:m:s","MMM/yyyy H:m:s","M/d/y H:m:s","MMM/d/y H:m:s","MMMM/d/y H:m:s","M/d/yyyy H:m:s","MMM/d/yyyy H:m:s","MMMM/d/yyyy H:m:s","d/M/y H:m:s","d/MMM/y H:m:s","d/MMMM/y H:m:s","d/M/yyyy H:m:s","d/MMM/yyyy H:m:s","d/MMMM/yyyy H:m:s","yyyy/M/d H:m:s","M-d H:m:s","MMM-d H:m:s","MMMM-d H:m:s","d-M H:m:s","d-MMM H:m:s","d-MMMM H:m:s","M-y H:m:s","MMM-y H:m:s","M-yyyy H:m:s","MMM-yyyy H:m:s","M-d-y H:m:s","MMM-d-y H:m:s","MMMM-d-y H:m:s","M-d-yyyy H:m:s","MMM-d-yyyy H:m:s","MMMM-d-yyyy H:m:s","d-M-y H:m:s","d-MMM-y H:m:s","d-MMMM-y H:m:s","d-M-yyyy H:m:s","d-MMM-yyyy H:m:s","d-MMMM-yyyy H:m:s","yyyy-M-d H:m:s","M/d h:m:s tt","MMM/d h:m:s tt","MMMM/d h:m:s tt","d/M h:m:s tt","d/MMM h:m:s tt","d/MMMM h:m:s tt","M/y h:m:s tt","MMM/y h:m:s tt","M/yyyy h:m:s tt","MMM/yyyy h:m:s tt","M/d/y h:m:s tt","MMM/d/y h:m:s tt","MMMM/d/y h:m:s tt","M/d/yyyy h:m:s tt","MMM/d/yyyy h:m:s tt","MMMM/d/yyyy h:m:s tt","d/M/y h:m:s tt","d/MMM/y h:m:s tt","d/MMMM/y h:m:s tt","d/M/yyyy h:m:s tt","d/MMM/yyyy h:m:s tt","d/MMMM/yyyy h:m:s tt","yyyy/M/d h:m:s tt","M/d/yyyy h:mm:ss tt","M-d h:m:s tt","MMM-d h:m:s tt","MMMM-d h:m:s tt","d-M h:m:s tt","d-MMM h:m:s tt","d-MMMM h:m:s tt","M-y h:m:s tt","MMM-y h:m:s tt","M-yyyy h:m:s tt","MMM-yyyy h:m:s tt","M-d-y h:m:s tt","MMM-d-y h:m:s tt","MMMM-d-y h:m:s tt","M-d-yyyy h:m:s tt","MMM-d-yyyy h:m:s tt","MMMM-d-yyyy h:m:s tt","d-M-y h:m:s tt","d-MMM-y h:m:s tt","d-MMMM-y h:m:s tt","d-M-yyyy h:m:s tt","d-MMM-yyyy h:m:s tt","d-MMMM-yyyy h:m:s tt","yyyy-M-d h:m:s tt"]},s.GeneralHourMinuteSecondSubSecondWithDate=function(){return["M/d H:m:s.FFF","MMM/d H:m:s.FFF","MMMM/d H:m:s.FFF","d/M H:m:s.FFF","d/MMM H:m:s.FFF","d/MMMM H:m:s.FFF","M/y H:m:s.FFF","MMM/y H:m:s.FFF","M/yyyy H:m:s.FFF","MMM/yyyy H:m:s.FFF","d/M/y H:m","d/MMM/y H:m","d/MMMM/y H:m","d/M/yyyy H:m","d/mmm/yyyy H:m","d/MMMM/yyyy H:m","yyyy/M/d H:m","M/d/y H:m:s.FFF","MMM/d/y H:m:s.FFF","MMMM/d/y H:m:s.FFF","M/d/yyyy H:m:s","MMM/d/yyyy H:m:s.FFF","MMMM/d/yyyy H:m:s.FFF","d/M/y H:m:s.FFF","d/MMM/y H:m:s.FFF","d/MMMM/y H:m:s.FFF","d/M/yyyy H:m:s.FFF","d/MMM/yyyy H:m:s.FFF","d/MMMM/yyyy H:m:s.FFF","yyyy/M/d H:m:s.FFF","M-d H:m:s.FFF","MMM-d H:m:s.FFF","MMMM-d H:m:s.FFF","d-M H:m:s.FFF","d-MMM H:m:s.FFF","d-MMMM H:m:s.FFF","M-y H:m:s.FFF","MMM-y H:m:s.FFF","M-yyyy H:m:s.FFF","MMM-Yyyy H:m:s.FFF","d-M-y H:m","d-MMM-y H:m","d-MMMM-y H:m","d-M-yyyy H:m","d-MMM-yyyy H:m","d-MMMM-yyyy H:m","yyyy-M-d H:m","M-d-y H:m:s.FFF","MMM-d-y H:m:s.FFF","MMMM-d-y H:m:s.FFF","M-d-yyyy H:m:s","MMM-d-yyyy H:m:s.FFF","MMMM-d-yyyy H:m:s.FFF","D-M-y H:m:s.FFF","d-MMM-y H:m:s.FFF","d-MMMM-y H:m:s.FFF","D-M-yyyy H:m:s.FFF","d-MMM-yyyy H:m:s.FFF","d-MMMM-yyyy H:m:s.FFF","yyyy-M-d H:m:s.FFF","M/d h:m:s.FFF tt","MMM/d h:m:s.FFF tt","MMMM/d h:m:s.FFF tt","d/M h:m:s.FFF tt","d/MMM h:m:s.FFF tt","d/MMMM h:m:s.FFF tt","M/y h:m:s.FFF tt","MMM/y h:m:s.FFF tt","M/yyyy h:m:s.FFF tt","MMM/yyyy h:m:s.FFF tt","d/M/y h:m tt","d/MMM/y h:m tt","d/MMMM/y h:m tt","d/M/yyyy h:m tt","d/mmm/yyyy h:m tt","d/MMMM/yyyy h:m tt","yyyy/M/d h:m tt","M/d/y h:m:s.FFF tt","MMM/d/y h:m:s.FFF tt","MMMM/d/y h:m:s.FFF tt","M/d/yyyy h:m:s tt","MMM/d/yyyy h:m:s.FFF tt","MMMM/d/yyyy h:m:s.FFF tt","d/M/y h:m:s.FFF tt","d/MMM/y h:m:s.FFF tt","d/MMMM/y h:m:s.FFF tt","d/M/yyyy h:m:s.FFF tt","d/MMM/yyyy h:m:s.FFF tt","d/MMMM/yyyy h:m:s.FFF tt","yyyy/M/d h:m:s.FFF tt","M-d h:m:s.FFF tt","MMM-d h:m:s.FFF tt","MMMM-d h:m:s.FFF tt","d-M h:m:s.FFF tt","d-MMM h:m:s.FFF tt","d-MMMM h:m:s.FFF tt","M-y h:m:s.FFF tt","MMM-y h:m:s.FFF tt","M-yyyy h:m:s.FFF tt","MMM-Yyyy h:m:s.FFF tt","d-M-y h:m tt","d-MMM-y h:m tt","d-MMMM-y h:m tt","d-M-yyyy h:m tt","d-MMM-yyyy h:m tt","d-MMMM-yyyy h:m tt","yyyy-M-d h:m tt","M-d-y h:m:s.FFF tt","MMM-d-y h:m:s.FFF tt","MMMM-d-y h:m:s.FFF tt","M-d-yyyy H:m:s tt","MMM-d-yyyy H:m:s.FFF tt","MMMM-d-yyyy h:m:s.FFF tt","d-M-y h:m:s.FFF tt","d-MMM-y h:m:s.FFF tt","d-MMMM-y h:m:s.FFF tt","d-M-yyyy h:m:s.FFF tt","d-MMM-yyyy h:m:s.FFF tt","d-MMMM-yyyy h:m:s.FFF tt","yyyy-M-d h:m:s.FFF tt"]},s.EvaluateFormat=function(n){if(!n||n===r.Empty)return!1;var t=u;return t.ContainsKeywords(n,t._keywords,t._keywordsSet)},s.GeneralPlaceholder="@NumberFormat",s.GeneralNumber="##################0.################",s}(u),bt=function(){function n(n,t){this.formatCached=n;this.cultureName=t;this.typeName=""}return n.prototype.Format=function(n,t){return i},n.prototype.Parse=function(n){return i},n.prototype.FormatString=function(){return this.formatCached},n.prototype.toJSON=function(){var t={};for(var n in this)this.hasOwnProperty(n)&&(t[n]=this[n]);return t},n.prototype.fromJSON=function(n){if(n)for(var t in n)n[t]!==f&&(this[t]=n[t])},n}();n.CustomFormatterBase=bt})(n.Sheets||(n.Sheets={}));var t=n.Sheets})(GcSpread||(GcSpread={}))
